VERSION 5.00
Begin VB.Form F1020701 
   BackColor       =   &H00FFFFFF&
   Caption         =   "ëOéÿÇËÉäÉXÉg"
   ClientHeight    =   6960
   ClientLeft      =   2025
   ClientTop       =   2265
   ClientWidth     =   11295
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   ForeColor       =   &H00000000&
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   6960
   ScaleWidth      =   11295
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton Command1 
      Caption         =   "àÛç¸íÜíf"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4680
      TabIndex        =   13
      Top             =   3600
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.Label LabJIGYO 
      Appearance      =   0  'Ã◊Øƒ
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      BackStyle       =   0  'ìßñæ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   315
      Left            =   120
      TabIndex        =   14
      Top             =   6480
      Width           =   180
   End
   Begin VB.Label Label1 
      BackColor       =   &H00FFFFFF&
      Caption         =   "àÛç¸íÜÇ≈Ç∑"
      Height          =   255
      Left            =   4800
      TabIndex        =   12
      Top             =   3000
      Visible         =   0   'False
      Width           =   1335
   End
End
Attribute VB_Name = "F1020701"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim PRT_CAN As Boolean                  'àÛç¸ìríÜÉLÉÉÉìÉZÉãóp
Dim NormalFont As New StdFont           'àÛç¸ÉtÉHÉìÉg

Const LMAX% = 46                        'ï≈ì‡ç≈ëÂçsêî
Const MGN_L% = 4                        'ñæç◊àÛç¸äJénåÖà íuÅiÇPÇ©ÇÁÅj
Const MGN_U% = 1                        'è„ó]îíÅiçsêîÅFÇPÇ©ÇÁÅj
Dim Pdate As String                     'àÛç¸äJénì˙ïtÅiÕØ¿ﬁ∞ópÅj
Dim Ptime As String                     'àÛç¸äJénéûçèÅiÕØ¿ﬁ∞ópÅj


Private Sub Print_Proc()

Dim Lcnt            As Integer
Dim sts             As Integer
Dim i               As Integer
Dim SV_JGYOBU       As String * 1
Dim Prt_JGYOBU      As String * 1
Dim RetBuf          As String
Dim com             As Integer
    
    
'àÛç¸íÜÇÕÅuàÛç¸íÜífÅvà»äOÇÃÉCÉxÉìÉgéÊìæïsâ¬
    Call Input_Lock           'âÊñ çÄñ⁄ÉçÉbÉN
    Label1.Visible = True
    DoEvents
    Command1.Visible = True
    DoEvents
    Command1.Enabled = True


    PRT_CAN = False

    
    Lcnt = 99
    Set Printer.Font = NormalFont
    Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    Pdate = Date
    Ptime = Time
    SV_JGYOBU = ""
    
    
    com = BtOpGetFirst
    Do
        DoEvents
                                            'àÛç¸íÜífóvãÅ
        If PRT_CAN Then
            Printer.KillDoc
            Exit Sub
        End If
        
        sts = BTRV(com, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)

        Select Case sts
            Case BtNoErr
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "ì¸â◊É`ÉFÉbÉNÉtÉ@ÉCÉãÅiëOéÿÇËÅj")
                Exit Sub
        End Select
        
        If SV_JGYOBU = " " Then
            SV_JGYOBU = StrConv(J_NYUREC.JGYOBU, vbUnicode)
        End If
        
        If SV_JGYOBU <> StrConv(J_NYUREC.JGYOBU, vbUnicode) Then
            SV_JGYOBU = StrConv(J_NYUREC.JGYOBU, vbUnicode)
            Lcnt = LMAX + 1
        End If
                                        'ÉwÉbÉ_Å[
        If (Lcnt > LMAX) Then
            Call Print_Head(Lcnt)
            Prt_JGYOBU = ""
        End If
    
        Printer.Print
        Printer.Print Tab(MGN_L + 3);
        If Prt_JGYOBU <> StrConv(J_NYUREC.JGYOBU, vbUnicode) Then
            For i = 0 To UBound(JGYOBU_T)
                If StrConv(J_NYUREC.JGYOBU, vbUnicode) = JGYOBU_T(i).CODE Then
                    Printer.Print RTrim(JGYOBU_T(i).NAME);
                End If
            Next i
        End If
        
        Prt_JGYOBU = StrConv(J_NYUREC.JGYOBU, vbUnicode)
        Printer.Print Tab(MGN_L + 20);
        If StrConv(J_NYUREC.NAIGAI, vbUnicode) = NAIGAI_GAI Then
            Printer.Print NAIGAI2;
        Else
            Printer.Print "Å@Å@";
        End If
        Printer.Print "  " + StrConv(J_NYUREC.HIN_GAI, vbUnicode);
        
        Printer.Print Tab(MGN_L + 46);
        
        Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(J_NYUREC.JGYOBU, vbUnicode))
        Call UniCode_Conv(K0_ITEM.NAIGAI, StrConv(J_NYUREC.NAIGAI, vbUnicode))
        Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(J_NYUREC.HIN_GAI, vbUnicode))
        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                Printer.Print StrConv(ITEMREC.HIN_NAME, vbUnicode);
                Printer.Print Tab(MGN_L + 86);
                Printer.Print Left(StrConv(ITEMREC.HIN_NAI, vbUnicode), 13);
            Case BtErrKeyNotFound
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
                Exit Sub
        End Select
        
        Printer.Print Tab(MGN_L + 116);
        RetBuf = Format(CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)), "#,##0")
        If Len(Trim(RetBuf)) < 10 Then
        
            RetBuf = Space(10 - Len(Trim(RetBuf))) & RetBuf
        End If
        
        
        Printer.Print RetBuf

        Lcnt = Lcnt + 2
        
        
        com = BtOpGetNext
    
    Loop

    If Lcnt <> 99 Then
        Printer.EndDoc
    End If
    




End Sub

Private Sub Print_Head(Lcnt As Integer)
                                        
Dim i       As Integer
Dim RetBuf  As String
Dim sts     As Integer

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
                                        'ÉwÉbÉ_Å[ÅiÇPÅj
    Printer.Print Tab(26);
    Printer.Print "ÅñÅñÅñ  ëOéÿÇËÉäÉXÉg  ÅñÅñÅñ";
    Printer.Print Tab(85);
    Printer.Print "ñ{ì˙" & Pdate; "ï™" & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")

    Printer.Print
                                        
                                        'ñæç◊àÛç¸
    Printer.Print Tab(MGN_L + 3);
    Printer.Print "éñã∆ïî";
    Printer.Print Tab(MGN_L + 26);
    Printer.Print "ïiî‘ÅiäOïîÅj";
    Printer.Print Tab(MGN_L + 46);
    Printer.Print "ïi  ñº  ";
    Printer.Print Tab(MGN_L + 86);
    Printer.Print "ïiî‘Åiì‡ïîÅj";
    Printer.Print Tab(MGN_L + 118);
    Printer.Print "ëOéÿÇËêî";
    Printer.Print

    Lcnt = 6 + MGN_U

End Sub


Private Sub Command1_Click()
    PRT_CAN = True
End Sub

Private Sub Form_Activate()
Dim Ans As Integer
    
    Beep
    Ans = MsgBox("ÅuëOéÿÇËÉäÉXÉgÅvàÛç¸ÇµÇ‹Ç∑Ç©ÅH", vbYesNo)
    If Ans = vbYes Then
        Call Print_Proc
    End If
    
    Unload Me

End Sub

Private Sub Form_DblClick()
    PrintForm
End Sub
Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub

Private Sub Form_Load()
Dim i As Integer
Dim c As String * 128
Dim sts As Integer

    If App.PrevInstance Then
        Beep
        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If

    Show
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)


                                'éñã∆ïîéÊÇËçûÇ›
    If JGYOB_TB_Set Then
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

                                'ïiñ⁄É}ÉXÉ^OPEN
    If ITEM_Open(0) Then
        Unload Me
    End If
                                'ì¸â◊É`ÉFÉbÉNÉtÉ@ÉCÉãOPEN
    If J_NYU_Open(0) Then
        Unload Me
    End If
                                'àÛç¸ÉtÉHÉìÉgê›íË
    With NormalFont
        .NAME = F1020701.FontName
        .Size = F1020701.FontSize
    End With
    Set Printer.Font = NormalFont
    
    
    End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer
    
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ì¸â◊É`ÉFÉbÉNÉtÉ@ÉCÉãÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊É`ÉFÉbÉNÉtÉ@ÉCÉã")
        End If
    End If
    
    sts = BTRV(BtOpReset, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set F1020701 = Nothing

    End
End Sub


Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------

    F1020701.MousePointer = vbHourglass

    Call Ctrl_Lock(F1020701)


End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------

    Call Ctrl_UnLock(F1020701)


    F1020701.MousePointer = vbDefault

End Sub

