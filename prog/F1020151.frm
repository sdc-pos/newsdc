VERSION 5.00
Begin VB.Form F1020151 
   BackColor       =   &H00FFFFFF&
   Caption         =   "ì¸èoâ◊ó\íËÉfÅ[É^éÊçûÇ› (F102015 2016.03.08 09ÅF30) "
   ClientHeight    =   4170
   ClientLeft      =   1905
   ClientTop       =   2385
   ClientWidth     =   8580
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   4170
   ScaleWidth      =   8580
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.ListBox LBox_Hin 
      Height          =   300
      Left            =   1560
      TabIndex        =   25
      Top             =   3840
      Width           =   4455
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   6360
      TabIndex        =   24
      Top             =   3240
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   6360
      TabIndex        =   23
      Top             =   2640
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   6360
      TabIndex        =   22
      Top             =   2040
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   6360
      TabIndex        =   21
      Top             =   1440
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   6360
      TabIndex        =   20
      Top             =   840
      Width           =   1695
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   5760
      TabIndex        =   19
      Top             =   3240
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   5760
      TabIndex        =   18
      Top             =   2640
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   5760
      TabIndex        =   17
      Top             =   2040
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5760
      TabIndex        =   16
      Top             =   1440
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   5760
      TabIndex        =   15
      Top             =   840
      Width           =   495
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   14
      Top             =   3240
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3960
      TabIndex        =   13
      Top             =   2640
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   3960
      TabIndex        =   12
      Top             =   2040
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   3960
      TabIndex        =   11
      Top             =   1440
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   3960
      TabIndex        =   10
      Top             =   840
      Width           =   1695
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3360
      TabIndex        =   9
      Top             =   3240
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3360
      TabIndex        =   8
      Top             =   2640
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   3360
      TabIndex        =   7
      Top             =   2040
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   3360
      TabIndex        =   6
      Top             =   1440
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   3360
      TabIndex        =   5
      Top             =   840
      Width           =   495
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   960
      TabIndex        =   4
      Top             =   3240
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   960
      TabIndex        =   3
      Top             =   2640
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   960
      TabIndex        =   2
      Top             =   2040
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   1
      Top             =   1440
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   960
      TabIndex        =   0
      Top             =   840
      Width           =   2295
   End
End
Attribute VB_Name = "F1020151"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private WS_NO       As String * 3           '‹∞∏Ω√∞ºÆ›î‘çÜ

Private FileName    As String               'ÉeÉLÉXÉgÉtÉ@ÉCÉãñº
Private FileNo      As Integer              'ÉtÉ@ÉCÉãáÇ

Private KASO_NYUKA_SOKO      As String * 2  'âºëzì¸â◊ëqå…î‘çÜ
Private KASO_SMODOSHI_SOKO   As String * 2  'âºëzéxããñﬂÇµëqå…î‘çÜ

Private Proc_F      As Integer              'ïiî‘Åïç›å…óLñ≥Å@îªíËÉtÉâÉO
Private Last_Proc_F As Integer              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉO
                                            
Private Type YUKO_SOKO_TBL                  'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÉeÅ[ÉuÉã
    HS_SOKO             As String * 8
    NAIGAI              As String * 1
End Type

Dim Soko_T()            As YUKO_SOKO_TBL  'ëqå…èÓïÒ

'-                                          2005.12.30
Private Type SHIMUKE_TBL
    SHIMUKE_CODE            As String * 2   'édå¸ÇØêÊ
    JGYOBU                  As String * 1   'éñã∆ïî
    NAIGAI                  As String * 1   'çëì‡äO
End Type

Private SHIMUKE_T()         As SHIMUKE_TBL

Private SHIMUKE_Flg         As Boolean

'-                                          2005.12.30


Private New_HS_IN_SIJ   As String           'ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñº
Private New_HS_OUT_SIJ  As String           'êV⁄≤±≥ƒèoå…ÉfÅ[É^ÉtÉ@ÉCÉãñº


Private In_Cnt      As Integer              'ÉfÅ[É^ì«Ç›çûÇ›åèêî
Private Out_Cnt     As Integer              'ÉfÅ[É^èoóÕåèêî

Private Const In_Mode% = 1                  'ì¸â◊èàóù
Private Const Out_Mode% = 2                 'èoâ◊èàóù

                                            
Dim NormalFont As New StdFont               'àÛç¸ÉtÉHÉìÉg

Private Const LMAX% = 46                    'ï≈ì‡ç≈ëÂçsêî
Private Const MGN_L% = 1                    'ñæç◊àÛç¸äJénåÖà íuÅiÇPÇ©ÇÁÅj
Private Const MGN_U% = 1                    'è„ó]îíÅiçsêîÅFÇPÇ©ÇÁÅj
Private Pdate As String                     'àÛç¸äJénì˙ïtÅiÕØ¿ﬁ∞ópÅj
Private Ptime As String                     'àÛç¸äJénéûçèÅiÕØ¿ﬁ∞ópÅj


Private Const NAI_CHANGE% = 1
Private Const GAI_CHANGE% = 2
Private Const NOT_GAI_CHANGE% = 3


Private ETC_MTS_NAI As String * 8             'ÇªÇÃëºå¸ÇØêÊ(çëì‡)
Private ETC_SS_NAI  As String * 8             'ÇªÇÃëºíºëóêÊ(çëì‡)

Private ETC_MTS_GAI As String * 8             'ÇªÇÃëºå¸ÇØêÊ(äCäO)
Private ETC_SS_GAI  As String * 8             'ÇªÇÃëºíºëóêÊ(äCäO)

Dim DUP_SYUKA_DATA  As String                 'èoâ◊ÉfÅ[É^ÉtÉãÉpÉX

                                        
Dim MyCenter        As String

Dim Err_FLg         As Boolean

Dim TANA_SPACE      As Boolean          '2009.03.07
                                        
Private MENU_NO     As String * 2       'é¿ê—ÉçÉOèoóÕóp“∆≠∞áÇ   2007.11.06
                                        
                                        
                                        
Dim RYOHEN_TANA     As String * 8       'ó«ïiï‘ïiì¸å…íIî‘       2011.01.18
                                        
'è§ïiâªåvâÊéxâá 2011.07.07
Dim NOT_Hin_Name    As Variant          'èúäOïiñº
Dim NOT_Hin_Name_F  As Boolean          'èúäOïiñºóLñ≥
'è§ïiâªåvâÊéxâá 2011.07.07
Dim GOODS_F         As String * 1       'è§ïiâªóLñ≥Å@√ﬁÃ´Ÿƒ 2012.12.20
                                        
                                        
Private Function New_Nyuka_Update_Proc(JGYOBU As String) As Boolean
'----------------------------------------------------------------------------
'                   Åuì¸â◊ó\íËÉfÅ[É^ÅvçXêVèàóù
'----------------------------------------------------------------------------

''''''''''''''''''''''''''''''' ëSÇƒîpé~ 2009.06.18
'''Dim i           As Integer
'''Dim j           As Integer
'''Dim Skip_Flg    As Boolean
    
'''Dim WK_Y_QTY    As Long     'èoâ◊êîÉèÅ[ÉN
'''Dim WK_Qty      As Long     'ëOéÿécÉèÅ[ÉN
'''Dim WK_E_QTY    As Long     'êÊçsèoâ◊êîÉèÅ[ÉN

'''Dim SUMI_QTY    As Long     'è§ïiâªçœÇ›Ç∆ÇµÇƒìoò^
'''Dim MI_QTY      As Long     'ñ¢è§ïiÇ∆ÇµÇƒìoò^

'''Dim Work_SOKO     As String * 2
    
'''Dim sts         As Integer
'''Dim ans         As Integer
'''Dim Not_SHUSI   As Boolean
    
''''èoâ◊ó\íË ï“èWëOèàóù ################################################################# 2005/05/16 Add Å´
'''Dim Fast_Flg        As Boolean
'''Dim DUP_SYUKANo     As Integer
'''Dim fileName        As String
'''Dim Ret             As Integer
'''Dim INS_NOW         As String * 14
'''Dim wkStr           As String
    
'''Dim wkMUKE_CODE     As String
    
    
'''Dim NAIGAI          As String * 1
    
'''''''''''''''''''''''''''''   ëSÇƒÇÃì¸â◊èàóùÇîpé~    2007.06.22
'''    Fast_Flg = True
'''
'''
'''
'''    DUP_SYUKANo = FreeFile
'''    fileName = DUP_SYUKA_DATA
'''
'''    Ret = InStr(1, Trim(fileName), ".") - 1
'''    fileName = Left(Trim(fileName), Ret) & Format(Now, "YYYYMMDDHHMMSS") & "_" & Last_JGYOBU & Right(Trim(fileName), Len(Trim(fileName)) - Ret)
'''
'''    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")
''''#################################################################################### 2005/05/16 Add Å™
'''
'''    New_Nyuka_Update_Proc = True
'''
'''
'''    Do
'''        Get #FileNo, , New_HS_IN_SIJREC
'''        If Left(StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode), 1) < " " Then
'''            Exit Do
'''        End If
'''
'''        If StrConv(New_HS_IN_SIJREC.CR_LF, vbUnicode) <> vbCrLf Then
'''
'''            Call NG_File_Make_Proc
'''
'''
'''            Exit Do
'''        End If
'''
'''
'''        In_Cnt = In_Cnt + 1
'''        lblINCNT(i).Caption = Format(In_Cnt, "#0")
'''        DoEvents
'''
'''
''''        Skip_Flg = True
''''        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
''''            If JGYOBU = JGYOBU_T(i).CODE Then
''''                For j = 0 To UBound(Soko_T, 2)
''''                    If StrConv(HS_IN_SIJREC.HOST_SOKO, vbUnicode) = Soko_T(i, j).HS_SOKO Then
''''                        Skip_Flg = False
''''                        Exit For
''''                    End If
''''                Next j
''''                Exit For
''''            End If
''''        Next i
'''
''''--     2005.12.30
'''        Skip_Flg = True
'''        Not_SHUSI = False
'''        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
'''            If JGYOBU = JGYOBU_T(i).CODE Then
'''                For j = 0 To UBound(Soko_T, 2)
'''                    If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = Soko_T(i, j).HS_SOKO Then
'''                        Skip_Flg = False
'''                        Exit For
'''                    End If
'''                Next j
'''                Exit For
'''            End If
'''        Next i
'''
'''        If Skip_Flg Then
'''            Not_SHUSI = True
'''        End If
''''--     2005.12.30
'''
'''
'''
'''
'''
'''        If StrConv(New_HS_IN_SIJREC.IO_KBN, vbUnicode) <> "1" Then
'''            Skip_Flg = True
'''        End If
'''
'''
'''        If StrConv(New_HS_IN_SIJREC.PM_KBN, vbUnicode) = "-" Then
'''            Skip_Flg = True
'''        End If
'''
'''        'NOPOS  2006.05.01
'''        If Trim(StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode)) = "NOPOS" Then
'''            Skip_Flg = True
'''        End If
'''
'''
'''
'''
'''
'''
'''        Work_SOKO = KASO_NYUKA_SOKO
'''
'''
'''
'''        Select Case JGYOBU
'''
'''''            Case SENTAKU                        'êÙëÛã@
'''''
'''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "P2" Then
'''''                    Skip_Flg = True
'''''                End If
'''''
'''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 1) = "9" Then
'''''                    Skip_Flg = True
'''''                End If
'''
'''
'''
'''
'''            Case SOJIKI                         'ë|èúã@
'''
'''
'''                If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KM" Then
'''                    Skip_Flg = True
'''                End If
'''
'''                If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KK" Then
'''                    Skip_Flg = True
'''                End If
'''
'''                If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "GG" Then
'''                    Skip_Flg = True
'''                End If
'''
'''                If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "SS" Then
'''                    Skip_Flg = True
'''                End If
'''
'''                '2005.04.07 é˚éxí«â¡
'''                If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 5) = "0090K" Then
'''                    Skip_Flg = True
'''                End If
'''
'''
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KM" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "KK" Then
''''                    Skip_Flg = True
''''                End If
'''
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KK" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "KM" Then
''''                    Skip_Flg = True
''''                End If
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "GG" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "KK" Then
''''                    Skip_Flg = True
''''                End If
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KK" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "GG" Then
''''                    Skip_Flg = True
''''                End If
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "KK" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "SS" Then
''''                    Skip_Flg = True
''''                End If
'''
''''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "SS" And _
''''                    Left(StrConv(HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "KK" Then
''''                    Skip_Flg = True
''''                End If
'''
'''
'''                If Trim(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) <> "91H" Then
'''                    Work_SOKO = KASO_SMODOSHI_SOKO
'''                End If
'''
'''
'''
'''            Case DENKA, SUIHAN, SENTAKU         'ìdâªÅAêÜî—ÅAêÙëÛã@ÅiÉAÉCÉçÉìÅj
'''
'''
'''                Select Case MyCenter
'''
'''                    Case "O"
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "01" Then
'''                            Skip_Flg = True
'''                        End If
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 3) = "H33" Then    '2004.07.16
'''                            Skip_Flg = True
'''                        End If
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 3) = "H22" Then    '2004.07.16
'''                            Skip_Flg = True
'''                        End If
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "05" Then
'''                            Skip_Flg = True
'''                        End If
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 3) = "G22" Then
'''                            Work_SOKO = "80"
'''                        End If
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 3) = "G11" Then
'''                            Work_SOKO = "81"
'''                        End If
'''
'''                        '2006.04.29óp
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "S1" And _
'''                            Left(StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "S3" Then
'''                            Work_SOKO = "87"
'''                        End If
'''                        '2006.05.01
'''                        If Trim(StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode)) = "POS87" Then
'''                            Work_SOKO = "87"
'''                        End If
'''
'''
'''                    Case "F"
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "P2" Then
'''                            Skip_Flg = True
'''                        End If
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 3) <> "904" Then
'''                            If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 1) = "9" Then
'''                              Skip_Flg = True
'''                            End If
'''                        End If
'''
'''
'''                        If Left(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "S1" And _
'''                            Left(StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode), 2) = "S2" Then
'''                            Work_SOKO = "88"
'''                        End If
'''
'''                        '2006.05.01
'''                        If Trim(StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode)) = "POS88" Then
'''                            Work_SOKO = "88"
'''                        End If
'''
'''
'''                End Select
'''             Case AIRCON                     'ÉGÉAÉRÉì
'''
'''                If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "J4" Or _
'''                    StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "JG" Or _
'''                    StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "JW" Or _
'''                    StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "JV" Or _
'''                    StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "HY" Then
'''                    Skip_Flg = True
'''                End If
'''
'''
'''                If Trim(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) = "SH" Then
'''                    Skip_Flg = True
'''                End If
'''
'''
'''                If Trim(StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) = "S1" Then
'''                    If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "OS" Then
'''                      Skip_Flg = True
'''                    End If
'''                End If
'''
'''                If Not Skip_Flg Then
''''---------------    2005.06.14
'''                    If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "S8" Then
'''                        Work_SOKO = "80"
'''                    Else
'''                        If StrConv(New_HS_IN_SIJREC.CYU_KBN, vbUnicode) = "A" Then
'''                            If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "SH" Then
'''                                Work_SOKO = "92"
'''                            Else
'''                                Work_SOKO = "95"
'''                            End If
'''                        Else
'''                            If StrConv(New_HS_IN_SIJREC.CYU_KBN, vbUnicode) = "D" Then
'''                                Work_SOKO = "70"
'''                            Else
''''---------------    2005.06.14
'''                                If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "SH" Then
'''                                    Work_SOKO = "92"
'''                                Else
'''
''''                                    If StrConv(HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "S8" Then
''''                                        Work_SOKO = "80"
''''                                    Else
'''                                        Work_SOKO = "95"
''''                                    End If
'''                                End If
'''                            End If
'''                        End If
'''                    End If
'''                End If
'''
'''
'''
'''        End Select
'''
'''
'''
'''
'''
'''
'''
'''        If Not Skip_Flg Then
'''
'''
'''
'''
'''                                        'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
'''            Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
'''            Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''            Call UniCode_Conv(K0_Y_NYU.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''
'''            sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'''            Select Case sts
'''                Case BtNoErr
'''                    Call Log_Out(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''                    Skip_Flg = True
'''                Case BtErrKeyNotFound
'''                Case Else
'''                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
'''                    Exit Function
'''            End Select
'''
'''            If Not Skip_Flg Then
'''                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
'''                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'''                If sts <> BtNoErr Then
'''                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
'''                    Exit Function
'''                End If
'''                                            'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
'''                If Item_Check_Proc(In_Mode, JGYOBU, Soko_T(i, j).NAIGAI, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode)) Then
'''                    GoTo Abort_Tran
'''                End If
'''
'''
'''                                            'ì¸â◊ÉfÅ[É^çÏê¨
'''                Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
'''                Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
'''                Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
'''                Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
'''                Call UniCode_Conv(Y_NYUREC.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''
'''
'''
'''
'''
'''
'''                Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
'''                Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.ID_NO, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.KAIKEI_JGYOBA, "")
'''                Call UniCode_Conv(Y_NYUREC.SHISAN_JGYOBA, "")
'''
'''
'''                Call UniCode_Conv(Y_NYUREC.HIN_NO, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.DEN_NO, StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(StrConv(New_HS_IN_SIJREC.YOTEI_QTY, vbUnicode)), "0000000"))
'''                Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
'''                Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.SHISAN_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.HOJYO_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.TANKA, "")
'''                Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
'''                Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
'''                Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
'''                Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
'''                Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
'''                Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
'''                Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
'''                Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
'''                Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
'''                Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.S_SHISAN_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.S_HOJYO_SYUSI, "")
'''
'''
'''                Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
'''                Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.HIN_NAME, StrConv(New_HS_IN_SIJREC.HIN_NAME, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
'''                Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.ZAN_SHISAN_SYUSI, "")
'''                Call UniCode_Conv(Y_NYUREC.ZAN_HOJYO_SYUSI, "")
'''
'''
'''                Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
'''                Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
'''                Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
'''
'''                Call UniCode_Conv(Y_NYUREC.SS_CODE, "")
'''                Call UniCode_Conv(Y_NYUREC.KEPIN_KAIJYO, "")
'''
'''
'''                Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
'''
'''
'''                Last_Proc_F = True              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇË
'''
'''
'''                'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
'''                Call UniCode_Conv(K0_J_NYU.JGYOBU, JGYOBU)
'''                Call UniCode_Conv(K0_J_NYU.NAIGAI, Soko_T(i, j).NAIGAI)
'''                Call UniCode_Conv(K0_J_NYU.HIN_GAI, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'''
'''                WK_Y_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''
'''
'''                Do
'''                    sts = BTRV(BtOpGetEqual + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
'''                    Select Case sts
'''                        Case BtNoErr
'''                            If CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) > WK_Y_QTY Then
'''                                WK_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) - WK_Y_QTY
'''                                Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(WK_Qty, "00000000"))
'''
'''                                Do
'''
'''                                    sts = BTRV(BtOpUpdate, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
'''                                    Select Case sts
'''                                        Case BtNoErr
'''                                            Exit Do
'''                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                                            Beep
'''                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                                            If ans = vbCancel Then
'''                                                Exit Function
'''                                            End If
'''                                        Case Else
'''                                            Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿")
'''                                            Exit Function
'''                                    End Select
'''
'''                                Loop
'''                                WK_E_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                            Else
'''                                Do
'''                                    sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
'''                                    Select Case sts
'''                                        Case BtNoErr
'''                                            Exit Do
'''                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                                            Beep
'''                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                                            If ans = vbCancel Then
'''                                                Exit Function
'''                                            End If
'''                                        Case Else
'''                                            Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿")
'''                                            Exit Function
'''                                    End Select
'''                                Loop
'''                                WK_E_QTY = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
'''                            End If
'''
'''                            Exit Do
'''                        Case BtErrKeyNotFound
'''                            WK_E_QTY = 0
'''                            Exit Do
'''                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                            Beep
'''                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                            If ans = vbCancel Then
'''                                Exit Function
'''                            End If
'''                        Case Else
'''                            Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿")
'''                            Exit Function
'''                    End Select
'''                Loop
'''                                    'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
'''                Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, Format(WK_E_QTY, "00000000"))
'''
'''                                    'ó\éZíPà å≥
'''                Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode))
'''                                    'ó\éZíPà êÊ
'''                Call UniCode_Conv(Y_NYUREC.YOSAN_TO, StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode))
'''                                    'ïWèÄíIî‘
'''                Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
'''                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
'''                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
'''                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
'''                Call UniCode_Conv(Y_NYUREC.HIN_NAI, StrConv(New_HS_IN_SIJREC.HIN_NAI, vbUnicode))
'''
'''                Call UniCode_Conv(Y_NYUREC.FILLER, "")
'''
'''                Do
'''                    sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'''                    Select Case sts
'''                        Case BtNoErr
'''                            Exit Do
'''                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                            Beep
'''                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                            If ans = vbCancel Then
'''                                Exit Function
'''                            End If
'''                        Case Else
'''                            Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'''                            Exit Function
'''                    End Select
'''                Loop
'''
''''------------ 2005.12.30
'''                Select Case JGYOBU
'''                    Case AIRCON, SENTAKU
'''                        Call UniCode_Conv(K0_SOKO.Soko_No, Work_SOKO)
'''                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
'''                        Select Case sts
'''                            Case BtNoErr
'''                            Case Else
'''                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^")
'''                                Exit Function
'''                        End Select
'''
'''                        If StrConv(SOKOREC.GOODS_ON_F, vbUnicode) = GOODS_ON Then
'''
'''                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                            MI_QTY = 0
'''                        Else
'''
'''                            If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
'''                                MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                                SUMI_QTY = 0
'''                            Else
'''                                SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                                MI_QTY = 0
'''                            End If
'''                        End If
'''
''''------------ 2005.12.30
'''
'''                    Case Else
'''
'''
'''                        If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
'''                            MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                            SUMI_QTY = 0
'''                        Else
'''                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'''                            MI_QTY = 0
'''                        End If
'''                End Select
'''
'''
''''                Wk_SOKO = KASO_NYUKA_SOKO
''''                If Trim(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) <> "91H" Then
''''                    Wk_SOKO = KASO_SMODOSHI_SOKO
''''
''''                End If
'''
'''                'ì¸â◊êîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ{Åj
'''                If Nyuko_Update_Proc(JGYOBU, _
'''                                    Soko_T(i, j).NAIGAI, _
'''                                    StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode), _
'''                                    StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
'''                                    (Work_SOKO & "01" & "01" & "01"), _
'''                                    YOIN_TU_NYUKA, _
'''                                    SUMI_QTY, MI_QTY, _
'''                                    WS_NO, WS_NO, , _
'''                                    StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode) & " ì`áÇ:" & StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode)) Then
'''                    Exit Function
'''
'''                End If
'''
'''                'ëOéÿÇËêîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ|Åj
'''                If WK_E_QTY <> 0 Then
'''                'ç›å…ÉfÅ[É^LOCK
'''                    If Zaiko_Lock_Proc((Work_SOKO & "01" & "01" & "01"), _
'''                                        JGYOBU, _
'''                                        Soko_T(i, j).NAIGAI, _
'''                                        StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode), _
'''                                        WS_NO) Then
'''                        Exit Function
'''
'''                    End If
'''
'''                    If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
'''                        MI_QTY = WK_E_QTY
'''                    Else
'''                        SUMI_QTY = WK_E_QTY
'''                    End If
'''
'''
'''                    If Syuko_Update_Proc(JGYOBU, _
'''                                        Soko_T(i, j).NAIGAI, _
'''                                        StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode), _
'''                                        StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode), _
'''                                        (Work_SOKO & "01" & "01" & "01"), _
'''                                        YOIN_MAE_SOUSAI, _
'''                                        SUMI_QTY, MI_QTY, 0, _
'''                                        WS_NO, WS_NO) Then
'''                        Exit Function
'''
'''                    End If
'''
'''
'''
'''
'''
'''
'''                End If
'''
'''
'''                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'''                If sts <> BtNoErr Then
'''                    GoTo Abort_Tran
'''                End If
'''
'''
'''                Out_Cnt = Out_Cnt + 1
'''                lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
'''                DoEvents
'''
'''            End If
'''
'''
'''
'''
'''
''''èoâ◊ó\íËïœä∑################################################## 2005/05/16 Add é†âÍï®ó¨Å´
'''        Else
'''
'''            If JGYOBU = AIRCON Then
'''
'''                If Not_SHUSI Then
'''                Else
'''                    If StrConv(New_HS_IN_SIJREC.IO_KBN, vbUnicode) = "2" Then
'''
'''
'''                        wkMUKE_CODE = ""
'''
'''                        If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "S8" Then
'''                            wkMUKE_CODE = "S8"
'''                        Else
'''                            If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "SH" Then
'''                            Else
'''                                Select Case Trim(StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode))
'''
'''                                    Case "Z0014"
'''                                        wkMUKE_CODE = "LM"
'''                                    Case "B0070"
'''                                        If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = "S2" Then
'''                                            wkMUKE_CODE = "S2"
'''                                        Else
'''                                            wkMUKE_CODE = "AC"
'''                                        End If
'''                                    Case Else
'''                                        wkMUKE_CODE = "AC"
'''                                End Select
'''                            End If
'''                        End If
'''
'''
'''                        If wkMUKE_CODE = "" Then
'''                        Else
'''                            Skip_Flg = False
'''                                                        'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
'''                            Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
'''                            Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                            Call UniCode_Conv(K0_Y_NYU.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''
'''                            sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'''                            Select Case sts
'''                                Case BtNoErr
'''                                    Call Log_Out(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''                                    Skip_Flg = True
'''                                Case BtErrKeyNotFound
'''                                Case Else
'''                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
'''                                    Exit Function
'''                            End Select
'''
'''
'''
'''
'''
'''        ''                                    'èoâ◊ó\íËèdï°É`ÉFÉbÉN
'''        ''                    Call UniCode_Conv(K0_Y_SYU.JGYOBU, JGYOBU)
'''        ''                    Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode))
'''        ''
'''        ''                    sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
'''        ''                    Select Case sts
'''        ''                        Case BtNoErr
'''        ''                            Call Log_Out(LOG_F, "Y_SYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ì`ï[ÇhÇcÅÅ" & StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode))
'''        ''                            Skip_Flg = True
'''        ''
'''        ''                            If Fast_Flg Then
'''        ''                                Open (fileName) For Output As DUP_SYUKANo
'''        ''                                Write #DUP_SYUKANo, , , "èoâ◊èdï°ÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")
'''        ''                                Write #DUP_SYUKANo, "èoâ◊ì˙", "ì`ï[áÇ", "éxï•êÊ∫∞ƒﬁ", "ëqå…/ÇrÇr∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"
'''        ''                                Fast_Flg = False
'''        ''                            End If
'''        ''
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.SYUKA_YMD, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.DEN_NO, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.MUKE_NAME, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.CHU_KBN, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.CHU_KBN_NAME, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.HIN_NO, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.SURYO, vbUnicode),
'''        ''                            Write #DUP_SYUKANo, StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode)
'''        ''
'''        ''                        Case BtErrKeyNotFound
'''        ''                        Case Else
'''        ''                            Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË")
'''        ''                            Exit Function
'''        ''                    End Select
'''
'''                            If Not Skip_Flg Then
'''
'''                                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
'''                                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'''                                If sts <> BtNoErr Then
'''                                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
'''                                    Exit Function
'''                                End If
'''                                                                'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
'''                                If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode)) Then
'''                                    GoTo Abort_Tran
'''                                End If
'''
'''        '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
'''                                Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
'''                                Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
'''                                Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
'''                                Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
'''                                Call UniCode_Conv(Y_NYUREC.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''
'''
'''
'''
'''
'''
'''                                Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
'''                                Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.ID_NO, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.KAIKEI_JGYOBA, "")
'''                                Call UniCode_Conv(Y_NYUREC.SHISAN_JGYOBA, "")
'''
'''
'''                                Call UniCode_Conv(Y_NYUREC.HIN_NO, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.DEN_NO, StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(StrConv(New_HS_IN_SIJREC.YOTEI_QTY, vbUnicode)), "0000000"))
'''                                Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
'''                                Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.HOJYO_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.TANKA, "")
'''                                Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
'''                                Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
'''                                Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
'''                                Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
'''                                Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
'''                                Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
'''                                Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
'''                                Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
'''                                Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
'''                                Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.S_SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.S_HOJYO_SYUSI, "")
'''
'''
'''                                Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
'''                                Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.HIN_NAME, StrConv(New_HS_IN_SIJREC.HIN_NAME, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
'''                                Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.ZAN_SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_NYUREC.ZAN_HOJYO_SYUSI, "")
'''
'''
'''                                Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
'''                                Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
'''                                Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
'''
'''                                Call UniCode_Conv(Y_NYUREC.SS_CODE, "")
'''                                Call UniCode_Conv(Y_NYUREC.KEPIN_KAIJYO, "")
'''                                Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
'''                                Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
'''                                Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.YOSAN_TO, StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
'''                                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
'''                                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
'''                                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
'''                                Call UniCode_Conv(Y_NYUREC.HIN_NAI, StrConv(New_HS_IN_SIJREC.HIN_NAI, vbUnicode))
'''
'''                                Call UniCode_Conv(Y_NYUREC.FILLER, "")
'''
'''                                Do
'''                                    sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'''                                    Select Case sts
'''                                        Case BtNoErr
'''                                            Exit Do
'''                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                                            Beep
'''                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                                            If ans = vbCancel Then
'''                                                Exit Function
'''                                            End If
'''                                        Case Else
'''                                            Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'''                                            Exit Function
'''                                    End Select
'''                                Loop
'''        '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
'''
'''                                Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
'''                                Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
'''                                Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
'''                                Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
'''                                Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
'''                                Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
'''
'''                                If Den_No_Set_Proc(21, JGYOBU, wkStr) Then
'''                                    GoTo Abort_Tran
'''                                Else
'''                                    Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, wkStr)
'''                                End If
'''
'''                                Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
'''                                Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, wkMUKE_CODE)
'''                                Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
'''                                Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
'''                                Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
'''                                Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
'''
'''                                Call UniCode_Conv(Y_SYUREC.HIN_NO, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.DEN_NO, StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode))
'''                                wkStr = Format(Val(StrConv(New_HS_IN_SIJREC.YOTEI_QTY, vbUnicode)), "0000000")
'''                                Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
'''                                Call UniCode_Conv(Y_SYUREC.MUKE_CODE, wkMUKE_CODE)
'''                                Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
'''
'''                                Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.TANKA, "")
'''
'''
'''                                Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
'''                                Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
'''
'''
'''
'''                                Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''
'''                                Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
'''                                Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
'''                                Call UniCode_Conv(Y_SYUREC.TANABAN3, "")
'''
'''                                Call UniCode_Conv(Y_SYUREC.MUKE_NAME, StrConv(New_HS_IN_SIJREC.SYUK_NAME, vbUnicode))
'''
'''                                Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
'''                                Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
'''                                Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
'''                                Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
'''                                Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
'''                                Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, StrConv(New_HS_IN_SIJREC.CYOK_KBN, vbUnicode))
'''
'''                                Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
'''                                Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
'''                                Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
'''                                Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.HIN_NAME, StrConv(New_HS_IN_SIJREC.HIN_NAME, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
'''                                Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
'''                                Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
'''                                Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
'''                                Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
'''                                Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
'''                                Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")
'''
'''
'''                                Call UniCode_Conv(Y_SYUREC.HIN_NAI, StrConv(New_HS_IN_SIJREC.HIN_NAI, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(New_HS_IN_SIJREC.HOST_TANA, vbUnicode))
'''                                Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
'''                                Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
'''                                Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
'''                                Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
'''                                Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
'''                                Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
'''
'''                                Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, "")       '2006.07.20
'''                                Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, "")              '2006.07.20
'''                                Call UniCode_Conv(Y_SYUREC.LK_MUKE_CODE, wkMUKE_CODE)   '2006.07.20
'''                                Call UniCode_Conv(Y_SYUREC.LK_SEQ_NO, "")               '2006.07.20
'''
'''
'''                                Call UniCode_Conv(Y_SYUREC.FILLER, "")
'''
'''                                Do
'''                                    sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
'''                                    Select Case sts
'''                                        Case BtNoErr
'''                                            Exit Do
'''                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'''                                            Beep
'''                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'''                                            If ans = vbCancel Then
'''                                                Exit Function
'''                                            End If
'''                                        Case Else
'''                                            Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË")
'''                                            Exit Function
'''                                    End Select
'''                                Loop
'''
'''                                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'''                                If sts <> BtNoErr Then
'''                                    GoTo Abort_Tran
'''                                End If
'''
'''                                Out_Cnt = Out_Cnt + 1
'''                                lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
'''                                DoEvents
'''
'''                                If SYUKA_LOG_ON Then
'''                                    Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
'''                                End If
'''
'''                                If Not Fast_Flg Then
'''                                    Close #DUP_SYUKANo
'''                                End If
'''                            End If
'''                        End If
'''                    End If
'''                End If
'''            End If
''''#################################################################################### 2005/05/16 Add Å™
'''
'''
'''
'''
'''
'''        End If
'''
'''    Loop
'''    New_Nyuka_Update_Proc = False
'''
'''    Exit Function
'''
'''Abort_Tran:
'''
'''    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'''    If sts <> BtNoErr Then
'''        Call File_Error(sts, BtOpAbortTransaction, "")
'''    End If


    
''''''''''''''''''''''''''''''' ëSÇƒîpé~    2009.06.18
'''    New_Nyuka_Update_Proc = True
'''
'''    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")
'''
'''
'''
'''
'''    Do
'''        Get #FileNo, , New_HS_IN_SIJREC
'''        If Left(StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode), 1) < " " Then
'''            Exit Do
'''        End If
'''
'''        If StrConv(New_HS_IN_SIJREC.CR_LF, vbUnicode) <> vbCrLf Then
'''
'''            Call NG_File_Make_Proc
'''
'''
'''            Exit Do
'''        End If
'''
'''
'''        In_Cnt = In_Cnt + 1
'''        lblINCNT(i).Caption = Format(In_Cnt, "#0")
'''        DoEvents
'''
'''
'''        Skip_Flg = True
'''        Not_SHUSI = False
'''        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
'''            If StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode) = JGYOBU_T(i).CODE Then
'''                For j = 0 To UBound(Soko_T, 2)
'''                    If StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode) = Soko_T(i, j).HS_SOKO Then
'''                        Skip_Flg = False
'''                        Exit For
'''                    End If
'''                Next j
'''                Exit For
'''            End If
'''        Next i
'''
'''        If Skip_Flg Then
'''            Not_SHUSI = True
'''        End If

''''-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
'''        'è∆çáópì¸â◊ó\íËèdï°É`ÉFÉbÉN
'''        Call UniCode_Conv(K0_Y_GLICS.JGYOBU, StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode))
'''        Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'''        Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''
'''        sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
'''        Select Case sts
'''            Case BtNoErr
'''                Call Log_Out(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode) & "ÇsÇdÇwÇsÇhÇcÅÅ" & StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'''            Case BtErrKeyNotFound
'''            Case Else
'''                Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË")
'''                Exit Function
'''        End Select
'''
'''
'''        If Not_SHUSI Then
'''            NAIGAI = "1"
'''        Else
'''            NAIGAI = Soko_T(i, j).NAIGAI
'''        End If
'''
'''        If sts = BtErrKeyNotFound Then
'''
'''            If Y_GLICS_PUT_PROC(StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode), NAIGAI, INS_NOW) Then
'''                Exit Function
'''            End If
'''
'''        End If
'''
'''
'''    Loop
''''-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
'''
'''
'''
'''
'''    New_Nyuka_Update_Proc = False
    





'----------------------------------------------------------------------------
'                   Åuì¸â◊ó\íËÉfÅ[É^ÅvçXêVèàóù  F102010ÇÊÇËà⁄çs
'----------------------------------------------------------------------------
Dim i           As Integer
Dim j           As Integer
Dim Skip_Flg    As Boolean
    
Dim WK_Y_QTY    As Long     'èoâ◊êîÉèÅ[ÉN
Dim WK_Qty      As Long     'ëOéÿécÉèÅ[ÉN
Dim WK_E_QTY    As Long     'êÊçsèoâ◊êîÉèÅ[ÉN

Dim SUMI_QTY    As Long     'è§ïiâªçœÇ›Ç∆ÇµÇƒìoò^
Dim MI_QTY      As Long     'ñ¢è§ïiÇ∆ÇµÇƒìoò^

Dim WORK_SOKO   As String * 2
    
Dim sts         As Integer
Dim ans         As Integer
Dim Not_SHUSI   As Boolean
    
Dim wkText      As String
Dim Length      As Integer
    
    
Dim NAIGAI      As String * 1   '2007.06.15
    
    
Dim TEXT_NO     As String * 9           '√∑ΩƒáÇ
Dim JGYOBU_Code As String * 1           'éñã∆ïîãÊï™
Dim CYOK_KBN    As String * 1           'íºëóãÊï™
Dim DEN_DT      As String * 8           'ì`ï[ì˙ït
Dim IO_KBN      As String * 1           'ì¸èoå…ãÊï™
Dim PM_KBN      As String * 1           'ê‘çïãÊï™
Dim DEN_SYU     As String * 1           'ì`ï[éÌï 
Dim DEN_NO      As String * 6           'ì`ï[áÇ
Dim CYU_KBN     As String * 1           'íçï∂ãÊï™
'Dim HIN_GAI     As String * 13          'ïiî‘ÅiäOïîÅj  '13-->20 2016.03.07
Dim HIN_GAI13     As String * 13          'ïiî‘ÅiäOïîÅj   '13-->20 2016.03.07
Dim HIN_GAI20     As String * 20          'ïiî‘ÅiäOïîÅj   '13-->20 2016.03.07
Dim HIN_GAI     As String * 20          'ïiî‘ÅiäOïîÅj   '13-->20 2016.03.07


Dim HIN_NAI     As String * 13          'ïiî‘Åiì‡ïîÅj
Dim HIN_NAME    As String * 25          'ïiñº
Dim YOTEI_QTY   As String * 6           'êîó 
Dim YOSAN_FROM  As String * 5           'ó\éZíPà Åiå≥Åj
Dim YOSAN_TO    As String * 5           'ó\éZíPà ÅiêÊÅj
Dim HOST_SOKO   As String * 8           'ëqå…ãÊï™ÅiŒΩƒÅj
Dim HOST_TANA   As String * 8           'íIî‘ÅiŒΩƒÅj
Dim SYUK_CODE   As String * 5           'éxããêÊÅ^èoâ◊êÊ
Dim SYUK_NAME   As String * 20          'éxããêÊÅ^èoâ◊êÊñº
Dim REC_END     As String * 1           '⁄∫∞ƒﬁèIí[œ∞∏(@)
    
    
    
    
'2011.01.18
Dim GENSANKOKU          As String * 20  'å¥éYçëñº
Dim GEN_GENSANKOKU      As String * 20  'åªï®ï\é¶å¥éYçëñº
Dim SHIIRE_WORK_CENTER  As String * 8   'éëçﬁédì¸êÊ‹∞∏æ›¿∞
Dim KANKYO_KBN          As String * 3   'ä¬ã´éÌóﬁãÊï™
Dim KANKYO_KBN_ST       As String * 8   'ä¬ã´éÌóﬁãÊï™ìKópäJén
Dim KANKYO_KBN_SURYO    As String * 10  'ä¬ã´éÌóﬁãÊï™êîó 
Dim ID_NO2              As String * 12  'ID_NO
Dim AITESAKI_CODE       As String * 16  'ëäéËêÊ∫∞ƒﬁ
Dim JYUCHU_YMD          As String * 8   'éÛíçîNåéì˙
Dim SHITEI_NOUKI_YMD    As String * 8   'éwíËî[ä˙îNåéì˙


Dim GENSAN_CNT          As Integer

Dim com                 As Integer
'2011.01.18
    
    
    
    
'èoâ◊ó\íË ï“èWëOèàóù ################################################################# 2005/05/16 Add Å´
Dim Fast_Flg        As Boolean
Dim DUP_SYUKANo     As Integer
Dim FileName        As String
Dim Ret             As Integer
Dim INS_NOW         As String * 14
Dim wkStr           As String
    
Dim wkMUKE_CODE     As String
    
    
Dim Loop_Cnt        As Integer          '2011.01.15

'2011.03.23
Dim MOTO_TEXT_NO    As String * 9
'2011.03.23
Dim DUP_FLG         As Boolean

    
    Fast_Flg = True

    DUP_SYUKANo = FreeFile
    FileName = DUP_SYUKA_DATA

    Ret = InStr(1, Trim(FileName), ".") - 1
    FileName = Left(Trim(FileName), Ret) & Format(Now, "YYYYMMDDHHMMSS") & "_" & Last_JGYOBU & Right(Trim(FileName), Len(Trim(FileName)) - Ret)

    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")
'#################################################################################### 2005/05/16 Add Å™
    
    New_Nyuka_Update_Proc = True


    Do Until EOF(FileNo)
        Line Input #FileNo, wkText
    
    
    
    
    
'        If LenB(StrConv(wkText, vbFromUnicode)) <> 138 Then    '138-->145 2016.03.07
        If LenB(StrConv(wkText, vbFromUnicode)) <> 138 And _
            LenB(StrConv(wkText, vbFromUnicode)) <> 145 Then     '138-->145 2016.03.07
            
            
            
'            Call NG_File_Make_Proc
             Err_FLg = True
           
            
            Exit Do
        End If
    
    
    
    
        In_Cnt = In_Cnt + 1
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents
    
    
    
    
    
    
    
                                                                    '√∑ΩƒáÇ
        Length = 1
        TEXT_NO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(TEXT_NO)), vbUnicode)
                                                                    'éñã∆ïîãÊï™
        Length = Length + Len(TEXT_NO)
        JGYOBU_Code = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(JGYOBU_Code)), vbUnicode)
                                                                    'íºëóãÊï™
        Length = Length + Len(JGYOBU_Code)
        CYOK_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(CYOK_KBN)), vbUnicode)
                                                                    'ì`ï[ì˙ït
        Length = Length + Len(CYOK_KBN)
        DEN_DT = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_DT)), vbUnicode)
                                                                    'ì¸èoå…ãÊï™
        Length = Length + Len(DEN_DT)
        IO_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(IO_KBN)), vbUnicode)
                                                                    'ê‘çïãÊï™
        Length = Length + Len(IO_KBN)
        PM_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(PM_KBN)), vbUnicode)
                                                                    'ì`ï[éÌï 
        Length = Length + Len(PM_KBN)
        DEN_SYU = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_SYU)), vbUnicode)
                                                                    'ì`ï[áÇ
        Length = Length + Len(DEN_SYU)
        DEN_NO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_NO)), vbUnicode)
                                                                    'íçï∂ãÊï™
        Length = Length + Len(DEN_NO)
        CYU_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(CYU_KBN)), vbUnicode)
                                                                    'ïiî‘ÅiäOïîÅj
        Length = Length + Len(CYU_KBN)
'        HIN_GAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_GAI)), vbUnicode)
                                                                    'ïiî‘Åiì‡ïîÅj
        If LenB(StrConv(wkText, vbFromUnicode)) = 138 Then
            HIN_GAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_GAI13)), vbUnicode)
            Length = Length + Len(HIN_GAI13)
        Else
            HIN_GAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_GAI20)), vbUnicode)
            Length = Length + Len(HIN_GAI20)
        End If
        
        
        HIN_NAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_NAI)), vbUnicode)
                                                                    'ïiñº
        Length = Length + Len(HIN_NAI)
        HIN_NAME = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_NAME)), vbUnicode)
                                                                    'êîó 
        Length = Length + Len(HIN_NAME)
        YOTEI_QTY = Trim(StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOTEI_QTY)), vbUnicode))
                                                                    'ó\éZíPà Åiå≥Åj
        Length = Length + Len(YOTEI_QTY)
        YOSAN_FROM = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOSAN_FROM)), vbUnicode)
                                                                    'ó\éZíPà ÅiêÊÅj
        Length = Length + Len(YOSAN_FROM)
        YOSAN_TO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOSAN_TO)), vbUnicode)
                                                                    'ëqå…ãÊï™ÅiŒΩƒÅj
        Length = Length + Len(YOSAN_TO)
        HOST_SOKO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HOST_SOKO)), vbUnicode)
                                                                    'íIî‘ÅiŒΩƒÅj
        Length = Length + Len(HOST_SOKO)
        HOST_TANA = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HOST_TANA)), vbUnicode)
                                                                    'éxããêÊÅ^èoâ◊êÊ
        Length = Length + Len(HOST_TANA)
        SYUK_CODE = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SYUK_CODE)), vbUnicode)
                                                                    'éxããêÊÅ^èoâ◊êÊñº
        Length = Length + Len(SYUK_CODE)
        SYUK_NAME = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SYUK_NAME)), vbUnicode)
    
    
    
        '2011.01.18
        GENSANKOKU = ""             'å¥éYçëñº
        GEN_GENSANKOKU = ""         'åªï®ï\é¶å¥éYçëñº
        SHIIRE_WORK_CENTER = ""     'éëçﬁédì¸êÊ‹∞∏æ›¿∞
        KANKYO_KBN = ""             'ä¬ã´éÌóﬁãÊï™
        KANKYO_KBN_ST = ""          'ä¬ã´éÌóﬁãÊï™ìKópäJén
        KANKYO_KBN_SURYO = ""       'ä¬ã´éÌóﬁãÊï™êîó 
        ID_NO2 = TEXT_NO            'ID_NO
        AITESAKI_CODE = ""          'ëäéËêÊ∫∞ƒﬁ
        JYUCHU_YMD = ""             'éÛíçîNåéì˙
        SHITEI_NOUKI_YMD = ""       'éwíËî[ä˙îNåéì˙
        '2011.01.18
    
        Skip_Flg = True
        Not_SHUSI = False
        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
            If JGYOBU_Code = JGYOBU_T(i).CODE Then
                For j = 0 To UBound(Soko_T, 2)
                    If Trim(HOST_SOKO) = Trim(Soko_T(i, j).HS_SOKO) Then
                        Skip_Flg = False
                        Exit For
                    End If
                Next j
                Exit For
            End If
        Next i
    
        If Skip_Flg Then
            Not_SHUSI = True
        End If
    
    
'-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
        'è∆çáópì¸â◊ó\íËèdï°É`ÉFÉbÉN
        Call UniCode_Conv(K0_Y_GLICS.JGYOBU, JGYOBU_Code)
        Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, DEN_DT)
        Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, TEXT_NO)

        DUP_FLG = False                 '2011.03.23

        sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
        Select Case sts
            Case BtNoErr
                Call LOG_OUT(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & JGYOBU_Code & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
                DUP_FLG = True          '2011.03.23
            Case BtErrKeyNotFound
            Case Else
                Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË", 0)
                Exit Function
        End Select


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' î≠ê∂å≥Ç…ÇÊÇÈÉfÅ[É^ämîF  2011.03.23
        MOTO_TEXT_NO = ""
        
        If DUP_FLG Then
            If StrConv(App.EXEName, vbUpperCase) = Trim(StrConv(Y_GLICSREC.MOTO_PROG_ID, vbUnicode)) Then
            Else
                If Trim(TEXT_NO) = Trim(StrConv(Y_GLICSREC.MOTO_TEXT_NO, vbUnicode)) Then
                Else
                    MOTO_TEXT_NO = TEXT_NO
                    Mid(TEXT_NO, 5, 1) = "A"
                    DUP_FLG = False
                End If
            
            End If
        End If
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' î≠ê∂å≥Ç…ÇÊÇÈÉfÅ[É^ämîF  2011.03.23



        If Not_SHUSI Then
            NAIGAI = "1"
        Else
            NAIGAI = Soko_T(i, j).NAIGAI
        End If

'        If sts = BtErrKeyNotFound Then
        If Not DUP_FLG Then



''            If Y_GLICS_PUT_PROC(StrConv(New_HS_IN_SIJREC.JGYOBU, vbUnicode), NAIGAI, INS_NOW) Then
''                Exit Function
''            End If
            
            
'''''''''''''''''''''2011.03.23 à¯êîí«â¡
'            If Y_GLICS_PUT_PROC(JGYOBU_Code, NAIGAI, INS_NOW, _
'                                TEXT_NO, _
'                                JGYOBU_Code, _
'                                CYOK_KBN, _
'                                DEN_DT, _
'                                IO_KBN, _
'                                PM_KBN, _
'                                DEN_SYU, _
'                                DEN_NO, _
'                                CYU_KBN, _
'                                HIN_GAI, _
'                                HIN_NAI, _
'                                HIN_NAME, _
'                                YOTEI_QTY, _
'                                YOSAN_FROM, _
'                                YOSAN_TO, _
'                                HOST_SOKO, _
'                                HOST_TANA, _
'                                SYUK_CODE, _
'                                SYUK_NAME, _
'                                GENSANKOKU, GEN_GENSANKOKU, SHIIRE_WORK_CENTER, KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO, ID_NO2, AITESAKI_CODE, JYUCHU_YMD, SHITEI_NOUKI_YMD) Then
                
                
                
            If Y_GLICS_PUT_PROC(JGYOBU_Code, NAIGAI, INS_NOW, _
                                TEXT_NO, _
                                JGYOBU_Code, _
                                CYOK_KBN, _
                                DEN_DT, _
                                IO_KBN, _
                                PM_KBN, _
                                DEN_SYU, _
                                DEN_NO, _
                                CYU_KBN, _
                                HIN_GAI, _
                                HIN_NAI, _
                                HIN_NAME, _
                                YOTEI_QTY, _
                                YOSAN_FROM, _
                                YOSAN_TO, _
                                HOST_SOKO, _
                                HOST_TANA, _
                                SYUK_CODE, _
                                SYUK_NAME, _
                                GENSANKOKU, GEN_GENSANKOKU, SHIIRE_WORK_CENTER, KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO, ID_NO2, AITESAKI_CODE, JYUCHU_YMD, SHITEI_NOUKI_YMD, MOTO_TEXT_NO) Then
                
                
                
                
'''''''''''''''''''''2011.03.23 à¯êîí«â¡
                
                Exit Function
            End If

        End If



'-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
    
        Skip_Flg = False
        If Not_SHUSI Then
            Skip_Flg = True
        End If
    
        If PM_KBN = "-" Then
            Skip_Flg = True
        End If
        
        If IO_KBN <> "1" Then
            
            If IO_KBN = "4" And Left(YOSAN_FROM, 4) = "0211" And Left(YOSAN_TO, 3) = "SDC" And Trim(HOST_SOKO) = "11B" Then
''''            2011.01.18
''''                If (JGYOBU_Code = SUIHAN Or JGYOBU_Code = DENKA) Then
                If Trim(RYOHEN_TANA) <> "" Then
''''            2011.01.18
                Else
                    Skip_Flg = True
                End If
            Else
                Skip_Flg = True
            End If
        Else
            Skip_Flg = True
        End If
    
    
        WORK_SOKO = KASO_NYUKA_SOKO
    
    
    
''''2011.01.18
''''        Select Case JGYOBU_Code
''''
''''            Case SOJIKI                         'ë|èúã@
''''
''''
''''
''''            Case DENKA, SUIHAN, SENTAKU         'ìdâªÅAêÜî—ÅAêÙëÛã@ÅiÉAÉCÉçÉìÅj
''''
''''
''''                Select Case MyCenter
''''
''''                    Case "O"
''''
''''
''''
''''                        '2009.06.01 65î‘ëqå…èoóÕí«â¡
''''                        If (JGYOBU_Code = SUIHAN Or JGYOBU_Code = DENKA) Then
''''                            If IO_KBN = "4" Then
''''                                If Left(YOSAN_FROM, 4) = "0211" And Left(YOSAN_TO, 3) = "SDC" Then
''''
''''                                    If Trim(HOST_SOKO) = "11B" Then
''''                                        WORK_SOKO = "65"
''''                                    End If
''''                                End If
''''                            End If
''''                        End If
''''
''''
''''
''''
''''
''''                End Select
''''             Case AIRCON                     'ÉGÉAÉRÉì
''''
''''
''''
''''        End Select
        If Trim(RYOHEN_TANA) <> "" Then
            WORK_SOKO = RYOHEN_TANA
        End If
''''2011.01.18
            
            
            
            
        
    
    
        If Not Skip_Flg Then
                                        
                                        
            
                
                                        'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
            Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU_Code)
            Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, DEN_DT)
            Call UniCode_Conv(K0_Y_NYU.TEXT_NO, TEXT_NO)
    
            sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
            Select Case sts
                Case BtNoErr
                    Call LOG_OUT(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
                    Skip_Flg = True
                Case BtErrKeyNotFound
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË", 0)
                    Exit Function
            End Select
        
            If Not Skip_Flg Then
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                If sts <> BtNoErr Then
                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                    Exit Function
                End If
                                            'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                If Item_Check_Proc(In_Mode, JGYOBU_Code, Soko_T(i, j).NAIGAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                    GoTo Abort_Tran
                End If
                                            
                                            
                '2012.12.20
                If StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "0" And StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "1" Then
                    Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_F)
                End If
                '2012.12.20
                                            
                                            'ì¸â◊ÉfÅ[É^çÏê¨
                Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU_Code)
                Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
                Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
        
        
                Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                Call UniCode_Conv(Y_NYUREC.TANKA, "")
                Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
        
        
                Last_Proc_F = True              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇË
        
        
                'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
                Call UniCode_Conv(K0_J_NYU.JGYOBU, JGYOBU_Code)
                Call UniCode_Conv(K0_J_NYU.NAIGAI, Soko_T(i, j).NAIGAI)
                Call UniCode_Conv(K0_J_NYU.HIN_GAI, HIN_GAI)
    
                WK_Y_QTY = CLng(YOTEI_QTY)
    
                Loop_Cnt = 0
    
                Do
                    sts = BTRV(BtOpGetEqual + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                    Select Case sts
                        Case BtNoErr
                            If CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) > WK_Y_QTY Then
                                WK_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) - WK_Y_QTY
                                Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(WK_Qty, "00000000"))
                        
                                Loop_Cnt = 0
                        
                                Do
                                
                                    sts = BTRV(BtOpUpdate, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'
'                                            Beep
'                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                            If ans = vbCancel Then
'                                                Exit Function
'                                            End If
                                        
                                            Loop_Cnt = Loop_Cnt + 1
                                            If Loop_Cnt > 5 Then
                                                Exit Function
                                            End If
                                            DoEvents
                                            Sleep (500)
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)
                                            Exit Function
                                    End Select
                                
                                Loop
                                WK_E_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                            Else
                                
                                
                                Loop_Cnt = 0
                                Do
                                    sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                            Beep
'                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                            If ans = vbCancel Then
'                                                Exit Function
'                                            End If
                                        
                                            Loop_Cnt = Loop_Cnt + 1
                                            If Loop_Cnt > 5 Then
                                                Exit Function
                                            End If
                                            DoEvents
                                            Sleep (500)
                                        
                                                                                    
                                        
                                        Case Else
                                            Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)
                                            Exit Function
                                    End Select
                                Loop
                                WK_E_QTY = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
                            End If
                    
                            Exit Do
                        Case BtErrKeyNotFound
                            WK_E_QTY = 0
                            Exit Do
                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                            Beep
'                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                            If ans = vbCancel Then
'                                Exit Function
'                           End If
                        
                            Loop_Cnt = Loop_Cnt + 1
                            If Loop_Cnt > 5 Then
                                Exit Function
                            End If
                            DoEvents
                            Sleep (500)
                                            
                                            
                        
                        Case Else
                            Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)
                            Exit Function
                    End Select
                Loop
                                    'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
                Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, Format(WK_E_QTY, "00000000"))
        
                                    'ó\éZíPà å≥
                Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                                    'ó\éZíPà êÊ
                Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                                    'ïWèÄíIî‘
                Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
                Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
                                    'Hëqå… 2006.10.17
                Call UniCode_Conv(Y_NYUREC.H_SOKO, HOST_SOKO)

                                    'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, " ")
            
            '2011.01.18
                Call UniCode_Conv(K0_GENSAN.JGYOBU, StrConv(Y_NYUREC.JGYOBU, vbUnicode))
                Call UniCode_Conv(K0_GENSAN.NAIGAI, StrConv(Y_NYUREC.NAIGAI, vbUnicode))
                Call UniCode_Conv(K0_GENSAN.HIN_GAI, StrConv(Y_NYUREC.HIN_NO, vbUnicode))
                Call UniCode_Conv(K0_GENSAN.GENSANKOKU, "")
                
                com = BtOpGetGreaterEqual
                
                GENSAN_CNT = 0
                
                Do
                    DoEvents
                
                    sts = BTRV(com, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                    Select Case sts
                        Case BtNoErr
                        
                            If StrConv(GENSANREC.JGYOBU, vbUnicode) <> StrConv(Y_NYUREC.JGYOBU, vbUnicode) Or _
                                StrConv(GENSANREC.NAIGAI, vbUnicode) <> StrConv(Y_NYUREC.NAIGAI, vbUnicode) Or _
                                StrConv(GENSANREC.HIN_GAI, vbUnicode) <> StrConv(Y_NYUREC.HIN_NO, vbUnicode) Then
                                Exit Do
                            End If
                        
                        
                            GENSAN_CNT = GENSAN_CNT + 1
                            If GENSAN_CNT > 1 Then
                                GENSANKOKU = ""
                                Exit Do
                            End If
                        
                        
                            GENSANKOKU = StrConv(GENSANREC.GENSANKOKU, vbUnicode)
                        
                        Case BtErrEOF
                            Exit Do
                        
                        Case Else
                            Call File_Error(sts, com, "å¥éYçëÉ}ÉXÉ^", 0)
                            Exit Function
                    End Select
                
                    com = BtOpGetNext
                                
                Loop
                
                
                                
                
                
                Call UniCode_Conv(Y_NYUREC.GENSANKOKU, "")                          'å¥éYçëñº
                If GENSAN_CNT = 1 Then
                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, GENSANKOKU)
                End If
                                                                                    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
                Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN, KANKYO_KBN)                  'ä¬ã´éÌóﬁãÊï™
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_ST, KANKYO_KBN_ST)            'ä¬ã´éÌóﬁãÊï™ìKópäJén
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)      'ä¬ã´éÌóﬁãÊï™êîó 
                Call UniCode_Conv(Y_NYUREC.ID_NO2, TEXT_NO)                         'ID_NO
                Call UniCode_Conv(Y_NYUREC.AITESAKI_CODE, AITESAKI_CODE)            'ëäéËêÊ∫∞ƒﬁ
                Call UniCode_Conv(Y_NYUREC.JYUCHU_YMD, JYUCHU_YMD)                  'éÛíçîNåéì˙
                Call UniCode_Conv(Y_NYUREC.SHITEI_NOUKI_YMD, SHITEI_NOUKI_YMD)      'éwíËî[ä˙îNåéì˙
                Call UniCode_Conv(Y_NYUREC.LIST_OUT_END_F, "")                      'ì¸å…ä÷òAÿΩƒèoóÕF
                Call UniCode_Conv(Y_NYUREC.LIST_NYU_KANRI_F, "")                    'ì¸å…ä«óùÿΩƒèoóÕF
                Call UniCode_Conv(Y_NYUREC.LIST_NYU_CHECK_F, "")                    'ì¸å…¡™Ø∏ÿΩƒèoóÕF
                Call UniCode_Conv(Y_NYUREC.NYUKO_TANABAN, WORK_SOKO & "010101")     'ì¸å…íIî‘
                Call UniCode_Conv(Y_NYUREC.MAEGARI_SURYO, "")                       'ëOéÿëäéEêî
                
                Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2015")       'í«â¡Å@íSìñé“
                Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)   'í«â¡Å@ì˙éû
            
                Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")           'çXêVÅ@íSìñé“
                Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")        'çXêVÅ@ì˙éû         2005.11.15
            '2011.01.18

                
                
                
                '2011.03.23 î≠ê∂å≥ÉvÉçÉOÉâÉÄ
                Call UniCode_Conv(Y_NYUREC.MOTO_PROG_ID, StrConv(App.EXEName, vbUpperCase))
                '2011.03.23 å≥ÉeÉLÉXÉgáÇ
                If Trim(MOTO_TEXT_NO) = "" Then
                    Call UniCode_Conv(Y_NYUREC.MOTO_TEXT_NO, "")
                Else
                    Call UniCode_Conv(Y_NYUREC.MOTO_TEXT_NO, MOTO_TEXT_NO)
                End If
                
                
                Call UniCode_Conv(Y_NYUREC.FILLER, "")
                
                Loop_Cnt = 0
                
                Do
                    sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                            Beep
'                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                            If ans = vbCancel Then
'                                Exit Function
'                            End If
                        
                        
                            Loop_Cnt = Loop_Cnt + 1
                            If Loop_Cnt > 5 Then
                                Exit Function
                            End If
                            DoEvents
                            Sleep (500)
                        
                        
                        Case Else
                            Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)
                            Exit Function
                    End Select
                Loop
            
'------------ 2005.12.30
'                Select Case JGYOBU_Code
'                    Case AIRCON, SENTAKU
'                        Call UniCode_Conv(K0_SOKO.Soko_No, WORK_SOKO)
'                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
'                        Select Case sts
'                            Case BtNoErr
'                            Case Else
'                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^")
'                                Exit Function
'                        End Select
'
'                        If StrConv(SOKOREC.GOODS_ON_F, vbUnicode) = GOODS_ON Then
'
'                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'                            MI_QTY = 0
'                        Else
'
'                            If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
'                                MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'                                SUMI_QTY = 0
'                            Else
'                                SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'                                MI_QTY = 0
'                            End If
'                        End If
'
'------------ 2005.12.30
'
'                    Case Else
'
'
'                        If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
'                            MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'                            SUMI_QTY = 0
'                        Else
'                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
'                            MI_QTY = 0
'                        End If
'                End Select
                
        
'                Wk_SOKO = KASO_NYUKA_SOKO
'                If Trim(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) <> "91H" Then
'                    Wk_SOKO = KASO_SMODOSHI_SOKO
'
'                End If
        
                
                 MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                 SUMI_QTY = 0
                
                
                'ì¸â◊êîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ{Åj
'                If Nyuko_Update_Proc(JGYOBU_Code, _
'                                    Soko_T(i, j).NAIGAI, _
'                                    HIN_GAI, _
'                                    StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
'                                    (WORK_SOKO & "01" & "01" & "01"), _
'                                    YOIN_TU_NYUKA, _
'                                    SUMI_QTY, MI_QTY, _
'                                    WS_NO, WS_NO, , _
'                                    DEN_DT & " ì`áÇ:" & DEN_NO, , , , MENU_NO) Then
'                    Exit Function
'
'                End If
            
                
                If Nyuko_Update_Proc(JGYOBU_Code, _
                                    Soko_T(i, j).NAIGAI, _
                                    HIN_GAI, _
                                    StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
                                    (WORK_SOKO & "01" & "01" & "01"), _
                                    YOIN_TU_NYUKA, _
                                    SUMI_QTY, MI_QTY, _
                                    WS_NO, WS_NO, , _
                                    Trim(YOSAN_FROM) & " " & DEN_DT & " ì`áÇ:" & DEN_NO, , , , MENU_NO, , RYOHEN, GENSANKOKU, SHIIRE_WORK_CENTER, ID_NO2, YOSAN_FROM) Then
                    Exit Function
            
                End If
            
            
            
                'ëOéÿÇËêîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ|Åj
                If WK_E_QTY <> 0 Then
                'ç›å…ÉfÅ[É^LOCK
                    If Zaiko_Lock_Proc((WORK_SOKO & "01" & "01" & "01"), _
                                        JGYOBU_Code, _
                                        Soko_T(i, j).NAIGAI, _
                                        HIN_GAI, _
                                        WS_NO, , , 5) Then
                        Exit Function
    
                    End If
        
                    If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                        MI_QTY = WK_E_QTY
                    Else
                        SUMI_QTY = WK_E_QTY
                    End If
            
            
                    If Syuko_Update_Proc(JGYOBU_Code, _
                                        Soko_T(i, j).NAIGAI, _
                                        HIN_GAI, _
                                        DEN_DT, _
                                        (WORK_SOKO & "01" & "01" & "01"), _
                                        YOIN_MAE_SOUSAI, _
                                        SUMI_QTY, MI_QTY, 0, _
                                        WS_NO, WS_NO, 5) Then
                        Exit Function
        
                    End If
            
            
            
            
            
            
                End If
                
                
                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                If sts <> BtNoErr Then
                    GoTo Abort_Tran
                End If
                
                
                Out_Cnt = Out_Cnt + 1
                lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                DoEvents
    
            End If
        
        
        
        
        
        
        
        End If
        
        
        
    
    Loop

    New_Nyuka_Update_Proc = False
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


    




End Function
    
Private Function New_Syuka_Update_Proc(JGYOBU As String) As Boolean
'----------------------------------------------------------------------------
'                   Åuèoâ◊ó\íËÉfÅ[É^ÅvçXêVèàóù
'----------------------------------------------------------------------------
Dim i           As Integer
Dim j           As Integer
Dim k           As Integer
Dim Skip_Flg    As Boolean
Dim sts         As Integer
    
Dim ans         As Integer

Dim c               As String * 128

Dim Fast_Flg        As Boolean
Dim DUP_SYUKANo     As Integer
Dim FileName        As String
Dim Ret             As Integer
    
Dim INS_NOW         As String * 14
Dim wkCHOKU_KBN     As String * 1

Dim wkSS            As String
        
Dim wkMUKE_CODE     As String

Dim Loop_Cnt        As Integer          '2011.01.15


    
    New_Syuka_Update_Proc = True

    Fast_Flg = True


    DUP_SYUKANo = FreeFile
    FileName = DUP_SYUKA_DATA

    Ret = InStr(1, Trim(FileName), ".") - 1
    FileName = Left(Trim(FileName), Ret) & Format(Now, "YYYYMMDDHHMMSS") & "_" & Last_JGYOBU & Right(Trim(FileName), Len(Trim(FileName)) - Ret)


    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")

    Do
        Get #FileNo, , New_HS_OUT_SIJREC
        If Left(StrConv(New_HS_OUT_SIJREC.JGYOBA, vbUnicode), 1) < " " Then
            Exit Do
        End If
    
    
        If StrConv(New_HS_OUT_SIJREC.CRLF, vbUnicode) <> vbCrLf Then
'''            Call NG_File_Make_Proc
            Err_FLg = True
            Exit Do
        End If
    
        In_Cnt = In_Cnt + 1
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents
    
        Skip_Flg = True
        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
            If JGYOBU = JGYOBU_T(i).CODE Then
                For j = 0 To UBound(Soko_T, 2)
                    If Trim(StrConv(New_HS_OUT_SIJREC.SYUKO_SYUSI, vbUnicode)) = Trim(Soko_T(i, j).HS_SOKO) Then
                        Skip_Flg = False
                        Exit For
                    End If
                Next j
                Exit For
            End If
        Next i
    
                                'ïiñ⁄É}ÉXÉ^ÇÃÉ`ÉFÉbÉN
'                Call UniCode_Conv(K0_ITEM.JGYOBU, JGYOBU)
'                Call UniCode_Conv(K0_ITEM.NAIGAI, Soko_T(i, j).NAIGAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(HS_OUT_SIJREC.HIN_NO, vbUnicode))
'
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                Select Case sts
'                    Case BtNoErr
'                    Case BtErrKeyNotFound
'                        Skip_Flg = True
'                        Call Log_Out(LOG_F, "ì`ï[ID=" & StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode))
'                    Case Else
'                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
'                        Exit Function
'                End Select
                
                
                
        If Not Skip_Flg Then
                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        If sts <> BtNoErr Then
            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
            Exit Function
        End If
        
        
                                    'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
        If Item_Check_Proc(Out_Mode, JGYOBU, Soko_T(i, j).NAIGAI, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode)) Then
            GoTo Abort_Tran
        End If
                                                        
'2008.12.16        If Len(Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))) = 0 Or _
'2008.12.16            IsNumeric(Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))) Then
'2008.12.16        Else
'2008.12.16            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
'2008.12.16        End If
                                                        
                                                        
        If Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "" Then
            wkCHOKU_KBN = ""
        Else
            wkCHOKU_KBN = "1"
        End If
                                                                                                
                                                        
        If Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "" Then
            If Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A1" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A2" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A3" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A4" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A5" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A6" Or _
                Trim(StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = "A7" Then
                Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "3")
            End If
        
            If StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000440" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000441" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000442" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000443" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000444" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000445" Or _
                StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) = "22000446" Then
                Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "2")
            End If
        
        End If
                                                        
        If Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "" Then
            Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "3")
        End If
                                                                
        '2006.07.20
        wkMUKE_CODE = StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)
'-----------    2005.12.30
'''                    If JGYOBU = AIRCON Then
'''
'''                        'MTS∫∞ƒﬁÇÃì«Ç›ë÷Ç¶
'''                        If GetIni(App.EXEName, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode), App.EXEName, c) Then
'''                        Else
'''                            Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, Trim(c))
'''                            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
'''                        End If
'''
'''
'''                    End If
            
        'ÉGÉAÉRÉìÇæÇ¡ÇΩèÍçáå¸ÇØêÊÇ…íºëóêÊÇæØƒ  2004.12.01-->ëSéñã∆ïîã§í 
        
        If (StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode)) = StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode) Then
            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
        Else
            If Len(Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))) <> 0 Then
                Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
                Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
            End If
        End If


        If Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode)) = "" Then
        
            If GetIni(App.EXEName, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode), App.EXEName, c) Then
            Else
                Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, Trim(c))
                Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
            End If
        End If


        If StrConv(New_HS_OUT_SIJREC.HAN_KBN, vbUnicode) = "2" Then
            Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "E")
            'ñfà’ÇÕÅu39040ÅvÇ…èWñÒ 2006.05.31
            Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, "39040")
            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
        
        
        End If
        
        
        
        
        
        
        'ïîì‡èoâ◊ì`ï[Åi√ﬁ∞¿ãÊï™ÅÅ7ÅAéÊà¯ãÊï™=29ÅjÇÃå¸ÇØêÊïœä∑Å@2006.06.17
        If Trim(StrConv(New_HS_OUT_SIJREC.DATA_KBN, vbUnicode)) = "7" And _
            Trim(StrConv(New_HS_OUT_SIJREC.TORI_KBN, vbUnicode)) = "29" Then

            Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, _
                Right(StrConv(New_HS_OUT_SIJREC.SHISAN_JGYOBA, vbUnicode), 5))
            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")

        End If
        
        
        
        'ë|èúã@ÇÃèÍçáÇÕÅAå¸ÇØêÊÇñﬂÇ∑ÅB 2007.10.29
        If JGYOBU = SOJIKI Then
        
            If Trim(StrConv(New_HS_OUT_SIJREC.DATA_KBN, vbUnicode)) = "7" And _
                Trim(StrConv(New_HS_OUT_SIJREC.TORI_KBN, vbUnicode)) = "29" And _
                Trim(StrConv(New_HS_OUT_SIJREC.SHISAN_JGYOBA, vbUnicode)) = "00023210" And _
                Trim(wkMUKE_CODE) = "09002" Then
            
            
                Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, wkMUKE_CODE)
                Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
            
            
            End If
        
        
        
        
        
        End If
            
        
        
        
        
        'íçï∂ãÊï™ÅÅ6ÇÕÇQÇ…
''                    If JGYOBU = SENTAKU And StrConv(New_HS_OUT_SIJREC.SYUKO_SYUSI, vbUnicode) = "S2" Then
''
''                        If StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) = "6" Then
''                            Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "2")
''
''
''                        End If
''                    End If

        If Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "E" Then
            wkCHOKU_KBN = ""
        End If


        If Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "1" Or _
            Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "2" Or _
            Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "3" Or _
            Trim(StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode)) = "E" Then
        Else

            Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "1")
        End If

'''                    Else
            
            'êÙëÛã@ÇÃèÍçáÅAîıçlÇPÇíºëóêÊÇ…ÉZÉbÉg 2006.03.25
'''                        If JGYOBU = SENTAKU And StrConv(New_HS_OUT_SIJREC.SYUKO_SYUSI, vbUnicode) = "S2" Then
'''                            If StrComp(StrConv(New_HS_OUT_SIJREC.ODER_NO, vbUnicode), "FAX", vbTextCompare) Then
'''
'''                                wkSS = ""
'''
'''                                For k = 1 To Len(StrConv(New_HS_OUT_SIJREC.BIKOU1, vbUnicode))
'''                                    If IsNumeric(Mid(StrConv(New_HS_OUT_SIJREC.BIKOU1, vbUnicode), k, 1)) Then
'''                                        wkSS = wkSS & Mid(StrConv(New_HS_OUT_SIJREC.BIKOU1, vbUnicode), k, 1)
'''                                    Else
'''                                        Exit For
'''                                    End If
'''                                Next k
'''
'''                                Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, wkSS)
'''                            End If
'''
'''                        End If
'''
'''
'''
'''                        'ëºÇÃéñã∆ïîÇÕåªèÛÇÃÇ‹Ç‹
'''                        If Len(Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))) = 0 Or _
'''                            IsNumeric(Trim(StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))) Then
'''                        Else
'''                            Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
'''                        End If
'''                    End If
'                   Å™Ç…à⁄ìÆ    2004.12.01
'                    If Len(Trim(StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode))) = 0 Or _
'                        IsNumeric(Trim(StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode))) Then
'                    Else
'                        Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
'                    End If
                                                        
                                                        
                                                        
                                                        'å¸ÇØêÊÉ}ÉXÉ^ì«Ç›çûÇ›
'                    If Len(Trim(StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode))) = 0 Then
'                        Call UniCode_Conv(K0_MTS.MUKE_CODE, StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode))
'                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
            
'                    Else
            
            Call UniCode_Conv(K0_MTS.MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
            Call UniCode_Conv(K0_MTS.SS_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
'                    End If
                 
                 
                 
                                     
                 
                 
                 
        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
        Select Case sts
            Case BtNoErr
            Case BtErrKeyNotFound
                
                
'''ëOéñã∆ïîœΩ¿ãNï[ 2006.05.31
'''                            If JGYOBU = AIRCON Then
                    'ÉGÉAÉRÉìÇæÇ¡ÇΩèÍçáå¸ÇØêÊÇ…íºëóêÊÇ≈å¸ÇØêÊœΩ¿ÇêVãKçÏê¨  2004.12.01
                
                    Call UniCode_Conv(MTSREC.NAIGAI, Soko_T(i, j).NAIGAI)
                    Call UniCode_Conv(MTSREC.DATA_KBN, "")
                    Call UniCode_Conv(MTSREC.MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
                    Call UniCode_Conv(MTSREC.SS_CODE, "")
                    Call UniCode_Conv(MTSREC.MUKE_NAME, StrConv(New_HS_OUT_SIJREC.MUKE_NAME, vbUnicode))
                    Call UniCode_Conv(MTSREC.SS_NAME, "")
                    Call UniCode_Conv(MTSREC.MUKE_DNAME, StrConv(New_HS_OUT_SIJREC.MUKE_NAME, vbUnicode))
                    Call UniCode_Conv(MTSREC.DISPLAY_RANKING, "99")
                    Call UniCode_Conv(MTSREC.FILLER, "")
                    
                    Loop_Cnt = 0
                    
                    Do
                        sts = BTRV(BtOpInsert, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr, BtErrDuplicates
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<MTS.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    GoTo Abort_Tran
'                                End If
                                                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    Exit Function
                                End If
                                DoEvents
                                Sleep (500)
                                                            
                                                            
                            Case Else
                                Call File_Error(sts, BtOpInsert, "å¸ÇØêÊä«óùœΩ¿" & "key=" & StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode) & "-" & StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode), 0)
                                GoTo Abort_Tran
                        End Select
                    Loop
                                            
                                            
                                            
                                            
                
'''                            Else
'''                               'ëºÇÃéñã∆ïîÇÕåªèÛÇÃÇ‹Ç‹
'''                                If Soko_T(i, j).NAIGAI = NAIGAI_NAI Then
'''                                    Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_NAI)
'''                                    Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
'''                                Else
'''                                    Call UniCode_Conv(New_HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_GAI)
'''                                    Call UniCode_Conv(New_HS_OUT_SIJREC.SS_CODE, "")
'''                                End If
''                            End If
                
'                          Å™Ç…à⁄ìÆ    2004.12.01
'                           If Soko_T(i, j).NAIGAI = NAIGAI_NAI Then
'                               Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_NAI)
'                               Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
'                           Else
'                               Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_GAI)
'                               Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
'                           End If
            
            Case Else
                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 0)
                GoTo Abort_Tran
        End Select
                                                        
                                                        
'-----------    2005.12.30
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        'å¸ÇØêÊÉ}ÉXÉ^ì«Ç›çûÇ›
'                    Call UniCode_Conv(K0_MTS.MUKE_CODE, StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
'                    Call UniCode_Conv(K0_MTS.SS_CODE, StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode))
'
'                    sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
'                    Select Case sts
'                        Case BtNoErr
'                        Case BtErrKeyNotFound
'
'                            If Soko_T(i, j).NAIGAI = NAIGAI_NAI Then
'                                Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_NAI)
'                                Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
'                            Else
'                                Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_GAI)
'                                Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
'                            End If
'
'                        Case Else
'                            Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
'                            Exit Function
'                    End Select
                        
        
        
'''                    If StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) <> "1" And _
'''                        StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) <> "2" And _
'''                        StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) <> "3" And _
'''                        StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) <> "E" Then
'''
'''                        Call UniCode_Conv(New_HS_OUT_SIJREC.CYU_KBN, "2")
'''
'''                    End If
                    
                    
                                'èoâ◊ó\íËèdï°É`ÉFÉbÉN
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, JGYOBU)
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode))
    
    
            sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
            Select Case sts
                Case BtNoErr
                    
                    
                        
                    Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
                    
                    Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.JGYOBA, StrConv(New_HS_OUT_SIJREC.JGYOBA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.DATA_KBN, StrConv(New_HS_OUT_SIJREC.DATA_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.TORI_KBN, StrConv(New_HS_OUT_SIJREC.TORI_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, StrConv(New_HS_OUT_SIJREC.KAIKEI_JGYOBA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, StrConv(New_HS_OUT_SIJREC.SHISAN_JGYOBA, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.HIN_NO, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.DEN_NO, StrConv(New_HS_OUT_SIJREC.DEN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SURYO, StrConv(New_HS_OUT_SIJREC.SURYO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, StrConv(New_HS_OUT_SIJREC.SYUKO_SYUSI, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.HOJYO_SYUSI, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.TANKA, StrConv(New_HS_OUT_SIJREC.TANKA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ODER_NO, StrConv(New_HS_OUT_SIJREC.ODER_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ITEM_NO, StrConv(New_HS_OUT_SIJREC.ITEM_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ODER_NO_R, StrConv(New_HS_OUT_SIJREC.ODER_NO_R, vbUnicode))
                    '2011.10.31
                    Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, Left(StrConv(New_HS_OUT_SIJREC.KOSO_KEITAI, vbUnicode), 10))
                    Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    
                    
                    
                    
                    If TANA_SPACE Then
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")
                    Else
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, StrConv(New_HS_OUT_SIJREC.TANABAN1, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, StrConv(New_HS_OUT_SIJREC.TANABAN2, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, StrConv(New_HS_OUT_SIJREC.TANABAN3, vbUnicode))
                    End If
                    
                    
                    Call UniCode_Conv(Y_SYUREC.MUKE_NAME, StrConv(New_HS_OUT_SIJREC.MUKE_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN, StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, StrConv(New_HS_OUT_SIJREC.CYU_KBN_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ORIGIN1, StrConv(New_HS_OUT_SIJREC.ORIGIN1, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ORIGIN2, StrConv(New_HS_OUT_SIJREC.ORIGIN2, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.BIKOU2, StrConv(New_HS_OUT_SIJREC.BIKOU2, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HAN_KBN, StrConv(New_HS_OUT_SIJREC.HAN_KBN, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, StrConv(New_HS_OUT_SIJREC.CHOKU_KBN, vbUnicode))
                    
    
                    Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, StrConv(New_HS_OUT_SIJREC.UNIT_ID_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, StrConv(New_HS_OUT_SIJREC.ZAIKO_HIKIATE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, StrConv(New_HS_OUT_SIJREC.GOKON_KANRI_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, StrConv(New_HS_OUT_SIJREC.JYUCHU_ZAN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, StrConv(New_HS_OUT_SIJREC.KYOKYU_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, StrConv(New_HS_OUT_SIJREC.SHOHIN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.S_SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.S_HOJYO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.BIKOU1, StrConv(New_HS_OUT_SIJREC.BIKOU1, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, StrConv(New_HS_OUT_SIJREC.CHOHA_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, StrConv(New_HS_OUT_SIJREC.JYU_HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HIN_NAME, StrConv(New_HS_OUT_SIJREC.HIN_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, StrConv(New_HS_OUT_SIJREC.HIN_CHANGE_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, StrConv(New_HS_OUT_SIJREC.MODULE_EXCHANGE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAIKO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAN_SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAN_HOJYO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, StrConv(New_HS_OUT_SIJREC.NOUKI_YMD, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, StrConv(New_HS_OUT_SIJREC.SERVICE_KANRI_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KISHU_CODE, StrConv(New_HS_OUT_SIJREC.KISHU_CODE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, StrConv(New_HS_OUT_SIJREC.ENVIRONMENT_KBN, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SS_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, StrConv(New_HS_OUT_SIJREC.KEPIN_KAIJYO, vbUnicode))
                    
                    
                    Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                    
'2008.11.28                    Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                    Call UniCode_Conv(Y_SYUREC.UPD_NOW, INS_NOW)            '2008.11.28
                
                    Call UniCode_Conv(Y_SYUREC.LK_MUKE_CODE, wkMUKE_CODE)   '2006.07.20
                    
                    sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                    If sts Then
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        GoTo Abort_Tran
                    End If
                                
                                
                    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    If sts <> BtNoErr Then
                        GoTo Abort_Tran
                    End If
                                
                                
                                
                    
                    Call LOG_OUT(LOG_F, "Y_SYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ì`ï[ÇhÇcÅÅ" & StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode))
                    Skip_Flg = True
                
                
                    If Fast_Flg Then
                        Open (FileName) For Output As DUP_SYUKANo
                        Write #DUP_SYUKANo, , , "èoâ◊èdï°ÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")
                        Write #DUP_SYUKANo, "èoâ◊ì˙", "ì`ï[áÇ", "éxï•êÊ∫∞ƒﬁ", "ëqå…/ÇrÇr∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"
                        Fast_Flg = False
                    End If
                
                
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.DEN_NO, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.MUKE_NAME, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.CYU_KBN_NAME, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.SURYO, vbUnicode),
                    Write #DUP_SYUKANo, StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode)
                
                
                
                Case BtErrKeyNotFound
                
                    Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                    Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                    Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                    
                    
                                        
                    Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode))
                    
    '''2006.07.15                    If (JGYOBU = "D" Or JGYOBU = "4") And StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode) = "E" Then
    '''2006.07.15                        Call UniCode_Conv(Y_SYUREC.NAIGAI, "2")
    '''2006.07.15                    Else
                        Call UniCode_Conv(Y_SYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
    '''2006.07.15                    End If
                    Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    
                    
                    
                    
                    Call UniCode_Conv(Y_SYUREC.JGYOBA, StrConv(New_HS_OUT_SIJREC.JGYOBA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.DATA_KBN, StrConv(New_HS_OUT_SIJREC.DATA_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.TORI_KBN, StrConv(New_HS_OUT_SIJREC.TORI_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(New_HS_OUT_SIJREC.ID_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, StrConv(New_HS_OUT_SIJREC.KAIKEI_JGYOBA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, StrConv(New_HS_OUT_SIJREC.SHISAN_JGYOBA, vbUnicode))
                    
                    
                    
                    Call UniCode_Conv(Y_SYUREC.HIN_NO, StrConv(New_HS_OUT_SIJREC.HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.DEN_NO, StrConv(New_HS_OUT_SIJREC.DEN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SURYO, StrConv(New_HS_OUT_SIJREC.SURYO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.MUKE_CODE, StrConv(New_HS_OUT_SIJREC.MUKE_CODE, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, StrConv(New_HS_OUT_SIJREC.SYUKO_SYUSI, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.HOJYO_SYUSI, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.TANKA, StrConv(New_HS_OUT_SIJREC.TANKA, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ODER_NO, StrConv(New_HS_OUT_SIJREC.ODER_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ITEM_NO, StrConv(New_HS_OUT_SIJREC.ITEM_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ODER_NO_R, StrConv(New_HS_OUT_SIJREC.ODER_NO_R, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, StrConv(New_HS_OUT_SIJREC.KOSO_KEITAI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, StrConv(New_HS_OUT_SIJREC.SYUKA_YMD, vbUnicode))
                    
                    If TANA_SPACE Then
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")
                    Else
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, StrConv(New_HS_OUT_SIJREC.TANABAN1, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, StrConv(New_HS_OUT_SIJREC.TANABAN2, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, StrConv(New_HS_OUT_SIJREC.TANABAN3, vbUnicode))
                    End If
                    
                    Call UniCode_Conv(Y_SYUREC.MUKE_NAME, StrConv(New_HS_OUT_SIJREC.MUKE_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN, StrConv(New_HS_OUT_SIJREC.CYU_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, StrConv(New_HS_OUT_SIJREC.CYU_KBN_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ORIGIN1, StrConv(New_HS_OUT_SIJREC.ORIGIN1, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ORIGIN2, StrConv(New_HS_OUT_SIJREC.ORIGIN2, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.BIKOU2, StrConv(New_HS_OUT_SIJREC.BIKOU2, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HAN_KBN, StrConv(New_HS_OUT_SIJREC.HAN_KBN, vbUnicode))
                    
                    '2006.07.31 çÄñ⁄ì‡óeÇÇªÇÃÇ‹Ç‹æØƒ
                    Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, StrConv(New_HS_OUT_SIJREC.CHOKU_KBN, vbUnicode))
    '''                    Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, wkCHOKU_KBN)
                    
    
                    Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, StrConv(New_HS_OUT_SIJREC.UNIT_ID_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, StrConv(New_HS_OUT_SIJREC.ZAIKO_HIKIATE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, StrConv(New_HS_OUT_SIJREC.GOKON_KANRI_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, StrConv(New_HS_OUT_SIJREC.JYUCHU_ZAN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, StrConv(New_HS_OUT_SIJREC.KYOKYU_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, StrConv(New_HS_OUT_SIJREC.SHOHIN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.S_SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.S_HOJYO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.BIKOU1, StrConv(New_HS_OUT_SIJREC.BIKOU1, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, StrConv(New_HS_OUT_SIJREC.CHOHA_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, StrConv(New_HS_OUT_SIJREC.JYU_HIN_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HIN_NAME, StrConv(New_HS_OUT_SIJREC.HIN_NAME, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, StrConv(New_HS_OUT_SIJREC.HIN_CHANGE_KBN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, StrConv(New_HS_OUT_SIJREC.MODULE_EXCHANGE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAIKO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAN_SHISAN_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, StrConv(New_HS_OUT_SIJREC.ZAN_HOJYO_SYUSI, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, StrConv(New_HS_OUT_SIJREC.NOUKI_YMD, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, StrConv(New_HS_OUT_SIJREC.SERVICE_KANRI_NO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.KISHU_CODE, StrConv(New_HS_OUT_SIJREC.KISHU_CODE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, StrConv(New_HS_OUT_SIJREC.ENVIRONMENT_KBN, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.SS_CODE, StrConv(New_HS_OUT_SIJREC.SS_CODE, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, StrConv(New_HS_OUT_SIJREC.KEPIN_KAIJYO, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.HIN_NAI, "")
                    
                    Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                    Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                    Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                    Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                    Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                    Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                    Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                    Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                    
                    Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                    
                    Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, "")       '2006.07.20
                    Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, "")              '2006.07.20
                    Call UniCode_Conv(Y_SYUREC.LK_MUKE_CODE, wkMUKE_CODE)   '2006.07.20
                    Call UniCode_Conv(Y_SYUREC.LK_SEQ_NO, "")               '2006.07.20
                    
                    
                    Call UniCode_Conv(Y_SYUREC.G_KENPIN_F, "")              '2006.09.07
                    Call UniCode_Conv(Y_SYUREC.KENPIN_SURYO, "")            '2006.09.07
                    
                    
                    Call UniCode_Conv(Y_SYUREC.UPD_NOW, "")                 '2008.11.28
                    
                    
                    Call UniCode_Conv(Y_SYUREC.FILLER, "")
    
            
    
                    
                    Loop_Cnt = 0
                    Do
                        sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    GoTo Abort_Tran
'                                End If
                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    GoTo Abort_Tran
                                End If
                                
                                DoEvents
                                Sleep (500)
                            Case Else
                                Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)
                                GoTo Abort_Tran
                        End Select
                    Loop
    
                    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    If sts <> BtNoErr Then
                        GoTo Abort_Tran
                    End If
        
        
        
        
                    Out_Cnt = Out_Cnt + 1
                    lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                    DoEvents
        
        
        
        
        
        
        
                    If SYUKA_LOG_ON Then
                        Call SYUKA_LOG_OUT_PROC("INS", "AFT")
                    End If
                
                
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË", 0)
                    GoTo Abort_Tran
            End Select
                    
                                
                    
                    
                    
                    
                    
                    
                    
                    
                    
        End If
    Loop
    
        
    Close #DUP_SYUKANo
        
        
        
    New_Syuka_Update_Proc = False

    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function
                                            'ÉwÉbÉ_Å[àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Head(Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
    
    Printer.Print Tab(3);
    For i = 0 To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).CODE Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(37);
    Printer.Print "ÅñÅñÅñÅ@ïiî‘ïœçXÉäÉXÉgÅ@ÅñÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")
    
    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print "------- ïiî‘ÅiäOïîÅj-------";
    Printer.Print Tab(30);
    Printer.Print "------- ïiî‘Åiì‡ïîÅj-------";
    Printer.Print
    
    Printer.Print Tab(MGN_L);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 15);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 30);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 44);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 58);
    Printer.Print "ì`ï[ì˙ït";
    Printer.Print Tab(MGN_L + 69);
    Printer.Print "ì¸èoå…ãÊ";
    Printer.Print Tab(MGN_L + 78);
    Printer.Print "ì`ï[áÇ";
    Printer.Print Tab(MGN_L + 86);
    Printer.Print "ì¸èoêî";
    Printer.Print Tab(MGN_L + 93);
    Printer.Print "ëq";
    Printer.Print Tab(MGN_L + 96);
    Printer.Print "íçï∂ãÊ";
    Printer.Print Tab(MGN_L + 103);
    Printer.Print "èoâ◊êÊ"
    Printer.Print

    Lcnt = 7 + MGN_U

End Sub
                                            'ñæç◊àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Proc()

Dim Lcnt As Integer
Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim Emsg As String
Dim Wqty As Long
Dim i As Integer
Dim sts As Integer
Dim B_Jgyobu As String

    Lcnt = 99

    For i = 0 To LBox_Hin.ListCount - 1
        
'        Ldata = LBox_Hin.List(i)
'
'                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
        If Lcnt > LMAX Or _
           B_Jgyobu <> Left(Ldata, 1) Then
            Call P_Hin_Head(Lcnt, Left(Ldata, 1))
            B_Jgyobu = Left(Ldata, 1)
        End If
'
'                                        'ñæç◊àÛç¸
'        Ldata = Mid(Ldata, 11, Len(Ldata) - 11)                     'éñã∆ïîÅC√∑ΩƒáÇÅCçëì‡äOÅ@èúäO'
'
'        Printer.Print Tab(MGN_L);
'        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘ÅiäOïîÅj
'        Work = ChrCut(Ldata, 13)
'        If Right(Ldata, 1) = "1" Or Right(Ldata, 1) = "2" Then      'äOïîïiî‘ïœçXÅH
'            Printer.Print Tab(MGN_L + 15);
'            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘ÅiäOïîÅj
'        End If
'
'        Printer.Print Tab(MGN_L + 30);
'        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘Åiì‡ïîÅj
'        Work = ChrCut(Ldata, 13)
'        If Right(Ldata, 1) = "0" Then                               'ì‡ïîïiî‘ïœçXÅH
'            Printer.Print Tab(MGN_L + 44);
'            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘Åiì‡ïîÅj
'        End If
'
'        Printer.Print Tab(MGN_L + 58);                              'ì`ï[ì˙ït
'        Printer.Print ChrCut(Ldata, 4) & "/" & ChrCut(Ldata, 2) & "/" & ChrCut(Ldata, 2);
'
'        Printer.Print Tab(MGN_L + 69);                              'ì¸èoå…ãÊï™
'        wk_IO = ChrCut(Ldata, 1)
'        Select Case wk_IO
'            Case IO_KBN_URI
'                Printer.Print wk_IO & " " & (IO_KBN_0);
'            Case IO_KBN_NYU
'                Printer.Print wk_IO & " " & (IO_KBN_1);
'            Case IO_KBN_SYU
'                Printer.Print wk_IO & " " & (IO_KBN_2);
'            Case IO_KBN_ZAT
'                Printer.Print wk_IO & " " & (IO_KBN_3);
'            Case Else
'                Printer.Print wk_IO;
'        End Select
'
'        Printer.Print Tab(MGN_L + 78);
'        Printer.Print ChrCut(Ldata, 6);                             'ì`ï[áÇ
'
'        Printer.Print Tab(MGN_L + 85);                              'ì¸èoå…êî
'        Wqty = CLng(ChrCut(Ldata, 6))
'
'
'        sts = Numeric_Check(EDIT_ONLY, 7, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, Format(Wqty, "00000000"), Work)
'
'        Printer.Print Work;
'
'        Printer.Print Tab(MGN_L + 93);
'        Printer.Print ChrCut(Ldata, 2);                             'ëqå…ãÊï™ÅiŒΩƒÅj
'
'        Printer.Print Tab(MGN_L + 96);                              'íçï∂ãÊï™
'        Select Case Left(Ldata, 1)
'            Case CYU_KBN_TUK
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_1);
'            Case CYU_KBN_SPO
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_2);
'            Case CYU_KBN_HJU
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_3);
'            Case CYU_KBN_BOU
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_E);
'            Case Else
'                Printer.Print ChrCut(Ldata, 1);
'        End Select
'
'        Printer.Print Tab(MGN_L + 103);
'        Printer.Print ChrCut(Ldata, 5);                             'éxããêÊÅ^èoâ◊êÊ7
'
'        Printer.Print Tab(MGN_L + 110);                             'ïœçXÉÅÉbÉZÅ[ÉW
'        Select Case Left(Ldata, 1)
'            Case "0"
'                Printer.Print "ì‡ïîïœçX œΩ¿ïiî‘ì¸ë÷";
'            Case "1"
'                Printer.Print "äOïîïœçX œΩ¿ïiî‘ì¸ë÷";
'            Case "2"
'                Printer.Print "ç›å…óLÅIäOïîïœçXïsâ¬";
'        End Select
        
        Printer.Print LBox_Hin.List(i)
        
        Call LOG_OUT(LOG_F, LBox_Hin.List(i))
        
        Printer.Print

        Printer.Print

        Lcnt = Lcnt + 2
    Next i

    If Lcnt <> 99 Then
        Printer.EndDoc
        Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    End If

End Sub

Private Sub Form_Activate()

Dim Ret         As String


Dim i           As Integer
Dim FullPath    As String


    Call NG_File_Make_Proc

    Err_FLg = False

    '---------------------------------------------  éñã∆ïîñàÉÅÉCÉìÉãÅ[Év
    For i = 0 To UBound(JGYOBU_T)
        
        In_Cnt = 0
        Out_Cnt = 0

        lblJGYOBU(i).Caption = JGYOBU_T(i).NAME
        lblJGYOBU(i).ForeColor = JGYOBU_T(i).COLOR

        lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents

'2007.06.22Å@ì¸å…éÊÇËçûÇ›Çïúäà

        FileNo = FreeFile
        FileName = New_HS_IN_SIJ

        Ret = InStr(1, Trim(FileName), ".") - 1
        FileName = Left(Trim(FileName), Ret) & "_" & JGYOBU_T(i).CODE & Right(Trim(FileName), Len(Trim(FileName)) - Ret)

        On Error GoTo Error_Proc

        Open FileName For Input As #FileNo

        On Error GoTo 0


        If New_Nyuka_Update_Proc(JGYOBU_T(i).CODE) Then     'ì¸â◊ó\íËÉfÅ[É^çXêVèàóù

            Unload Me

        End If


        Close #FileNo

        '-----------------------------------------------
    
        FileNo = FreeFile
        FileName = New_HS_OUT_SIJ

        Ret = InStr(1, Trim(FileName), ".") - 1
        FileName = Left(Trim(FileName), Ret) & "_" & JGYOBU_T(i).CODE & Right(Trim(FileName), Len(Trim(FileName)) - Ret)
        
        On Error GoTo Error_Proc
        
        Open FileName For Binary As #FileNo
    
        On Error GoTo 0
    
    
        If New_Syuka_Update_Proc(JGYOBU_T(i).CODE) Then  'èoâ◊ó\íËÉfÅ[É^çXêVèàóù

            Unload Me
        End If
    
    
        Close #FileNo
    
    
    
    
    Next i


    If Not Err_FLg Then
        Call NG_File_Kill_Proc
    End If


    Unload Me

Error_Proc:

    Unload Me


End Sub

Private Sub Form_DblClick()
    PrintForm
End Sub

Private Sub Form_Load()
Dim i           As Integer
Dim j           As Integer

Dim c           As String * 128
Dim sts         As Integer


Dim sBuffer     As String * 255
Dim com         As String
    
Dim Max_Soko    As Integer
    
    If App.PrevInstance Then
 '       Beep
 '       MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If

    Show
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                'èoâ◊ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If SYUKA_LOGF_GET_PROC() Then
        Beep
        MsgBox "èoâ◊ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                 'èoâ◊èdï°ÉfÅ[É^èoóÕÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "DUP_SYUKA_DATA", "SYS", c) Then
        Beep
        MsgBox "èoâ◊èdï°ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    DUP_SYUKA_DATA = Trim(c)
                               
    If JGYOB_TB_Set(1) Then      'éñã∆ïîÇÃälìæ
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                
                                'ëqå…ç≈ëÂêîÇéÊÇËçûÇ›
    If GetIni(App.EXEName, "MAX_SOKO", App.EXEName, c) Then
        Max_Soko = 1
    Else
        If Not IsNumeric(RTrim(c)) Then
            Max_Soko = 1
        Else
            Max_Soko = CInt(RTrim(c))
        End If
    End If
                                    
                                
                                
                                
                                'ç›å…éÊÇËçûÇ›ópÉeÅ[ÉuÉãçÏê¨
    ReDim Soko_T(0 To UBound(JGYOBU_T), 0 To Max_Soko - 1)
                                'ëqå…èÓïÒéÊÇËçûÇ›
    For i = 0 To UBound(JGYOBU_T)
        j = 0
        Do
                                'óLå¯ëqå…älìæ
            If GetIni(App.EXEName, "SOKO" & JGYOBU_T(i).CODE & Format(j + 1, "0"), App.EXEName, c) Then
                Beep
                MsgBox "ëqå…èÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
                End
            End If
    
            If Trim(c) = "**" Then  'ëqå…éwíËèIóπ
                Exit Do
            End If
    
    
'            ReDim Preserve JSOKO_T(i).JSOKO_T(0 To j)
            Soko_T(i, j).HS_SOKO = Trim(c)
                                'çëì‡äOèÓïÒälìæ
            If GetIni(App.EXEName, "NAIG" & JGYOBU_T(i).CODE & Format(j + 1, "0"), App.EXEName, c) Then
                Beep
                MsgBox "çëì‡äOèÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
                End
            End If
            
            Soko_T(i, j).NAIGAI = Trim(c)
            j = j + 1
        Loop
    
    Next i
                                
                                
                                
                                
    'ó«ïiï‘ïiì¸å…íIî‘   2011.01.18
    If GetIni(App.EXEName, "RYOHEN_TANA", App.EXEName, c) Then
        RYOHEN_TANA = ""
    Else
        RYOHEN_TANA = RTrim(c)
    End If
                                
                                
                                'ïiñºÇ…ÇÊÇÈèúäO 2011.07.04
    NOT_Hin_Name_F = False
    If GetIni(App.EXEName, "NOT_HIN_NAME", App.EXEName, c) Then
    Else
        NOT_Hin_Name = Split(Trim(c), ",", -1)
        NOT_Hin_Name_F = True
    End If
                                'ïiñºÇ…ÇÊÇÈèúäO 2011.07.04
                                
                                
                                'ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæ
    If GetIni("FILE", "NEW_HS_SIJ_IN", "SYS", c) Then
        Beep
        MsgBox "ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    New_HS_IN_SIJ = Trim(c)
                                
                                
                                'êV⁄≤±≥ƒ èoå…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæ 2006.05.23
    If GetIni("FILE", "NEW_HS_SIJ_OUT", "SYS", c) Then
        Beep
        MsgBox "êVÅ@èoå…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    New_HS_OUT_SIJ = Trim(c)
                                
                                
                                
                                'Åuí èÌì¸â◊ÅvóvàˆÇÃälìæ
    If GetIni("YOIN", "YOIN_TU_NYUKA", "SYS", c) Then
        Beep
        MsgBox "Åuí èÌì¸â◊ÅvóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_TU_NYUKA = Trim(c)
                                
                                'ÅuëOéÿëäéEÅvóvàˆÇÃälìæ
    If GetIni("YOIN", "YOIN_MAE_SOUSAI", "SYS", c) Then
        Beep
        MsgBox "ÅuëOéÿëäéEÅvóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_MAE_SOUSAI = Trim(c)
                                
                                'âºëzì¸â◊ëqå…ÇÃälìæ
    If GetIni("SYSTEM", "KASO_NYUKA", "SYS", c) Then
        Beep
        MsgBox "âºëzì¸â◊ëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    KASO_NYUKA_SOKO = Trim(c)
                                'âºëzéxããñﬂÇµëqå…ÇÃälìæ
    If GetIni("SYSTEM", "KASO_SMODOSHI ", "SYS", c) Then
        Beep
        MsgBox "âºëzì¸â◊ëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    KASO_SMODOSHI_SOKO = Trim(c)
                                
                                
                                'ÇªÇÃëºå¸ÇØêÊÅiçëì‡ÅjÇÃälìæ
    If GetIni(App.EXEName, "ETC_MTS_NAI", App.EXEName, c) Then
        Beep
        MsgBox "ÇªÇÃëºå¸ÇØêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    ETC_MTS_NAI = Trim(c)
                                
                                'ÇªÇÃëºå¸ÇØêÊÅiäCäOÅjÇÃälìæ
    If GetIni(App.EXEName, "ETC_MTS_GAI", App.EXEName, c) Then
        Beep
        MsgBox "ÇªÇÃëºå¸ÇØêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    ETC_MTS_GAI = Trim(c)
                                
'---------------------------------------------- '“∆≠∞áÇÇÃälìæ    2007.11.06
    If GetIni(App.EXEName, "MENU_NO", App.EXEName, c) Then
        MENU_NO = ""
    Else
        MENU_NO = RTrim(c)
    End If
                                
                                'êÙëÛã@êÍóp
    If GetIni(App.EXEName, "CENTER", "SYS", c) Then
        MyCenter = "O"
    Else
        MyCenter = Trim(c)
    End If
'---------------------------------------------- 'ó«ïiï‘ïiÇÃóvàˆ 2009.07.10
    RYOHEN = YOIN_TU_NYUKA
    If GetIni(App.EXEName, "RYOHEN", App.EXEName, c) Then
    Else
        RYOHEN = RTrim(c)
    End If
                                
                                
                                'ÇªÇÃëºíºëóêÊÇÃälìæ
'    If GetIni(App.EXEName, "ETC_SS_NAI", "SYS", c) Then
'        Beep
'        MsgBox "ÇªÇÃëºíºëóêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
'        End
'    End If
'    ETC_SS_NAI = Trim(c)
                                
                                '‹∞∏Ω√∞ºÆ›î‘çÜéÊÇËçûÇ›
    sBuffer = Space(255)
    If GetComputerNameA(sBuffer, 255) <> 0 Then
        com = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
    Else
        com = "??"
    End If
    WS_NO = RTrim(com)

'---------------------------------------------- 'íIî‘ê›íËèÓïÒÇÃälìæ    2009.03.07
    If GetIni(App.EXEName, "TANA_SPACE", App.EXEName, c) Then
        TANA_SPACE = False
    Else
        If Trim(c) = "1" Then
            TANA_SPACE = True
        Else
            TANA_SPACE = False
        End If
    End If

'---------------------------------------------- 'è§ïiâª√ﬁÃ´Ÿƒ    2012.12.20
    If GetIni(App.EXEName, "GOODS_F", App.EXEName, c) Then
        GOODS_F = "0"
    Else
        If Trim(c) = "1" Then
            GOODS_F = "1"
        Else
            GOODS_F = "0"
        End If
    End If
'---------------------------------------------- 'è§ïiâª√ﬁÃ´Ÿƒ    2012.12.20



                                'ëqå…É}ÉXÉ^ÇnÇoÇdÇm
    If SOKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç\ê¨É}ÉXÉ^ÇnÇoÇdÇm '2005.12.30
    If P_COMPO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇnÇoÇdÇm
    If wITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If MTS_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'óvàˆÉ}ÉXÉ^ÇnÇoÇdÇm
    If YOIN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'íSìñé“É}ÉXÉ^ÇnÇoÇdÇm
    If TANTO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ÉRÅ[ÉhÉ}ÉXÉ^ÇnÇoÇdÇm   2005.12.30
    If P_CODE_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                'å¥éYçëÉ}ÉXÉ^ÇnÇoÇdÇm   2010.07.08
    If GENSAN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                
                                'PNÉ}ÉXÉ^ÇnÇoÇdÇm   2010.09.01
    If PN_M_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
    If Country_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                'ç›å…ÉfÅ[É^ÇnÇoÇdÇm
    If ZAIKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…à⁄ìÆóÇnÇoÇdÇm
    If IDO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊ó\íËÇnÇoÇdÇm
    If Y_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'èoâ◊ó\íËÇnÇoÇdÇm
    If Y_SYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊¡™Ø∏√ﬁ∞¿ÇnÇoÇdÇm
    If J_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If

                                'è∆çáópì¸â◊ó\íËÇnÇoÇdÇm 2007.06.15
    If Y_GLICS_Open(BtOpenNomal) Then
        Unload Me
    End If

    If P_SAGYO_LOG_Open(BtOpenNomal) Then
        Unload Me
    End If

'î≠î‘É}ÉXÉ^ÇnÇoÇdÇm ################################################################## 2005/05/16 Add Å´
    If HATUBAN_Open(BtOpenNomal) Then
        Unload Me
    End If
'#################################################################################### 2005/05/16 Add Å™
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                'å¥éYçëÉ}ÉXÉ^ÇnÇoÇdÇm 2011.01.18
    If GENSAN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                'àÛç¸ÉtÉHÉìÉgê›íË
    With NormalFont
        .NAME = F1020151.FontName
        .Size = F1020151.FontSize
    End With
    Set Printer.Font = NormalFont

    Last_Proc_F = False         'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉOÉNÉäÉA


    'édå¸ÇØêÊälìæ       2005.12.30
    i = -1
    
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN04_CD)
    Call UniCode_Conv(K0_P_CODE.C_Code, "")
    com = BtOpGetGreater
    SHIMUKE_Flg = False
    
    Do
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_CODEREC.DATA_KBN, vbUnicode) <> P_KBN04_CD Then
                    Exit Do
                End If
            
                i = i + 1
                ReDim Preserve SHIMUKE_T(0 To i)
            
            
                SHIMUKE_Flg = True
            
                SHIMUKE_T(i).SHIMUKE_CODE = StrConv(P_CODEREC.C_Code, vbUnicode)
                SHIMUKE_T(i).JGYOBU = StrConv(P_CODEREC.OPTION1, vbUnicode)
                SHIMUKE_T(i).NAIGAI = StrConv(P_CODEREC.OPTION2, vbUnicode)
                            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^", 0)
                Unload Me
        End Select
    
        com = BtOpGetNext
    Loop
        
    
    
    'édå¸ÇØêÊälìæ       2005.12.30


    Show
End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer

    DoEvents
    
'    If Last_Proc_F = True Then              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇËÅH
'        Call Last_Proc
'    End If

                                            'ëqå…É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^")
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ç\ê¨É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, wITEM_POS, wITEMREC, Len(wITEMREC), K0_wITEM, Len(K0_wITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
        End If
    End If
                                            'óvàˆÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")
        End If
    End If
                                            'íSìñé“É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")
        End If
    End If
                                            'ÉRÅ[ÉhÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ÉRÅ[ÉhÉ}ÉXÉ^")
        End If
    End If
                                            'ç›å…ÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")
        End If
    End If
                                            'ç›å…à⁄ìÆóÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, IDO_POS, IDOREC, Len(IDOREC), K0_IDO, Len(K0_IDO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆó")
        End If
    End If
                                            'ì¸â◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊ó\íË")
        End If
    End If
                                            'è∆çáópì¸â◊ó\íËÇbÇkÇnÇrÇd   2007.06.16
    sts = BTRV(BtOpClose, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "è∆çáópì¸â◊ó\íË")
        End If
    End If
                                            'èoâ◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íË")
        End If
    End If
                                            'ì¸â◊¡™Ø∏√ﬁ∞¿ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊¡™Ø∏√ﬁ∞¿")
        End If
    End If
                                            'ÇaÇîÇíÇâÇÖÇñÇÖÉäÉZÉbÉg
    sts = BTRV(BtOpReset, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set F1020151 = Nothing

    End
End Sub
Private Function Item_Check_Proc(Mode As Integer, JGYOBU As String, NAIGAI As String, HIN_GAI As String, _
                                                                                        Optional HIN_NAI As String = "             ", _
                                                                                        Optional HIN_NAME As String = "                         ", _
                                                                                        Optional GENSANKOKU As String = "                    ", _
                                                                                        Optional GEN_GENSANKOKU As String = "                    ", _
                                                                                        Optional SHIIRE_WORK_CENTER As String = "                    ", _
                                                                                        Optional KANKYO_KBN As String = "   ", _
                                                                                        Optional KANKYO_KBN_ST As String = "        ", _
                                                                                        Optional KANKYO_KBN_SURYO As String = "          ") As Integer
'----------------------------------------------------------------------------
'                   Åuïiñ⁄É}ÉXÉ^ÅvÉ`ÉFÉbÉNÅïçXêVèàóù
'----------------------------------------------------------------------------
Dim com         As Integer
Dim sts         As Integer
Dim ans         As Integer

Dim HIN_CHANGE  As Integer

    
    
Dim BEF_GAI     As String * 13
Dim BEF_NAI     As String * 13
    
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long
        
Dim i           As Integer
    
    
Dim sBuffer     As String * 255     '2009.01.21
Dim wkTanto     As String           '2009.01.21
    
Dim PN_M_STS    As Integer          '2010.09.01
    
    
    
Dim Loop_Cnt    As Integer          '2011.01.19
    
    
    Item_Check_Proc = True

    HIN_CHANGE = 0
    

    Call UniCode_Conv(K0_ITEM.JGYOBU, JGYOBU)
    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, HIN_GAI)

    Loop_Cnt = 0

    Do

        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                


                    If Mode = In_Mode Then          'ëŒì‡ïiî‘ïœçXÇÃÉ`ÉFÉbÉN
    '                Else
    
                        If Len(Trim(HIN_NAI)) <> 0 Then
                            If Trim(StrConv(ITEMREC.HIN_NAI, vbUnicode)) <> Trim(HIN_NAI) Then
                                HIN_CHANGE = NAI_CHANGE
                                BEF_NAI = StrConv(ITEMREC.HIN_NAI, vbUnicode)
                                'ì‡ïîïiî‘ì¸ÇÍë÷Ç¶
                                Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)
                            
                            
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                    
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                            
                            
                            
                            
                            
                            
                            End If
                        End If
                    
                    
                    
                                        
                        '---------------    2010.07.08  Å§
                        'å¥éYçëì¸ÇÍë÷Ç¶É`ÉFÉbÉN
                        If Len(Trim(GENSANKOKU)) <> 0 Or Len(Trim(GEN_GENSANKOKU)) <> 0 Or Len(Trim(SHIIRE_WORK_CENTER)) <> 0 Then
    '                        If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) <> Trim(GENSANKOKU) Then
                                'å¥éYçëì¸ÇÍë÷Ç¶
                                
                            
                                If Trim(GENSANKOKU) <> "" Then
                                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, GENSANKOKU)
                                Else
                                    Debug.Print
                                End If
                                
                                
    '                            If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) = "" Then
    '
    '                                Call UniCode_Conv(ITEMREC.GENSANKOKU, GENSANKOKU)
    '
    '
    '                            End If
                                
                                
                                Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, GEN_GENSANKOKU)
                                Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                            
                            
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                    
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                                
                                
                            
    '                        End If
                        End If
                        '---------------    2010.07.08  Å¢
                    
                    
                        '---------------    2010.07.27  Å§
                        'ä¬ã´ãÊï™É`ÉFÉbÉN
                        If Len(Trim(KANKYO_KBN)) <> 0 Or Len(Trim(KANKYO_KBN_ST)) <> 0 Or Len(Trim(KANKYO_KBN_SURYO)) <> 0 Then
                            
                            
                            
                            If Val(KANKYO_KBN_SURYO) = 0 Then
                            Else
                            
                                
                                'ä¬ã´ãÊï™ì¸ÇÍë÷Ç¶
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
                                    
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
                                
                                
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                        
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                            End If
                                
                            
                        End If
                        '---------------    2010.07.08  Å¢
                    
                    
                    
                    End If
                
                
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                
                com = BtOpInsert
                
                PN_M_STS = PN_M_GET(JGYOBU, HIN_GAI, 0)
                Select Case PN_M_STS
                
                    Case False
                    
                    Case BtErrKeyNotFound
                    
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")
                    
                    Case True
                        
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")

                
                End Select
                '2010.09.01
                
                
                
                
                Call Rclr_ITEMREC               '2012.02.11
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.JGYOBU, JGYOBU)   'éñã∆ïî
                Call UniCode_Conv(ITEMREC.NAIGAI, NAIGAI)   'çëì‡äO
                Call UniCode_Conv(ITEMREC.HIN_GAI, HIN_GAI) 'ïiî‘ÅiäOïîÅj
                                                            'ïiñº
                Call UniCode_Conv(ITEMREC.HIN_NAME, HIN_NAME)
    
                    
'2009.01.21                If Mode = In_Mode Then  'êVãKïiî‘éû*ÇÉZÉbÉg2008.10.29
                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
                    Call UniCode_Conv(ITEMREC.ST_SOKO, "**")
                    Call UniCode_Conv(ITEMREC.ST_RETU, "**")
                    Call UniCode_Conv(ITEMREC.ST_REN, "**")
                    Call UniCode_Conv(ITEMREC.ST_DAN, "**")
                    
'                Else
'                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
'                    Call UniCode_Conv(ITEMREC.ST_SOKO, "")
'                    Call UniCode_Conv(ITEMREC.ST_RETU, "")
'                    Call UniCode_Conv(ITEMREC.ST_REN, "")
'                    Call UniCode_Conv(ITEMREC.ST_DAN, "")
'                End If
    
                Call UniCode_Conv(ITEMREC.BEF_SOKO, "")
                Call UniCode_Conv(ITEMREC.BEF_RETU, "")
                Call UniCode_Conv(ITEMREC.BEF_REN, "")
                Call UniCode_Conv(ITEMREC.BEF_DAN, "")
    
                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, "")
    
                
                
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.HIN_NAI, StrConv(PN_MREC.SPn, vbUnicode))        'ïiî‘Åiì‡ïîÅj
                Else
                    Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)         'ïiî‘Åiì‡ïîÅj
                End If
    
                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, "")           'îıçl ÉzÉXÉgëqå…
                Call UniCode_Conv(ITEMREC.BIKOU_TANA, "")           'îıçl ÉzÉXÉgíIî‘
'                Call UniCode_Conv(ITEMREC.SIZAI_CD, "")             'éëçﬁÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")      'ï‚è[ì_
                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")    'åéïΩãœèoâ◊êî
                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")          'ÉTÉìÉvÉãêî
                Call UniCode_Conv(ITEMREC.LAST_INP_DT, "")          'ç≈èIì¸â◊ì˙ït
    
'                Call UniCode_Conv(ITEMREC.LOCK_F, "")               'îrëºÉtÉâÉO
'                Call UniCode_Conv(ITEMREC.WEL_ID, "")               'égópéqã@ÇhÇc
'                Call UniCode_Conv(ITEMREC.PRG_ID, "")               'égópíÜÉvÉçÉOÉâÉÄ
    
                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")          'ç≈èIè∆çáì˙ït
                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "")         'ç≈èIè∆çáéûç›å…êî
'                Call UniCode_Conv(ITEMREC.MOTO_JIGYOBU, "")         'å≥éñéñã∆ïî
                Call UniCode_Conv(ITEMREC.BIKOU, "")                'àÛç¸îıçl
                Call UniCode_Conv(ITEMREC.IRI_QTY, "")              'àÛç¸ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.JAN_CODE, "")             'JanÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HIN_CHANGE, "")           'ïiî‘ì«Ç›ë÷Ç¶
                Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_ON)      'è§ïiâªóLñ≥
                Call UniCode_Conv(ITEMREC.PACKING_NO, "")           'å¬ëïî†áÇ
                Call UniCode_Conv(ITEMREC.GLICS1_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS2_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS3_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                
                
                                
                
                
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.G_SHIIRE_KBN, "")             'ã∆ñ±ä«óùÅ@ édì¸ãÊï™
                Call UniCode_Conv(ITEMREC.G_HANBAI_KBN, "")             '           îÃîÑãÊï™
                Call UniCode_Conv(ITEMREC.G_SYUSHI, "")                 '           é˚éxíPà 
                Call UniCode_Conv(ITEMREC.G_KUMITATE, "")               '           ëgóßêªïi
                Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")              '           ïWèÄëeóòîÑâøíPâøÅ@9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_URITAN_DT, "")           '           ïWèÄëeóòîÑâøê›íËì˙
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "")              '           ïWèÄëeóòå¥âøíPâø  9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, "")           '           ïWèÄëeóòå¥âøê›íËì˙
                                            
                                            
                                                                        '           édì¸êÊèÓïÒ
                For i = 0 To 2
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).CODE, "")             '∫∞ƒﬁ
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA, "")            'édì¸íPâø
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA_DT, "")         'íPâøê›íËì˙
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LOT, "")              '€Øƒêî
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LEAD_TIME, "")        'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_DT, "")    'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_QTY, "")   'ÿ∞ƒﬁ¿≤—
                
                Next i
                                            
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_KIN, "")          '           ëOåéç›å…ã‡äz
                Call UniCode_Conv(ITEMREC.G_SHIZAI_KBN, "")             '           éëçﬁãÊï™
                Call UniCode_Conv(ITEMREC.G_LABEL_NON, P_G_LABEL_ON)    '           ÉâÉxÉãì\ït
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å¢

'*------------------------------------------ 2005.11.15 í«â¡(è§ïi◊ÕﬁŸçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.L_HIN_NAME_E, "")             'è§ïi◊ÕﬁŸ   ïiñº
                Call UniCode_Conv(ITEMREC.L_BIKOU, "")                  '           îıçl
                Call UniCode_Conv(ITEMREC.L_KAISHA_CODE, "")            '           âÔé–ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_KISHU1, "")                 '           ã@éÌ(1)
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
                Call UniCode_Conv(ITEMREC.L_KISHU3, "")                 '           ã@éÌ(3)
                Call UniCode_Conv(ITEMREC.L_PAPER, "")                  '           éÜ
                Call UniCode_Conv(ITEMREC.L_PLASTIC, "")                '           ÉvÉâÉXÉ`ÉbÉN
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.L_URIKIN1, "")                '           âøäi(1)
'                Call UniCode_Conv(ITEMREC.L_URIKIN2, "")                '           âøäi(2)
'                Call UniCode_Conv(ITEMREC.L_URIKIN3, "")                '           âøäi(3)
                
                
                                                                '           âøäi(1)
                If IsNumeric(StrConv(PN_MREC.Tanka2, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, Format(Val(StrConv(PN_MREC.Tanka2, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(2)
                If IsNumeric(StrConv(PN_MREC.Tanka3, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, Format(Val(StrConv(PN_MREC.Tanka3, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(3)
                If IsNumeric(StrConv(PN_MREC.Tanka4, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, Format(Val(StrConv(PN_MREC.Tanka4, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, "0000000000")
                End If
                '2010.09.01
                
                
                
                
                Call UniCode_Conv(ITEMREC.L_LABEL, "")                  '           ìKópã@éÌ◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_MAISU, "")                  '           ñáêî◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_KISHU_BIKOU, "")            '           ìKópã@éÌîıçl
                Call UniCode_Conv(ITEMREC.L_SAGYO_SHIJI, "")            '           çÏã∆éwé¶
                Call UniCode_Conv(ITEMREC.L_BIKOU3, "")                 '           îıçlÇR
                Call UniCode_Conv(ITEMREC.L_JGYOBU_CODE, "")            '           éñã∆ïîÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_IRI_QTY, "")                '           ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.L_TANA1, "")                  '           íIî‘(1)
                Call UniCode_Conv(ITEMREC.L_TANA2, "")                  '           íIî‘(2)
                
                
                
'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å§
                
                Call UniCode_Conv(ITEMREC.S_TANTO, "")                  'é˚íPÅ^íSìñé“ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.ZAIKO_F, "")                  'ç›å…ä«óùëŒè€óLñ≥ 1:ëŒè€ 0:ëŒè€äO
    
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
    
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_QTY, "")          '           ëOåéç›å…êîó 
                Call UniCode_Conv(ITEMREC.G_LAST_SYUKA_QTY, "")         '           ç≈èIèoâ◊êî
    
                Call UniCode_Conv(ITEMREC.G_S2_ZAI_QTY, "")             'GLICSç›å…(S2) ë‹à‰óp
                Call UniCode_Conv(ITEMREC.G_P2_ZAI_QTY, "")             'GLICSç›å…(P2) ë‹à‰óp
                    
                '2010.09.01
                Call UniCode_Conv(ITEMREC.K_KEITAI, "")                 'å¬ëïå`ë‘
                Call UniCode_Conv(ITEMREC.K_KEITAI, StrConv(PN_MREC.KKeitai, vbUnicode))
                '2010.09.01
    
    
    

    
'2010.09.01
'                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, "")               '’∆ØƒïîïiãÊï™
'                Call UniCode_Conv(ITEMREC.NAI_BUHIN, "")                'çëì‡ãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.GAI_BUHIN, "")                'äCäOãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.HYO_TANKA, "")                'ïWèÄíPâø   2006.07.28


                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, StrConv(PN_MREC.UnitKbn, vbUnicode))      '’∆ØƒïîïiãÊï™
                Call UniCode_Conv(ITEMREC.NAI_BUHIN, StrConv(PN_MREC.NaiKbn, vbUnicode))        'çëì‡ãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.GAI_BUHIN, StrConv(PN_MREC.GaiKbn, vbUnicode))        'äCäOãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.HYO_TANKA, StrConv(PN_MREC.HyoTan, vbUnicode))        'ïWèÄíPâø   2006.07.28
'2010.09.01
    
    
    
    
    
    
    
    
    
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.LAST_CODE, "")                'ç≈èIédì¸êÊÉRÅ[Éh   2007.05.29
                Call UniCode_Conv(ITEMREC.LAST_TANKA, "")               'ç≈èIédì¸íPâø       2007.05.29
    
                Call UniCode_Conv(ITEMREC.MAKER_CODE, "")               '“∞∂∞∫∞ƒﬁ           2007.06.06
                Call UniCode_Conv(ITEMREC.MAKER_NAME, "")               '“∞∂∞ñºèÃ           2007.06.06
    
    
                Call UniCode_Conv(ITEMREC.L_MARK, "")                   'çƒç´ïÔœ∞∏          2007.11.08
    
                Call UniCode_Conv(ITEMREC.SAI_SU, "")                   'çÀêî               2008.02.14
    
                Call UniCode_Conv(ITEMREC.D_KEISHIKI, "")               'å`éÆ               2008.02.14
                Call UniCode_Conv(ITEMREC.D_MATERIAL, "")               'çﬁéø               2008.02.14
                Call UniCode_Conv(ITEMREC.D_THICKNESS, "")              '¿ﬁ›Œﬁ∞ŸÅ@å˙Ç≥      2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.D_SIZE_W, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiWÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_D, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiDÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_H, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiHÅj   2008.02.14
        
                Call UniCode_Conv(ITEMREC.D_PRINT, "")                  'àÛç¸Ç∑ÇÈÅ^ÇµÇ»Ç¢   2008.02.14
            
        
                Call UniCode_Conv(ITEMREC.S_KOUSU, "")                  'è§ïiâªÅ@çHêî       2008.02.14
        
                Call UniCode_Conv(ITEMREC.S_KOUSU_GENKA, "")            'è§ïiâªÅ@çHêîå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_BAIKA, "")            'è§ïiâªÅ@çHêîîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_SET_DATE, "")         'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
        
    
                Call UniCode_Conv(ITEMREC.S_SHIZAI_GENKA, "")           'è§ïiâªÅ@éëçﬁå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_BAIKA, "")           'è§ïiâªÅ@éëçﬁîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_SET_DATE, "")        'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.SE_USOU_F, "")                'óAëóî†Å@èoóÕÃ◊∏ﬁ   2008.02.14
    
                Call UniCode_Conv(ITEMREC.USE_TAPE_KIND, "")            'égópÉeÅ[ÉvéÌóﬁ     2008.02.14
                Call UniCode_Conv(ITEMREC.USE_TAPE_LNG, "")             'égópÉeÅ[Éví∑       2008.02.14
    
                Call UniCode_Conv(ITEMREC.H_TANA_MAKE, "")              'íIî‘É}Å[ÉN         2008.04.02
    
    
                Call UniCode_Conv(ITEMREC.SE_TANKA_MEMO, "")            'êøãÅíPâøÅ@ÉÅÉÇ     2008.04.15
    
                '2010.07.08 Å§
                'Call UniCode_Conv(ITEMREC.GENSANKOKU, "")              'å¥éYçë             2008.06.11
                Call UniCode_Conv(ITEMREC.xGENSANKOKU, "")              'å¥éYçë
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.GENSANKOKU, "")               'å¥éYçë
                Call UniCode_Conv(ITEMREC.GENSANKOKU, StrConv(PN_MREC.MadeIn, vbUnicode))
                '2010.09.01
                
                
                If Trim(GENSANKOKU) <> "" Or Trim(GEN_GENSANKOKU) <> "" Or Trim(SHIIRE_WORK_CENTER) <> "" Then
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, GEN_GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                Else
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, "")
                End If
                '2010.07.08 Å¢
    
                '2010.09.01
                If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) = "" Then
                    
                    Call UniCode_Conv(K0_Country.CountryCode, StrConv(PN_MREC.MadeInCode, vbUnicode))
                    sts = BTRV(BtOpGetEqual, Country_POS, CountryREC, Len(CountryREC), K0_Country, Len(K0_Country), 0)
                    Select Case sts
                        Case BtNoErr
                            Debug.Print
                        Case BtErrKeyNotFound
                            Call UniCode_Conv(CountryREC.CountryName2, "")
                        Case Else
                    
                            Call File_Error(sts, BtOpGetEqual, "COUNTRY")
                            Exit Function
                    
                    End Select
                
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, StrConv(CountryREC.CountryName2, vbUnicode))
                
                
                End If
                '2010.09.01
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.S_GAISO_TANKA, "")            'äOëïíPâø 9(8)V99   2008.06.12
                Call UniCode_Conv(ITEMREC.S_PPSC_KAKO_KOSU, "")         'PPSCâ¡çHíPâø9(8)   2008.06.12
                Call UniCode_Conv(ITEMREC.S_BU_KAKO_KOSU, "")           'BUâ¡çHíPâø9(8)     2008.06.12
    
    
                Call UniCode_Conv(ITEMREC.SEI_LOT, "")                  'ê∂éYÉçÉbÉg         2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_RATE, "")                 'ï™ÉåÅ[Ég           2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_SYU_KON, "")              'èWçáç´ïÔ           2008.07.07
    
    
                Call UniCode_Conv(ITEMREC.SEI_TANKA_TANTO, "")          'íPâøê›íËíSìñé“     2008.07.09
    
                Call UniCode_Conv(ITEMREC.SHIMUKE_CODE, "")             'édå¸ÇØêÊ           2008.07.09

                Call UniCode_Conv(ITEMREC.SEI_KBN, "")                  'êøãÅãÊï™           2008.07.16

                Call UniCode_Conv(ITEMREC.SEI_LABEL_QTY, "")            'ÉâÉxÉãì\ÇËñáêî     2008.07.19

                Call UniCode_Conv(ITEMREC.SEI_SZI_CNT, "")              'éëçﬁåèêî     Å@    2008.08.20í«â¡
                Call UniCode_Conv(ITEMREC.SEI_DKN_CNT, "")              'ìØç´åèêî           2008.08.20í«â¡
         

'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å¢
                
                
                                
                
                
                
                'Å´2009.02.20
                For i = 0 To 9
                    Call UniCode_Conv(ITEMREC.BEF_KOUTEI(i).BEF_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.MAIN_KOUTEI(i).MAIN_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.AFT_KOUTEI(i).AFT_KOUTEI, "")

                Next i


                Call UniCode_Conv(ITEMREC.SE_IO_TANKA_No, "")
                'Å™2009.02.20
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.STAT, "1")                    'èÛë‘ãÊï™           2009.01.21
    

                sBuffer = Space(255)                                    '2009.01.21
                If GetComputerNameA(sBuffer, 255) <> 0 Then
                    wkTanto = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
                Else
                    wkTanto = "???"
                End If

                
                
                
                Call UniCode_Conv(ITEMREC.INSP_MESSAGE, "")             'åüïi“Øæ∞ºﬁ 2009.08.28
                Call UniCode_Conv(ITEMREC.S_SEIKYU_F, "")               'êøãÅÇe 2009.08.28
                
                Call UniCode_Conv(ITEMREC.BEF_S_KOUSU_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_SHIZAI_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_GAISO_TANKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_PPSC_KAKO_KOSU, "")
                Call UniCode_Conv(ITEMREC.BEF_S_BU_KAKO_KOSU, "")
            
                Call UniCode_Conv(ITEMREC.M_BIKOU, "")
                Call UniCode_Conv(ITEMREC.SHIYOU_NO, "")
                Call UniCode_Conv(ITEMREC.MITSUMORI_KBN, "")
                Call UniCode_Conv(ITEMREC.TANKA_KIRIKAE_DT, "")
                Call UniCode_Conv(ITEMREC.KIRIKAE_KBN, "")
                
                
                
                
                Call UniCode_Conv(ITEMREC.KANKYO_KBN, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, "")
                
                
                If Trim(KANKYO_KBN) <> "" Or Trim(KANKYO_KBN_ST) <> "" Or Trim(KANKYO_KBN_SURYO) <> "" Then
                    
                    If Val(KANKYO_KBN_SURYO) <> 0 Then
                    
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
                
                    End If
            
                End If
                
                
                                                                        'í«â¡íSìñé“
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.INS_TANTO, wkTanto)
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "ysyuk")
                Else
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "yglcs")
                End If
                '2010.09.01
                                                                        
                                                                        'í«â¡ì˙éû
                Call UniCode_Conv(ITEMREC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))


                
                
                
                Call UniCode_Conv(ITEMREC.BEF_L_LABEL, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PLASTIC, "")
    
                
                
                Call UniCode_Conv(ITEMREC.BIKOU20, "")
                
                '2011.07.05
                Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "")
                
                If NOT_Hin_Name_F Then
                    For i = 0 To UBound(NOT_Hin_Name)
                        If InStr(1, RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode)), NOT_Hin_Name(i)) <> 0 Then
                            Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "1")
                            Exit For
                        End If
                    Next i
                End If
                '2011.07.05
                
                Call UniCode_Conv(ITEMREC.FILLER, "")
                                                                        'çXêVíSìñé“
                Call UniCode_Conv(ITEMREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                        'çXêVì˙éû
                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                                
                
                
                
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
            
                DoEvents
                Sleep (500)
           
            
            Case BtErrDEAD_LOCK
                Exit Function
                        
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^", 0)
                Exit Function
        End Select
    Loop
    
    Loop_Cnt = 0
    
    Do
        sts = BTRV(com, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
            
                DoEvents
                Sleep (500)
            
            
            
            Case BtErrDEAD_LOCK
                Exit Function
            Case Else
                Call File_Error(sts, com, "ïiñ⁄É}ÉXÉ^", 0)
                Exit Function
        End Select
    Loop
        
    If SHIMUKE_Flg Then
        If com = BtOpInsert Then
            'ç\ê¨É}ÉXÉ^ÇÃí«â¡       2005.12.30
            For i = 0 To UBound(SHIMUKE_T)
            
                If StrConv(ITEMREC.JGYOBU, vbUnicode) = SHIMUKE_T(i).JGYOBU And _
                    StrConv(ITEMREC.NAIGAI, vbUnicode) = SHIMUKE_T(i).NAIGAI Then
                                                                            'édå¸ÇØêÊ∫∞ƒﬁ
                    Call UniCode_Conv(P_COMPO_O_REC.SHIMUKE_CODE, SHIMUKE_T(i).SHIMUKE_CODE)
                                                                            'éñã∆ïî
                    Call UniCode_Conv(P_COMPO_O_REC.JGYOBU, SHIMUKE_T(i).JGYOBU)
                                                                            'çëì‡äO
                    Call UniCode_Conv(P_COMPO_O_REC.NAIGAI, SHIMUKE_T(i).NAIGAI)
                                                                            'ïiî‘
                    Call UniCode_Conv(P_COMPO_O_REC.HIN_GAI, StrConv(ITEMREC.HIN_GAI, vbUnicode))
                                                                            '√ﬁ∞¿ãÊï™
                    Call UniCode_Conv(P_COMPO_O_REC.DATA_KBN, P_HEAD)
                                                                            'í«î‘
                    Call UniCode_Conv(P_COMPO_O_REC.SEQNO, "000")
                                                                            'äÓñ{ÉNÉâÉX
                    Call UniCode_Conv(P_COMPO_O_REC.CLASS_CODE, "")
                                                                            'îıçl
                    Call UniCode_Conv(P_COMPO_O_REC.BIKOU, "")
                    
                    Call UniCode_Conv(P_COMPO_O_REC.FILLER, "")
                                                                            'çXêVíSìñé“
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                            'çXêVì˙éû
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                
                    Loop_Cnt = 0
                    Do
                        sts = BTRV(BtOpInsert, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                        Select Case sts
                            Case BtNoErr, BtErrDuplicates
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    Exit Function
'                                End If
                            
                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    Exit Function
                                End If
                            
                                DoEvents
                                Sleep (500)
                            
                            
                            Case BtErrDEAD_LOCK
                                Exit Function
                            Case Else
                                Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    Loop
                
                
                End If
            Next i
        
        End If
        
    End If
        
    If HIN_CHANGE <> 0 Then
        LBox_Hin.AddItem JGYOBU & NAIGAI & StrConv(ITEMREC.HIN_GAI, vbUnicode) & BEF_GAI & StrConv(ITEMREC.HIN_NAI, vbUnicode) & BEF_NAI & NAI_CHANGE
    End If

    Item_Check_Proc = False

End Function

Private Function old_Item_Check_Proc(Mode As Integer, JGYOBU As String, NAIGAI As String, HIN_GAI As String, _
                                                                                        Optional HIN_NAI As String = "             ", _
                                                                                        Optional HIN_NAME As String = "                         ", _
                                                                                        Optional GENSANKOKU As String = "                    ", _
                                                                                        Optional GEN_GENSANKOKU As String = "                    ", _
                                                                                        Optional SHIIRE_WORK_CENTER As String = "                    ", _
                                                                                        Optional KANKYO_KBN As String = "   ", _
                                                                                        Optional KANKYO_KBN_ST As String = "        ", _
                                                                                        Optional KANKYO_KBN_SURYO As String = "          ") As Integer
'----------------------------------------------------------------------------
'                   Åuïiñ⁄É}ÉXÉ^ÅvÉ`ÉFÉbÉNÅïçXêVèàóù
'----------------------------------------------------------------------------
Dim com         As Integer
Dim sts         As Integer
Dim ans         As Integer

Dim HIN_CHANGE  As Integer

    
    
Dim BEF_GAI     As String * 13
Dim BEF_NAI     As String * 13
    
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long
        
Dim i           As Integer
    
Dim sBuffer     As String * 255     '2009.01.21
Dim wkTanto     As String           '2009.01.21
    
Dim Loop_Cnt        As Integer          '2011.01.15
    
Dim PN_M_STS    As Integer          '2010.09.01
    
    
    old_Item_Check_Proc = True

    HIN_CHANGE = 0
    
    
           
'    If Mode = Out_Mode Then
'        Item_Check_Proc = False
'        Exit Function
'    End If
    
'    If Len(Trim(StrConv(HS_IN_SIJREC.HIN_NAI, vbUnicode))) <> 0 Then
'
'        Call UniCode_Conv(K2_ITEM.JGYOBU, JGYOBU)
'        Call UniCode_Conv(K2_ITEM.NAIGAI, NAIGAI)
'        Call UniCode_Conv(K2_ITEM.HIN_NAI, StrConv(HS_IN_SIJREC.HIN_NAI, vbUnicode))
'
'
'        Do                          'ëŒäOïiî‘ì¸ÇÍë÷Ç¶ÇÃÉãÅ[Év
'
'            sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K2_ITEM, Len(K2_ITEM), 2)
'            Select Case sts
'                Case BtNoErr
'                    If StrConv(ITEMREC.HIN_GAI, vbUnicode) <> Trim(HIN_GAI) Then
'                                    'äOïîïiî‘ÇÃì¸ÇÍë÷Ç¶ÇÃà◊ÇÃç›å…óLñ≥É`ÉFÉbÉN
'                        If Zaiko_Syukei_Proc(Sumi_Qty, MI_Qty, StrConv(ITEMREC.JGYOBU, vbUnicode), StrConv(ITEMREC.NAIGAI, vbUnicode), StrConv(ITEMREC.HIN_GAI, vbUnicode)) Then
'                            Exit Function
'                        End If
'
'
'                        If (Sumi_Qty + MI_Qty) = 0 Then
'                            Do
'                                sts = BTRV(BtOpDelete, ITEM_POS, ITEMREC, Len(ITEMREC), K2_ITEM, Len(K2_ITEM), 2)
'                                Select Case sts
'                                    Case BtNoErr
'                                        Exit Do
'
'
'                                    Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                        Beep
'                                        ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                        If ans = vbCancel Then
'                                            Exit Function
'                                        End If
'                                    Case Else
'                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
'                                        Exit Function
'                                End Select
'                            Loop
'
'
'                            HIN_CHANGE = GAI_CHANGE
'                            BEF_GAI = HIN_GAI
'
'                        Else
'                            'ïiî‘ì¸ÇÍë÷Ç¶ïsâ¬
'                            sts = BTRV(BtOpUnlock, ITEM_POS, ITEMREC, Len(ITEMREC), K2_ITEM, Len(K2_ITEM), 2)
'                            If sts Then
'                                Call File_Error(sts, BtOpUnlock, "ïiñ⁄É}ÉXÉ^")
'                                Exit Function
'                            End If
'                            HIN_CHANGE = NOT_GAI_CHANGE
'                            BEF_GAI = HIN_GAI
'
'                        End If
'                    End If
'
'                    Exit Do
'
'                Case BtErrKeyNotFound
'                    Exit Do
'                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                    Beep
'                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                    If ans = vbCancel Then
'                        Exit Function
'                    End If
'                Case Else
'                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
'                    Exit Function
'            End Select
'
'        Loop
'
'    End If

    Call UniCode_Conv(K0_ITEM.JGYOBU, JGYOBU)
    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, HIN_GAI)

    Loop_Cnt = 0

    Do

        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr

                If Mode = In_Mode Then          'ëŒì‡ïiî‘ïœçXÇÃÉ`ÉFÉbÉN
'                Else

                    If Len(Trim(Trim(HIN_NAI))) <> 0 Then
                        If Trim(StrConv(ITEMREC.HIN_NAI, vbUnicode)) <> Trim(HIN_NAI) Then
                            HIN_CHANGE = NAI_CHANGE
                            BEF_NAI = StrConv(ITEMREC.HIN_NAI, vbUnicode)
                            'ì‡ïîïiî‘ì¸ÇÍë÷Ç¶
                            Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)
                        
                        
                            'íSìñé“çXêVí«â¡ 2009.11.11
                                
                                                                                    'çXêVíSìñé“
                            Call UniCode_Conv(ITEMREC.UPD_TANTO, "2015")
                                                                                    'çXêVì˙éû
                            Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                        
                        
                        End If
                    End If
                End If
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ç∑Çµë÷Ç¶    2012.07.05
                com = BtOpInsert
                
                PN_M_STS = PN_M_GET(JGYOBU, HIN_GAI, 0)
                Select Case PN_M_STS
                
                    Case False
                    
                    Case BtErrKeyNotFound
                    
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")
                    
                    Case True
                        
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")

                
                End Select
                '2010.09.01
                
                
                
                
                Call Rclr_ITEMREC               '2012.02.11
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.JGYOBU, JGYOBU)   'éñã∆ïî
                Call UniCode_Conv(ITEMREC.NAIGAI, NAIGAI)   'çëì‡äO
                Call UniCode_Conv(ITEMREC.HIN_GAI, HIN_GAI) 'ïiî‘ÅiäOïîÅj
                                                            'ïiñº
                Call UniCode_Conv(ITEMREC.HIN_NAME, HIN_NAME)
    
                    
'2009.01.21                If Mode = In_Mode Then  'êVãKïiî‘éû*ÇÉZÉbÉg2008.10.29
                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
                    Call UniCode_Conv(ITEMREC.ST_SOKO, "**")
                    Call UniCode_Conv(ITEMREC.ST_RETU, "**")
                    Call UniCode_Conv(ITEMREC.ST_REN, "**")
                    Call UniCode_Conv(ITEMREC.ST_DAN, "**")
                    
'                Else
'                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
'                    Call UniCode_Conv(ITEMREC.ST_SOKO, "")
'                    Call UniCode_Conv(ITEMREC.ST_RETU, "")
'                    Call UniCode_Conv(ITEMREC.ST_REN, "")
'                    Call UniCode_Conv(ITEMREC.ST_DAN, "")
'                End If
    
                Call UniCode_Conv(ITEMREC.BEF_SOKO, "")
                Call UniCode_Conv(ITEMREC.BEF_RETU, "")
                Call UniCode_Conv(ITEMREC.BEF_REN, "")
                Call UniCode_Conv(ITEMREC.BEF_DAN, "")
    
                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, "")
    
                
                
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.HIN_NAI, StrConv(PN_MREC.SPn, vbUnicode))        'ïiî‘Åiì‡ïîÅj
                Else
                    Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)         'ïiî‘Åiì‡ïîÅj
                End If
    
                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, "")           'îıçl ÉzÉXÉgëqå…
                Call UniCode_Conv(ITEMREC.BIKOU_TANA, "")           'îıçl ÉzÉXÉgíIî‘
'                Call UniCode_Conv(ITEMREC.SIZAI_CD, "")             'éëçﬁÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")      'ï‚è[ì_
                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")    'åéïΩãœèoâ◊êî
                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")          'ÉTÉìÉvÉãêî
                Call UniCode_Conv(ITEMREC.LAST_INP_DT, "")          'ç≈èIì¸â◊ì˙ït
    
'                Call UniCode_Conv(ITEMREC.LOCK_F, "")               'îrëºÉtÉâÉO
'                Call UniCode_Conv(ITEMREC.WEL_ID, "")               'égópéqã@ÇhÇc
'                Call UniCode_Conv(ITEMREC.PRG_ID, "")               'égópíÜÉvÉçÉOÉâÉÄ
    
                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")          'ç≈èIè∆çáì˙ït
                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "")         'ç≈èIè∆çáéûç›å…êî
'                Call UniCode_Conv(ITEMREC.MOTO_JIGYOBU, "")         'å≥éñéñã∆ïî
                Call UniCode_Conv(ITEMREC.BIKOU, "")                'àÛç¸îıçl
                Call UniCode_Conv(ITEMREC.IRI_QTY, "")              'àÛç¸ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.JAN_CODE, "")             'JanÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HIN_CHANGE, "")           'ïiî‘ì«Ç›ë÷Ç¶
                Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_ON)      'è§ïiâªóLñ≥
                Call UniCode_Conv(ITEMREC.PACKING_NO, "")           'å¬ëïî†áÇ
                Call UniCode_Conv(ITEMREC.GLICS1_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS2_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS3_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                
                
                                
                
                
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.G_SHIIRE_KBN, "")             'ã∆ñ±ä«óùÅ@ édì¸ãÊï™
                Call UniCode_Conv(ITEMREC.G_HANBAI_KBN, "")             '           îÃîÑãÊï™
                Call UniCode_Conv(ITEMREC.G_SYUSHI, "")                 '           é˚éxíPà 
                Call UniCode_Conv(ITEMREC.G_KUMITATE, "")               '           ëgóßêªïi
                Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")              '           ïWèÄëeóòîÑâøíPâøÅ@9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_URITAN_DT, "")           '           ïWèÄëeóòîÑâøê›íËì˙
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "")              '           ïWèÄëeóòå¥âøíPâø  9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, "")           '           ïWèÄëeóòå¥âøê›íËì˙
                                            
                                            
                                                                        '           édì¸êÊèÓïÒ
                For i = 0 To 2
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).CODE, "")             '∫∞ƒﬁ
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA, "")            'édì¸íPâø
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA_DT, "")         'íPâøê›íËì˙
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LOT, "")              '€Øƒêî
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LEAD_TIME, "")        'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_DT, "")    'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_QTY, "")   'ÿ∞ƒﬁ¿≤—
                
                Next i
                                            
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_KIN, "")          '           ëOåéç›å…ã‡äz
                Call UniCode_Conv(ITEMREC.G_SHIZAI_KBN, "")             '           éëçﬁãÊï™
                Call UniCode_Conv(ITEMREC.G_LABEL_NON, P_G_LABEL_ON)    '           ÉâÉxÉãì\ït
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å¢

'*------------------------------------------ 2005.11.15 í«â¡(è§ïi◊ÕﬁŸçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.L_HIN_NAME_E, "")             'è§ïi◊ÕﬁŸ   ïiñº
                Call UniCode_Conv(ITEMREC.L_BIKOU, "")                  '           îıçl
                Call UniCode_Conv(ITEMREC.L_KAISHA_CODE, "")            '           âÔé–ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_KISHU1, "")                 '           ã@éÌ(1)
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
                Call UniCode_Conv(ITEMREC.L_KISHU3, "")                 '           ã@éÌ(3)
                Call UniCode_Conv(ITEMREC.L_PAPER, "")                  '           éÜ
                Call UniCode_Conv(ITEMREC.L_PLASTIC, "")                '           ÉvÉâÉXÉ`ÉbÉN
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.L_URIKIN1, "")                '           âøäi(1)
'                Call UniCode_Conv(ITEMREC.L_URIKIN2, "")                '           âøäi(2)
'                Call UniCode_Conv(ITEMREC.L_URIKIN3, "")                '           âøäi(3)
                
                
                                                                '           âøäi(1)
                If IsNumeric(StrConv(PN_MREC.Tanka2, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, Format(Val(StrConv(PN_MREC.Tanka2, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(2)
                If IsNumeric(StrConv(PN_MREC.Tanka3, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, Format(Val(StrConv(PN_MREC.Tanka3, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(3)
                If IsNumeric(StrConv(PN_MREC.Tanka4, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, Format(Val(StrConv(PN_MREC.Tanka4, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, "0000000000")
                End If
                '2010.09.01
                
                
                
                
                Call UniCode_Conv(ITEMREC.L_LABEL, "")                  '           ìKópã@éÌ◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_MAISU, "")                  '           ñáêî◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_KISHU_BIKOU, "")            '           ìKópã@éÌîıçl
                Call UniCode_Conv(ITEMREC.L_SAGYO_SHIJI, "")            '           çÏã∆éwé¶
                Call UniCode_Conv(ITEMREC.L_BIKOU3, "")                 '           îıçlÇR
                Call UniCode_Conv(ITEMREC.L_JGYOBU_CODE, "")            '           éñã∆ïîÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_IRI_QTY, "")                '           ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.L_TANA1, "")                  '           íIî‘(1)
                Call UniCode_Conv(ITEMREC.L_TANA2, "")                  '           íIî‘(2)
                
                
                
'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å§
                
                Call UniCode_Conv(ITEMREC.S_TANTO, "")                  'é˚íPÅ^íSìñé“ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.ZAIKO_F, "")                  'ç›å…ä«óùëŒè€óLñ≥ 1:ëŒè€ 0:ëŒè€äO
    
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
    
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_QTY, "")          '           ëOåéç›å…êîó 
                Call UniCode_Conv(ITEMREC.G_LAST_SYUKA_QTY, "")         '           ç≈èIèoâ◊êî
    
                Call UniCode_Conv(ITEMREC.G_S2_ZAI_QTY, "")             'GLICSç›å…(S2) ë‹à‰óp
                Call UniCode_Conv(ITEMREC.G_P2_ZAI_QTY, "")             'GLICSç›å…(P2) ë‹à‰óp
                    
                '2010.09.01
                Call UniCode_Conv(ITEMREC.K_KEITAI, "")                 'å¬ëïå`ë‘
                Call UniCode_Conv(ITEMREC.K_KEITAI, StrConv(PN_MREC.KKeitai, vbUnicode))
                '2010.09.01
    
    
    

    
'2010.09.01
'                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, "")               '’∆ØƒïîïiãÊï™
'                Call UniCode_Conv(ITEMREC.NAI_BUHIN, "")                'çëì‡ãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.GAI_BUHIN, "")                'äCäOãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.HYO_TANKA, "")                'ïWèÄíPâø   2006.07.28


                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, StrConv(PN_MREC.UnitKbn, vbUnicode))      '’∆ØƒïîïiãÊï™
                Call UniCode_Conv(ITEMREC.NAI_BUHIN, StrConv(PN_MREC.NaiKbn, vbUnicode))        'çëì‡ãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.GAI_BUHIN, StrConv(PN_MREC.GaiKbn, vbUnicode))        'äCäOãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.HYO_TANKA, StrConv(PN_MREC.HyoTan, vbUnicode))        'ïWèÄíPâø   2006.07.28
'2010.09.01
    
    
    
    
    
    
    
    
    
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.LAST_CODE, "")                'ç≈èIédì¸êÊÉRÅ[Éh   2007.05.29
                Call UniCode_Conv(ITEMREC.LAST_TANKA, "")               'ç≈èIédì¸íPâø       2007.05.29
    
                Call UniCode_Conv(ITEMREC.MAKER_CODE, "")               '“∞∂∞∫∞ƒﬁ           2007.06.06
                Call UniCode_Conv(ITEMREC.MAKER_NAME, "")               '“∞∂∞ñºèÃ           2007.06.06
    
    
                Call UniCode_Conv(ITEMREC.L_MARK, "")                   'çƒç´ïÔœ∞∏          2007.11.08
    
                Call UniCode_Conv(ITEMREC.SAI_SU, "")                   'çÀêî               2008.02.14
    
                Call UniCode_Conv(ITEMREC.D_KEISHIKI, "")               'å`éÆ               2008.02.14
                Call UniCode_Conv(ITEMREC.D_MATERIAL, "")               'çﬁéø               2008.02.14
                Call UniCode_Conv(ITEMREC.D_THICKNESS, "")              '¿ﬁ›Œﬁ∞ŸÅ@å˙Ç≥      2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.D_SIZE_W, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiWÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_D, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiDÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_H, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiHÅj   2008.02.14
        
                Call UniCode_Conv(ITEMREC.D_PRINT, "")                  'àÛç¸Ç∑ÇÈÅ^ÇµÇ»Ç¢   2008.02.14
            
        
                Call UniCode_Conv(ITEMREC.S_KOUSU, "")                  'è§ïiâªÅ@çHêî       2008.02.14
        
                Call UniCode_Conv(ITEMREC.S_KOUSU_GENKA, "")            'è§ïiâªÅ@çHêîå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_BAIKA, "")            'è§ïiâªÅ@çHêîîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_SET_DATE, "")         'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
        
    
                Call UniCode_Conv(ITEMREC.S_SHIZAI_GENKA, "")           'è§ïiâªÅ@éëçﬁå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_BAIKA, "")           'è§ïiâªÅ@éëçﬁîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_SET_DATE, "")        'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.SE_USOU_F, "")                'óAëóî†Å@èoóÕÃ◊∏ﬁ   2008.02.14
    
                Call UniCode_Conv(ITEMREC.USE_TAPE_KIND, "")            'égópÉeÅ[ÉvéÌóﬁ     2008.02.14
                Call UniCode_Conv(ITEMREC.USE_TAPE_LNG, "")             'égópÉeÅ[Éví∑       2008.02.14
    
                Call UniCode_Conv(ITEMREC.H_TANA_MAKE, "")              'íIî‘É}Å[ÉN         2008.04.02
    
    
                Call UniCode_Conv(ITEMREC.SE_TANKA_MEMO, "")            'êøãÅíPâøÅ@ÉÅÉÇ     2008.04.15
    
                '2010.07.08 Å§
                'Call UniCode_Conv(ITEMREC.GENSANKOKU, "")              'å¥éYçë             2008.06.11
                Call UniCode_Conv(ITEMREC.xGENSANKOKU, "")              'å¥éYçë
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.GENSANKOKU, "")               'å¥éYçë
                Call UniCode_Conv(ITEMREC.GENSANKOKU, StrConv(PN_MREC.MadeIn, vbUnicode))
                '2010.09.01
                
                
                If Trim(GENSANKOKU) <> "" Or Trim(GEN_GENSANKOKU) <> "" Or Trim(SHIIRE_WORK_CENTER) <> "" Then
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, GEN_GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                Else
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, "")
                End If
                '2010.07.08 Å¢
    
                '2010.09.01
                If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) = "" Then
                    
                    Call UniCode_Conv(K0_Country.CountryCode, StrConv(PN_MREC.MadeInCode, vbUnicode))
                    sts = BTRV(BtOpGetEqual, Country_POS, CountryREC, Len(CountryREC), K0_Country, Len(K0_Country), 0)
                    Select Case sts
                        Case BtNoErr
                            Debug.Print
                        Case BtErrKeyNotFound
                            Call UniCode_Conv(CountryREC.CountryName2, "")
                        Case Else
                    
                            Call File_Error(sts, BtOpGetEqual, "COUNTRY")
                            Exit Function
                    
                    End Select
                
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, StrConv(CountryREC.CountryName2, vbUnicode))
                
                
                End If
                '2010.09.01
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.S_GAISO_TANKA, "")            'äOëïíPâø 9(8)V99   2008.06.12
                Call UniCode_Conv(ITEMREC.S_PPSC_KAKO_KOSU, "")         'PPSCâ¡çHíPâø9(8)   2008.06.12
                Call UniCode_Conv(ITEMREC.S_BU_KAKO_KOSU, "")           'BUâ¡çHíPâø9(8)     2008.06.12
    
    
                Call UniCode_Conv(ITEMREC.SEI_LOT, "")                  'ê∂éYÉçÉbÉg         2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_RATE, "")                 'ï™ÉåÅ[Ég           2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_SYU_KON, "")              'èWçáç´ïÔ           2008.07.07
    
    
                Call UniCode_Conv(ITEMREC.SEI_TANKA_TANTO, "")          'íPâøê›íËíSìñé“     2008.07.09
    
                Call UniCode_Conv(ITEMREC.SHIMUKE_CODE, "")             'édå¸ÇØêÊ           2008.07.09

                Call UniCode_Conv(ITEMREC.SEI_KBN, "")                  'êøãÅãÊï™           2008.07.16

                Call UniCode_Conv(ITEMREC.SEI_LABEL_QTY, "")            'ÉâÉxÉãì\ÇËñáêî     2008.07.19

                Call UniCode_Conv(ITEMREC.SEI_SZI_CNT, "")              'éëçﬁåèêî     Å@    2008.08.20í«â¡
                Call UniCode_Conv(ITEMREC.SEI_DKN_CNT, "")              'ìØç´åèêî           2008.08.20í«â¡
         

'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å¢
                
                
                                
                
                
                
                'Å´2009.02.20
                For i = 0 To 9
                    Call UniCode_Conv(ITEMREC.BEF_KOUTEI(i).BEF_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.MAIN_KOUTEI(i).MAIN_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.AFT_KOUTEI(i).AFT_KOUTEI, "")

                Next i


                Call UniCode_Conv(ITEMREC.SE_IO_TANKA_No, "")
                'Å™2009.02.20
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.STAT, "1")                    'èÛë‘ãÊï™           2009.01.21
    

                sBuffer = Space(255)                                    '2009.01.21
                If GetComputerNameA(sBuffer, 255) <> 0 Then
                    wkTanto = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
                Else
                    wkTanto = "???"
                End If

                
                
                
                Call UniCode_Conv(ITEMREC.INSP_MESSAGE, "")             'åüïi“Øæ∞ºﬁ 2009.08.28
                Call UniCode_Conv(ITEMREC.S_SEIKYU_F, "")               'êøãÅÇe 2009.08.28
                
                Call UniCode_Conv(ITEMREC.BEF_S_KOUSU_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_SHIZAI_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_GAISO_TANKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_PPSC_KAKO_KOSU, "")
                Call UniCode_Conv(ITEMREC.BEF_S_BU_KAKO_KOSU, "")
            
                Call UniCode_Conv(ITEMREC.M_BIKOU, "")
                Call UniCode_Conv(ITEMREC.SHIYOU_NO, "")
                Call UniCode_Conv(ITEMREC.MITSUMORI_KBN, "")
                Call UniCode_Conv(ITEMREC.TANKA_KIRIKAE_DT, "")
                Call UniCode_Conv(ITEMREC.KIRIKAE_KBN, "")
                
                
                
                
                Call UniCode_Conv(ITEMREC.KANKYO_KBN, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, "")
                
                
                If Trim(KANKYO_KBN) <> "" Or Trim(KANKYO_KBN_ST) <> "" Or Trim(KANKYO_KBN_SURYO) <> "" Then
                    
                    If Val(KANKYO_KBN_SURYO) <> 0 Then
                    
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
                
                    End If
            
                End If
                
                
                                                                        'í«â¡íSìñé“
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.INS_TANTO, wkTanto)
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "ysyuk")
                Else
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "yglcs")
                End If
                '2010.09.01
                                                                        
                                                                        'í«â¡ì˙éû
                Call UniCode_Conv(ITEMREC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))


                
                
                
                Call UniCode_Conv(ITEMREC.BEF_L_LABEL, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PLASTIC, "")
    
                
                
                Call UniCode_Conv(ITEMREC.BIKOU20, "")
                
                '2011.07.05
                Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "")
                
                If NOT_Hin_Name_F Then
                    For i = 0 To UBound(NOT_Hin_Name)
                        If InStr(1, RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode)), NOT_Hin_Name(i)) <> 0 Then
                            Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "1")
                            Exit For
                        End If
                    Next i
                End If
                '2011.07.05
                
                Call UniCode_Conv(ITEMREC.FILLER, "")
                                                                        'çXêVíSìñé“
                Call UniCode_Conv(ITEMREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                        'çXêVì˙éû
                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                                
                
                
                
                Exit Do




                
                
'                com = BtOpInsert
'
'                Call UniCode_Conv(ITEMREC.JGYOBU, JGYOBU)   'éñã∆ïî
'                Call UniCode_Conv(ITEMREC.NAIGAI, NAIGAI)   'çëì‡äO
'                Call UniCode_Conv(ITEMREC.HIN_GAI, HIN_GAI) 'ïiî‘ÅiäOïîÅj
'
'                If Mode = In_Mode Then                      'ïiñº
'                    Call UniCode_Conv(ITEMREC.HIN_NAME, HIN_NAME)
'                Else
'                    Call UniCode_Conv(ITEMREC.HIN_NAME, StrConv(New_HS_OUT_SIJREC.HIN_NAME, vbUnicode))
'                End If
'
''                If Mode = Out_Mode Then                      'ïWèÄíIî‘
''                    If Len(Trim(HS_IN_SIJREC.TANABAN1)) = 0 Then
''                        Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
''                        Call UniCode_Conv(ITEMREC.ST_SOKO, "")
''                        Call UniCode_Conv(ITEMREC.ST_RETU, "")
''                        Call UniCode_Conv(ITEMREC.ST_REN, "")
''                        Call UniCode_Conv(ITEMREC.ST_DAN, "")
''                    Else
''                        Call UniCode_Conv(ITEMREC.ST_SET_DT, Format(Now, "YYYYMMDD"))
''                        Call UniCode_Conv(ITEMREC.ST_SOKO, Mid(StrConv(HS_IN_SIJREC.TANABAN1, 1, 2)))
''                        Call UniCode_Conv(ITEMREC.ST_RETU, Mid(StrConv(HS_IN_SIJREC.TANABAN1, 3, 2)))
''                        Call UniCode_Conv(ITEMREC.ST_REN, Mid(StrConv(HS_IN_SIJREC.TANABAN1, 5, 2)))
''                        Call UniCode_Conv(ITEMREC.ST_DAN, Mid(StrConv(HS_IN_SIJREC.TANABAN1, 7, 2)))
''
''                    End If
''                Else
'                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
''2009.01.21 "**" Ç…ïœçX                    Call UniCode_Conv(ITEMREC.ST_SOKO, "")
''                    Call UniCode_Conv(ITEMREC.ST_RETU, "")
''                    Call UniCode_Conv(ITEMREC.ST_REN, "")
''                    Call UniCode_Conv(ITEMREC.ST_DAN, "")
'
'                    Call UniCode_Conv(ITEMREC.ST_SOKO, "**")
'                    Call UniCode_Conv(ITEMREC.ST_RETU, "**")
'                    Call UniCode_Conv(ITEMREC.ST_REN, "**")
'                    Call UniCode_Conv(ITEMREC.ST_DAN, "**")
'
''                End If
'
'                Call UniCode_Conv(ITEMREC.BEF_SOKO, "")
'                Call UniCode_Conv(ITEMREC.BEF_RETU, "")
'                Call UniCode_Conv(ITEMREC.BEF_REN, "")
'                Call UniCode_Conv(ITEMREC.BEF_DAN, "")
'
'                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, "")
'                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, "")
'
'                If Mode = In_Mode Then          'ëŒì‡ïiî‘
'                    Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)
'                Else
'                    Call UniCode_Conv(ITEMREC.HIN_NAI, "")
'                End If
'
'                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, "")           'îıçl ÉzÉXÉgëqå…
'                Call UniCode_Conv(ITEMREC.BIKOU_TANA, "")           'îıçl ÉzÉXÉgíIî‘
''                Call UniCode_Conv(ITEMREC.SIZAI_CD, "")             'éëçﬁÉRÅ[Éh
'                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")      'ï‚è[ì_
'                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")    'åéïΩãœèoâ◊êî
'                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")          'ÉTÉìÉvÉãêî
'                Call UniCode_Conv(ITEMREC.LAST_INP_DT, "")          'ç≈èIì¸â◊ì˙ït
'
''                Call UniCode_Conv(ITEMREC.LOCK_F, "")               'îrëºÉtÉâÉO
''                Call UniCode_Conv(ITEMREC.WEL_ID, "")               'égópéqã@ÇhÇc
''                Call UniCode_Conv(ITEMREC.PRG_ID, "")               'égópíÜÉvÉçÉOÉâÉÄ
'
'                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")          'ç≈èIè∆çáì˙ït
'                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "")         'ç≈èIè∆çáéûç›å…êî
''                Call UniCode_Conv(ITEMREC.MOTO_JIGYOBU, "")         'å≥éñéñã∆ïî
'                Call UniCode_Conv(ITEMREC.BIKOU, "")                'àÛç¸îıçl
'                Call UniCode_Conv(ITEMREC.IRI_QTY, "")              'àÛç¸ì¸ÇËêî
'                Call UniCode_Conv(ITEMREC.JAN_CODE, "")             'JanÉRÅ[Éh
'                Call UniCode_Conv(ITEMREC.HIN_CHANGE, "")           'ïiî‘ì«Ç›ë÷Ç¶
'                Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_ON)      'è§ïiâªóLñ≥
'                Call UniCode_Conv(ITEMREC.PACKING_NO, "")           'å¬ëïî†áÇ
'                Call UniCode_Conv(ITEMREC.GLICS1_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
'                Call UniCode_Conv(ITEMREC.GLICS2_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
'                Call UniCode_Conv(ITEMREC.GLICS3_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
'
'
'
'
'
''*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å§
'                Call UniCode_Conv(ITEMREC.G_SHIIRE_KBN, "")             'ã∆ñ±ä«óùÅ@ édì¸ãÊï™
'                Call UniCode_Conv(ITEMREC.G_HANBAI_KBN, "")             '           îÃîÑãÊï™
'                Call UniCode_Conv(ITEMREC.G_SYUSHI, "")                 '           é˚éxíPà 
'                Call UniCode_Conv(ITEMREC.G_KUMITATE, "")               '           ëgóßêªïi
'                Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")              '           ïWèÄëeóòîÑâøíPâøÅ@9(8)V99
'                Call UniCode_Conv(ITEMREC.G_ST_URITAN_DT, "")           '           ïWèÄëeóòîÑâøê›íËì˙
'                Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "")              '           ïWèÄëeóòå¥âøíPâø  9(8)V99
'                Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, "")           '           ïWèÄëeóòå¥âøê›íËì˙
'
'
'                                                                        '           édì¸êÊèÓïÒ
'                For i = 0 To 2
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).CODE, "")             '∫∞ƒﬁ
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA, "")            'édì¸íPâø
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA_DT, "")         'íPâøê›íËì˙
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LOT, "")              '€Øƒêî
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LEAD_TIME, "")        'ÿ∞ƒﬁ¿≤—
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_DT, "")    'ÿ∞ƒﬁ¿≤—
'                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_QTY, "")   'ÿ∞ƒﬁ¿≤—
'
'                Next i
'
'                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_KIN, "")          '           ëOåéç›å…ã‡äz
'                Call UniCode_Conv(ITEMREC.G_SHIZAI_KBN, "")             '           éëçﬁãÊï™
'                Call UniCode_Conv(ITEMREC.G_LABEL_NON, P_G_LABEL_ON)    '           ÉâÉxÉãì\ït
''*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å¢
'
''*------------------------------------------ 2005.11.15 í«â¡(è§ïi◊ÕﬁŸçÄñ⁄) Å§
'                Call UniCode_Conv(ITEMREC.L_HIN_NAME_E, "")             'è§ïi◊ÕﬁŸ   ïiñº
'                Call UniCode_Conv(ITEMREC.L_BIKOU, "")                  '           îıçl
'                Call UniCode_Conv(ITEMREC.L_KAISHA_CODE, "")            '           âÔé–ÉRÅ[Éh
'                Call UniCode_Conv(ITEMREC.L_KISHU1, "")                 '           ã@éÌ(1)
'                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
'                Call UniCode_Conv(ITEMREC.L_KISHU3, "")                 '           ã@éÌ(3)
'                Call UniCode_Conv(ITEMREC.L_PAPER, "")                  '           éÜ
'                Call UniCode_Conv(ITEMREC.L_PLASTIC, "")                '           ÉvÉâÉXÉ`ÉbÉN
'                Call UniCode_Conv(ITEMREC.L_URIKIN1, "")                '           âøäi(1)
'                Call UniCode_Conv(ITEMREC.L_URIKIN2, "")                '           âøäi(2)
'                Call UniCode_Conv(ITEMREC.L_URIKIN3, "")                '           âøäi(3)
'                Call UniCode_Conv(ITEMREC.L_LABEL, "")                  '           ìKópã@éÌ◊ÕﬁŸ
'                Call UniCode_Conv(ITEMREC.L_MAISU, "")                  '           ñáêî◊ÕﬁŸ
'                Call UniCode_Conv(ITEMREC.L_KISHU_BIKOU, "")            '           ìKópã@éÌîıçl
'                Call UniCode_Conv(ITEMREC.L_SAGYO_SHIJI, "")            '           çÏã∆éwé¶
'                Call UniCode_Conv(ITEMREC.L_BIKOU3, "")                 '           îıçlÇR
'                Call UniCode_Conv(ITEMREC.L_JGYOBU_CODE, "")            '           éñã∆ïîÉRÅ[Éh
'                Call UniCode_Conv(ITEMREC.L_IRI_QTY, "")                '           ì¸ÇËêî
'                Call UniCode_Conv(ITEMREC.L_TANA1, "")                  '           íIî‘(1)
'                Call UniCode_Conv(ITEMREC.L_TANA2, "")                  '           íIî‘(2)
'
'
'
'
'
''*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å§
'
'                Call UniCode_Conv(ITEMREC.S_TANTO, "")                  'é˚íPÅ^íSìñé“ÉRÅ[Éh
'                Call UniCode_Conv(ITEMREC.ZAIKO_F, "")                  'ç›å…ä«óùëŒè€óLñ≥ 1:ëŒè€ 0:ëŒè€äO
'
'                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
'
'                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_QTY, "")          '           ëOåéç›å…êîó 
'                Call UniCode_Conv(ITEMREC.G_LAST_SYUKA_QTY, "")         '           ç≈èIèoâ◊êî
'
'                Call UniCode_Conv(ITEMREC.G_S2_ZAI_QTY, "")             'GLICSç›å…(S2) ë‹à‰óp
'                Call UniCode_Conv(ITEMREC.G_P2_ZAI_QTY, "")             'GLICSç›å…(P2) ë‹à‰óp
'
'                Call UniCode_Conv(ITEMREC.K_KEITAI, "")                 'å¬ëïå`ë‘
'
'
'                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, "")               '’∆ØƒïîïiãÊï™
'                Call UniCode_Conv(ITEMREC.NAI_BUHIN, "")                'çëì‡ãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.GAI_BUHIN, "")                'äCäOãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.HYO_TANKA, "")                'ïWèÄíPâø   2006.07.28
'
'                Call UniCode_Conv(ITEMREC.LAST_CODE, "")                'ç≈èIédì¸êÊÉRÅ[Éh   2007.05.29
'                Call UniCode_Conv(ITEMREC.LAST_TANKA, "")               'ç≈èIédì¸íPâø       2007.05.29
'
'                Call UniCode_Conv(ITEMREC.MAKER_CODE, "")               '“∞∂∞∫∞ƒﬁ           2007.06.06
'                Call UniCode_Conv(ITEMREC.MAKER_NAME, "")               '“∞∂∞ñºèÃ           2007.06.06
'
'
'                Call UniCode_Conv(ITEMREC.L_MARK, "")                   'çƒç´ïÔœ∞∏          2007.11.08
'
'                Call UniCode_Conv(ITEMREC.SAI_SU, "")                   'çÀêî               2008.02.14
'
'                Call UniCode_Conv(ITEMREC.D_KEISHIKI, "")               'å`éÆ               2008.02.14
'                Call UniCode_Conv(ITEMREC.D_MATERIAL, "")               'çﬁéø               2008.02.14
'                Call UniCode_Conv(ITEMREC.D_THICKNESS, "")              '¿ﬁ›Œﬁ∞ŸÅ@å˙Ç≥      2008.02.14
'
'
'                Call UniCode_Conv(ITEMREC.D_SIZE_W, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiWÅj   2008.02.14
'                Call UniCode_Conv(ITEMREC.D_SIZE_D, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiDÅj   2008.02.14
'                Call UniCode_Conv(ITEMREC.D_SIZE_H, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiHÅj   2008.02.14
'
'                Call UniCode_Conv(ITEMREC.D_PRINT, "")                  'àÛç¸Ç∑ÇÈÅ^ÇµÇ»Ç¢   2008.02.14
'
'
'                Call UniCode_Conv(ITEMREC.S_KOUSU, "")                  'è§ïiâªÅ@çHêî       2008.02.14
'
'                Call UniCode_Conv(ITEMREC.S_KOUSU_GENKA, "")            'è§ïiâªÅ@çHêîå¥âø   2008.02.14
'                Call UniCode_Conv(ITEMREC.S_KOUSU_BAIKA, "")            'è§ïiâªÅ@çHêîîÑâø   2008.02.14
'                Call UniCode_Conv(ITEMREC.S_KOUSU_SET_DATE, "")         'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
'
'
'                Call UniCode_Conv(ITEMREC.S_SHIZAI_GENKA, "")           'è§ïiâªÅ@éëçﬁå¥âø   2008.02.14
'                Call UniCode_Conv(ITEMREC.S_SHIZAI_BAIKA, "")           'è§ïiâªÅ@éëçﬁîÑâø   2008.02.14
'                Call UniCode_Conv(ITEMREC.S_SHIZAI_SET_DATE, "")        'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
'
'
'                Call UniCode_Conv(ITEMREC.SE_USOU_F, "")                'óAëóî†Å@èoóÕÃ◊∏ﬁ   2008.02.14
'
'                Call UniCode_Conv(ITEMREC.USE_TAPE_KIND, "")            'égópÉeÅ[ÉvéÌóﬁ     2008.02.14
'                Call UniCode_Conv(ITEMREC.USE_TAPE_LNG, "")             'égópÉeÅ[Éví∑       2008.02.14
'
'                Call UniCode_Conv(ITEMREC.H_TANA_MAKE, "")              'íIî‘É}Å[ÉN         2008.04.02
'
'
'                Call UniCode_Conv(ITEMREC.SE_TANKA_MEMO, "")            'êøãÅíPâøÅ@ÉÅÉÇ     2008.04.15
'
'
'                Call UniCode_Conv(ITEMREC.GENSANKOKU, "")               'å¥éYçë             2008.06.11
'
'
'
'                Call UniCode_Conv(ITEMREC.S_GAISO_TANKA, "")            'äOëïíPâø 9(8)V99   2008.06.12
'                Call UniCode_Conv(ITEMREC.S_PPSC_KAKO_KOSU, "")         'PPSCâ¡çHíPâø9(8)   2008.06.12
'                Call UniCode_Conv(ITEMREC.S_BU_KAKO_KOSU, "")           'BUâ¡çHíPâø9(8)     2008.06.12
'
'
'                Call UniCode_Conv(ITEMREC.SEI_LOT, "")                  'ê∂éYÉçÉbÉg         2008.07.07
'                Call UniCode_Conv(ITEMREC.SEI_RATE, "")                 'ï™ÉåÅ[Ég           2008.07.07
'                Call UniCode_Conv(ITEMREC.SEI_SYU_KON, "")              'èWçáç´ïÔ           2008.07.07
'
'
'                Call UniCode_Conv(ITEMREC.SEI_TANKA_TANTO, "")          'íPâøê›íËíSìñé“     2008.07.09
'
'                Call UniCode_Conv(ITEMREC.SHIMUKE_CODE, "")             'édå¸ÇØêÊ           2008.07.09
'
'                Call UniCode_Conv(ITEMREC.SEI_KBN, "")                  'êøãÅãÊï™           2008.07.16
'
'                Call UniCode_Conv(ITEMREC.SEI_LABEL_QTY, "")            'ÉâÉxÉãì\ÇËñáêî     2008.07.19
'
'                Call UniCode_Conv(ITEMREC.SEI_SZI_CNT, "")              'éëçﬁåèêî     Å@    2008.08.20í«â¡
'                Call UniCode_Conv(ITEMREC.SEI_DKN_CNT, "")              'ìØç´åèêî           2008.08.20í«â¡
'
'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å¢
'
'                'Å´2009.02.20
'                For i = 0 To 9
'                    Call UniCode_Conv(ITEMREC.BEF_KOUTEI(i).BEF_KOUTEI, "")
'                    Call UniCode_Conv(ITEMREC.MAIN_KOUTEI(i).MAIN_KOUTEI, "")
'                    Call UniCode_Conv(ITEMREC.AFT_KOUTEI(i).AFT_KOUTEI, "")
'
'                Next i
'
'
'                Call UniCode_Conv(ITEMREC.SE_IO_TANKA_No, "")
'                'Å™2009.02.20
'
'                Call UniCode_Conv(ITEMREC.STAT, "1")                    'èÛë‘ãÊï™           2009.01.21
'
'
'
'
'''''''''''''''' 2011.07.05  '''''''''''''''''''''''''''''''''''''''''''''
'
'
'                Call UniCode_Conv(ITEMREC.INSP_MESSAGE, "")             'åüïi“Øæ∞ºﬁ 2009.08.28
'                Call UniCode_Conv(ITEMREC.S_SEIKYU_F, "")               'êøãÅÇe 2009.08.28
'
'                Call UniCode_Conv(ITEMREC.BEF_S_KOUSU_BAIKA, "")
'                Call UniCode_Conv(ITEMREC.BEF_S_SHIZAI_BAIKA, "")
'                Call UniCode_Conv(ITEMREC.BEF_S_GAISO_TANKA, "")
'                Call UniCode_Conv(ITEMREC.BEF_S_PPSC_KAKO_KOSU, "")
'                Call UniCode_Conv(ITEMREC.BEF_S_BU_KAKO_KOSU, "")
'
'                Call UniCode_Conv(ITEMREC.M_BIKOU, "")
'                Call UniCode_Conv(ITEMREC.SHIYOU_NO, "")
'                Call UniCode_Conv(ITEMREC.MITSUMORI_KBN, "")
'                Call UniCode_Conv(ITEMREC.TANKA_KIRIKAE_DT, "")
'                Call UniCode_Conv(ITEMREC.KIRIKAE_KBN, "")
'
'
'
'
'                Call UniCode_Conv(ITEMREC.KANKYO_KBN, "")
'                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, "")
'                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, "")
'
'
'                If Trim(KANKYO_KBN) <> "" Or Trim(KANKYO_KBN_ST) <> "" Or Trim(KANKYO_KBN_SURYO) <> "" Then
'
'                    If Val(KANKYO_KBN_SURYO) <> 0 Then
'
'                        Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
'                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
'                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
'
'                    End If
'
'                End If
'
'
'                                                                        'í«â¡íSìñé“
'                '2010.09.01
''                Call UniCode_Conv(ITEMREC.INS_TANTO, wkTanto)
'                If Mode = Out_Mode Then
'                    Call UniCode_Conv(ITEMREC.INS_TANTO, "ysyuk")
'                Else
'                    Call UniCode_Conv(ITEMREC.INS_TANTO, "yglcs")
'                End If
'                '2010.09.01
'
'                                                                        'í«â¡ì˙éû
'                Call UniCode_Conv(ITEMREC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
'
'
'
'
'
'                Call UniCode_Conv(ITEMREC.BEF_L_LABEL, "")
'                Call UniCode_Conv(ITEMREC.BEF_1_L_PAPER, "")
'                Call UniCode_Conv(ITEMREC.BEF_1_L_PLASTIC, "")
'                Call UniCode_Conv(ITEMREC.BEF_2_L_PAPER, "")
'                Call UniCode_Conv(ITEMREC.BEF_2_L_PLASTIC, "")
'                Call UniCode_Conv(ITEMREC.BEF_3_L_PAPER, "")
'                Call UniCode_Conv(ITEMREC.BEF_3_L_PLASTIC, "")
'                Call UniCode_Conv(ITEMREC.BEF_4_L_PAPER, "")
'                Call UniCode_Conv(ITEMREC.BEF_4_L_PLASTIC, "")
'                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PAPER, "")
'                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PLASTIC, "")
'
'
'
'                Call UniCode_Conv(ITEMREC.BIKOU20, "")
'
'                '2011.07.05
'                Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "")
'
'                If NOT_Hin_Name_F Then
'                    For i = 0 To UBound(NOT_Hin_Name)
'                        If InStr(1, RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode)), NOT_Hin_Name(i)) <> 0 Then
'                            Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "1")
'                            Exit For
'                        End If
'                    Next i
'                End If
'                '2011.07.05
'
'
'
'''''''''''''''' 2011.07.05  '''''''''''''''''''''''''''''''''''''''''''''
'
'
'
'
'
'
'
'
'
'''''''''''''''' 2011.07.05  ''''''''''''''''''''''''''''''''''''''''''''' delete
''                sBuffer = Space(255)                                    '2009.01.21
''                If GetComputerNameA(sBuffer, 255) <> 0 Then
''                    wkTanto = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
''                Else
''                    wkTanto = "???"
''                End If
''
''
''                                                                        'í«â¡íSìñé“
''                Call UniCode_Conv(ITEMREC.INS_TANTO, wkTanto)
''                                                                        'í«â¡ì˙éû
''                Call UniCode_Conv(ITEMREC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
'''''''''''''''' 2011.07.05  ''''''''''''''''''''''''''''''''''''''''''''' delete
'
'
'
'
'
'
'
'
'
'
'
'                Call UniCode_Conv(ITEMREC.FILLER, "")
'                                                                        'çXêVíSìñé“
'                Call UniCode_Conv(ITEMREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
'                                                                        'çXêVì˙éû
'                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
'
'
'
'
'
'                Exit Do
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> ç∑Çµë÷Ç¶    2012.07.05
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If


                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
                DoEvents
                Sleep (500)


            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop
    
    Loop_Cnt = 0
    
    Do
        sts = BTRV(com, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
                DoEvents
                Sleep (500)
            
            Case Else
                Call File_Error(sts, com, "ïiñ⁄É}ÉXÉ^", 0)
                Exit Function
        End Select
    Loop
        
    If SHIMUKE_Flg Then
        If com = BtOpInsert Then
            'ç\ê¨É}ÉXÉ^ÇÃí«â¡       2005.12.30
            For i = 0 To UBound(SHIMUKE_T)
            
                If StrConv(ITEMREC.JGYOBU, vbUnicode) = SHIMUKE_T(i).JGYOBU And _
                    StrConv(ITEMREC.NAIGAI, vbUnicode) = SHIMUKE_T(i).NAIGAI Then
                                                                            'édå¸ÇØêÊ∫∞ƒﬁ
                    Call UniCode_Conv(P_COMPO_O_REC.SHIMUKE_CODE, SHIMUKE_T(i).SHIMUKE_CODE)
                                                                            'éñã∆ïî
                    Call UniCode_Conv(P_COMPO_O_REC.JGYOBU, SHIMUKE_T(i).JGYOBU)
                                                                            'çëì‡äO
                    Call UniCode_Conv(P_COMPO_O_REC.NAIGAI, SHIMUKE_T(i).NAIGAI)
                                                                            'ïiî‘
                    Call UniCode_Conv(P_COMPO_O_REC.HIN_GAI, StrConv(ITEMREC.HIN_GAI, vbUnicode))
                                                                            '√ﬁ∞¿ãÊï™
                    Call UniCode_Conv(P_COMPO_O_REC.DATA_KBN, P_HEAD)
                                                                            'í«î‘
                    Call UniCode_Conv(P_COMPO_O_REC.SEQNO, "000")
                                                                            'äÓñ{ÉNÉâÉX
                    Call UniCode_Conv(P_COMPO_O_REC.CLASS_CODE, "")
                                                                            'îıçl
                    Call UniCode_Conv(P_COMPO_O_REC.BIKOU, "")
                    
                    Call UniCode_Conv(P_COMPO_O_REC.FILLER, "")
                                                                            'çXêVíSìñé“
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                            'çXêVì˙éû
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                
                    Loop_Cnt = 0
                    Do
                        sts = BTRV(BtOpInsert, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                        Select Case sts
                            Case BtNoErr, BtErrDuplicates
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    Exit Function
'                                End If
                            
                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    Exit Function
                                End If
                                DoEvents
                                Sleep (500)
                            
                            Case Else
                                Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    Loop
                
                
                End If
            Next i
        
        End If
        
    End If
        
    If HIN_CHANGE <> 0 Then
        LBox_Hin.AddItem JGYOBU & NAIGAI & StrConv(ITEMREC.HIN_GAI, vbUnicode) & BEF_GAI & StrConv(ITEMREC.HIN_NAI, vbUnicode) & BEF_NAI & NAI_CHANGE
    End If

    old_Item_Check_Proc = False

End Function

Sub NG_File_Make_Proc()
'----------------------------------------------------------------------------
'                   àŸèÌèIóπÉtÉ@ÉCÉãèoóÕèàóù
'----------------------------------------------------------------------------
Dim stream  As Integer                       'ÉtÉ@ÉCÉãî‘çÜ
Dim Buf     As String                           'ì«Ç›çûÇ›ÉoÉbÉtÉ@
Dim prog    As String
Dim sBuffer As String * 255
Dim com     As String

Dim NG_FILE As String
Dim c       As String * 128
    
    
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "NG_FILE", "SYS", c) Then
        Beep
        MsgBox "àŸèÌèIóπÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        Unload Me
    End If
    NG_FILE = RTrim(c)
    
    stream = FreeFile
    Open NG_FILE For Append As stream
    prog = StrConv(App.EXEName, vbUpperCase)
    
    Buf = (Date$ & " " & Time$ & " " & com & " " & prog)
    Print #stream, Buf
    Close stream



End Sub

Sub NG_File_Kill_Proc()
'----------------------------------------------------------------------------
'                   àŸèÌèIóπÉtÉ@ÉCÉãçÌèúèàóù
'----------------------------------------------------------------------------
Dim stream  As Integer                       'ÉtÉ@ÉCÉãî‘çÜ
Dim Buf     As String                           'ì«Ç›çûÇ›ÉoÉbÉtÉ@
Dim prog    As String
Dim sBuffer As String * 255
Dim com     As String

Dim NG_FILE As String
Dim c       As String * 128
    
    
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "NG_FILE", "SYS", c) Then
        Beep
        MsgBox "àŸèÌèIóπÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        Unload Me
    End If
    NG_FILE = RTrim(c)
    
    On Error GoTo Err_Proc
    Kill (NG_FILE)

Err_Proc:

End Sub

'Private Function Y_GLICS_PUT_PROC(JGYOBU As String, NAIGAI As String, INS_NOW As String) As Integer
Private Function Y_GLICS_PUT_PROC(JGYOBU As String, NAIGAI As String, INS_NOW As String, _
                                                                        TEXT_NO As String, _
                                                                        JGYOBU_Code As String, _
                                                                        CYOK_KBN As String, _
                                                                        DEN_DT As String, _
                                                                        IO_KBN As String, _
                                                                        PM_KBN As String, _
                                                                        DEN_SYU As String, _
                                                                        DEN_NO As String, _
                                                                        CYU_KBN As String, _
                                                                        HIN_GAI As String, _
                                                                        HIN_NAI As String, _
                                                                        HIN_NAME As String, _
                                                                        YOTEI_QTY As String, _
                                                                        YOSAN_FROM As String, _
                                                                        YOSAN_TO As String, _
                                                                        HOST_SOKO As String, _
                                                                        HOST_TANA As String, _
                                                                        SYUK_CODE As String, _
                                                                        SYUK_NAME As String, _
                                                                        GENSANKOKU As String, GEN_GENSANKOKU As String, SHIIRE_WORK_CENTER As String, KANKYO_KBN As String, KANKYO_KBN_ST As String, KANKYO_KBN_SURYO As String, ID_NO2 As String, AITESAKI_CODE As String, JYUCHU_YMD As String, SHITEI_NOUKI_YMD As String, MOTO_TEXT_NO As String) As Integer
'----------------------------------------------------------------------------
'           è∆çáópì¸â◊ó\íËÉtÉ@ÉCÉãèoóÕèàóù
'           2007.06.15
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim ans     As Integer
        
    
Dim Loop_Cnt        As Integer          '2011.01.15
    
    Y_GLICS_PUT_PROC = True
        
    Call UniCode_Conv(Y_GLICSREC.KAN_KBN, KAN_KBN_FIN)
    Call UniCode_Conv(Y_GLICSREC.DT_SYU, "0")
    Call UniCode_Conv(Y_GLICSREC.JGYOBU, JGYOBU)
    Call UniCode_Conv(Y_GLICSREC.NAIGAI, NAIGAI)
    Call UniCode_Conv(Y_GLICSREC.TEXT_NO, TEXT_NO)


    Call UniCode_Conv(Y_GLICSREC.JGYOBA, "")
    Call UniCode_Conv(Y_GLICSREC.DATA_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.TORI_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.ID_NO, "")
    Call UniCode_Conv(Y_GLICSREC.KAIKEI_JGYOBA, "")
    Call UniCode_Conv(Y_GLICSREC.SHISAN_JGYOBA, "")
    
    Call UniCode_Conv(Y_GLICSREC.HIN_NO, HIN_GAI)
    Call UniCode_Conv(Y_GLICSREC.DEN_NO, DEN_NO)
    
    
    '2008.01.10 É}ÉCÉiÉXÇÃëŒâû
    If YOTEI_QTY >= 0 Then
        Call UniCode_Conv(Y_GLICSREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
    Else
        Call UniCode_Conv(Y_GLICSREC.SURYO, Format(CLng(YOTEI_QTY), "000000"))
    End If
    
    Call UniCode_Conv(Y_GLICSREC.MUKE_CODE, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKO_YMD, DEN_DT)
    Call UniCode_Conv(Y_GLICSREC.TANKA, "")
    Call UniCode_Conv(Y_GLICSREC.ODER_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ITEM_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ODER_NO_R, "")
    Call UniCode_Conv(Y_GLICSREC.KOSO_KEITAI, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKA_YMD, DEN_DT)
    Call UniCode_Conv(Y_GLICSREC.TANABAN1, "")
    Call UniCode_Conv(Y_GLICSREC.TANABAN2, "")
    Call UniCode_Conv(Y_GLICSREC.TANABAN3, "")
    Call UniCode_Conv(Y_GLICSREC.MUKE_NAME, "")
    Call UniCode_Conv(Y_GLICSREC.CYU_KBN, CYU_KBN)
    Call UniCode_Conv(Y_GLICSREC.CYU_KBN_NAME, "")
    Call UniCode_Conv(Y_GLICSREC.ORIGIN1, "")
    Call UniCode_Conv(Y_GLICSREC.ORIGIN2, "")
    Call UniCode_Conv(Y_GLICSREC.BIKOU2, "")
    Call UniCode_Conv(Y_GLICSREC.HAN_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.CHOKU_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.UNIT_ID_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ZAIKO_HIKIATE, "")
    Call UniCode_Conv(Y_GLICSREC.GOKON_KANRI_NO, "")
    Call UniCode_Conv(Y_GLICSREC.JYUCHU_ZAN, "")
    Call UniCode_Conv(Y_GLICSREC.KYOKYU_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.SHOHIN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.S_SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.S_HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.BIKOU1, "")
    Call UniCode_Conv(Y_GLICSREC.CHOHA_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.JYU_HIN_NO, "")
    Call UniCode_Conv(Y_GLICSREC.HIN_NAME, HIN_NAME)
    Call UniCode_Conv(Y_GLICSREC.HIN_CHANGE_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.MODULE_EXCHANGE, "")
    Call UniCode_Conv(Y_GLICSREC.ZAIKO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.ZAN_SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.ZAN_HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.NOUKI_YMD, "")
    Call UniCode_Conv(Y_GLICSREC.SERVICE_KANRI_NO, "")
    Call UniCode_Conv(Y_GLICSREC.KI_HIN_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ENVIRONMENT_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.SS_CODE, "")
    Call UniCode_Conv(Y_GLICSREC.KEPIN_KAIJYO, "")
    
    
    Call UniCode_Conv(Y_GLICSREC.KAN_DT, Format(Now, "YYYYMMDD"))


                        'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
    Call UniCode_Conv(Y_GLICSREC.BEF_NYU_QTY, "00000000")

                        'ó\éZíPà å≥
    Call UniCode_Conv(Y_GLICSREC.YOSAN_FROM, YOSAN_FROM)
                        'ó\éZíPà êÊ
    Call UniCode_Conv(Y_GLICSREC.YOSAN_TO, YOSAN_TO)
                        'ïWèÄíIî‘
    Call UniCode_Conv(Y_GLICSREC.HTANABAN, "")
    Call UniCode_Conv(Y_GLICSREC.HIN_NAI, HIN_NAI)
                        'Hëqå… 2006.10.17
    Call UniCode_Conv(Y_GLICSREC.H_SOKO, HOST_SOKO)

                        'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
    Call UniCode_Conv(Y_GLICSREC.NYU_LIST_OUT, " ")
                        'íºëóãÊï™
    Call UniCode_Conv(Y_GLICSREC.CYOK_KBN, CYOK_KBN)
                        'ì¸èoå…ãÊï™
    Call UniCode_Conv(Y_GLICSREC.IO_KBN, IO_KBN)
                        'ê‘çïãÊï™
    Call UniCode_Conv(Y_GLICSREC.PM_KBN, PM_KBN)
                        'ì`ï[éÌï 
    Call UniCode_Conv(Y_GLICSREC.DEN_SYU, DEN_SYU)
                        'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(Y_GLICSREC.SYUK_CODE, SYUK_CODE)
                        'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(Y_GLICSREC.SYUK_NAME, SYUK_NAME)
                        'ë}ì¸îNåéì˙
    Call UniCode_Conv(Y_GLICSREC.INS_NOW, INS_NOW)
    
    
    '----------------   2010.07.08 Å§
    Call UniCode_Conv(Y_GLICSREC.GENSANKOKU, GENSANKOKU)                    'å¥éYçëñº
    Call UniCode_Conv(Y_GLICSREC.GEN_GENSANKOKU, GEN_GENSANKOKU)            'åªï®ï\é¶å¥éYçëñº
    Call UniCode_Conv(Y_GLICSREC.SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN, KANKYO_KBN)                    'ä¬ã´éÌóﬁãÊï™
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN_ST, KANKYO_KBN_ST)              'ä¬ã´éÌóﬁãÊï™ìKópäJén
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)        'ä¬ã´éÌóﬁãÊï™êîó 
    Call UniCode_Conv(Y_GLICSREC.ID_NO2, ID_NO2)                            'ID_NO
    Call UniCode_Conv(Y_GLICSREC.AITESAKI_CODE, AITESAKI_CODE)              'ëäéËêÊ∫∞ƒﬁ
    Call UniCode_Conv(Y_GLICSREC.JYUCHU_YMD, JYUCHU_YMD)                    'éÛíçîNåéì˙
    Call UniCode_Conv(Y_GLICSREC.SHITEI_NOUKI_YMD, SHITEI_NOUKI_YMD)        'éwíËî[ä˙îNåéì˙
    Call UniCode_Conv(Y_GLICSREC.LIST_OUT_END_F, "")                        'ì¸å…ÿΩƒèoóÕF
    Call UniCode_Conv(Y_GLICSREC.NYUKO_TANABAN, "")                         'ì¸å…íIî‘
    Call UniCode_Conv(Y_GLICSREC.MAEGARI_SURYO, "")                         'ëOéÿëäéEêî
    '----------------   2010.07.08 Å¢
    
    
    
    '2011.03.23 î≠ê∂å≥ÉvÉçÉOÉâÉÄ
    Call UniCode_Conv(Y_GLICSREC.MOTO_PROG_ID, StrConv(App.EXEName, vbUpperCase))
    '2011.03.23 å≥ÉeÉLÉXÉgáÇ
    If Trim(MOTO_TEXT_NO) = "" Then
        Call UniCode_Conv(Y_GLICSREC.MOTO_TEXT_NO, "")
    Else
        Call UniCode_Conv(Y_GLICSREC.MOTO_TEXT_NO, MOTO_TEXT_NO)
    End If
    
    Call UniCode_Conv(Y_GLICSREC.FILLER, "")

    Loop_Cnt = 0

    Do
        sts = BTRV(BtOpInsert, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_GLICSKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
                DoEvents
                Sleep (500)
            
            Case Else
                Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)
                Exit Function
        End Select
    Loop

    Y_GLICS_PUT_PROC = False

End Function

'----------------------------------------------------------------------------
'           è∆çáópì¸â◊ó\íËÉtÉ@ÉCÉãèoóÕèàóù
'           2007.06.15
'----------------------------------------------------------------------------
'Dim sts     As Integer
'Dim ans     As Integer
'
'    Y_GLICS_PUT_PROC = True
'
'    Call UniCode_Conv(Y_GLICSREC.KAN_KBN, KAN_KBN_FIN)
'    Call UniCode_Conv(Y_GLICSREC.DT_SYU, "0")
'    Call UniCode_Conv(Y_GLICSREC.JGYOBU, JGYOBU)
'    Call UniCode_Conv(Y_GLICSREC.NAIGAI, NAIGAI)
'    Call UniCode_Conv(Y_GLICSREC.TEXT_NO, StrConv(New_HS_IN_SIJREC.TEXT_NO, vbUnicode))
'
'
'    Call UniCode_Conv(Y_GLICSREC.JGYOBA, "")
'    Call UniCode_Conv(Y_GLICSREC.DATA_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.TORI_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.ID_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.KAIKEI_JGYOBA, "")
'    Call UniCode_Conv(Y_GLICSREC.SHISAN_JGYOBA, "")
'
'    Call UniCode_Conv(Y_GLICSREC.HIN_NO, StrConv(New_HS_IN_SIJREC.HIN_GAI, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.DEN_NO, StrConv(New_HS_IN_SIJREC.DEN_NO, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.SURYO, Format(CLng(StrConv(New_HS_IN_SIJREC.YOTEI_QTY, vbUnicode)), "0000000"))
'    Call UniCode_Conv(Y_GLICSREC.MUKE_CODE, "")
'    Call UniCode_Conv(Y_GLICSREC.SYUKO_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.SHISAN_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.HOJYO_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.SYUKO_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.TANKA, "")
'    Call UniCode_Conv(Y_GLICSREC.ODER_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.ITEM_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.ODER_NO_R, "")
'    Call UniCode_Conv(Y_GLICSREC.KOSO_KEITAI, "")
'    Call UniCode_Conv(Y_GLICSREC.SYUKA_YMD, StrConv(New_HS_IN_SIJREC.DEN_DT, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.TANABAN1, "")
'    Call UniCode_Conv(Y_GLICSREC.TANABAN2, "")
'    Call UniCode_Conv(Y_GLICSREC.TANABAN3, "")
'    Call UniCode_Conv(Y_GLICSREC.MUKE_NAME, "")
'    Call UniCode_Conv(Y_GLICSREC.CYU_KBN, StrConv(New_HS_IN_SIJREC.CYU_KBN, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.CYU_KBN_NAME, "")
'    Call UniCode_Conv(Y_GLICSREC.ORIGIN1, "")
'    Call UniCode_Conv(Y_GLICSREC.ORIGIN2, "")
'    Call UniCode_Conv(Y_GLICSREC.BIKOU2, "")
'    Call UniCode_Conv(Y_GLICSREC.HAN_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.CHOKU_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.UNIT_ID_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.ZAIKO_HIKIATE, "")
'    Call UniCode_Conv(Y_GLICSREC.GOKON_KANRI_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.JYUCHU_ZAN, "")
'    Call UniCode_Conv(Y_GLICSREC.KYOKYU_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.SHOHIN_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.S_SHISAN_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.S_HOJYO_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.BIKOU1, "")
'    Call UniCode_Conv(Y_GLICSREC.CHOHA_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.JYU_HIN_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.HIN_NAME, StrConv(New_HS_IN_SIJREC.HIN_NAME, vbUnicode))
'    Call UniCode_Conv(Y_GLICSREC.HIN_CHANGE_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.MODULE_EXCHANGE, "")
'    Call UniCode_Conv(Y_GLICSREC.ZAIKO_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.ZAN_SHISAN_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.ZAN_HOJYO_SYUSI, "")
'    Call UniCode_Conv(Y_GLICSREC.NOUKI_YMD, "")
'    Call UniCode_Conv(Y_GLICSREC.SERVICE_KANRI_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.KI_HIN_NO, "")
'    Call UniCode_Conv(Y_GLICSREC.ENVIRONMENT_KBN, "")
'    Call UniCode_Conv(Y_GLICSREC.SS_CODE, "")
'    Call UniCode_Conv(Y_GLICSREC.KEPIN_KAIJYO, "")
'
'
'    Call UniCode_Conv(Y_GLICSREC.KAN_DT, Format(Now, "YYYYMMDD"))
'
'
'                        'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
'    Call UniCode_Conv(Y_GLICSREC.BEF_NYU_QTY, "00000000")
'
'                        'ó\éZíPà å≥
'    Call UniCode_Conv(Y_GLICSREC.YOSAN_FROM, StrConv(New_HS_IN_SIJREC.YOSAN_FROM, vbUnicode))
'                        'ó\éZíPà êÊ
'    Call UniCode_Conv(Y_GLICSREC.YOSAN_TO, StrConv(New_HS_IN_SIJREC.YOSAN_TO, vbUnicode))
'                        'ïWèÄíIî‘
'    Call UniCode_Conv(Y_GLICSREC.HTANABAN, "")
'    Call UniCode_Conv(Y_GLICSREC.HIN_NAI, StrConv(New_HS_IN_SIJREC.HIN_NAI, vbUnicode))
'                        'Hëqå… 2006.10.17
'    Call UniCode_Conv(Y_GLICSREC.H_SOKO, StrConv(New_HS_IN_SIJREC.HOST_SOKO, vbUnicode))

'                        'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
'    Call UniCode_Conv(Y_GLICSREC.NYU_LIST_OUT, " ")
'                        'íºëóãÊï™
'    Call UniCode_Conv(Y_GLICSREC.CYOK_KBN, StrConv(New_HS_IN_SIJREC.CYOK_KBN, vbUnicode))
'                        'ì¸èoå…ãÊï™
'    Call UniCode_Conv(Y_GLICSREC.IO_KBN, StrConv(New_HS_IN_SIJREC.IO_KBN, vbUnicode))
'                        'ê‘çïãÊï™
'    Call UniCode_Conv(Y_GLICSREC.PM_KBN, StrConv(New_HS_IN_SIJREC.PM_KBN, vbUnicode))
'                        'ì`ï[éÌï 
'    Call UniCode_Conv(Y_GLICSREC.DEN_SYU, StrConv(New_HS_IN_SIJREC.DEN_SYU, vbUnicode))
'                        'éxããêÊÅ^èoâ◊êÊ
'    Call UniCode_Conv(Y_GLICSREC.SYUK_CODE, StrConv(New_HS_IN_SIJREC.SYUK_CODE, vbUnicode))
'                        'éxããêÊÅ^èoâ◊êÊñº
'    Call UniCode_Conv(Y_GLICSREC.SYUK_NAME, StrConv(New_HS_IN_SIJREC.SYUK_NAME, vbUnicode))
'                        'ë}ì¸îNåéì˙
'    Call UniCode_Conv(Y_GLICSREC.INS_NOW, INS_NOW)
'
'
'    Call UniCode_Conv(Y_GLICSREC.FILLER, "")
'
'    Do
'        sts = BTRV(BtOpInsert, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
'        Select Case sts
'            Case BtNoErr
'                Exit Do
'            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_GLICSKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
'            Case Else
'                Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'                Exit Function
'        End Select
'    Loop
'
'    Y_GLICS_PUT_PROC = False
'
'
'End Function


