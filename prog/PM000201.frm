VERSION 5.00
Begin VB.Form PM000201 
   Caption         =   "ÉRÅ[ÉhÉ}ÉXÉ^ÉÅÉìÉeÉiÉìÉX"
   ClientHeight    =   10485
   ClientLeft      =   1920
   ClientTop       =   2430
   ClientWidth     =   12540
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   10485
   ScaleWidth      =   12540
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
      Index           =   2
      Left            =   1680
      MaxLength       =   20
      TabIndex        =   3
      Top             =   1680
      Width           =   2535
   End
   Begin VB.ListBox List1 
      Height          =   5340
      Index           =   0
      ItemData        =   "PM000201.frx":0000
      Left            =   240
      List            =   "PM000201.frx":0002
      TabIndex        =   6
      Top             =   3720
      Width           =   12015
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   4
      Left            =   1680
      MaxLength       =   10
      TabIndex        =   5
      Top             =   2880
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   3
      Left            =   1680
      MaxLength       =   10
      TabIndex        =   4
      Top             =   2280
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
      Index           =   1
      Left            =   1680
      MaxLength       =   60
      TabIndex        =   2
      Top             =   1200
      Width           =   7335
   End
   Begin VB.ComboBox Combo1 
      Height          =   360
      Index           =   0
      Left            =   1680
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   0
      Top             =   240
      Width           =   1845
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   0
      Left            =   1680
      MaxLength       =   10
      TabIndex        =   1
      Top             =   720
      Width           =   1335
   End
   Begin VB.CommandButton Command1 
      Caption         =   "èI óπ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   18
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Caption         =   "çÌ èú"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   10
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   9840
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Caption         =   "çX êV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   7
      Top             =   9840
      Width           =   855
   End
   Begin VB.Label lblLIST_OP_NM2 
      Alignment       =   1  'âEëµÇ¶
      Height          =   255
      Left            =   10080
      TabIndex        =   29
      Top             =   3480
      Width           =   1335
   End
   Begin VB.Label lblLIST_OP_NM1 
      Alignment       =   1  'âEëµÇ¶
      Height          =   255
      Left            =   8640
      TabIndex        =   28
      Top             =   3480
      Width           =   1335
   End
   Begin VB.Label Label1 
      Caption         =   "ñºÅ@èÃ"
      Height          =   255
      Index           =   1
      Left            =   1920
      TabIndex        =   27
      Top             =   3480
      Width           =   855
   End
   Begin VB.Label Label1 
      Caption         =   "CODE"
      Height          =   255
      Index           =   0
      Left            =   240
      TabIndex        =   26
      Top             =   3480
      Width           =   855
   End
   Begin VB.Label Label 
      Caption         =   "ó™èÃ"
      Height          =   255
      Index           =   3
      Left            =   960
      TabIndex        =   25
      Top             =   1800
      Width           =   615
   End
   Begin VB.Label lblBikou 
      AutoSize        =   -1  'True
      Height          =   240
      Left            =   4680
      TabIndex        =   24
      Top             =   4440
      Width           =   135
   End
   Begin VB.Label lblOP_NM2 
      Alignment       =   1  'âEëµÇ¶
      Height          =   255
      Left            =   120
      TabIndex        =   23
      Top             =   3000
      Width           =   1335
   End
   Begin VB.Label lblOP_NM1 
      Alignment       =   1  'âEëµÇ¶
      Height          =   255
      Left            =   120
      TabIndex        =   22
      Top             =   2400
      Width           =   1335
   End
   Begin VB.Label Label 
      Caption         =   "ñºèÃ"
      Height          =   255
      Index           =   1
      Left            =   960
      TabIndex        =   21
      Top             =   1320
      Width           =   495
   End
   Begin VB.Label Label 
      Caption         =   "CODE"
      Height          =   255
      Index           =   0
      Left            =   960
      TabIndex        =   20
      Top             =   840
      Width           =   495
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ãÊï™"
      Height          =   255
      Index           =   2
      Left            =   960
      TabIndex        =   19
      Top             =   360
      Width           =   495
   End
End
Attribute VB_Name = "PM000201"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


'ÉeÉLÉXÉgópìYéö
Private Const ptxC_CODE% = 0                '∫∞ƒﬁ
Private Const ptxC_NAME% = 1                'ñºèÃ
Private Const ptxC_RNAME% = 2               'ó™èÃ

Private Const ptxOPTION1% = 3               'µÃﬂºÆ›1
Private Const ptxOPTION2% = 4               'µÃﬂºÆ›2

'ÉRÉìÉ{ópìYéö
Private Const pcmbDATA_KBN% = 0

'ÉäÉXÉgópìYéö
Private Const plstP_CODE% = 0


Private W_Index As Integer


'Private Const LAST_UPDATE_DAY$ = "[PM00020] 2010.12.29 10:00"
Private Const LAST_UPDATE_DAY$ = "[PM00020] 2018.04.09 10:45"


Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------

    PM000201.MousePointer = vbHourglass

    Call Ctrl_Lock(PM000201)


End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------

    Call Ctrl_UnLock(PM000201)


    PM000201.MousePointer = vbDefault

End Sub

Private Function Error_Check_Proc(Mode As Integer) As Integer
'----------------------------------------------------------------------------
'                   ì¸óÕçÄñ⁄ÇÃÉGÉâÅ[É`ÉFÉbÉN
'----------------------------------------------------------------------------
    
    
    Error_Check_Proc = True
    
        
    Select Case Mode
    
        Case ptxC_CODE
    
            If Trim(Text1(Mode).Text) = "" Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(CODE ïKê{ì¸óÕ)"
                Text1(Mode).SetFocus
                Exit Function
            End If
    
    
        Case ptxC_NAME          '2018.04.07
            If Trim(Text1(ptxC_RNAME).Text) = "" Then
                Text1(ptxC_RNAME).Text = Text1(ptxC_NAME).Text
            End If
    
    End Select
        
        
        
        
    Error_Check_Proc = False
    

End Function
Private Function Item_Disp_Proc(CODE As String) As Integer
'----------------------------------------------------------------------------
'                   âÊñ ï\é¶
'----------------------------------------------------------------------------
Dim sts As Integer
Dim i   As Integer

    Item_Disp_Proc = True
    
    '∫∞ƒﬁœΩ¿ì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, Right(Combo1(pcmbDATA_KBN).Text, 2))
    Call UniCode_Conv(K0_P_CODE.C_Code, CODE)
    
    sts = BTRV(BtOpGetEqual, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    Select Case sts
        Case BtNoErr
            '⁄∫∞ƒﬁì‡óeÇÃï\é¶
                                            '∫∞ƒﬁ
            Text1(ptxC_CODE).Text = StrConv(P_CODEREC.C_Code, vbUnicode)
                                            'ñºèÃ
            Text1(ptxC_NAME).Text = StrConv(P_CODEREC.C_NAME, vbUnicode)
                                            'ó™èÃ
            Text1(ptxC_RNAME).Text = StrConv(P_CODEREC.C_RNAME, vbUnicode)
                                            'µÃﬂºÆ›1
            Text1(ptxOPTION1).Text = StrConv(P_CODEREC.OPTION1, vbUnicode)
                                            'µÃﬂºÆ›2
            Text1(ptxOPTION2).Text = StrConv(P_CODEREC.OPTION2, vbUnicode)
        
        Case BtErrKeyNotFound
                                            '∫∞ƒﬁ
'            Text1(ptxC_CODE).Text = ""
                                            'ñºèÃ
            Text1(ptxC_NAME).Text = ""
                                            'ó™èÃ
            Text1(ptxC_RNAME).Text = ""
                                            'µÃﬂºÆ›1
            Text1(ptxOPTION1).Text = ""
                                            'µÃﬂºÆ›2
            Text1(ptxOPTION2).Text = ""
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^")
            Exit Function
    End Select

    Item_Disp_Proc = False

End Function
Private Function List_Disp_Proc() As Integer
'----------------------------------------------------------------------------
'                   ÉäÉXÉgÉ{ÉbÉNÉXï\é¶
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


    List_Disp_Proc = True
    
    List1(plstP_CODE).Clear
    
    '∫∞ƒﬁœΩ¿ì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, Right(Combo1(pcmbDATA_KBN).Text, 2))
    Call UniCode_Conv(K0_P_CODE.C_Code, "")
    
    com = BtOpGetGreaterEqual
    
    
    Do
    
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
            
        Select Case sts
            Case BtNoErr
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        
        End Select

        If StrConv(P_CODEREC.DATA_KBN, vbUnicode) <> Right(Combo1(pcmbDATA_KBN).Text, 2) Then
            Exit Do
        
        End If
        
        List1(plstP_CODE).AddItem StrConv(P_CODEREC.C_Code, vbUnicode) & "   " & _
                                    StrConv(P_CODEREC.C_NAME, vbUnicode) & "  " & _
                                    StrConv(P_CODEREC.OPTION1, vbUnicode) & "  " & _
                                    StrConv(P_CODEREC.OPTION2, vbUnicode)
        com = BtOpGetNext
    
    Loop
        
    DoEvents

    If List1(plstP_CODE).ListCount = 0 Then
        
        W_Index = -1
        Text1(ptxC_CODE).SetFocus
    
    Else
    
        List1(plstP_CODE).SetFocus
        List1(plstP_CODE).ListIndex = 0
            
    End If

    List_Disp_Proc = False

End Function

Private Function Update_Proc() As Integer
'----------------------------------------------------------------------------
'                   ÉRÅ[ÉhÉ}ÉXÉ^èoóÕ
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim ans     As Integer
Dim com     As Integer
Dim i       As Integer

    Update_Proc = True
    
    'ÉRÅ[ÉhÉ}ÉXÉ^Å@ì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, Right(Combo1(pcmbDATA_KBN).Text, 2))
    Call UniCode_Conv(K0_P_CODE.C_Code, Text1(ptxC_CODE).Text)
    
    
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                com = BtOpInsert
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CODE.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Update_Proc = False
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        
        End Select
    
    
    Loop
    '--------------------------------------------------------ÉåÉRÅ[Éhì‡óeï“èW
    
    Call UniCode_Conv(P_CODEREC.DATA_KBN, Right(Combo1(pcmbDATA_KBN).Text, 2))          '√ﬁ∞¿ãÊï™
    Call UniCode_Conv(P_CODEREC.C_Code, Text1(ptxC_CODE).Text)                          'ÉRÅ[Éh
    Call UniCode_Conv(P_CODEREC.C_NAME, Text1(ptxC_NAME).Text)                          'ñºèÃ
    Call UniCode_Conv(P_CODEREC.C_RNAME, Text1(ptxC_RNAME).Text)                        'ó™èÃ
    Call UniCode_Conv(P_CODEREC.OPTION1, Text1(ptxOPTION1).Text)                        'ÉIÉvÉVÉáÉìÇP
    Call UniCode_Conv(P_CODEREC.OPTION2, Text1(ptxOPTION2).Text)                        'ÉIÉvÉVÉáÉìÇQ
    
    
    Call UniCode_Conv(P_CODEREC.UPD_TANTO, "")                                          'çXêVíSìñé“
                                                                                        'çXêVì˙éû
    Call UniCode_Conv(P_CODEREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
    Call UniCode_Conv(P_CODEREC.FILLER, "")                                             'Filler
    
    
    Do
        
        DoEvents
        
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CODE.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    sts = BTRV(BtOpUnlock, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
                    Update_Proc = False
                    Exit Do
                End If
            Case Else
                Call File_Error(sts, com, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        End Select
    Loop
    
    For i = ptxC_CODE To ptxOPTION2
        Text1(i).Text = ""
    Next i


    If List_Disp_Proc() Then
        Exit Function
    End If
    
    List1(plstP_CODE).SetFocus
    If W_Index <> -1 Then
        List1(plstP_CODE).ListIndex = W_Index - 1
    End If
    
    Update_Proc = False


End Function
Private Function Delete_Proc() As Integer
'----------------------------------------------------------------------------
'                   ÉRÅ[ÉhÉ}ÉXÉ^çÌèú
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim ans     As Integer
Dim i       As Integer

    Delete_Proc = True
    
    'ÉRÅ[ÉhÉ}ÉXÉ^Å@ì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, Right(Combo1(pcmbDATA_KBN).Text, 2))
    Call UniCode_Conv(K0_P_CODE.C_Code, Text1(ptxC_CODE).Text)
    
    
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrKeyNotFound
                Delete_Proc = False
                Exit Function
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CODE.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Delete_Proc = False
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        
        End Select
    
    
    Loop
    
    
    Do
        
        DoEvents
        
        sts = BTRV(BtOpDelete, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CODE.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    sts = BTRV(BtOpUnlock, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
                    Delete_Proc = False
                    Exit Do
                End If
            Case Else
                Call File_Error(sts, BtOpDelete, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        End Select
    Loop

    For i = ptxC_CODE To ptxOPTION1
        Text1(i).Text = ""
    Next i




    If List_Disp_Proc() Then
        Exit Function
    End If
    
    If List1(plstP_CODE).ListCount > 0 Then
        List1(plstP_CODE).SetFocus
        If W_Index - 1 > List1(plstP_CODE).ListCount Then
                List1(plstP_CODE).ListIndex = List1(plstP_CODE).ListCount
        Else
                
                List1(plstP_CODE).ListIndex = W_Index - 1
        End If
    Else
        Text1(ptxC_CODE).SetFocus
    End If


    Delete_Proc = False


End Function

Private Sub Combo1_Click(Index As Integer)
Dim i       As Integer      '2018.04.09
                
        
                                    '∫∞ƒﬁç≈ëÂåÖêîê›íË
    Text1(ptxC_CODE).MaxLength = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_Len
                                    'µÃﬂºÆ›1égópóLñ≥
    Text1(ptxOPTION1).Visible = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP1
                                    'µÃﬂºÆ›2égópóLñ≥
    Text1(ptxOPTION2).Visible = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP2
                                    'µÃﬂºÆ›¿≤ƒŸ1
    lblOP_NM1.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM1
                                    'µÃﬂºÆ›¿≤ƒŸ2
    lblOP_NM2.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM2
                                    'îıçl
    lblBikou.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_BIKOU
    
    
                                    'µÃﬂºÆ›¿≤ƒŸ1
    lblLIST_OP_NM1.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM1
                                    'µÃﬂºÆ›¿≤ƒŸ2
    lblLIST_OP_NM2.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM2
    
    
    For i = ptxC_CODE To ptxOPTION2     '2018.04.09
        Text1(i).Text = ""              '2018.04.09
    Next i                              '2018.04.09
    
    
    
    
    If List_Disp_Proc() Then
        Unload Me
    End If
        
    Combo1(Index).SetFocus

End Sub

Private Sub Combo1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    
    If KeyCode = vbKeyReturn Then
                
        
                                        '∫∞ƒﬁç≈ëÂåÖêîê›íË
        Text1(ptxC_CODE).MaxLength = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_Len
                                        'µÃﬂºÆ›1égópóLñ≥
        Text1(ptxOPTION1).Visible = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP1
                                        'µÃﬂºÆ›2égópóLñ≥
        Text1(ptxOPTION2).Visible = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP2
                                        'µÃﬂºÆ›¿≤ƒŸ1
        lblOP_NM1.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM1
                                        'µÃﬂºÆ›¿≤ƒŸ2
        lblOP_NM2.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM2
                                        'îıçl
        lblBikou.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_BIKOU
        
        
                                        'µÃﬂºÆ›¿≤ƒŸ1
        lblLIST_OP_NM1.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM1
                                        'µÃﬂºÆ›¿≤ƒŸ2
        lblLIST_OP_NM2.Caption = P_KBN_TBL(Combo1(pcmbDATA_KBN).ListIndex).KBN_OP_NM2
        
        
        
        If List_Disp_Proc() Then
            Unload Me
        End If
        
        
'        Call Tab_Ctrl(Shift)        'à⁄ìÆ
    End If

End Sub

Private Sub Command1_Click(Index As Integer)

Dim ans As Integer
Dim i   As Integer

    Select Case Index
        Case P_CMD_Upd                      'çXêV
            For i = ptxC_CODE To ptxOPTION2
            
                If Error_Check_Proc(i) Then     'ÉGÉâÅ[É`ÉFÉbÉN
                    Exit Sub
                End If
            
            Next i
            
            Beep
            ans = MsgBox("çXêVÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If ans = vbYes Then
                If Update_Proc() Then
                    Unload Me
                End If
            End If
                    
        
        
        Case P_CMD_DEL                      'çÌèú
            ans = MsgBox("çÌèúÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If ans = vbYes Then
                If Delete_Proc() Then
                    Unload Me
                End If
            End If
        Case P_CMD_DSP                      'åüçı/ï\é¶
        Case P_CMD_OUT                      '√ﬁ∞¿èoóÕ
        Case P_CMD_PRT                      'àÛç¸
        
        Case P_CMD_End                      'èIóπ
            Unload Me
    End Select

End Sub

Private Sub Form_DblClick()
'    PrintForm                  '2018.04.07
End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
'----------------------------------------------------------------------------
'                   ÇjÇÖÇô ÇcÇèÇóÇé ëOèàóù
'----------------------------------------------------------------------------
    Select Case KeyCode
        Case vbKeyF1 To vbKeyF12
            Command1(KeyCode - vbKeyF1).Value = True
    End Select

End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub

Private Sub Form_Load()

Dim c       As String * 128
Dim i       As Integer

'    If App.PrevInstance Then
'        Beep
'        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
'        End
'    End If


    PM000201.Caption = PM000201.Caption & " " & LAST_UPDATE_DAY


'>  2018.04.07

                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
'    If GetIni("FILE", "LOGF", "SYS", c) Then
'        Beep
'        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
'        End
'    End If
    
    
    If GetIni(App.EXEName, "LOGF", App.EXEName, c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
'>  2018.04.07
    
    
    LOG_F = RTrim(c)
                                'ÉRÅ[ÉhÉ}ÉXÉ^ÇnÇoÇdÇm
    If P_CODE_Open(BtOpenNomal) Then
        Unload Me
    End If
   
    Call P_CODE_INI_TBL_Proc    '2018.04.07
    
                                'ãÊï™ê›íË
    Combo1(pcmbDATA_KBN).Clear
    For i = 0 To P_KBN_MAX
        Combo1(pcmbDATA_KBN).AddItem P_KBN_TBL(i).KBN_NM & "            " & P_KBN_TBL(i).KBN_CD
    Next i
                                
                                
                                
    W_Index = -1
    
    Show
    
    Combo1(pcmbDATA_KBN).ListIndex = 0
    
    If List_Disp_Proc() Then
        Unload Me
    End If
    
    Combo1(pcmbDATA_KBN).SetFocus
    
End Sub

Private Sub Form_Unload(CANCEL As Integer)
Dim sts As Integer
    
                                            'ÉRÅ[ÉhÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ÉRÅ[ÉhÉ}ÉXÉ^")
        End If
    End If
    sts = BTRV(BtOpReset, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set PM000201 = Nothing

    End
End Sub

Private Sub List1_DblClick(Index As Integer)

Dim W_KEY   As String

    W_Index = List1(plstP_CODE).ListIndex
    W_KEY = Left(List1(plstP_CODE).List(List1(plstP_CODE).ListIndex), 10)

    
    If Item_Disp_Proc(W_KEY) Then     'ñæç◊ï\é¶
        Unload Me
    End If

End Sub

Private Sub List1_GotFocus(Index As Integer)
    
    If List1(plstP_CODE).ListCount > 0 And _
       List1(plstP_CODE).ListIndex < 0 Then
        List1(plstP_CODE).ListIndex = 0
    End If

End Sub

Private Sub List1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)

Dim W_KEY   As String
    
    If KeyCode <> vbKeyReturn Then
        Exit Sub
    End If

    If Shift = vbShiftMask Then
        Call Tab_Ctrl(Shift)        'à⁄ìÆ
    Else
        W_Index = List1(plstP_CODE).ListIndex
        W_KEY = Left(List1(plstP_CODE).List(List1(plstP_CODE).ListIndex), 10)
    
        
        If Item_Disp_Proc(W_KEY) Then     'ñæç◊ï\é¶
            Unload Me
        End If
    End If

End Sub

Private Sub Text1_GotFocus(Index As Integer)
    
    If Text1(Index).TabStop = True Then
        Text1(Index) = Trim(Text1(Index).Text)
        Text1(Index).SelStart = 0
        Text1(Index).SelLength = Len(Text1(Index).Text)
    End If

End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    
    If KeyCode <> vbKeyReturn Then Exit Sub
        
        
    If Error_Check_Proc(Index) Then     'ÉGÉâÅ[É`ÉFÉbÉN
        Exit Sub
    End If
        
        
    Call Tab_Ctrl(Shift)        'à⁄ìÆ

End Sub

