VERSION 5.00
Begin VB.Form F1020101 
   BackColor       =   &H00FFFFFF&
   BorderStyle     =   5  'â¬ïœ¬∞Ÿ ≥®›ƒﬁ≥
   Caption         =   "ì¸èoâ◊ó\íËÉfÅ[É^éÊçûÇ› '2019/12/13 é†âÍDC é˚éxR8ëŒâû "
   ClientHeight    =   4170
   ClientLeft      =   1920
   ClientTop       =   2280
   ClientWidth     =   8580
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   4170
   ScaleWidth      =   8580
   ShowInTaskbar   =   0   'False
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.ListBox LBox_Hin 
      Height          =   300
      Left            =   1560
      TabIndex        =   25
      Top             =   3840
      Width           =   4455
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   6360
      TabIndex        =   24
      Top             =   3240
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   6360
      TabIndex        =   23
      Top             =   2640
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   6360
      TabIndex        =   22
      Top             =   2040
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   6360
      TabIndex        =   21
      Top             =   1440
      Width           =   1695
   End
   Begin VB.Label lblINCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   6360
      TabIndex        =   20
      Top             =   840
      Width           =   1695
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   5760
      TabIndex        =   19
      Top             =   3240
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   5760
      TabIndex        =   18
      Top             =   2640
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   5760
      TabIndex        =   17
      Top             =   2040
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5760
      TabIndex        =   16
      Top             =   1440
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   5760
      TabIndex        =   15
      Top             =   840
      Width           =   495
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   14
      Top             =   3240
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3960
      TabIndex        =   13
      Top             =   2640
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   3960
      TabIndex        =   12
      Top             =   2040
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   3960
      TabIndex        =   11
      Top             =   1440
      Width           =   1695
   End
   Begin VB.Label lblOUTCNT 
      Alignment       =   1  'âEëµÇ¶
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   3960
      TabIndex        =   10
      Top             =   840
      Width           =   1695
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3360
      TabIndex        =   9
      Top             =   3240
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3360
      TabIndex        =   8
      Top             =   2640
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   3360
      TabIndex        =   7
      Top             =   2040
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   3360
      TabIndex        =   6
      Top             =   1440
      Width           =   495
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000005&
      Caption         =   "ÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   3360
      TabIndex        =   5
      Top             =   840
      Width           =   495
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   960
      TabIndex        =   4
      Top             =   3240
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   960
      TabIndex        =   3
      Top             =   2640
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   960
      TabIndex        =   2
      Top             =   2040
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   1
      Top             =   1440
      Width           =   2295
   End
   Begin VB.Label lblJGYOBU 
      BackColor       =   &H80000005&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   960
      TabIndex        =   0
      Top             =   840
      Width           =   2295
   End
End
Attribute VB_Name = "F1020101"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private WS_NO       As String               '‹∞∏Ω√∞ºÆ›î‘çÜ

Private FileName    As String               'ÉeÉLÉXÉgÉtÉ@ÉCÉãñº
Private FileNo      As Integer              'ÉtÉ@ÉCÉãáÇ


Private ER_IN_FileName As String            '¥◊∞Å@ÉeÉLÉXÉgÉtÉ@ÉCÉãñº    2015.11.19
Private ER_IN_FileNo   As Integer           '¥◊∞Å@ÉtÉ@ÉCÉãáÇ            2015.11.19
Private ER_OUT_FileName As String           '¥◊∞Å@ÉeÉLÉXÉgÉtÉ@ÉCÉãñº    2015.11.19
Private ER_OUT_FileNo   As Integer          '¥◊∞Å@ÉtÉ@ÉCÉãáÇ            2015.11.19

Private TP_IN_FileName As String            '¥◊∞Å@ÉeÉLÉXÉgÉtÉ@ÉCÉãñº    2015.11.19
Private TP_IN_FileNo   As Integer           '¥◊∞Å@ÉtÉ@ÉCÉãáÇ            2015.11.19
Private TP_OUT_FileName As String           '¥◊∞Å@ÉeÉLÉXÉgÉtÉ@ÉCÉãñº    2015.11.19
Private TP_OUT_FileNo   As Integer          '¥◊∞Å@ÉtÉ@ÉCÉãáÇ            2015.11.19


Private KASO_NYUKA_SOKO      As String * 2  'âºëzì¸â◊ëqå…î‘çÜ
Private KASO_SMODOSHI_SOKO   As String * 2  'âºëzéxããñﬂÇµëqå…î‘çÜ

Private Proc_F      As Integer              'ïiî‘Åïç›å…óLñ≥Å@îªíËÉtÉâÉO
Private Last_Proc_F As Integer              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉO
                                            
Private Type YUKO_SOKO_TBL                  'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÉeÅ[ÉuÉã
    HS_SOKO             As String * 3
    NAIGAI              As String * 1
End Type

Dim Soko_T()            As YUKO_SOKO_TBL  'ëqå…èÓïÒ

'-                                          2005.12.30
Private Type SHIMUKE_TBL
    SHIMUKE_CODE            As String * 2   'édå¸ÇØêÊ
    JGYOBU                  As String * 1   'éñã∆ïî
    NAIGAI                  As String * 1   'çëì‡äO
End Type

Private SHIMUKE_T()         As SHIMUKE_TBL

Private SHIMUKE_Flg         As Boolean

'-                                          2005.12.30


Private HS_IN_SIJ   As String               'ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñº
Private HS_OUT_SIJ  As String               'èoå…ÉfÅ[É^ÉtÉ@ÉCÉãñº
Private New_HS_OUT_SIJ  As String           'êV⁄≤±≥ƒèoå…ÉfÅ[É^ÉtÉ@ÉCÉãñº2006.05.23


Private In_Cnt      As Integer              'ÉfÅ[É^ì«Ç›çûÇ›åèêî
Private Out_Cnt     As Integer              'ÉfÅ[É^èoóÕåèêî

Private Const In_Mode% = 1                  'ì¸â◊èàóù
Private Const Out_Mode% = 2                 'èoâ◊èàóù

                                            
Dim NormalFont As New StdFont               'àÛç¸ÉtÉHÉìÉg

Private Const LMAX% = 46                    'ï≈ì‡ç≈ëÂçsêî
Private Const MGN_L% = 1                    'ñæç◊àÛç¸äJénåÖà íuÅiÇPÇ©ÇÁÅj
Private Const MGN_U% = 1                    'è„ó]îíÅiçsêîÅFÇPÇ©ÇÁÅj
Private Pdate As String                     'àÛç¸äJénì˙ïtÅiÕØ¿ﬁ∞ópÅj
Private Ptime As String                     'àÛç¸äJénéûçèÅiÕØ¿ﬁ∞ópÅj


Private Const NAI_CHANGE% = 1
Private Const GAI_CHANGE% = 2
Private Const NOT_GAI_CHANGE% = 3


Private ETC_MTS_NAI As String * 8             'ÇªÇÃëºå¸ÇØêÊ(çëì‡)
Private ETC_SS_NAI  As String * 8             'ÇªÇÃëºíºëóêÊ(çëì‡)

Private ETC_MTS_GAI As String * 8             'ÇªÇÃëºå¸ÇØêÊ(äCäO)
Private ETC_SS_GAI  As String * 8             'ÇªÇÃëºíºëóêÊ(äCäO)

Dim DUP_SYUKA_DATA  As String                 'èoâ◊ÉfÅ[É^ÉtÉãÉpÉX


                                        
Dim MyCenter        As String

Private MENU_NO     As String * 2       'é¿ê—ÉçÉOèoóÕóp“∆≠∞áÇ   2007.11.06

Dim Err_FLg         As Boolean          '2008.10.07

Dim TANA_SPACE      As Boolean          '2009.03.07

Dim KAMOKU_FURIKAE      As String * 2       'â»ñ⁄êUë÷óvàˆ 2009.06.26

'2010.07.20 Å§
'Private Const GENSANKOKU_ON% = 1
'Private Const GENSANKOKU_OFF% = 0
'2010.07.20 Å¢


'è§ïiâªåvâÊéxâá 2011.07.07
Dim NOT_Hin_Name    As Variant          'èúäOïiñº
Dim NOT_Hin_Name_F  As Boolean          'èúäOïiñºóLñ≥
'è§ïiâªåvâÊéxâá 2011.07.07


Dim GOODS_F         As String * 1       'è§ïiâªóLñ≥Å@√ﬁÃ´Ÿƒ 2012.12.20




Dim GENSAN_T()      As String * 1       'å¥éYçëçXêVóLñ≥ 2016.12.28


'Private Const Last_Update_Day$ = "[F102010] 2019.03.06 11:55"
'Private Const Last_Update_Day$ = "[F102010] 2019.04.15 09:30"
Private Const Last_Update_Day$ = "[F102010] 2019.12.13 17:00 ÉGÉAÉRÉì é˚éxR8éÊçûëŒâû"






Private Function Nyuka_Update_Proc(JGYOBU As String) As Boolean
'----------------------------------------------------------------------------
'                   Åuì¸â◊ó\íËÉfÅ[É^ÅvçXêVèàóù
'----------------------------------------------------------------------------
Dim i           As Integer
Dim j           As Integer
Dim Skip_Flg    As Boolean
    
Dim WK_Y_QTY    As Long     'èoâ◊êîÉèÅ[ÉN
Dim WK_Qty      As Long     'ëOéÿécÉèÅ[ÉN
Dim WK_E_QTY    As Long     'êÊçsèoâ◊êîÉèÅ[ÉN

Dim SUMI_QTY    As Long     'è§ïiâªçœÇ›Ç∆ÇµÇƒìoò^
Dim MI_QTY      As Long     'ñ¢è§ïiÇ∆ÇµÇƒìoò^



Dim WORK_SOKO   As String * 2
    
Dim sts         As Integer
Dim ans         As Integer
Dim Not_SHUSI   As Boolean
    
Dim wkText      As String
Dim Length      As Integer
    
    
Dim NAIGAI      As String * 1   '2007.06.15
    
    
Dim TEXT_NO     As String * 9           '√∑ΩƒáÇ
Dim JGYOBU_Code As String * 1           'éñã∆ïîãÊï™
Dim CYOK_KBN    As String * 1           'íºëóãÊï™
Dim DEN_DT      As String * 8           'ì`ï[ì˙ït
Dim IO_KBN      As String * 1           'ì¸èoå…ãÊï™
Dim PM_KBN      As String * 1           'ê‘çïãÊï™
Dim DEN_SYU     As String * 1           'ì`ï[éÌï 
Dim DEN_NO      As String * 6           'ì`ï[áÇ
Dim CYU_KBN     As String * 1           'íçï∂ãÊï™
'Dim HIN_GAI     As String * 13          'ïiî‘ÅiäOïîÅj  '2016.04.26
'Dim HIN_NAI     As String * 13          'ïiî‘Åiì‡ïîÅj  '2016.04.26
Dim HIN_GAI     As String * 20          'ïiî‘ÅiäOïîÅj   '2016.04.26
Dim HIN_NAI     As String * 20          'ïiî‘Åiì‡ïîÅj   '2016.04.26
Dim HIN_NAME    As String * 25          'ïiñº
Dim YOTEI_QTY   As String * 6           'êîó 
Dim YOSAN_FROM  As String * 5           'ó\éZíPà Åiå≥Åj
Dim YOSAN_TO    As String * 5           'ó\éZíPà ÅiêÊÅj
Dim HOST_SOKO   As String * 8           'ëqå…ãÊï™ÅiŒΩƒÅj
Dim HOST_TANA   As String * 8           'íIî‘ÅiŒΩƒÅj
Dim SYUK_CODE   As String * 5           'éxããêÊÅ^èoâ◊êÊ
Dim SYUK_NAME   As String * 20          'éxããêÊÅ^èoâ◊êÊñº
Dim REC_END     As String * 1           '⁄∫∞ƒﬁèIí[œ∞∏(@)
    
    
    
Dim GENSANKOKU          As String * 20  'å¥éYçëñº
Dim GEN_GENSANKOKU      As String * 20  'åªï®ï\é¶å¥éYçëñº
Dim SHIIRE_WORK_CENTER  As String * 8   'éëçﬁédì¸êÊ‹∞∏æ›¿∞
Dim KANKYO_KBN          As String * 3   'ä¬ã´éÌóﬁãÊï™
Dim KANKYO_KBN_ST       As String * 8   'ä¬ã´éÌóﬁãÊï™ìKópäJén
Dim KANKYO_KBN_SURYO    As String * 10  'ä¬ã´éÌóﬁãÊï™êîó 
Dim ID_NO2              As String * 12  'ID_NO
Dim AITESAKI_CODE       As String * 16  'ëäéËêÊ∫∞ƒﬁ
Dim JYUCHU_YMD          As String * 8   'éÛíçîNåéì˙
Dim SHITEI_NOUKI_YMD    As String * 8   'éwíËî[ä˙îNåéì˙
    
    
    
    
Dim GENSANKOKU_CHG_F    As Boolean      'å¥éYçëïœçXF
    
    
'èoâ◊ó\íË ï“èWëOèàóù ################################################################# 2005/05/16 Add Å´
Dim Fast_Flg        As Boolean
Dim DUP_SYUKANo     As Integer
Dim FileName        As String
Dim Ret             As Integer
Dim INS_NOW         As String * 14
Dim wkStr           As String
    
Dim wkMUKE_CODE     As String
    
'2010.11.01
Dim DUP_FLG         As Boolean

'2011.01.19
Dim Loop_Cnt        As Integer


'2011.03.23
Dim MOTO_TEXT_NO    As String * 9

    
Dim Rec_LENG        As Long         '2016.04.19
    
    
Dim MAEGARI_FLG     As Boolean      '2018.11.16
    
    
    Fast_Flg = True

    DUP_SYUKANo = FreeFile
    FileName = DUP_SYUKA_DATA

    Ret = InStr(1, Trim(FileName), ".") - 1
    FileName = Left(Trim(FileName), Ret) & Format(Now, "YYYYMMDDHHMMSS") & "_" & Last_JGYOBU & Right(Trim(FileName), Len(Trim(FileName)) - Ret)

    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")
'#################################################################################### 2005/05/16 Add Å™
    
    Nyuka_Update_Proc = True


    Do Until EOF(FileNo)
        Line Input #FileNo, wkText
    
    
    
    
    
'        If LenB(StrConv(wkText, vbFromUnicode)) <> 138 And LenB(StrConv(wkText, vbFromUnicode)) <> 251 Then    '2016.04.26
        If LenB(StrConv(wkText, vbFromUnicode)) <> 138 And LenB(StrConv(wkText, vbFromUnicode)) <> 265 Then     '2016.04.26
            
'            Call NG_File_Make_Proc
             Err_FLg = True
           
    Call LOG_OUT(LOG_F, wkText)
            Exit Do
        End If
    
    
        Rec_LENG = LenB(StrConv(wkText, vbFromUnicode)) '2016.04.19
    
    
    
        In_Cnt = In_Cnt + 1
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents
    
    
    
    
        MAEGARI_FLG = False     '2018.11.16
    
                                                                    '√∑ΩƒáÇ
        Length = 1
        TEXT_NO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(TEXT_NO)), vbUnicode)
                                                                    'éñã∆ïîãÊï™
        Length = Length + Len(TEXT_NO)
        JGYOBU_Code = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(JGYOBU_Code)), vbUnicode)
                                                                    'íºëóãÊï™
        Length = Length + Len(JGYOBU_Code)
        CYOK_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(CYOK_KBN)), vbUnicode)
                                                                    'ì`ï[ì˙ït
        Length = Length + Len(CYOK_KBN)
        DEN_DT = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_DT)), vbUnicode)
                                                                    'ì¸èoå…ãÊï™
        Length = Length + Len(DEN_DT)
        IO_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(IO_KBN)), vbUnicode)
                                                                    'ê‘çïãÊï™
        Length = Length + Len(IO_KBN)
        PM_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(PM_KBN)), vbUnicode)
                                                                    'ì`ï[éÌï 
        Length = Length + Len(PM_KBN)
        DEN_SYU = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_SYU)), vbUnicode)
                                                                    'ì`ï[áÇ
        Length = Length + Len(DEN_SYU)
        DEN_NO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(DEN_NO)), vbUnicode)
                                                                    'íçï∂ãÊï™
        Length = Length + Len(DEN_NO)
        CYU_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(CYU_KBN)), vbUnicode)
                                                                    'ïiî‘ÅiäOïîÅj
        Length = Length + Len(CYU_KBN)
        HIN_GAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_GAI)), vbUnicode)
                                                                    'ïiî‘Åiì‡ïîÅj
        Length = Length + Len(HIN_GAI)
        HIN_NAI = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_NAI)), vbUnicode)
                                                                    'ïiñº
        Length = Length + Len(HIN_NAI)
        HIN_NAME = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_NAME)), vbUnicode)
                                                                    'êîó 
        Length = Length + Len(HIN_NAME)
        YOTEI_QTY = Trim(StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOTEI_QTY)), vbUnicode))
                                                                    'ó\éZíPà Åiå≥Åj
        Length = Length + Len(YOTEI_QTY)
        YOSAN_FROM = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOSAN_FROM)), vbUnicode)
                                                                    'ó\éZíPà ÅiêÊÅj
        Length = Length + Len(YOSAN_FROM)
        YOSAN_TO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(YOSAN_TO)), vbUnicode)
                                                                    'ëqå…ãÊï™ÅiŒΩƒÅj
        Length = Length + Len(YOSAN_TO)
        HOST_SOKO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HOST_SOKO)), vbUnicode)
                                                                    'íIî‘ÅiŒΩƒÅj
        Length = Length + Len(HOST_SOKO)
        HOST_TANA = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HOST_TANA)), vbUnicode)
                                                                    'éxããêÊÅ^èoâ◊êÊ
        Length = Length + Len(HOST_TANA)
        SYUK_CODE = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SYUK_CODE)), vbUnicode)
                                                                    'éxããêÊÅ^èoâ◊êÊñº
        Length = Length + Len(SYUK_CODE)
        SYUK_NAME = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SYUK_NAME)), vbUnicode)
    
    
'        If LenB(StrConv(wkText, vbFromUnicode)) = 251 Then     '2016.04.26
        If LenB(StrConv(wkText, vbFromUnicode)) = 265 Then      '2016.04.26
                                                                    'å¥éYçë
            Length = Length + Len(SYUK_NAME)
            GENSANKOKU = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(GENSANKOKU)), vbUnicode)
                                                                    'åªï®ï\é¶å¥éYçëñº
            Length = Length + Len(GENSANKOKU)
            GEN_GENSANKOKU = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(GEN_GENSANKOKU)), vbUnicode)
                                                                    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
            Length = Length + Len(GEN_GENSANKOKU)
            SHIIRE_WORK_CENTER = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SHIIRE_WORK_CENTER)), vbUnicode)
                                                                    'ä¬ã´éÌóﬁãÊï™
            Length = Length + Len(SHIIRE_WORK_CENTER)
            KANKYO_KBN = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(KANKYO_KBN)), vbUnicode)
                                                                    'ä¬ã´éÌóﬁãÊï™ìKópäJén
            Length = Length + Len(KANKYO_KBN)
            KANKYO_KBN_ST = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(KANKYO_KBN_ST)), vbUnicode)
                                                                    'ä¬ã´éÌóﬁãÊï™êîó 
            Length = Length + Len(KANKYO_KBN_ST)
            KANKYO_KBN_SURYO = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(KANKYO_KBN_SURYO)), vbUnicode)
                                                                    'ID_NO
            Length = Length + Len(KANKYO_KBN_SURYO)
            ID_NO2 = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(ID_NO2)), vbUnicode)
                                                                    'ëäéËêÊ
            Length = Length + Len(ID_NO2)
            AITESAKI_CODE = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(AITESAKI_CODE)), vbUnicode)
                                                                    'éÛíçîNåéì˙
            Length = Length + Len(AITESAKI_CODE)
            JYUCHU_YMD = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(JYUCHU_YMD)), vbUnicode)
                                                                    'éwíËî[ä˙îNåéì˙
            Length = Length + Len(JYUCHU_YMD)
            SHITEI_NOUKI_YMD = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(SHITEI_NOUKI_YMD)), vbUnicode)
        
        
        
        Else
            
            GENSANKOKU = ""             'å¥éYçëñº
            GEN_GENSANKOKU = ""         'åªï®ï\é¶å¥éYçëñº
            SHIIRE_WORK_CENTER = ""     'éëçﬁédì¸êÊ‹∞∏æ›¿∞
            KANKYO_KBN = ""             'ä¬ã´éÌóﬁãÊï™
            KANKYO_KBN_ST = ""          'ä¬ã´éÌóﬁãÊï™ìKópäJén
            KANKYO_KBN_SURYO = ""       'ä¬ã´éÌóﬁãÊï™êîó 
            ID_NO2 = ""                 'ID_NO
            AITESAKI_CODE = ""          'ëäéËêÊ∫∞ƒﬁ
            JYUCHU_YMD = ""             'éÛíçîNåéì˙
            SHITEI_NOUKI_YMD = ""       'éwíËî[ä˙îNåéì˙
        End If
'        Length = 1
'        TEXT_NO = Mid(wkText, Length, Len(TEXT_NO))                 '√∑ΩƒáÇ
        
'        Length = Length + Len(TEXT_NO)
'        JGYOBU_Code = Mid(wkText, Length, Len(JGYOBU_Code))         'éñã∆ïîãÊï™
    
'        Length = Length + Len(JGYOBU_Code)
'        CYOK_KBN = Mid(wkText, Length, Len(CYOK_KBN))               'íºëóãÊï™
    
'        Length = Length + Len(CYOK_KBN)
'        DEN_DT = Mid(wkText, Length, Len(DEN_DT))                   'ì`ï[ì˙ït
    
'        Length = Length + Len(DEN_DT)
'        IO_KBN = Mid(wkText, Length, Len(IO_KBN))                   'ì¸èoå…ãÊï™
    
'        Length = Length + Len(IO_KBN)
'        PM_KBN = Mid(wkText, Length, Len(PM_KBN))                   'ê‘çïãÊï™
    
'        Length = Length + Len(PM_KBN)
'        DEN_SYU = Mid(wkText, Length, Len(DEN_SYU))                 'ì`ï[éÌï 
    
'        Length = Length + Len(DEN_SYU)
'        DEN_NO = Mid(wkText, Length, Len(DEN_NO))                   'ì`ï[áÇ
    
'        Length = Length + Len(DEN_NO)
'        CYU_KBN = Mid(wkText, Length, Len(CYU_KBN))                 'íçï∂ãÊï™
    
'        Length = Length + Len(CYU_KBN)
'        HIN_GAI = Mid(wkText, Length, Len(HIN_GAI))                 'ïiî‘ÅiäOïîÅj
    
'        Length = Length + Len(HIN_GAI)
'        HIN_NAI = Mid(wkText, Length, Len(HIN_NAI))                 'ïiî‘Åiì‡ïîÅj
    
'        Length = Length + Len(HIN_NAI)
'        HIN_NAME = StrConv(MidB(StrConv(wkText, vbFromUnicode), Length, Len(HIN_NAME)), vbUnicode)             'ïiñº
    
'        Length = Length + Len(HIN_NAME)
'        YOTEI_QTY = Trim(Mid(wkText, Length, Len(YOTEI_QTY)))       'êîó 
    
'        Length = Length + Len(YOTEI_QTY)
'        YOSAN_FROM = Mid(wkText, Length, Len(YOSAN_FROM))           'ó\éZíPà Åiå≥Åj
    
'        Length = Length + Len(YOSAN_FROM)
'        YOSAN_TO = Mid(wkText, Length, Len(YOSAN_TO))               'ó\éZíPà ÅiêÊÅj
    
'        Length = Length + Len(YOSAN_TO)
'        HOST_SOKO = Mid(wkText, Length, Len(HOST_SOKO))             'ëqå…ãÊï™ÅiŒΩƒÅj
    
'        Length = Length + Len(HOST_SOKO)
'        HOST_TANA = Mid(wkText, Length, Len(HOST_TANA))             'íIî‘ÅiŒΩƒÅj
        
'        Length = Length + Len(HOST_TANA)
'        SYUK_CODE = Mid(wkText, Length, Len(SYUK_CODE))             'éxããêÊÅ^èoâ◊êÊ
        
'        Length = Length + Len(SYUK_CODE)
'        SYUK_NAME = Mid(wkText, Length, Len(SYUK_NAME))             'éxããêÊÅ^èoâ◊êÊñº
    
    
    
    
    
    
        Skip_Flg = True
        Not_SHUSI = False
        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
            If JGYOBU = JGYOBU_T(i).CODE Then
                For j = 0 To UBound(Soko_T, 2)
                    If Trim(HOST_SOKO) = Trim(Soko_T(i, j).HS_SOKO) Then
                        Skip_Flg = False
                        Exit For
                    End If
                Next j
                Exit For
            End If
        Next i
    
        If Skip_Flg Then
            Not_SHUSI = True
        End If
    
    
    
    
    
    
    
    
'-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
        'è∆çáópì¸â◊ó\íËèdï°É`ÉFÉbÉN
        Call UniCode_Conv(K0_Y_GLICS.JGYOBU, JGYOBU)
        Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, DEN_DT)
        Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, TEXT_NO)
        
'2010.11.01
        DUP_FLG = False
'2010.11.01
        
        
        sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
        Select Case sts
            Case BtNoErr
                Call LOG_OUT(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
'2010.11.01
                DUP_FLG = True
'2010.11.01
            
            Case BtErrKeyNotFound
            Case Else
                'Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË", 0)                '2016.06.23
                Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË", 1, Y_GLICS_ID)     '2016.06.23
'                Exit Function      '2015.11.19
                GoTo Abort_Tran     '2015.11.19
        End Select



''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' î≠ê∂å≥Ç…ÇÊÇÈÉfÅ[É^ämîF  2011.03.23
        MOTO_TEXT_NO = ""
        
        If DUP_FLG Then
            If StrConv(App.EXEName, vbUpperCase) = Trim(StrConv(Y_GLICSREC.MOTO_PROG_ID, vbUnicode)) Then
            Else
                If Trim(TEXT_NO) = Trim(StrConv(Y_GLICSREC.MOTO_TEXT_NO, vbUnicode)) Then
                Else
                    MOTO_TEXT_NO = TEXT_NO
                    Mid(TEXT_NO, 5, 1) = "A"
                    DUP_FLG = False
                End If
            
            End If
        End If
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' î≠ê∂å≥Ç…ÇÊÇÈÉfÅ[É^ämîF  2011.03.23

















        If Not_SHUSI Then
            NAIGAI = "1"
        Else
            NAIGAI = Soko_T(i, j).NAIGAI
        End If

'        If sts = BtErrKeyNotFound Then
        If Not DUP_FLG Then

'            If Y_GLICS_PUT_PROC(JGYOBU, NAIGAI, INS_NOW, _
'                                TEXT_NO, _
'                                JGYOBU_Code, _
'                                CYOK_KBN, _
'                                DEN_DT, _
'                                IO_KBN, _
'                                PM_KBN, _
'                                DEN_SYU, _
'                                DEN_NO, _
'                                CYU_KBN, _
'                                HIN_GAI, _
'                                HIN_NAI, _
'                                HIN_NAME, _
'                                YOTEI_QTY, _
'                                YOSAN_FROM, _
'                                YOSAN_TO, _
'                                HOST_SOKO, _
'                                HOST_TANA, _
'                                SYUK_CODE, _
'                                SYUK_NAME) Then
                
                
                
    '2010.07.20 Å§
            If Trim(GENSANKOKU) <> "" Or Trim(GEN_GENSANKOKU) <> "" Or Trim(SHIIRE_WORK_CENTER) <> "" Then
                If Item_Check_Proc(In_Mode, JGYOBU, "1", HIN_GAI, HIN_NAI, HIN_NAME, GENSANKOKU, GEN_GENSANKOKU, SHIIRE_WORK_CENTER, KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO) Then
'                    GoTo Abort_Tran
'                    Exit Function      '2015.11.19
                    GoTo Abort_Tran     '2015.11.19
                End If
            End If
    '2010.07.20 Å¢
                

                
                
'''''''''''''''''''''2011.03.23 à¯êîí«â¡
'            If Y_GLICS_PUT_PROC(JGYOBU, NAIGAI, INS_NOW, _
'                                TEXT_NO, _
'                                JGYOBU_Code, _
'                                CYOK_KBN, _
'                                DEN_DT, _
'                                IO_KBN, _
'                                PM_KBN, _
'                                DEN_SYU, _
'                                DEN_NO, _
'                                CYU_KBN, _
'                                HIN_GAI, _
'                                HIN_NAI, _
'                                HIN_NAME, _
'                                YOTEI_QTY, _
'                                YOSAN_FROM, _
'                                YOSAN_TO, _
'                                HOST_SOKO, _
'                                HOST_TANA, _
'                                SYUK_CODE, _
'                                SYUK_NAME, _
'                                GENSANKOKU, GEN_GENSANKOKU, SHIIRE_WORK_CENTER, KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO, ID_NO2, AITESAKI_CODE, JYUCHU_YMD, SHITEI_NOUKI_YMD) Then
            If Y_GLICS_PUT_PROC(JGYOBU, NAIGAI, INS_NOW, _
                                TEXT_NO, _
                                JGYOBU_Code, _
                                CYOK_KBN, _
                                DEN_DT, _
                                IO_KBN, _
                                PM_KBN, _
                                DEN_SYU, _
                                DEN_NO, _
                                CYU_KBN, _
                                HIN_GAI, _
                                HIN_NAI, _
                                HIN_NAME, _
                                YOTEI_QTY, _
                                YOSAN_FROM, _
                                YOSAN_TO, _
                                HOST_SOKO, _
                                HOST_TANA, _
                                SYUK_CODE, _
                                SYUK_NAME, _
                                GENSANKOKU, GEN_GENSANKOKU, SHIIRE_WORK_CENTER, KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO, ID_NO2, AITESAKI_CODE, JYUCHU_YMD, SHITEI_NOUKI_YMD, MOTO_TEXT_NO) Then
'''''''''''''''''''''2011.03.23 à¯êîí«â¡
'               Exit Function      '2015.11.19
                GoTo Abort_Tran     '2015.11.19
            End If

        End If



'-----------------------------------------  è∆çáópì¸â◊ó\íËÇÃèoóÕèàóù    2007.06.15
    
    
    
    
    
    
    
    
    
        If IO_KBN <> "1" Then
            
            If IO_KBN = "4" And Left(YOSAN_FROM, 4) = "0211" And Left(YOSAN_TO, 3) = "SDC" And Trim(HOST_SOKO) = "11B" Then
            Else
                Skip_Flg = True
            End If
        End If
    
    
        If PM_KBN = "-" Then
            Skip_Flg = True
        End If
    
        'NOPOS  2006.05.01
        If Trim(DEN_NO) = "NOPOS" Then
            Skip_Flg = True
        End If
    
        'ó\éZå≥ÅÅ36003èúäO  2006.07.15
        If Trim(YOSAN_FROM) = "36003" Then
            Skip_Flg = True
        End If
    
        'ó\éZå≥ÅÅPPèúäO  2008.01.10
        If Left(YOSAN_FROM, 2) = "PP" Then
            
            If Trim(YOSAN_FROM) = "PPP4" And JGYOBU = SHOKUSEN Then     '2017.02.17
            Else                                                        '2017.02.17
                Skip_Flg = True
            End If                                                      '2017.02.17
        End If
    
    
    
    
        WORK_SOKO = KASO_NYUKA_SOKO
    
    
    
        Select Case JGYOBU
            
''            Case SENTAKU                        'êÙëÛã@
''
''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 2) = "P2" Then
''                    Skip_Flg = True
''                End If
''
''                If Left(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode), 1) = "9" Then
''                    Skip_Flg = True
''                End If
                            
            
            
            
            Case SOJIKI                         'ë|èúã@
                
            
                If Left(YOSAN_FROM, 2) = "KM" Then
                    Skip_Flg = True
                End If

                If Left(YOSAN_FROM, 2) = "KK" Then
                    Skip_Flg = True
                End If

                If Left(YOSAN_FROM, 2) = "GG" Then
                    Skip_Flg = True
                End If

                If Left(YOSAN_FROM, 2) = "SS" Then
                    Skip_Flg = True
                End If

                '2005.04.07 é˚éxí«â¡
                If Left(YOSAN_FROM, 5) = "0090K" Then
                    Skip_Flg = True
                End If
                '2006.07.27 é˚éxí«â¡
                If Left(YOSAN_FROM, 5) = "0092H" Then
                    Skip_Flg = True
                End If
                '2006.07.27 é˚éxí«â¡
                If Left(YOSAN_FROM, 2) = "AA" Then
                    Skip_Flg = True
                End If
            
                '2009.08.28 é˚éxí«â¡
                If Left(YOSAN_FROM, 2) = "ZZ" Then
                    Skip_Flg = True
                End If
            
            
            
            
                If Trim(YOSAN_FROM) <> "91H" Then
                    WORK_SOKO = KASO_SMODOSHI_SOKO
                End If
            
            
            
            Case DENKA, SUIHAN, SENTAKU, BLBU        'ìdâªÅAêÜî—ÅAêÙëÛã@ÅiÉAÉCÉçÉìÅj    BLBUí«â¡ 2012.04.06
            
            
                Select Case MyCenter
                    
                    Case "O"
                
                        If Left(YOSAN_FROM, 2) = "01" Then
                            Skip_Flg = True
                        End If
                    
                        If Left(YOSAN_FROM, 3) = "H33" Then    '2004.07.16
                            Skip_Flg = True
                        End If
                        If Left(YOSAN_FROM, 3) = "H22" Then    '2004.07.16
                            Skip_Flg = True
                        End If
        
                        If Left(YOSAN_FROM, 2) = "05" Then
                            Skip_Flg = True
                        End If
        
                        '2006.08.17
                        If Left(YOSAN_FROM, 2) = "08" Then
                            Skip_Flg = True
                        End If
                        
                        '2006.10.13 ìdâªí≤óùÇÕó\éZå≥="02"ÇÃÇ›ëŒè€
                        If JGYOBU = DENKA Then
                            
                            '2008.01.07 "02"-->"0201"Ç…ïœçX 2008.01.08 Left(Trim(YOSAN_FROM), 2) <> "02" Ç…ïœçX
                            If Left(Trim(YOSAN_FROM), 2) <> "02" And _
                            Trim(YOSAN_FROM) <> "G11" And _
                            Trim(YOSAN_FROM) <> "G22" And _
                            Trim(YOSAN_FROM) <> "KA01" Then         '2012.08.31 KA01 í«â¡
                                Skip_Flg = True
                            End If
                        End If
        
        
        
        
                        '2012.08.31
                        
        
        
        
                        '2006.11.22 êÜî—/ÉAÉCÉçÉìÇÃèúäOèåèí«â¡ 2012.04.06 BLBUí«â¡
                        If (JGYOBU = SUIHAN Or _
                            JGYOBU = SENTAKU Or _
                            JGYOBU = BLBU) Then
                            If (Left(YOSAN_FROM, 2) = "P3" Or _
                                Left(YOSAN_FROM, 2) = "S3") Then
                                Skip_Flg = True
                            End If
                        End If
        
        
        
                        '2007.10.25 êÜî—/ÉAÉCÉçÉìÇÃèúäOèåèí«â¡ 2012.04.06 BLBUí«â¡
                        If (JGYOBU = SUIHAN Or _
                            JGYOBU = SENTAKU Or _
                            JGYOBU = BLBU) Then
                            If Left(YOSAN_FROM, 2) = "RO" Then
                                Skip_Flg = True
                            End If
                        End If
        
                        '2007.12.06 êÜî—/ÉAÉCÉçÉìÇÃèúäOèåèí«â¡  2012.04.06 BLBUí«â¡
                        If (JGYOBU = SUIHAN Or _
                            JGYOBU = SENTAKU Or _
                            JGYOBU = BLBU) Then
                            If Left(YOSAN_FROM, 2) = "07" Then
                                Skip_Flg = True
                            End If
                        End If
        
        
                        '2008.06.26 êÜî—ÇÃèúäOèåèí«â¡ 2012.04.06 BLBUí«â¡
                        If JGYOBU = SUIHAN Or JGYOBU = BLBU Then
                            If Left(YOSAN_FROM, 2) = "04" Then
                                Skip_Flg = True
                            End If
                        End If
        
        
                        '2008.10.14 êÜî—ÇÃèúäOèåèí«â¡ 2012.04.06 BLBUí«â¡
        
                        If JGYOBU = SUIHAN Or JGYOBU = BLBU Then
                            If Left(YOSAN_FROM, 2) = "NC" Or Left(YOSAN_FROM, 2) = "99" Then
                                Skip_Flg = True
                            End If
                        End If
        
        
        
                        '2016.06.17 êÜî—,BLBUÇÃèúäOèåèí«â¡
                        If JGYOBU = SUIHAN Or JGYOBU = BLBU Then
                            If Left(YOSAN_FROM, 2) = "RX" Then
                                Skip_Flg = True
                            End If
                        End If
        
        
                        '2017.07.22 êÜî—,BLBUÇÃèúäOèåèí«â¡
                        If JGYOBU = SUIHAN Or JGYOBU = BLBU Then
                            If Left(YOSAN_FROM, 2) = "RZ" Then
                                Skip_Flg = True
                            End If
                        End If
        
        
        
                        If Left(YOSAN_FROM, 3) = "G22" Then
                            WORK_SOKO = "80"
                        End If
        
                        If Left(YOSAN_FROM, 3) = "G11" Then
                            WORK_SOKO = "81"
                        End If
                    
                        '2006.04.29óp
                        If Left(YOSAN_FROM, 2) = "S1" And _
                            Left(YOSAN_TO, 2) = "S3" Then
                            WORK_SOKO = "87"
                        End If
                        '2006.05.01
                        If Trim(DEN_NO) = "POS87" Then
                            WORK_SOKO = "87"
                        End If
                
                                
                
                
                
                
                
                
                        '2008.06.26 êÜî—ÇÃëqå…î‘çÜÇÃê›íËí«â¡  2012.04.06 BLBUí«â¡
                        If JGYOBU = SUIHAN Or JGYOBU = BLBU Then
                            If Left(YOSAN_FROM, 2) = "02" And Left(YOSAN_TO, 3) = "SDC" Then
                                WORK_SOKO = "90"
                            End If
                        End If
                
                
                
                
                        '2009.06.01 65î‘ëqå…èoóÕí«â¡ 2012.04.06 BLBUí«â¡
                        If (JGYOBU = SUIHAN Or JGYOBU = DENKA Or JGYOBU = BLBU) Then
                            If IO_KBN = "4" Then
                                If Left(YOSAN_FROM, 4) = "0211" And Left(YOSAN_TO, 3) = "SDC" Then
                                    
                                    If Trim(HOST_SOKO) = "11B" Then
                                        WORK_SOKO = "65"
                                    End If
                                End If
                            End If
                        End If
                        
                        
                
                
                
                
                
                
                
                
                    Case "F"
            
            
            
                        If Left(YOSAN_FROM, 2) = "P2" Then
                            Skip_Flg = True
                        End If

                        If Left(YOSAN_FROM, 2) = "U2" Then      '2008.01.11
                            Skip_Flg = True
                        End If


                        If Left(YOSAN_FROM, 3) <> "904" Then
                            If Left(YOSAN_FROM, 1) = "9" Then
                              Skip_Flg = True
                            End If
                        End If
                        
                        
                        
                        'ó\éZå≥ÅÅPPë‹à‰ÇÃÇ›  2009.11.10
                        If Left(YOSAN_FROM, 2) = "PP" Then
                            
                            
                            If Not Not_SHUSI Then
                            
                                Skip_Flg = False
                            End If
                        End If
                        
                        If Left(YOSAN_FROM, 2) = "S1" And _
                            Left(YOSAN_TO, 2) = "S2" Then
                            WORK_SOKO = "88"
                        End If
            
                        '2006.05.01
                        If Trim(DEN_NO) = "POS88" Then
                            WORK_SOKO = "88"
                        End If
            
                End Select
             Case AIRCON                     'ÉGÉAÉRÉì
                'èúäOëqå…Ç…ÅuCAÅvÇí«â¡ 2006.07.27
                If Trim(HOST_SOKO) = "J4" Or _
                   Trim(HOST_SOKO) = "JG" Or _
                    Trim(HOST_SOKO) = "JW" Or _
                    Trim(HOST_SOKO) = "JV" Or _
                    Trim(HOST_SOKO) = "HY" Or _
                    Trim(HOST_SOKO) = "CA" Then
                    Skip_Flg = True
                End If
        
        
                If Left(YOSAN_FROM, 2) = "SH" Then
                    Skip_Flg = True
                End If
        
        
                If Left(YOSAN_FROM, 2) = "S1" Then
                    If Trim(HOST_SOKO) = "OS" Then
                      Skip_Flg = True
                    End If
                End If
        
                If Not Skip_Flg Then
                    'S2Çí«â¡ 2009.11.04
                    'SSÇí«â¡ 2010.03.08

'                    If Trim(HOST_SOKO) = "S8" Then
                    If Trim(HOST_SOKO) = "S8" Or Trim(HOST_SOKO) = "S2" Or Trim(HOST_SOKO) = "SS" Then
                        
                        
                        WORK_SOKO = "80"
                    Else
                        If CYU_KBN = "A" Then
                        Else
                            If CYU_KBN = "D" Then
                                WORK_SOKO = "70"
                            Else
                            End If
                        End If
                    End If
                End If
           
        
        
            Case OVEN           'ìdéqÉåÉìÉW 2012.09.28
                
        
    '6Å@1    Å¶     SDC    Å¶     90
    '6Å@1    001    SDC    Å¶     70Å©í«â¡ âºì¸å…ÅEÉÜÉjÉbÉg
    '6  1    0102   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0201   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0601   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0602   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0701   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0702   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0801   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0802   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    0899   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9101   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9102   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9301   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9601   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9602   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9901   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO
    '6  1    9902   SDC    Å¶     - Å©í«â¡ é˚éxêUë÷ï™ÇÕèúäO


        
                WORK_SOKO = "90"
                Select Case Trim(YOSAN_FROM)
                
                    Case "001"
                        WORK_SOKO = "70"
                

                        MAEGARI_FLG = True      '2018.11.16

                
                
                
                
                    Case "WP555"                    '2017.05.16
                        WORK_SOKO = "WP"            '2017.05.16
                    
                    
                        MAEGARI_FLG = True      '2018.11.16
                    
                    
                    
                    Case "0102"
                        Skip_Flg = True
                    Case "0201"
                        Skip_Flg = True
                    Case "0601"
                        Skip_Flg = True
                    Case "0602"
                        Skip_Flg = True
                    Case "0701"
                        If Trim(HOST_SOKO) = "01" Then          '2019.01.11
                        Else                                    '2019.01.11
                            Skip_Flg = True
                        End If                                  '2019.01.11
                    Case "0702"
                        Skip_Flg = True
                    Case "0801"
                        Skip_Flg = True
                    Case "0802"
                        Skip_Flg = True
                    Case "0899"
                        Skip_Flg = True
                    Case "9101"
                        Skip_Flg = True
                    Case "9102"
                        Skip_Flg = True
                    Case "9301"
                        Skip_Flg = True
                    Case "9601"
                        Skip_Flg = True
                    Case "9602"
                        Skip_Flg = True
                    Case "9901"
                        Skip_Flg = True
                    Case "9902"
                        Skip_Flg = True
                
                
                
                    Case "ZA071"                                    '2018.12.07
                        
                        
                        If (Trim(HOST_SOKO) = "01" Or Trim(HOST_SOKO) = "02" Or Trim(HOST_SOKO) = "99") Then    '2018.12.11
                        Else                                                                                    '2018.12.11
                            If Trim(HOST_SOKO) <> "06" Then     '2018.12.07
                                Skip_Flg = True                 '2018.12.07
                            End If                              '2018.12.07
                        End If                                                                                  '2018.12.11
                
                End Select
        
        
                If Trim(HOST_SOKO) = "06" And Trim(YOSAN_FROM) = "ZA071" Then     '2018.12.07
                Else                                                        '2018.12.70
        
        
                    If Trim(YOSAN_TO) <> "SDC" Then
                        Skip_Flg = True
                    End If
        
                End If                                                      '2018.12.7
        
        
                If Trim(HOST_SOKO) = "06" Then                  '2018.12.12
                    If (Trim(YOSAN_FROM) <> "ZA071" And Trim(YOSAN_FROM) <> "WP555") Then           '2018.12.12,2019.02.07
                        Skip_Flg = True                         '2018.12.12
                    End If                                      '2018.12.12
                End If                                          '2018.12.12
        
        
                '>> 2019.03.06
                If Trim(YOSAN_FROM) = "WP555" Then
                    If Trim(HOST_SOKO) = "01" Or Trim(HOST_SOKO) = "02" Or Trim(HOST_SOKO) = "06" Or Trim(HOST_SOKO) = "93" Or Trim(HOST_SOKO) = "99" Then
                        If Trim(YOSAN_TO) = "SDC" Then
                        
Debug.Print
                        
                        Else
                            Skip_Flg = True
                        End If
                    Else
                        Skip_Flg = True
                    End If
                End If
                '>> 2019.03.06
            
            '>>>>>>>>>>>>>>>>>>>>>>>>>2015.10.16     êHêÙí«â¡
            Case SHOKUSEN
                                                                                                                '"903" í«â¡ 2015.10.21
'                If Trim(YOSAN_FROM) <> "S1S4" And Trim(YOSAN_FROM) <> "S1P4" And Trim(YOSAN_FROM) <> "904" And Trim(YOSAN_FROM) <> "903" Then
                                                                                                                '"PPP4" í«â¡ 2017.02.17 "906"Å@í«â¡Å@2019.04.15
'                If Trim(YOSAN_FROM) <> "S1S4" And Trim(YOSAN_FROM) <> "S1P4" And Trim(YOSAN_FROM) <> "904" And Trim(YOSAN_FROM) <> "903" And Trim(YOSAN_FROM) <> "PPP4" Then
                If Trim(YOSAN_FROM) <> "S1S4" And Trim(YOSAN_FROM) <> "S1P4" And Trim(YOSAN_FROM) <> "904" And Trim(YOSAN_FROM) <> "903" And Trim(YOSAN_FROM) <> "PPP4" _
                    And Trim(YOSAN_FROM) <> "906" Then
                    Skip_Flg = True
                End If
                
                If Trim(YOSAN_FROM) = "904" Then
'                   If Trim(HOST_SOKO) <> "S4" Then                                '2017.08.04
                    If Trim(HOST_SOKO) <> "S4" And Trim(HOST_SOKO) <> "P4" Then     '2017.08.04
                        Skip_Flg = True
                    End If
                End If
                
                If Trim(YOSAN_FROM) = "903" Then            '2015.10.21
                    If Trim(HOST_SOKO) <> "P4" Then         '2015.10.21
                        Skip_Flg = True                     '2015.10.21
                    End If                                  '2015.10.21
                End If                                      '2015.10.21
                
                
                If Trim(YOSAN_FROM) = "906" Then            '2019.04.15
                    If Trim(HOST_SOKO) <> "P4" Then         '2019.04.15
                        Skip_Flg = True                     '2019.04.15
                    End If                                  '2019.04.15
                End If                                      '2019.04.15
                
                
                
                
                
                If Trim(YOSAN_FROM) = "PPP4" And Trim(HOST_SOKO) = "P4" Then            '2017.02.17
                    WORK_SOKO = "81"                                                    '2017.02.17
                End If                                                                  '2017.02.17
                
                
                If Trim(YOSAN_TO) <> "SDC" Then
                    Skip_Flg = True
                End If
            '>>>>>>>>>>>>>>>>>>>>>>>>>2015.10.16     êHêÙí«â¡
                
        
        End Select
            
            
            
            
        
    
    
        If Not Skip_Flg Then
                                        
                                        
            
                
                                        'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
            Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
            Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, DEN_DT)
            Call UniCode_Conv(K0_Y_NYU.TEXT_NO, TEXT_NO)
    
            sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
            Select Case sts
                Case BtNoErr
                    Call LOG_OUT(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
                    Skip_Flg = True
                Case BtErrKeyNotFound
                Case Else
                    'Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË", 0)              '2016.06.23
                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË", 1, Y_NYU_ID)     '2016.06.23
'                    Exit Function      '2015.11.19
                    GoTo Abort_Tran     '2015.11.19
            End Select
        
        
        
        
        
            If Not Skip_Flg Then
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                If sts <> BtNoErr Then
                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
'                    Exit Function      '2015.11.19
                    GoTo Abort_Tran     '2015.11.19
                End If
                                            'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
'                If Item_Check_Proc(In_Mode, JGYOBU, Soko_T(i, j).NAIGAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
'                    GoTo Abort_Tran
'                End If
                                            
                If Item_Check_Proc(In_Mode, JGYOBU, Soko_T(i, j).NAIGAI, HIN_GAI, HIN_NAI, HIN_NAME, , , , KANKYO_KBN, KANKYO_KBN_ST, KANKYO_KBN_SURYO) Then
                    GoTo Abort_Tran
                End If
                                            
                                            
                '2012.12.20
                If StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "0" And StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "1" Then
                    Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_F)
                End If
                '2012.12.20
                                            
                                            'ì¸â◊ÉfÅ[É^çÏê¨
                Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
                Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
        
        
                Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                Call UniCode_Conv(Y_NYUREC.TANKA, "")
                Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
        
        
                Last_Proc_F = True              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇË
        
        
                'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
                
                
                If MAEGARI_FLG Then                                         '2018.11.16
                
                    
                    If WORK_SOKO = "70" And JGYOBU = OVEN Then
                    
                        'Call LOG_OUT(LOG_F, "HIN_GAI=" & HIN_GAI & " YOTEI_QTY=" & YOTEI_QTY)
                        If MAEGARI_PROC(JGYOBU_Code, HIN_GAI, YOTEI_QTY) Then   '2018.11.16
                            Unload Me                                           '2018.11.16
                        End If                                                  '2018.11.16
                
                    End If
                
                
                    WK_E_QTY = 0                                            '2018.11.16
                    
                Else                                                        '2018.11.16
                
                
                
                
                
                    If JGYOBU = OVEN And Trim(YOSAN_FROM) <> "4HHK" Then        '2019.02.08
                        WK_E_QTY = 0                                            '2019.02.08
                    Else                                                        '2019.02.08
                
                
                        Call UniCode_Conv(K0_J_NYU.JGYOBU, JGYOBU)
                        Call UniCode_Conv(K0_J_NYU.NAIGAI, Soko_T(i, j).NAIGAI)
                        Call UniCode_Conv(K0_J_NYU.HIN_GAI, HIN_GAI)
            
                        WK_Y_QTY = CLng(YOTEI_QTY)
            
            
                        Loop_Cnt = 0
            
                        Do
                            sts = BTRV(BtOpGetEqual + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    If CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) > WK_Y_QTY Then
                                        WK_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) - WK_Y_QTY
                                        Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(WK_Qty, "00000000"))
                                
                                        Loop_Cnt = 0
                                        Do
                                        
                                            sts = BTRV(BtOpUpdate, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                            Select Case sts
                                                Case BtNoErr
                                                    Exit Do
                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
        '                                            Beep
        '                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
        '                                            If ans = vbCancel Then
        ''                                                Exit Function
        '                                                GoTo Abort_Tran
        '                                            End If
                                                
                                                
                                                    Loop_Cnt = Loop_Cnt + 1
                                                    If Loop_Cnt > 5 Then
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                    DoEvents
                                                    Sleep (500)
                                                
                                                Case Else
                                                    'Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)            '2016.06.23
                                                    Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)   '2016.06.23
        '                                            Exit Function
                                                    GoTo Abort_Tran
                                            End Select
                                        
                                        Loop
                                        WK_E_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                    Else
                                        
                                        
                                        Loop_Cnt = 0
                                                                        
                                        Do
                                            sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                            Select Case sts
                                                Case BtNoErr
                                                    Exit Do
                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
        '                                            Beep
        '                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
        '                                            If ans = vbCancel Then
        ''                                                Exit Function
        '                                                GoTo Abort_Tran
        '                                            End If
                                                
                                                
                                                    Loop_Cnt = Loop_Cnt + 1
                                                    If Loop_Cnt > 5 Then
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                    DoEvents
                                                    Sleep (500)
                                                
                                                
                                                Case Else
                                                    'Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)            '2016.06.23
                                                    Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)   '2016.06.23
        '                                            Exit Function
                                                    GoTo Abort_Tran
                                            End Select
                                        Loop
                                        WK_E_QTY = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
                                    End If
                            
                                    Exit Do
                                Case BtErrKeyNotFound
                                    WK_E_QTY = 0
                                    Exit Do
                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
        '                            Beep
        '                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
        '                            If ans = vbCancel Then
        ''                                Exit Function
        '                                GoTo Abort_Tran
        '                           End If
                                
                                
                                    Loop_Cnt = Loop_Cnt + 1
                                    If Loop_Cnt > 5 Then
                                        GoTo Abort_Tran
                                    End If
                                
                                    DoEvents
                                    Sleep (500)
                                
                                
                                
                                Case Else
                                    'Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)              '2016.06.23
                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)     '2016.06.23
        '                            Exit Function
                                    GoTo Abort_Tran
                            End Select
                        Loop
                    End If                                          '2019.02.08
                End If
                                    
                                    
                                    'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
                Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, Format(WK_E_QTY, "00000000"))
        
                                    'ó\éZíPà å≥
                Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                                    'ó\éZíPà êÊ
                Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                                    'ïWèÄíIî‘
                Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
                Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
                                    'Hëqå… 2006.10.17
                Call UniCode_Conv(Y_NYUREC.H_SOKO, HOST_SOKO)

                                    'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, " ")








                '----------------   2010.07.08 Å§
                
                
                If Trim(GENSANKOKU) = "" And Trim(GEN_GENSANKOKU) = "" And Trim(SHIIRE_WORK_CENTER) = "" Then
                
                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode))                    'å¥éYçëñº
                    Call UniCode_Conv(Y_NYUREC.GEN_GENSANKOKU, StrConv(ITEMREC.TORI_GEN_GENSANKOKU, vbUnicode))            'åªï®ï\é¶å¥éYçëñº
                    Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, StrConv(ITEMREC.TORI_SHIIRE_WORK_CENTER, vbUnicode))    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
                
                Else
                
                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, GENSANKOKU)                    'å¥éYçëñº
                    Call UniCode_Conv(Y_NYUREC.GEN_GENSANKOKU, GEN_GENSANKOKU)            'åªï®ï\é¶å¥éYçëñº
                    Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
                End If
                
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN, KANKYO_KBN)                          'ä¬ã´éÌóﬁãÊï™
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_ST, KANKYO_KBN_ST)                    'ä¬ã´éÌóﬁãÊï™ìKópäJén
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)              'ä¬ã´éÌóﬁãÊï™êîó 
                Call UniCode_Conv(Y_NYUREC.ID_NO2, ID_NO2)                                  'ID_NO
                Call UniCode_Conv(Y_NYUREC.AITESAKI_CODE, AITESAKI_CODE)                    'ëäéËêÊ∫∞ƒﬁ
                Call UniCode_Conv(Y_NYUREC.JYUCHU_YMD, JYUCHU_YMD)                          'éÛíçîNåéì˙
                Call UniCode_Conv(Y_NYUREC.SHITEI_NOUKI_YMD, SHITEI_NOUKI_YMD)              'éwíËî[ä˙îNåéì˙
                Call UniCode_Conv(Y_NYUREC.LIST_OUT_END_F, "0")                             'ì¸å…ä÷òAÿΩƒèoóÕF
                    
                Call UniCode_Conv(Y_NYUREC.LIST_NYU_KANRI_F, "8")                           'ì¸å…ä«óùÿΩƒèoóÕF
                If StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode) <> "" And Mid(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode), 1, 1) > " " Then
                    
                    Call UniCode_Conv(K0_GENSAN.JGYOBU, JGYOBU)
                    Call UniCode_Conv(K0_GENSAN.NAIGAI, Soko_T(i, j).NAIGAI)
                    Call UniCode_Conv(K0_GENSAN.HIN_GAI, HIN_GAI)
                    Call UniCode_Conv(K0_GENSAN.GENSANKOKU, StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode))
                        
                    sts = BTRV(BtOpGetEqual, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                    Select Case sts
                        Case BtNoErr
                        
                        Case BtErrKeyNotFound
                        
                            Call UniCode_Conv(K0_GENSAN.JGYOBU, JGYOBU)
                            Call UniCode_Conv(K0_GENSAN.NAIGAI, Soko_T(i, j).NAIGAI)
                            Call UniCode_Conv(K0_GENSAN.HIN_GAI, HIN_GAI)
                            Call UniCode_Conv(K0_GENSAN.GENSANKOKU, "")
                            sts = BTRV(BtOpGetGreaterEqual, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                        
                            Select Case sts
                                Case BtNoErr
                                
                                    If Trim(HIN_GAI) = Trim(StrConv(GENSANREC.HIN_GAI, vbUnicode)) Then
                                        Call UniCode_Conv(Y_NYUREC.LIST_NYU_KANRI_F, "0")                   'ì¸å…ä«óùÿΩƒèoóÕF
                                    End If
                                
                                
                                
                                Case BtErrEOF
                        
                                Case Else
                                  
                                    'Call File_Error(sts, BtOpGetGreaterEqual, "å¥éYçëœΩ¿", 0)              '2016.06.23
                                    Call File_Error(sts, BtOpGetGreaterEqual, "å¥éYçëœΩ¿", 1, GENSAN_ID)    '2016.06.23
'                                    Exit Function
                                    GoTo Abort_Tran
                            End Select
                    End Select
                End If

                Call UniCode_Conv(Y_NYUREC.LIST_NYU_CHECK_F, "0")                       'ì¸å…¡™Ø∏ÿΩƒèoóÕF
                
                
                Call UniCode_Conv(Y_NYUREC.NYUKO_TANABAN, (WORK_SOKO & _
                                                            "01" & "01" & "01"))        'ì¸å…íIî‘
                                                                                        'ëOéÿëäéEêî
                Call UniCode_Conv(Y_NYUREC.MAEGARI_SURYO, Format(WK_E_QTY, "00000000"))
                
                
                
                
                Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
                
                
                
                '2011.03.23 î≠ê∂å≥ÉvÉçÉOÉâÉÄ
                Call UniCode_Conv(Y_NYUREC.MOTO_PROG_ID, StrConv(App.EXEName, vbUpperCase))
                '2011.03.23 å≥ÉeÉLÉXÉgáÇ
                If Trim(MOTO_TEXT_NO) = "" Then
                    Call UniCode_Conv(Y_NYUREC.MOTO_TEXT_NO, "")
                Else
                    Call UniCode_Conv(Y_NYUREC.MOTO_TEXT_NO, MOTO_TEXT_NO)
                End If
                
                '----------------   2010.07.08 Å¢








                Call UniCode_Conv(Y_NYUREC.FILLER, "")
                
                
                Loop_Cnt = 0
                            
                Do
                    sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                            Beep
'                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                            If ans = vbCancel Then
''                                Exit Function
'                                GoTo Abort_Tran
'                            End If
                        
                            Loop_Cnt = Loop_Cnt + 1
                            If Loop_Cnt > 5 Then
                                GoTo Abort_Tran
                            End If
                        
                            DoEvents
                            Sleep (500)
                        
                        Case Else
                            'Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)            '2016.06.23
                            Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 1, Y_NYU_ID)   '2016.06.23
'                            Exit Function
                            GoTo Abort_Tran
                    End Select
                Loop
            
            
                '----------------   2010.07.08 Å§
                'å¥éYçëÇÃÉ`ÉFÉbÉNÅïìoò^
                If StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode) <> "" And Mid(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode), 1, 1) > " " Then
                    Call UniCode_Conv(K0_GENSAN.JGYOBU, JGYOBU)
                    Call UniCode_Conv(K0_GENSAN.NAIGAI, NAIGAI)
                    Call UniCode_Conv(K0_GENSAN.HIN_GAI, HIN_GAI)
                    Call UniCode_Conv(K0_GENSAN.GENSANKOKU, StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode))
                
                    sts = BTRV(BtOpGetEqual, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                    Select Case sts
                        Case BtNoErr
                        
                            
                            '>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.12.28
                            Call UniCode_Conv(GENSANREC.UPD_TANTO, "2010")
                            Call UniCode_Conv(GENSANREC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                            
                            Loop_Cnt = 0
                            
                            Do
                                sts = BTRV(BtOpUpdate, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                                    
                                        Loop_Cnt = Loop_Cnt + 1
                                        If Loop_Cnt > 5 Then
                                            GoTo Abort_Tran
                                        End If
                                    
                                        DoEvents
                                        Sleep (500)
                                    
                                    
                                    Case Else
                                        'Call File_Error(sts, BtOpInsert, "å¥éYçëœΩ¿", 0)               '2016.06.23
                                        Call File_Error(sts, BtOpInsert, "å¥éYçëœΩ¿", 1, GENSAN_ID)     '2016.06.23
                                        GoTo Abort_Tran
                                End Select
                            Loop
                            '>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.12.28
                        
                        
                        
                        Case BtErrKeyNotFound
                        
                            Call UniCode_Conv(GENSANREC.JGYOBU, JGYOBU)
                            Call UniCode_Conv(GENSANREC.NAIGAI, NAIGAI)
                            Call UniCode_Conv(GENSANREC.HIN_GAI, HIN_GAI)
                            Call UniCode_Conv(GENSANREC.GENSANKOKU, StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode))
                            Call UniCode_Conv(GENSANREC.FILLER, "")
                            Call UniCode_Conv(GENSANREC.INS_TANTO, "2010")
                            Call UniCode_Conv(GENSANREC.Ins_DateTime, Format(Now, "YYYYMMDDHHMMSS"))
                            Call UniCode_Conv(GENSANREC.UPD_TANTO, "")
                            Call UniCode_Conv(GENSANREC.UPD_DATETIME, "")
                            
                            Loop_Cnt = 0
                            
                            Do
                                sts = BTRV(BtOpInsert, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                        Beep
'                                        ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                        If ans = vbCancel Then
''                                            Exit Function
'                                            GoTo Abort_Tran
'                                        End If
                                    
                                        Loop_Cnt = Loop_Cnt + 1
                                        If Loop_Cnt > 5 Then
                                            GoTo Abort_Tran
                                        End If
                                    
                                        DoEvents
                                        Sleep (500)
                                    
                                    
                                    Case Else
                                        'Call File_Error(sts, BtOpInsert, "å¥éYçëœΩ¿", 0)               '2016.06.23
                                        Call File_Error(sts, BtOpInsert, "å¥éYçëœΩ¿", 1, GENSAN_ID)     '2016.06.23
'                                        Exit Function
                                        GoTo Abort_Tran
                                End Select
                            Loop
                        Case Else
                            'Call File_Error(sts, BtOpGetEqual, "å¥éYçëœΩ¿", 0)                 '2016.06.23
                            Call File_Error(sts, BtOpGetEqual, "å¥éYçëœΩ¿", 1, GENSAN_ID)       '2016.06.23
'                            Exit Function
                            GoTo Abort_Tran
                    End Select
                End If
                '----------------   2010.07.08 Å¢
            
            
            
            
            
            
            
'------------ 2005.12.30
                Select Case JGYOBU
                    Case AIRCON, SENTAKU
                        Call UniCode_Conv(K0_SOKO.Soko_No, WORK_SOKO)
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case Else
                                'Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)            '2016.06.23
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 1, SOKO_ID)    '2016.06.23
'                                Exit Function
                                GoTo Abort_Tran
                        End Select
        
                        If StrConv(SOKOREC.GOODS_ON_F, vbUnicode) = GOODS_ON Then
        
                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                            MI_QTY = 0
                        Else
                        
                            If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                                MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                SUMI_QTY = 0
                            Else
                                SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                MI_QTY = 0
                            End If
                        End If
                        
'------------ 2005.12.30
                        
                    Case Else
                        
                        
                        If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                            MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                            SUMI_QTY = 0
                        Else
                            SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                            MI_QTY = 0
                        End If
                End Select
                
        
'                Wk_SOKO = KASO_NYUKA_SOKO
'                If Trim(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) <> "91H" Then
'                    Wk_SOKO = KASO_SMODOSHI_SOKO
'
'                End If
        
        
        
        
        
                'ì¸â◊êîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ{Åj
                If Nyuko_Update_Proc(JGYOBU, _
                                    Soko_T(i, j).NAIGAI, _
                                    HIN_GAI, _
                                    StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
                                    (WORK_SOKO & "01" & "01" & "01"), _
                                    YOIN_TU_NYUKA, _
                                    SUMI_QTY, MI_QTY, _
                                    WS_NO, WS_NO, 5, _
                                    DEN_DT & " ì`áÇ:" & DEN_NO, , , , MENU_NO, , , StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode), StrConv(ITEMREC.TORI_SHIIRE_WORK_CENTER, vbUnicode), ID_NO2, YOSAN_FROM, YOSAN_TO) Then
'                    Exit Function
                    GoTo Abort_Tran
            
                End If
            
                'ëOéÿÇËêîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ|Åj
                If WK_E_QTY <> 0 Then
                'ç›å…ÉfÅ[É^LOCK
                    If Zaiko_Lock_Proc((WORK_SOKO & "01" & "01" & "01"), _
                                        JGYOBU, _
                                        Soko_T(i, j).NAIGAI, _
                                        HIN_GAI, _
                                        WS_NO, , , 5) Then
'                        Exit Function
                        GoTo Abort_Tran
    
                    End If
        
                    If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                        MI_QTY = WK_E_QTY
                    Else
                        SUMI_QTY = WK_E_QTY
                    End If
            
            
                    If Syuko_Update_Proc(JGYOBU, _
                                        Soko_T(i, j).NAIGAI, _
                                        HIN_GAI, _
                                        DEN_DT, _
                                        (WORK_SOKO & "01" & "01" & "01"), _
                                        YOIN_MAE_SOUSAI, _
                                        SUMI_QTY, MI_QTY, 0, _
                                        WS_NO, WS_NO, 5) Then
'                        Exit Function
                        GoTo Abort_Tran
        
                    End If
            
            
            
            
            
            
                End If
                
                
                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                If sts <> BtNoErr Then
                    GoTo Abort_Tran
                End If
                
                
                Out_Cnt = Out_Cnt + 1
                lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                DoEvents
    
            End If
        
        
        
        
        
'èoâ◊ó\íËïœä∑################################################## 2005/05/16 Add é†âÍï®ó¨Å´
        Else
            
            If JGYOBU = AIRCON Then
            
                If Not_SHUSI And Trim(HOST_SOKO) <> "R8" Then     '2019/12/13 é†âÍDC é˚éxR8ëŒâû
                Else
                    If IO_KBN = "2" Then
                                
                        
                        wkMUKE_CODE = ""
                        
                        If Trim(HOST_SOKO) = "S8" Then
                            wkMUKE_CODE = "S8"
                        ElseIf Trim(HOST_SOKO) = "R8" Then '2019/12/13 é†âÍDC é˚éxR8ëŒâû
                            wkMUKE_CODE = "R8"             '2019/12/13 é†âÍDC é˚éxR8ëŒâû
                        Else
                            If Trim(HOST_SOKO) = "ST" Then              'STí«â¡Å@   2016.03.11
                                wkMUKE_CODE = "ST"                      '           2016.03.11
                            Else                                        '           2016.03.11
                                If Trim(HOST_SOKO) = "SH" Then
                                Else
                                    Select Case Trim(YOSAN_TO)
                                    
                                        Case "Z0014"
                                            wkMUKE_CODE = "LM"
                                        Case "B0070"
                                            If Trim(HOST_SOKO) = "S2" Then
                                                wkMUKE_CODE = "S2"
                                            Else
                                                wkMUKE_CODE = "AC"
                                            End If
                                        Case Else
                                             wkMUKE_CODE = "AC"
                                    End Select
                                End If                                  '           2016.03.11
                            End If
                        
                            If Trim(HOST_SOKO) <> "S2" Then             'ÅÇ"S2" and ="B0070"    '2019.01.22
                                If Trim(YOSAN_TO) = "B0070" Then
                                    wkMUKE_CODE = "AC"
                                End If
                            End If
                        End If
            
            
                        If wkMUKE_CODE = "" Then
                        Else
'                            Skip_Flg = False
                                                        'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
'                            Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
'                            Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, DEN_DT)
'                            Call UniCode_Conv(K0_Y_NYU.TEXT_NO, TEXT_NO)
'
'                            sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'                            Select Case sts
'                                Case BtNoErr
'                                    Call LOG_OUT(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
'                                    Skip_Flg = True
'                                Case BtErrKeyNotFound
'                                Case Else
'                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
'                                    Exit Function
'                            End Select
            
            
            
            
'
'                            Call UniCode_Conv(K0_Y_GLICS.JGYOBU, JGYOBU)
'                            Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, DEN_DT)
'                            Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, TEXT_NO)
'
'                            sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
'                            Select Case sts
'                                Case BtNoErr
'                                    Call LOG_OUT(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
'                                    Skip_Flg = True
'                                Case BtErrKeyNotFound
'                                Case Else
'                                    Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË")
'                                    Exit Function
'                            End Select
            
            
                            
                            If Not DUP_FLG Then
            
                                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    Exit Function
                                End If
                                                                'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                                If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                                    GoTo Abort_Tran
                                End If
            
        '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
                                Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                                Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                                Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
'                                Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI) '2019/12/13 é†âÍDC é˚éxR8ëŒâû
                                Call UniCode_Conv(Y_NYUREC.NAIGAI, "1")
                                Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
                        
                        
                                Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                                Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                                Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                                Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                                Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                                Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                                Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                                Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                                Call UniCode_Conv(Y_NYUREC.TANKA, "")
                                Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                                Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                                Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                                Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                                Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                                Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                                Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                                Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                                Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                                Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                                Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                                Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                                Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                                Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                                Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                                Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                                Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                                Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                                Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                                Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                                Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                                Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                                Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                                Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                                Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                                Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                                Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                                Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                                Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                                Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                                Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                                Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
                                Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
                
                
                                Call UniCode_Conv(Y_NYUREC.H_SOKO, " ")
                
                
                
                                                    'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                                Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, "9")
                
                
                
                
                
                
                
                
                
                                '----------------   2010.07.08 Å§
                                Call UniCode_Conv(Y_NYUREC.GENSANKOKU, GENSANKOKU)                      'å¥éYçëñº
                                Call UniCode_Conv(Y_NYUREC.GEN_GENSANKOKU, GEN_GENSANKOKU)              'åªï®ï\é¶å¥éYçëñº
                                Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)      'éëçﬁédì¸êÊ‹∞∏æ›¿∞
                                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN, KANKYO_KBN)                      'ä¬ã´éÌóﬁãÊï™
                                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_ST, KANKYO_KBN_ST)                'ä¬ã´éÌóﬁãÊï™ìKópäJén
                                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)          'ä¬ã´éÌóﬁãÊï™êîó 
                                Call UniCode_Conv(Y_NYUREC.ID_NO2, ID_NO2)                              'ID_NO
                                Call UniCode_Conv(Y_NYUREC.AITESAKI_CODE, AITESAKI_CODE)                'ëäéËêÊ∫∞ƒﬁ
                                Call UniCode_Conv(Y_NYUREC.JYUCHU_YMD, JYUCHU_YMD)                      'éÛíçîNåéì˙
                                Call UniCode_Conv(Y_NYUREC.SHITEI_NOUKI_YMD, SHITEI_NOUKI_YMD)          'éwíËî[ä˙îNåéì˙
                                Call UniCode_Conv(Y_NYUREC.LIST_OUT_END_F, "")                          'ì¸å…ÿΩƒèoóÕF
                                Call UniCode_Conv(Y_NYUREC.NYUKO_TANABAN, "")                           'ì¸å…íIî‘
                                Call UniCode_Conv(Y_NYUREC.MAEGARI_SURYO, "")                           'ëOéÿëäéEêî
                                
                                
                                
                                Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                                Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                                Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                                Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
                                
                                
                                
                                
                                
                                '----------------   2010.07.08 Å¢
                
                
                
                
                
                
                
                
                
                
                
                
                                Call UniCode_Conv(Y_NYUREC.FILLER, "")
                                
'                                Do
'                                    sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'                                    Select Case sts
'                                        Case BtNoErr
'                                            Exit Do
'                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                            Beep
'                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                            If ans = vbCancel Then
'                                                Exit Function
'                                            End If
'                                        Case Else
'                                            Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'                                            Exit Function
'                                    End Select
'                                Loop
        '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
            
                                Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                                Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                                Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                                Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                                Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                                Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
            
                                If Rec_LENG = 138 Then                                      '2016.04.19
                                    If Den_No_Set_Proc(21, JGYOBU, wkStr) Then
                                        GoTo Abort_Tran
                                    Else
                                        Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, wkStr)
                                    End If
                                Else                                                        '2016.04.19
                                    Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO2)           '2016.04.19
                                End If                                                      '2016.04.19
            
            
                                Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
                                Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_GAI)
                                Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, wkMUKE_CODE)
                                Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
                                Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, DEN_DT)
                                Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
                                Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                                Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
                                Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
                                
                                Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_GAI)
                                
                                'If JGYOBU = AIRCON Then             '2008.02.01
                                '    If Left(DEN_NO, 1) = "0" Then
                                '        DEN_NO = Right(DEN_NO, Len(DEN_NO) - 1)
                                '    End If
                                'End If
                                
                                Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                                
                                
                                
                                
                                
                                wkStr = Format(Val(YOTEI_QTY), "0000000")
                                Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
                                Call UniCode_Conv(Y_SYUREC.MUKE_CODE, wkMUKE_CODE)
                                Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, HOST_SOKO)
                                Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
                                
                                Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, DEN_DT)
                                Call UniCode_Conv(Y_SYUREC.TANKA, "")
                                
                                
                                Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
                                Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
                                Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
                                Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
                                
                                
                                
                                Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, DEN_DT)
    
                                Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                                Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                                Call UniCode_Conv(Y_SYUREC.TANABAN3, "")
    
                                Call UniCode_Conv(Y_SYUREC.MUKE_NAME, SYUK_NAME)
    
                                Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
                                Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
                                Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
                                Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
                                Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
                                Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CYOK_KBN)
    
                                Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
                                Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
                                Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
                                Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
                                Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
                                Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
                                Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                                Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
                                Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
                                Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
                                Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
                                Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
                                Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                                Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")
    
                                Call UniCode_Conv(Y_SYUREC.HIN_NAI, HIN_NAI)
                                Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
                                Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                                Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                                Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                                Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                                Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                                Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                                Call UniCode_Conv(Y_SYUREC.FILLER, "")
            
                                Loop_Cnt = 0
                                
                                Do
                                    sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                            Beep
'                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                            If ans = vbCancel Then
''                                                Exit Function
'                                                GoTo Abort_Tran
'                                            End If
                                        
                                        
                                            Loop_Cnt = Loop_Cnt + 1
                                            If Loop_Cnt > 5 Then
                                                GoTo Abort_Tran
                                            End If
                                        
                                            DoEvents
                                            Sleep (500)
                                        
                                        
                                        Case Else
                                            'Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)            '2016.06.23
                                            Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 1, Y_SYU_ID)   '2016.06.23
'                                            Exit Function
                                            GoTo Abort_Tran
                                    End Select
                                Loop
            
                                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    GoTo Abort_Tran
                                End If
            
                                Out_Cnt = Out_Cnt + 1
                                lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                                DoEvents
            
                                If SYUKA_LOG_ON Then
                                    Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
                                End If
            
'                                If Not Fast_Flg Then
'                                    Close #DUP_SYUKANo
'                                End If
                            End If
                        End If
                    End If
                End If
            End If
'#################################################################################### 2005/05/16 Add Å™
        
'#################################################################################### 2008/02/22 Add Å´
            If JGYOBU = SOJIKI Then
            
                If IO_KBN = "1" Then
                            
                    wkMUKE_CODE = ""
                            
                    If Trim(HOST_SOKO) = "SS" Then
                        wkMUKE_CODE = "00000000"
                    End If
                    If Trim(HOST_SOKO) = "ZZ" Then
                        wkMUKE_CODE = "88888888"
                    End If
        
        
                    If wkMUKE_CODE = "" Then
                    Else
 '                       Skip_Flg = False
                                                    'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
 '                       Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
 '                       Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, DEN_DT)
 '                       Call UniCode_Conv(K0_Y_NYU.TEXT_NO, TEXT_NO)
 '
 '                       sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
 '                       Select Case sts
 '                           Case BtNoErr
 '                               Call LOG_OUT(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
 '                               Skip_Flg = True
 '                           Case BtErrKeyNotFound
 '                           Case Else
 '                               Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
 '                               Exit Function
 '                       End Select
        
        
 '                       Call UniCode_Conv(K0_Y_GLICS.JGYOBU, JGYOBU)
 '                       Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, DEN_DT)
 '                       Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, TEXT_NO)
 '
 '                       sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
 '                       Select Case sts
 '                           Case BtNoErr
 '                               Call LOG_OUT(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
 '                               Skip_Flg = True
 '                           Case BtErrKeyNotFound
 '                           Case Else
 '                               Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË")
 '                               Exit Function
 '                       End Select
        
        
        
                        If Not DUP_FLG Then
        
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                                                            'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                            If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                                GoTo Abort_Tran
                            End If
        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
                            Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                            Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                            Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                            Call UniCode_Conv(Y_NYUREC.NAIGAI, NAIGAI_NAI)
                            Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
                    
                    
                            Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                            Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                            Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                            Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                            Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                            Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                            Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                            Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                            Call UniCode_Conv(Y_NYUREC.TANKA, "")
                            Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                            Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                            Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                            Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                            Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                            Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                            Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                            Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                            Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                            Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                            Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                            Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                            Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                            Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                            Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                            Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                            Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                            Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                            Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                            Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                            Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                            Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                            Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                            Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                            Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                            Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                            Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                            Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                            Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                            Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                            Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                            Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_DAN, vbUnicode))
                            Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
            
            
                            Call UniCode_Conv(Y_NYUREC.H_SOKO, " ")
            
            
            
                                                'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                            Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, "9")
            
                            Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                            Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                            Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                            Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
            
                            Call UniCode_Conv(Y_NYUREC.FILLER, "")
                            
'                            Do
'                                sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'                                Select Case sts
'                                    Case BtNoErr
'                                       Exit Do
'Å@                                  Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                        Beep
'                                        ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                        If ans = vbCancel Then
'                                            Exit Function
'                                        End If
'                                    Case Else
'                                        Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'                                        Exit Function
'                                End Select
'                            Loop
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
        
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                            Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                            Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                            Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                            
                            If Trim(HOST_SOKO) = "SS" Then
                                Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
                            Else
                                Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_TUK)
                            End If
        
                            
                            If Rec_LENG = 138 Then                                  '2016.04.19
                                If Den_No_Set_Proc(21, JGYOBU, wkStr) Then
                                    GoTo Abort_Tran
                                Else
                                    Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, wkStr)
                                End If
                            Else                                                    '2016.04.19
                                Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO2)       '2016.04.19
                            End If                                                  '2016.04.19
        
                            Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
                            Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_GAI)
                            Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, wkMUKE_CODE)
                            Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
                            Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, DEN_DT)
                            Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
                            Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                            Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
                            Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
                            
                            Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_GAI)
                            
                            'If JGYOBU = AIRCON Then             '2008.02.01
                            '    If Left(DEN_NO, 1) = "0" Then
                            '        DEN_NO = Right(DEN_NO, Len(DEN_NO) - 1)
                            '    End If
                            'End If
                            
                            Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                            
                            
                            
                            
                            
                            wkStr = Format(Val(YOTEI_QTY), "0000000")
                            Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
                            Call UniCode_Conv(Y_SYUREC.MUKE_CODE, wkMUKE_CODE)
                            Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, HOST_SOKO)
                            Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
                            
                            Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, DEN_DT)
                            Call UniCode_Conv(Y_SYUREC.TANKA, "")
                            
                            
                            Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
                            Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
                            Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
                            Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
                            
                            
                            
                            Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, DEN_DT)

                            Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                            Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                            Call UniCode_Conv(Y_SYUREC.TANABAN3, "")

                            Call UniCode_Conv(Y_SYUREC.MUKE_NAME, SYUK_NAME)

                            If Trim(HOST_SOKO) = "SS" Then
                                Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
                            Else
                                Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_TUK)
                            End If

                            
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
                            Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
                            Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
                            Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
                            Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CYOK_KBN)

                            Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
                            Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
                            Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
                            Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
                            Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
                            Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
                            Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                            Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
                            Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
                            Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
                            Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
                            Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
                            Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                            Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")

                            Call UniCode_Conv(Y_SYUREC.HIN_NAI, HIN_NAI)
                            Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                        StrConv(ITEMREC.ST_DAN, vbUnicode))
                            Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                            Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                            Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                            Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                            Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                            Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                            Call UniCode_Conv(Y_SYUREC.FILLER, "")
        
        
                            Loop_Cnt = 0
        
                            Do
                                sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                        Beep
'                                        ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                        If ans = vbCancel Then
''                                            Exit Function
'                                            GoTo Abort_Tran
'                                        End If
                                    
                                    
                                        Loop_Cnt = Loop_Cnt + 1
                                        If Loop_Cnt > 5 Then
                                            GoTo Abort_Tran
                                        End If
                                    
                                        DoEvents
                                        Sleep (500)
                                    
                                    
                                    
                                    Case Else
                                        'Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)            '2016.06.23
                                        Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 1, Y_SYU_ID)   '2016.06.23
'                                        Exit Function
                                        GoTo Abort_Tran
                                End Select
                            Loop
        
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                GoTo Abort_Tran
                            End If
        
                            Out_Cnt = Out_Cnt + 1
                            lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                            DoEvents
        
                            If SYUKA_LOG_ON Then
                                Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
                            End If
        
'                            If Not Fast_Flg Then
'                                Close #DUP_SYUKANo
'                            End If
                        End If
                    End If
                End If
            End If
        
'#################################################################################### 2008/02/22 Add Å™
        
        
        
        
        
        
        
        
        
        
        
'#################################################################################### 2010/07/21 Add Å´
            If JGYOBU = DENKA Then
            
                If IO_KBN = "2" And Trim(YOSAN_FROM) = "SDC" And Trim(AITESAKI_CODE) = "01KA" Then
                            
'                    Skip_Flg = False
                                                'ì¸â◊ó\íËèdï°É`ÉFÉbÉN
'                    Call UniCode_Conv(K0_Y_NYU.JGYOBU, JGYOBU)
'                    Call UniCode_Conv(K0_Y_NYU.SYUKA_YMD, DEN_DT)
'                    Call UniCode_Conv(K0_Y_NYU.TEXT_NO, TEXT_NO)
'
'                    sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'                    Select Case sts
'                        Case BtNoErr
'                            Call LOG_OUT(LOG_F, "Y_NYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
'                            Skip_Flg = True
'                        Case BtErrKeyNotFound
'                        Case Else
'                            Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
'                            Exit Function
'                    End Select
    
'                    Call UniCode_Conv(K0_Y_GLICS.JGYOBU, JGYOBU)
'                    Call UniCode_Conv(K0_Y_GLICS.SYUKA_YMD, DEN_DT)
'                    Call UniCode_Conv(K0_Y_GLICS.TEXT_NO, TEXT_NO)
'
'                    sts = BTRV(BtOpGetEqual, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
'                    Select Case sts
'                        Case BtNoErr
'                            Call LOG_OUT(LOG_F, "Y_GLICS.DAT DUP éñã∆ïî=" & JGYOBU & "ÇsÇdÇwÇsÇhÇcÅÅ" & TEXT_NO)
'                            Skip_Flg = True
'                        Case BtErrKeyNotFound
'                        Case Else
'                            Call File_Error(sts, BtOpGetEqual, "è∆çáópì¸â◊ó\íË")
'                            Exit Function
'                    End Select
    
    
                    If Not DUP_FLG Then
    
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        '                    Exit Function      '2015.11.19
                            GoTo Abort_Tran     '2015.11.19
                        End If
                                                        'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                        If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                            GoTo Abort_Tran
                        End If
        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
                        Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                        Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                        Call UniCode_Conv(Y_NYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
                
                
                        Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                        Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                        Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANKA, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                        Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                        Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                        Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                        Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                        Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
        
        
                        Call UniCode_Conv(Y_NYUREC.H_SOKO, " ")
        
        
        
                                            'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                        Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, "9")
        
        
                        Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                        Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                        Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                        Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
        
        
                        Call UniCode_Conv(Y_NYUREC.FILLER, "")
                        
'                        Do
'                            sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
'                            Select Case sts
'                                Case BtNoErr
'                                    Exit Do
'                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                    Beep
'                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                    If ans = vbCancel Then
'                                        Exit Function
'                                    End If
'                                Case Else
'                                    Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'                                    Exit Function
'                            End Select
'                        Loop
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
        
                        Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                        Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                        Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                        
                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_TUK)
                        End If
    
                        Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO2)
    
                        Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
                        
                        Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_GAI)
                            
                        Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                        
                        wkStr = Format(Val(YOTEI_QTY), "0000000")
                        Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
                        Call UniCode_Conv(Y_SYUREC.MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, HOST_SOKO)
                        Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.TANKA, "")
                        
                        
                        Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
                        
                        
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, DEN_DT)

                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")

                        Call UniCode_Conv(Y_SYUREC.MUKE_NAME, SYUK_NAME)

                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_TUK)
                        End If

                        
                        Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CYOK_KBN)

                        Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")

                        Call UniCode_Conv(Y_SYUREC.HIN_NAI, HIN_NAI)
                        Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                        Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                        Call UniCode_Conv(Y_SYUREC.FILLER, "")
    
    
                        Loop_Cnt = 0
    
                        Do
                            sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                    Beep
'                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                    If ans = vbCancel Then
''                                        Exit Function
'                                        GoTo Abort_Tran
'                                    End If
                                
                                
                                    Loop_Cnt = Loop_Cnt + 1
                                    If Loop_Cnt > 5 Then
                                        GoTo Abort_Tran
                                    End If
                                
                                    DoEvents
                                    Sleep (500)
                                
                                Case Else
                                    'Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)            '2016.06.23
                                    Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 1, Y_SYU_ID)   '2016.06.23
'                                    Exit Function
                                    GoTo Abort_Tran
                            End Select
                        Loop
    
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            GoTo Abort_Tran
                        End If
    
                        Out_Cnt = Out_Cnt + 1
                        lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                        DoEvents
    
                        If SYUKA_LOG_ON Then
                            Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
                        End If
    
'                        If Not Fast_Flg Then
'                            Close #DUP_SYUKANo
'                        End If
                    End If
                End If
            End If
        
'#################################################################################### 2008/02/22 Add Å™
        
        
'#################################################################################### 2018/09/19 Add Å´
            If JGYOBU = OVEN Then
                If (IO_KBN = "2" And Trim(HOST_SOKO) = "01" And Trim(YOSAN_FROM) = "SDC" And Trim(AITESAKI_CODE) = "0107") Or _
                    (IO_KBN = "2" And Trim(HOST_SOKO) = "06" And Trim(YOSAN_FROM) = "SDC" And Trim(AITESAKI_CODE) = "0607") Or _
                    (IO_KBN = "2" And Trim(YOSAN_FROM) = "SDC" And Mid(AITESAKI_CODE, 3, 2) = "KA") Then
                            
    
    
                    If Not DUP_FLG Then
    
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        '                    Exit Function      '2015.11.19
                            GoTo Abort_Tran     '2015.11.19
                        End If
                                                        'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                        If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                            GoTo Abort_Tran
                        End If
        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
                        Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                        Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                        Call UniCode_Conv(Y_NYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
                
                
                        Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                        Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                        Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANKA, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                        Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                        Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                        Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                        Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                        Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
        
        
                        Call UniCode_Conv(Y_NYUREC.H_SOKO, " ")
        
        
        
                                            'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                        Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, "9")
        
        
                        Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                        Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                        Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                        Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
        
        
                        Call UniCode_Conv(Y_NYUREC.FILLER, "")
                        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
        
                        Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                        Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                        Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                        
                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_TUK)
                        End If
    
                        Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO2)
    
                        Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
                        
                        Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_GAI)
                            
                        Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                        
                        wkStr = Format(Val(YOTEI_QTY), "0000000")
                        Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
                        Call UniCode_Conv(Y_SYUREC.MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, HOST_SOKO)
                        Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.TANKA, "")
                        
                        
                        Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
                        
                        
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, DEN_DT)

                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")

                        Call UniCode_Conv(Y_SYUREC.MUKE_NAME, SYUK_NAME)

                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_TUK)
                        End If

                        
                        Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CYOK_KBN)

                        Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")

                        Call UniCode_Conv(Y_SYUREC.HIN_NAI, HIN_NAI)
                        Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                        Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                        Call UniCode_Conv(Y_SYUREC.FILLER, "")
    
    
                        Loop_Cnt = 0
    
                        Do
                            sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                    Beep
'                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                    If ans = vbCancel Then
''                                        Exit Function
'                                        GoTo Abort_Tran
'                                    End If
                                
                                
                                    Loop_Cnt = Loop_Cnt + 1
                                    If Loop_Cnt > 5 Then
                                        GoTo Abort_Tran
                                    End If
                                
                                    DoEvents
                                    Sleep (500)
                                
                                Case Else
                                    'Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)            '2016.06.23
                                    Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 1, Y_SYU_ID)   '2016.06.23
'                                    Exit Function
                                    GoTo Abort_Tran
                            End Select
                        Loop
    
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            GoTo Abort_Tran
                        End If
    
                        Out_Cnt = Out_Cnt + 1
                        lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                        DoEvents
    
                        If SYUKA_LOG_ON Then
                            Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
                        End If
    
                    End If
                End If
            End If
        
'#################################################################################### 2018/09/19 Add Å™
        
'#################################################################################### 2018/09/20 Add Å´
            If JGYOBU = SHOKUSEN Then
                If IO_KBN = "2" And Trim(YOSAN_TO) = "904" Then
                            
    
    
                    If Not DUP_FLG Then
    
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        '                    Exit Function      '2015.11.19
                            GoTo Abort_Tran     '2015.11.19
                        End If
                                                        'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                        If Item_Check_Proc(Out_Mode, JGYOBU, NAIGAI_NAI, HIN_GAI, HIN_NAI, HIN_NAME) Then
                            GoTo Abort_Tran
                        End If
        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
                        Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                        Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                        Call UniCode_Conv(Y_NYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_NYUREC.TEXT_NO, TEXT_NO)
                
                
                        Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                        Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
                        Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANKA, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                        Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                        Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                        Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                        Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                        Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, YOSAN_FROM)
                        Call UniCode_Conv(Y_NYUREC.YOSAN_TO, YOSAN_TO)
                        Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_NYUREC.HIN_NAI, HIN_NAI)
        
        
                        Call UniCode_Conv(Y_NYUREC.H_SOKO, " ")
        
        
        
                                            'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                        Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, "9")
        
        
                        Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                        Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                        Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                        Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
        
        
                        Call UniCode_Conv(Y_NYUREC.FILLER, "")
                        
    '-------------------------------------------------------'ì¸â◊ÉfÅ[É^ÇÃÇ›ìoò^Ç∑ÇÈÅiçƒéÊçûÇ›éûÇÃ¡™Ø∏ÇÃÇΩÇﬂÅj
        
                        Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                        Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                        Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                        Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                        
                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN_TUK)
                        End If
    
                        Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO2)
    
                        Call UniCode_Conv(Y_SYUREC.NAIGAI, NAIGAI_NAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_GAI)
                        Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.DATA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.TORI_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, "")
                        Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, "")
                        
                        Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_GAI)
                            
                        Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                        
                        wkStr = Format(Val(YOTEI_QTY), "0000000")
                        Call UniCode_Conv(Y_SYUREC.SURYO, wkStr)
                        Call UniCode_Conv(Y_SYUREC.MUKE_CODE, AITESAKI_CODE)
                        Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, HOST_SOKO)
                        Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, "")
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, DEN_DT)
                        Call UniCode_Conv(Y_SYUREC.TANKA, "")
                        
                        
                        Call UniCode_Conv(Y_SYUREC.ODER_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ITEM_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ODER_NO_R, "")
                        Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, "")
                        
                        
                        
                        Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, DEN_DT)

                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")

                        Call UniCode_Conv(Y_SYUREC.MUKE_NAME, SYUK_NAME)

                        If Trim(HOST_SOKO) = "SS" Then
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_SPO)
                        Else
                            Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_TUK)
                        End If

                        
                        Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN1, "")
                        Call UniCode_Conv(Y_SYUREC.ORIGIN2, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU2, "")
                        Call UniCode_Conv(Y_SYUREC.HAN_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CYOK_KBN)

                        Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, "")
                        Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, "")
                        Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.BIKOU1, "")
                        Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, "")
                        Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                        Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, "")
                        Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, "")
                        Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, "")
                        Call UniCode_Conv(Y_SYUREC.KISHU_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                        Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, "")

                        Call UniCode_Conv(Y_SYUREC.HIN_NAI, HIN_NAI)
                        Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                    StrConv(ITEMREC.ST_DAN, vbUnicode))
                        Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                        Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                        Call UniCode_Conv(Y_SYUREC.FILLER, "")
    
    
                        Loop_Cnt = 0
    
                        Do
                            sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                    Beep
'                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                    If ans = vbCancel Then
''                                        Exit Function
'                                        GoTo Abort_Tran
'                                    End If
                                
                                
                                    Loop_Cnt = Loop_Cnt + 1
                                    If Loop_Cnt > 5 Then
                                        GoTo Abort_Tran
                                    End If
                                
                                    DoEvents
                                    Sleep (500)
                                
                                Case Else
                                    'Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 0)            '2016.06.23
                                    Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË", 1, Y_SYU_ID)   '2016.06.23
'                                    Exit Function
                                    GoTo Abort_Tran
                            End Select
                        Loop
    
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            GoTo Abort_Tran
                        End If
    
                        Out_Cnt = Out_Cnt + 1
                        lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                        DoEvents
    
                        If SYUKA_LOG_ON Then
                            Call SYUKA_LOG_OUT_PROC("INS", "ì¸â◊Ç©ÇÁê∂ê¨")
                        End If
    
                    End If
                End If
            End If
        
'#################################################################################### 2018/09/19 Add Å™
        
        
        
        
        
        End If
        
        
        
    
    Loop

    Nyuka_Update_Proc = False
    Exit Function

Abort_Tran:
    
'>>>>>  2015.11.19
    If Fast_Flg Then
        Open (FileName) For Output As DUP_SYUKANo
        Write #DUP_SYUKANo, , , "ì¸å…éÊçûÇ›àŸèÌÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")  '2015.11.19
        Write #DUP_SYUKANo, "ÉGÉâÅ[ì‡óe", "ì`ï[ì˙ït", "ì`ï[áÇ", "ó\éZå≥", "ó\éZêÊ", "ŒΩƒëqå…", "ïiî‘", "êîó ", "TEXT_NO"      '2015.11.19
        Fast_Flg = False
    End If


    Write #DUP_SYUKANo, "ÅÉèdï°ÅÑ",
    Write #DUP_SYUKANo, DEN_DT,
    Write #DUP_SYUKANo, DEN_NO,
    Write #DUP_SYUKANo, YOSAN_FROM,
    Write #DUP_SYUKANo, YOSAN_TO,
    Write #DUP_SYUKANo, HOST_SOKO,

    Write #DUP_SYUKANo, HIN_GAI,
    Write #DUP_SYUKANo, YOTEI_QTY,
    Write #DUP_SYUKANo, TEXT_NO
'>>>>>  2015.11.19
    
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


    

End Function
    
Private Function Syuka_Update_Proc(JGYOBU As String) As Boolean
'----------------------------------------------------------------------------
'                   Åuèoâ◊ó\íËÉfÅ[É^ÅvçXêVèàóù
'----------------------------------------------------------------------------
Dim i           As Integer
Dim j           As Integer
Dim k           As Integer
Dim Skip_Flg    As Boolean
Dim sts         As Integer
    
Dim ans         As Integer

Dim c               As String * 128

Dim Fast_Flg        As Boolean
Dim DUP_SYUKANo     As Integer
Dim FileName        As String
Dim Ret             As Integer
    
Dim INS_NOW         As String * 14

Dim wkSS            As String
Dim wkMUKE_CODE     As String
Dim wkCHOKU_KBN     As String * 1


Dim wkText          As String
Dim Length      As Integer


Dim JGYOBA              As String * 8       'éñã∆èÍ
Dim DATA_KBN            As String * 1       'ÉfÅ[É^ãÊï™
Dim TORI_KBN            As String * 2       'éÊà¯ãÊï™
Dim ID_NO               As String * 12      'ID-NO
Dim KAIKEI_JGYOBA       As String * 8       'âÔåvópéñã∆èÍ∫∞ƒﬁ
Dim SHISAN_JGYOBA       As String * 8       'éëéYä«óùéñã∆èÍ∫∞ƒﬁ
Dim HIN_NO              As String * 20      'ïiñ⁄î‘çÜ
Dim DEN_NO              As String * 10      'ì`ï[î‘çÜ
Dim SURYO               As String * 7       'èoå…êîó 
Dim MUKE_CODE           As String * 8       'èoå…êÊ
Dim SYUKO_SYUSI         As String * 8       'èoå…é˚éx
Dim SHISAN_SYUSI        As String * 8       'éëéYä«óùópç›å…é˚éx∫∞ƒﬁ
Dim HOJYO_SYUSI         As String * 8       'ï‚èïç›å…é˚éx∫∞ƒﬁ
Dim SYUKO_YMD           As String * 8       'èoå…ì˙ït
Dim TANKA               As String * 10      'íPâø
Dim ODER_NO             As String * 12      'ÉIÅ[É_Å[î‘çÜ
Dim ITEM_NO             As String * 5       'ÉAÉCÉeÉÄî‘çÜ
Dim ODER_NO_R           As String * 5       'ÉIÅ[É_Å[ó™çÜ
Dim KOSO_KEITAI         As String * 14      'å¬ëïå`ë‘       10-->14 2011.10.31
Dim SYUKA_YMD           As String * 8       'èoâ◊ì˙
Dim TANABAN1            As String * 10      'íIî‘ÇP
Dim TANABAN2            As String * 10      'íIî‘ÇQ
Dim TANABAN3            As String * 10      'íIî‘ÇR
Dim MUKE_NAME           As String * 24      'èoå…êÊñºèÃ
Dim CYU_KBN             As String * 1       'íçï∂ãÊï™
Dim CYU_KBN_NAME        As String * 40      'íçï∂ãÊï™ñºèÃ
Dim ORIGIN1             As String * 10      'å¥éYçëÇP
Dim ORIGIN2             As String * 10      'å¥éYçëÇQ
Dim BIKOU2              As String * 40      'îıçlÇQ
Dim HAN_KBN             As String * 1       'îÃîÑãÊï™
Dim CHOKU_KBN           As String * 1       'íºëóãÊï™
Dim UNIT_ID_NO          As String * 12      '’∆ØƒèCóùID-NO
Dim ZAIKO_HIKIATE       As String * 3       'ç›å…à¯ìñèáèò
Dim GOKON_KANRI_NO      As String * 8       'çáç´ä«óùî‘çÜ
Dim JYUCHU_ZAN          As String * 7       'éÛíçécêîó 
Dim KYOKYU_KBN          As String * 1       'ãüãããÊï™
Dim SHOHIN_SYUSI        As String * 8       'è§ïiâªî[ì¸êÊé˚éx
Dim S_SHISAN_SYUSI      As String * 8       'è§ïiâªî[ïiéëéYä«óùé˚éx∫∞ƒﬁ
Dim S_HOJYO_SYUSI       As String * 8       'è§ïiâªî[ïiï‚èïé˚éx∫∞ƒﬁ
Dim BIKOU1              As String * 40      'îıçlÇP
Dim CHOHA_KBN           As String * 1       'í†í[ãÊï™
Dim JYU_HIN_NO          As String * 40      'éÛíçïiñ⁄î‘çÜ
Dim HIN_NAME            As String * 40      'ïiñº
Dim HIN_CHANGE_KBN      As String * 1       'ïiî‘ïœçXãÊï™
Dim MODULE_EXCHANGE     As String * 1       'ÉÇÉWÉÖÅ[Éãåä∑ãÊï™
Dim ZAIKO_SYUSI         As String * 8       'écç›å…Ç‹Ç∆Çﬂç›å…é˚éxÉRÅ[Éh
Dim ZAN_SHISAN_SYUSI    As String * 8       'écç›å…Ç‹Ç∆ÇﬂéëéYä«óùé˚éx∫∞ƒﬁ
Dim ZAN_HOJYO_SYUSI     As String * 8       'écç›å…Ç‹Ç∆Çﬂï‚èïé˚éx∫∞ƒﬁ
Dim NOUKI_YMD           As String * 8       'éwíËî[ä˙
Dim SERVICE_KANRI_NO    As String * 9       'ÉTÅ[ÉrÉXâÔé–ä«óùî‘çÜ
Dim KISHU_CODE          As String * 3       'ã@éÌïiñ⁄ÉRÅ[Éh
Dim ENVIRONMENT_KBN     As String * 1       'ä¬ã´ãKäiïîïiãÊï™
Dim SS_CODE             As String * 8       'íºëóêÊÉRÅ[Éh
Dim KEPIN_KAIJYO        As String * 1       'åáïiâè¡ãÊï™


Dim wkSyukaRec      As wkSyukaRec_tag










Dim Upd_com             As Integer          '2008.02.23

Dim wkTemp              As String


Dim WK_Y_QTY            As Long             '2009.04.14
Dim WK_Qty              As Long             '2009.04.14
Dim WK_E_QTY            As Long             '2009.04.14

Dim WORK_SOKO           As String * 2       '2009.04.14

Dim SUMI_QTY            As Long             '2009.04.14
Dim MI_QTY              As Long             '2009.04.14

'2011.01.19
Dim GENSAN_CNT          As Integer
Dim com                 As Integer
Dim GENSANKOKU          As String * 20

Dim Loop_Cnt            As Integer

'2011.01.19



    Syuka_Update_Proc = True



    Fast_Flg = True

    DUP_SYUKANo = FreeFile
    FileName = DUP_SYUKA_DATA

    Ret = InStr(1, Trim(FileName), ".") - 1
    FileName = Left(Trim(FileName), Ret) & Format(Now, "YYYYMMDDHHMMSS") & "_" & JGYOBU & Right(Trim(FileName), Len(Trim(FileName)) - Ret)


    INS_NOW = Format(Now, "YYYYMMDDHHMMSS")

    Do Until EOF(FileNo)
'        Line Input #FileNo, wkText
        Get #FileNo, , wkSyukaRec
        
        
        
'        If StrConv(wkSyukaRec.CRLF, vbUnicode) <> vbCrLf Then
'            Call NG_File_Make_Proc
'            Exit Do
'        End If
    
        In_Cnt = In_Cnt + 1
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents
    
    
    
'        Length = 1
'        JGYOBA = Mid(wkText, Length, Len(JGYOBA))                   'éñã∆èÍ
        JGYOBA = StrConv(wkSyukaRec.JGYOBA, vbUnicode)
        
        
'        Length = Length + Len(JGYOBA)
'        DATA_KBN = Mid(wkText, Length, Len(DATA_KBN))               'ÉfÅ[É^ãÊï™
        DATA_KBN = StrConv(wkSyukaRec.DATA_KBN, vbUnicode)
        
        
        
'        Length = Length + Len(DATA_KBN)
'        TORI_KBN = Mid(wkText, Length, Len(TORI_KBN))               'éÊà¯ãÊï™
        TORI_KBN = StrConv(wkSyukaRec.TORI_KBN, vbUnicode)
    
'        Length = Length + Len(TORI_KBN)
'        ID_NO = Mid(wkText, Length, Len(ID_NO))                     'ID-NO
        ID_NO = StrConv(wkSyukaRec.ID_NO, vbUnicode)
    
'        Length = Length + Len(ID_NO)
'        KAIKEI_JGYOBA = Mid(wkText, Length, Len(KAIKEI_JGYOBA))     'âÔåvópéñã∆èÍ∫∞ƒﬁ
        KAIKEI_JGYOBA = StrConv(wkSyukaRec.KAIKEI_JGYOBA, vbUnicode)
    
'        Length = Length + Len(KAIKEI_JGYOBA)
'        SHISAN_JGYOBA = Mid(wkText, Length, Len(SHISAN_JGYOBA))     'éëéYä«óùéñã∆èÍ∫∞ƒﬁ
        SHISAN_JGYOBA = StrConv(wkSyukaRec.SHISAN_JGYOBA, vbUnicode)
    
'        Length = Length + Len(SHISAN_JGYOBA)
'        HIN_NO = Mid(wkText, Length, Len(HIN_NO))                   'ïiñ⁄î‘çÜ
        HIN_NO = StrConv(wkSyukaRec.HIN_NO, vbUnicode)
    
'        Length = Length + Len(HIN_NO)
'        DEN_NO = Mid(wkText, Length, Len(DEN_NO))                   'ì`ï[î‘çÜ
        DEN_NO = StrConv(wkSyukaRec.DEN_NO, vbUnicode)
    
'        Length = Length + Len(DEN_NO)
'        SURYO = Mid(wkText, Length, Len(SURYO))                     'èoå…êîó 
        SURYO = StrConv(wkSyukaRec.SURYO, vbUnicode)
    
'        Length = Length + Len(SURYO)
'        MUKE_CODE = Mid(wkText, Length, Len(MUKE_CODE))             'èoå…êÊ
        MUKE_CODE = StrConv(wkSyukaRec.MUKE_CODE, vbUnicode)
    
'        Length = Length + Len(MUKE_CODE)
'        SYUKO_SYUSI = Mid(wkText, Length, Len(SYUKO_SYUSI))         'èoå…é˚éx
        SYUKO_SYUSI = StrConv(wkSyukaRec.SYUKO_SYUSI, vbUnicode)
    
'        Length = Length + Len(SYUKO_SYUSI)
'        SHISAN_SYUSI = Mid(wkText, Length, Len(SHISAN_SYUSI))       'éëéYä«óùópç›å…é˚éx∫∞ƒﬁ
        SHISAN_SYUSI = StrConv(wkSyukaRec.SHISAN_SYUSI, vbUnicode)
    
    
'        Length = Length + Len(SHISAN_SYUSI)
'        HOJYO_SYUSI = Mid(wkText, Length, Len(HOJYO_SYUSI))         'ï‚èïç›å…é˚éx∫∞ƒﬁ
        HOJYO_SYUSI = StrConv(wkSyukaRec.HOJYO_SYUSI, vbUnicode)
        
'        Length = Length + Len(HOJYO_SYUSI)
'        SYUKO_YMD = Mid(wkText, Length, Len(SYUKO_YMD))             'èoå…ì˙ït
        SYUKO_YMD = StrConv(wkSyukaRec.SYUKO_YMD, vbUnicode)
    
'        Length = Length + Len(SYUKO_YMD)
'        TANKA = Mid(wkText, Length, Len(TANKA))                     'íPâø
        TANKA = StrConv(wkSyukaRec.TANKA, vbUnicode)
    
'        Length = Length + Len(TANKA)
'        ODER_NO = Mid(wkText, Length, Len(ODER_NO))                 'ÉIÅ[É_Å[î‘çÜ
        ODER_NO = StrConv(wkSyukaRec.ODER_NO, vbUnicode)
    
'        Length = Length + Len(ODER_NO)
'        ITEM_NO = Mid(wkText, Length, Len(ITEM_NO))                 'ÉAÉCÉeÉÄî‘çÜ
        ITEM_NO = StrConv(wkSyukaRec.ITEM_NO, vbUnicode)
    
'        Length = Length + Len(ITEM_NO)
'        ODER_NO_R = Mid(wkText, Length, Len(ODER_NO_R))             'ÉIÅ[É_Å[ó™çÜ
        ODER_NO_R = StrConv(wkSyukaRec.ODER_NO_R, vbUnicode)
    
'        Length = Length + Len(ODER_NO_R)
'        KOSO_KEITAI = Mid(wkText, Length, Len(KOSO_KEITAI))         'å¬ëïå`ë‘
        KOSO_KEITAI = StrConv(wkSyukaRec.KOSO_KEITAI, vbUnicode)
    
'        Length = Length + Len(KOSO_KEITAI)
'        SYUKA_YMD = Mid(wkText, Length, Len(SYUKA_YMD))             'èoâ◊ì˙
        SYUKA_YMD = StrConv(wkSyukaRec.SYUKA_YMD, vbUnicode)
    
'        Length = Length + Len(SYUKA_YMD)
'        TANABAN1 = Mid(wkText, Length, Len(TANABAN1))               'íIî‘ÇP
        TANABAN1 = StrConv(wkSyukaRec.TANABAN1, vbUnicode)
    
'        Length = Length + Len(TANABAN1)
'        TANABAN2 = Mid(wkText, Length, Len(TANABAN2))               'íIî‘ÇQ
        TANABAN2 = StrConv(wkSyukaRec.TANABAN2, vbUnicode)
    
'        Length = Length + Len(TANABAN2)
'        TANABAN3 = Mid(wkText, Length, Len(TANABAN3))               'íIî‘ÇR
        TANABAN3 = StrConv(wkSyukaRec.TANABAN3, vbUnicode)
    
    
    
    
'        Length = Length + Len(TANABAN3)
'        MUKE_NAME = Mid(wkText, Length, Len(MUKE_NAME))             'èoå…êÊñºèÃ
        MUKE_NAME = StrConv(wkSyukaRec.MUKE_NAME, vbUnicode)
    
            
    
    
    
    
    
    
'        Length = Length + Len(MUKE_NAME)
'        CYU_KBN = Mid(wkText, Length, Len(CYU_KBN))                 'íçï∂ãÊï™
        CYU_KBN = StrConv(wkSyukaRec.CYU_KBN, vbUnicode)
    
    
    
    
    
'        Length = Length + Len(CYU_KBN)
'        CYU_KBN_NAME = Mid(wkText, Length, Len(CYU_KBN_NAME))       'íçï∂ãÊï™ñºèÃ
        CYU_KBN_NAME = StrConv(wkSyukaRec.CYU_KBN_NAME, vbUnicode)
        
        
        
'        Length = Length + Len(CYU_KBN_NAME)
'        ORIGIN1 = Mid(wkText, Length, Len(ORIGIN1))                 'å¥éYçëÇP
        ORIGIN1 = StrConv(wkSyukaRec.ORIGIN1, vbUnicode)
    
'        Length = Length + Len(ORIGIN1)
'        ORIGIN2 = Mid(wkText, Length, Len(ORIGIN2))                 'å¥éYçëÇQ
        ORIGIN2 = StrConv(wkSyukaRec.ORIGIN2, vbUnicode)
    
'        Length = Length + Len(ORIGIN2)
'        BIKOU2 = Mid(wkText, Length, Len(BIKOU2))                   'îıçlÇQ
        BIKOU2 = StrConv(wkSyukaRec.BIKOU2, vbUnicode)
    
'        Length = Length + Len(BIKOU2)
'        HAN_KBN = Mid(wkText, Length, Len(HAN_KBN))                 'îÃîÑãÊï™
        HAN_KBN = StrConv(wkSyukaRec.HAN_KBN, vbUnicode)
    
'        Length = Length + Len(HAN_KBN)
'        CHOKU_KBN = Mid(wkText, Length, Len(CHOKU_KBN))             'íºëóãÊï™
        CHOKU_KBN = StrConv(wkSyukaRec.CHOKU_KBN, vbUnicode)
    
'        Length = Length + Len(CHOKU_KBN)
'        UNIT_ID_NO = Mid(wkText, Length, Len(UNIT_ID_NO))           '’∆ØƒèCóùID-NO
        UNIT_ID_NO = StrConv(wkSyukaRec.UNIT_ID_NO, vbUnicode)
    
'        Length = Length + Len(UNIT_ID_NO)
'        ZAIKO_HIKIATE = Mid(wkText, Length, Len(ZAIKO_HIKIATE))     'ç›å…à¯ìñèáèò
        ZAIKO_HIKIATE = StrConv(wkSyukaRec.ZAIKO_HIKIATE, vbUnicode)
    
'        Length = Length + Len(ZAIKO_HIKIATE)
'        GOKON_KANRI_NO = Mid(wkText, Length, Len(GOKON_KANRI_NO))   'çáç´ä«óùî‘çÜ
        GOKON_KANRI_NO = StrConv(wkSyukaRec.GOKON_KANRI_NO, vbUnicode)
    
'        Length = Length + Len(GOKON_KANRI_NO)
'        JYUCHU_ZAN = Mid(wkText, Length, Len(JYUCHU_ZAN))           'éÛíçécêîó 
        JYUCHU_ZAN = StrConv(wkSyukaRec.JYUCHU_ZAN, vbUnicode)
    
'        Length = Length + Len(JYUCHU_ZAN)
'        KYOKYU_KBN = Mid(wkText, Length, Len(KYOKYU_KBN))           'ãüãããÊï™
        KYOKYU_KBN = StrConv(wkSyukaRec.KYOKYU_KBN, vbUnicode)
    
'        Length = Length + Len(KYOKYU_KBN)
'        SHOHIN_SYUSI = Mid(wkText, Length, Len(SHOHIN_SYUSI))       'è§ïiâªî[ì¸êÊé˚éx
        SHOHIN_SYUSI = StrConv(wkSyukaRec.SHOHIN_SYUSI, vbUnicode)
    
'        Length = Length + Len(SHOHIN_SYUSI)
'        S_SHISAN_SYUSI = Mid(wkText, Length, Len(S_SHISAN_SYUSI))   'è§ïiâªî[ïiéëéYä«óùé˚éx∫∞ƒﬁ
        S_SHISAN_SYUSI = StrConv(wkSyukaRec.S_SHISAN_SYUSI, vbUnicode)
    
'        Length = Length + Len(S_SHISAN_SYUSI)
'        S_HOJYO_SYUSI = Mid(wkText, Length, Len(S_HOJYO_SYUSI))     'è§ïiâªî[ïiï‚èïé˚éx∫∞ƒﬁ
        S_HOJYO_SYUSI = StrConv(wkSyukaRec.S_HOJYO_SYUSI, vbUnicode)
    
'        Length = Length + Len(S_SHISAN_SYUSI)
'        BIKOU1 = Mid(wkText, Length, Len(BIKOU1))                   'îıçlÇP
        BIKOU1 = StrConv(wkSyukaRec.BIKOU1, vbUnicode)
    
'        Length = Length + Len(BIKOU1)
'        CHOHA_KBN = Mid(wkText, Length, Len(CHOHA_KBN))             'í†í[ãÊï™
        CHOHA_KBN = StrConv(wkSyukaRec.CHOHA_KBN, vbUnicode)
    
'        Length = Length + Len(CHOHA_KBN)
'        JYU_HIN_NO = Mid(wkText, Length, Len(JYU_HIN_NO))           'éÛíçïiñ⁄î‘çÜ
        JYU_HIN_NO = StrConv(wkSyukaRec.JYU_HIN_NO, vbUnicode)
    
'        Length = Length + Len(JYU_HIN_NO)
'        HIN_NAME = Mid(wkText, Length, Len(HIN_NAME))               'ïiñº
        HIN_NAME = StrConv(wkSyukaRec.HIN_NAME, vbUnicode)
    
'        Length = Length + Len(HIN_NAME)
'        HIN_CHANGE_KBN = Mid(wkText, Length, Len(HIN_CHANGE_KBN))   'ïiî‘ïœçXãÊï™
        HIN_CHANGE_KBN = StrConv(wkSyukaRec.HIN_CHANGE_KBN, vbUnicode)
    
'        Length = Length + Len(HIN_CHANGE_KBN)
'        MODULE_EXCHANGE = Mid(wkText, Length, Len(MODULE_EXCHANGE)) 'ÉÇÉWÉÖÅ[Éãåä∑ãÊï™
        MODULE_EXCHANGE = StrConv(wkSyukaRec.MODULE_EXCHANGE, vbUnicode)
    
'        Length = Length + Len(MODULE_EXCHANGE)
'        ZAIKO_SYUSI = Mid(wkText, Length, Len(ZAIKO_SYUSI))         'écç›å…Ç‹Ç∆Çﬂç›å…é˚éxÉRÅ[Éh
        ZAIKO_SYUSI = StrConv(wkSyukaRec.ZAIKO_SYUSI, vbUnicode)
    
'        Length = Length + Len(ZAIKO_SYUSI)
'        ZAN_SHISAN_SYUSI = Mid(wkText, Length, Len(ZAN_SHISAN_SYUSI))   'écç›å…Ç‹Ç∆ÇﬂéëéYä«óùé˚éx∫∞ƒﬁ
        ZAN_SHISAN_SYUSI = StrConv(wkSyukaRec.ZAN_SHISAN_SYUSI, vbUnicode)
    
'        Length = Length + Len(ZAN_SHISAN_SYUSI)
'        ZAN_HOJYO_SYUSI = Mid(wkText, Length, Len(ZAN_HOJYO_SYUSI)) 'écç›å…Ç‹Ç∆Çﬂï‚èïé˚éx∫∞ƒﬁ
        ZAN_HOJYO_SYUSI = StrConv(wkSyukaRec.ZAN_HOJYO_SYUSI, vbUnicode)
    
'        Length = Length + Len(ZAN_HOJYO_SYUSI)
'        NOUKI_YMD = Mid(wkText, Length, Len(NOUKI_YMD))             'éwíËî[ä˙
        NOUKI_YMD = StrConv(wkSyukaRec.NOUKI_YMD, vbUnicode)
    
'        Length = Length + Len(NOUKI_YMD)
'        SERVICE_KANRI_NO = Mid(wkText, Length, Len(SERVICE_KANRI_NO))   'ÉTÅ[ÉrÉXâÔé–ä«óùî‘çÜ
        SERVICE_KANRI_NO = StrConv(wkSyukaRec.SERVICE_KANRI_NO, vbUnicode)
    
'        Length = Length + Len(SERVICE_KANRI_NO)
'        KISHU_CODE = Mid(wkText, Length, Len(KISHU_CODE))           'ã@éÌïiñ⁄ÉRÅ[Éh
        KISHU_CODE = StrConv(wkSyukaRec.KISHU_CODE, vbUnicode)
    
'        Length = Length + Len(KISHU_CODE)
'        ENVIRONMENT_KBN = Mid(wkText, Length, Len(ENVIRONMENT_KBN)) 'ä¬ã´ãKäiïîïiãÊï™
        ENVIRONMENT_KBN = StrConv(wkSyukaRec.ENVIRONMENT_KBN, vbUnicode)
    
'        Length = Length + Len(ENVIRONMENT_KBN)
'        SS_CODE = Mid(wkText, Length, Len(SS_CODE))                 'íºëóêÊÉRÅ[Éh
        SS_CODE = StrConv(wkSyukaRec.SS_CODE, vbUnicode)
    
'        Length = Length + Len(SS_CODE)
'        KEPIN_KAIJYO = Mid(wkText, Length, Len(KEPIN_KAIJYO))       'åáïiâè¡ãÊï™
        KEPIN_KAIJYO = StrConv(wkSyukaRec.KEPIN_KAIJYO, vbUnicode)
        
If ID_NO = "700092591973" Then
     Debug.Print ID_NO
End If
        
        Skip_Flg = True
        For i = 0 To UBound(JGYOBU_T)               'é˚éxãÊï™ÇÃÉ`ÉFÉbÉN
            If JGYOBU = JGYOBU_T(i).CODE Then
                For j = 0 To UBound(Soko_T, 2)
                    If Trim(SYUKO_SYUSI) = Trim(Soko_T(i, j).HS_SOKO) Then
                        Skip_Flg = False
                        Exit For
                    End If
                Next j
                Exit For
            End If
        Next i
    
'-------------------------- PPSCéÊÇËçûÇ›ÇÊÇË
        If Trim(CYU_KBN) = "" Then
            wkCHOKU_KBN = ""
        Else
            wkCHOKU_KBN = "1"
        End If
                                                                                                
                                                        
        If Trim(CYU_KBN) = "" Then
            If Trim(MUKE_CODE) = "A1" Or _
                Trim(MUKE_CODE) = "A2" Or _
                Trim(MUKE_CODE) = "A3" Or _
                Trim(MUKE_CODE) = "A4" Or _
                Trim(MUKE_CODE) = "A5" Or _
                Trim(MUKE_CODE) = "A6" Or _
                Trim(MUKE_CODE) = "A7" Then
                CYU_KBN = "3"
            End If
        
            If MUKE_CODE = "22000440" Or _
                MUKE_CODE = "22000441" Or _
                MUKE_CODE = "22000442" Or _
                MUKE_CODE = "22000443" Or _
                MUKE_CODE = "22000444" Or _
                MUKE_CODE = "22000445" Or _
                MUKE_CODE = "22000446" Then
                CYU_KBN = "2"
            End If
        
        End If
                                                        
        If Trim(CYU_KBN) = "" Then
            CYU_KBN = "3"
        End If
    
'-------------------------- PPSCéÊÇËçûÇ›ÇÊÇË
    
    
    
    
    
    
    
    
        'Åu00036003ÅvÇÃëŒâû2006.06.03
    
        'If JGYOBU = AIRCON Then                        'ÉGÉAÉRÉìÇÕèúäO 2006.11.10
'        If JGYOBU = AIRCON Or JGYOBU = OVEN Then        'ÉGÉAÉRÉìÅAìdéqÉåÉìÉWÇÕèúäO 2011.05.16
        
        If JGYOBU = AIRCON Or JGYOBU = OVEN Or JGYOBU = REIZOU Or JGYOBU = SHOKUSEN Then         'ÉGÉAÉRÉìÅAìdéqÉåÉìÉWÇÕèúäO 2011.05.16 ó‚ë†å…í«â¡ 2014.12.17 êHêÙ 2015.03.03
        Else
            If Trim(MUKE_CODE) = "00036003" Then
                Skip_Flg = True
            End If
        End If
    
        If Not Skip_Flg Then
                                'èoâ◊ó\íËèdï°É`ÉFÉbÉN
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, JGYOBU)
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_NO)
    
    
            sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
            Select Case sts
                Case BtNoErr
                    Call LOG_OUT(LOG_F, "Y_SYUKA.DAT DUP éñã∆ïî=" & JGYOBU & "ì`ï[ÇhÇcÅÅ" & StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode))
'                    Skip_Flg = True
                
                
                    If Fast_Flg Then
                        Open (FileName) For Output As DUP_SYUKANo
'                        Write #DUP_SYUKANo, , , "èoâ◊èdï°ÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS") '2015.11.19
                        Write #DUP_SYUKANo, , , "èoâ◊éÊçûÇ›àŸèÌÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")  '2015.11.19
'                        Write #DUP_SYUKANo, "èoâ◊ì˙", "ì`ï[áÇ", "éxï•êÊ∫∞ƒﬁ", "ëqå…/ÇrÇr∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"                  '2015.11.19
                        Write #DUP_SYUKANo, "ÉGÉâÅ[ì‡óe", "èoâ◊ì˙", "ì`ï[áÇ", "èoâ◊êÊ∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"      '2015.11.19
                        Fast_Flg = False
                    End If
                
                
                    Write #DUP_SYUKANo, "ÅÉèdï°ÅÑ",
                    Write #DUP_SYUKANo, SYUKA_YMD,
                    Write #DUP_SYUKANo, DEN_NO,
                    Write #DUP_SYUKANo, MUKE_CODE,
                    Write #DUP_SYUKANo, MUKE_NAME,
                    Write #DUP_SYUKANo, CYU_KBN,
                    Write #DUP_SYUKANo, CYU_KBN_NAME,
                    Write #DUP_SYUKANo, HIN_NO,
                    Write #DUP_SYUKANo, SURYO,
                    Write #DUP_SYUKANo, ID_NO
                
                    Upd_com = BtOpUpdate
                
                Case BtErrKeyNotFound
                    Upd_com = BtOpInsert
                Case Else
'                    Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË", 0)                      '2016.06.23
                    Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË", 1, Y_SYU_ID)             '2016.06.23
                    Exit Function
            End Select
    
    
    
    
            
            If Not Skip_Flg Then
                
                                'ïiñ⁄É}ÉXÉ^ÇÃÉ`ÉFÉbÉN
'                Call UniCode_Conv(K0_ITEM.JGYOBU, JGYOBU)
'                Call UniCode_Conv(K0_ITEM.NAIGAI, Soko_T(i, j).NAIGAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(HS_OUT_SIJREC.HIN_NO, vbUnicode))
'
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                Select Case sts
'                    Case BtNoErr
'                    Case BtErrKeyNotFound
'                        Skip_Flg = True
'                        Call Log_Out(LOG_F, "ì`ï[ID=" & StrConv(HS_OUT_SIJREC.ID_NO, vbUnicode))
'                    Case Else
'                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
'                        Exit Function
'                End Select
                
                
                
                If Not Skip_Flg Then
                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    If sts <> BtNoErr Then
                        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                        Exit Function
                    End If
                    
                    
                                                'ïiñ⁄É}ÉXÉ^É`ÉFÉbÉN
                    If Item_Check_Proc(Out_Mode, JGYOBU, Soko_T(i, j).NAIGAI, HIN_NO, , HIN_NAME) Then
                        GoTo Abort_Tran
                    End If
                    '2012.12.20
                    If StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "0" And StrConv(ITEMREC.GOODS_KBN, vbUnicode) <> "1" Then
                        Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_F)
                    End If
                    '2012.12.20
                                                                    
                    wkMUKE_CODE = MUKE_CODE
                                                                    
                                                                    
                    If Len(Trim(SS_CODE)) = 0 Or _
                        IsNumeric(Trim(SS_CODE)) Then
                    Else
                        SS_CODE = ""
                    End If
                                                                    
                                                                    
'-----------    2005.12.30
                    If JGYOBU = AIRCON Then
                        
                        'MTS∫∞ƒﬁÇÃì«Ç›ë÷Ç¶
                        If GetIni(App.EXEName, StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode), App.EXEName, c) Then
                        Else
                            Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, Trim(c))
                            Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
                        End If
                        
                        
                        
                        
                        'ÉGÉAÉRÉìÇæÇ¡ÇΩèÍçáå¸ÇØêÊÇ…íºëóêÊÇæØƒ  2004.12.01
                        
                        If Trim(MUKE_CODE) = Trim(SS_CODE) Then
                            SS_CODE = ""
                        Else
                            If Len(Trim(SS_CODE)) <> 0 Then
                                MUKE_CODE = SS_CODE
                                SS_CODE = ""
                            End If
                        End If
                    Else
                        
                        'êÙëÛã@ÇÃèÍçáÅAîıçlÇPÇíºëóêÊÇ…ÉZÉbÉg 2006.03.25
                        If JGYOBU = SENTAKU And SYUKO_SYUSI = "S2" Then
                            If StrComp(ODER_NO, "FAX", vbTextCompare) Then
                            
                                wkSS = ""
                            
                                For k = 1 To Len(BIKOU1)
                                    If IsNumeric(Mid(BIKOU1, k, 1)) Then
                                        wkSS = wkSS & Mid(BIKOU1, k, 1)
                                    Else
                                        Exit For
                                    End If
                                Next k
                            
                                SS_CODE = wkSS
                            End If
                        
                        End If
                        
                        
                        
                        'ëºÇÃéñã∆ïîÇÕåªèÛÇÃÇ‹Ç‹
                        If Len(Trim(SS_CODE)) = 0 Or _
                            IsNumeric(Trim(SS_CODE)) Then
                        Else
                            SS_CODE = ""
                        End If
                    End If
                        
                    Call UniCode_Conv(K0_MTS.MUKE_CODE, MUKE_CODE)
                    Call UniCode_Conv(K0_MTS.SS_CODE, SS_CODE)
                             
                             
                    sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrKeyNotFound
                            
                            
                            
                            If JGYOBU = AIRCON Then
                                'ÉGÉAÉRÉìÇæÇ¡ÇΩèÍçáå¸ÇØêÊÇ…íºëóêÊÇ≈å¸ÇØêÊœΩ¿ÇêVãKçÏê¨  2004.12.01
                            
                                Call UniCode_Conv(MTSREC.NAIGAI, Soko_T(i, j).NAIGAI)
                                Call UniCode_Conv(MTSREC.DATA_KBN, "")
                                Call UniCode_Conv(MTSREC.MUKE_CODE, MUKE_CODE)
                                Call UniCode_Conv(MTSREC.SS_CODE, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, MUKE_NAME)
                                Call UniCode_Conv(MTSREC.SS_NAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, MUKE_NAME)
                                Call UniCode_Conv(MTSREC.DISPLAY_RANKING, "")
                                Call UniCode_Conv(MTSREC.FILLER, "")
                                
                                Loop_Cnt = 0
                                
                                
                                Do
                                    sts = BTRV(BtOpInsert, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                            Beep
'                                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<MTS.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                            If ans = vbCancel Then
'                                                Exit Function
'                                            End If
                                        
                                        
                                        
                                            Loop_Cnt = Loop_Cnt + 1
                                            If Loop_Cnt > 5 Then
                                                GoTo Abort_Tran
                                            End If
                                        
                                            DoEvents
                                            Sleep (500)
                                       
                                        
                                        
                                        Case Else
                                            'Call File_Error(sts, BtOpInsert, "å¸ÇØêÊä«óùœΩ¿" & "key=" & StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode) & "-" & StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode), 0)                      '2016.06.23
                                            Call File_Error(sts, BtOpInsert, "å¸ÇØêÊä«óùœΩ¿" & "key=" & StrConv(HS_OUT_SIJREC.MUKE_CODE, vbUnicode) & "-" & StrConv(HS_OUT_SIJREC.SS_CODE, vbUnicode), 1, MTS_ID)               '2016.06.23

'                                            Exit Function      '2015.11.19
                                            GoTo Abort_Tran     '2015.11.19
                                    End Select
                                Loop
                                                        
                                                        
                                                        
                                                        
                            
                            Else
                                'ëºÇÃéñã∆ïîÇÕåªèÛÇÃÇ‹Ç‹
                                If Soko_T(i, j).NAIGAI = NAIGAI_NAI Then
                                    Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_NAI)
                                    Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
                                Else
                                    Call UniCode_Conv(HS_OUT_SIJREC.MUKE_CODE, ETC_MTS_GAI)
                                    Call UniCode_Conv(HS_OUT_SIJREC.SS_CODE, "")
                                End If
                            End If
                            
                        
                        Case Else
                            'Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 0)                      '2016.06.23
                            Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 1, MTS_ID)               '2016.06.23
'                            Exit Function      '2015.11.19
                            GoTo Abort_Tran     '2015.11.19
                    End Select
                                                                    
                                                                    
                                    
                    If HAN_KBN = "2" Then
                        CYU_KBN = "E"
                    
                    
                    End If
                    'íçï∂ãÊï™ÅÅ6ÇÕÇQÇ…
                    If JGYOBU = SENTAKU And SYUKO_SYUSI = "S2" Then
                        
                        If CYU_KBN = "6" Then
                            CYU_KBN = "2"
                        
                        
                        End If
                    End If
                    
                    
                    'íçï∂ãÊï™ëŒè€äOÇÕ1Ç∆Ç∑ÇÈ
                    If CYU_KBN = "1" Or _
                        CYU_KBN = "2" Or _
                        CYU_KBN = "3" Or _
                        CYU_KBN = "E" Then
                    Else
            
                        CYU_KBN = "1"
                    End If
                    
                    
                    
                    Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                    Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                    Call UniCode_Conv(Y_SYUREC.JGYOBU, JGYOBU)
                    
                    
                                        
                    Call UniCode_Conv(Y_SYUREC.KEY_CYU_KBN, CYU_KBN)
                    
                    Call UniCode_Conv(Y_SYUREC.KEY_ID_NO, ID_NO)
                    
                    Call UniCode_Conv(Y_SYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
                    Call UniCode_Conv(Y_SYUREC.KEY_HIN_NO, HIN_NO)
                    Call UniCode_Conv(Y_SYUREC.KEY_MUKE_CODE, MUKE_CODE)
                    Call UniCode_Conv(Y_SYUREC.KEY_SS_CODE, SS_CODE)
                    Call UniCode_Conv(Y_SYUREC.KEY_SYUKA_YMD, SYUKA_YMD)
                    
                    Call UniCode_Conv(Y_SYUREC.JGYOBA, JGYOBA)
                    Call UniCode_Conv(Y_SYUREC.DATA_KBN, DATA_KBN)
                    Call UniCode_Conv(Y_SYUREC.TORI_KBN, TORI_KBN)
                    Call UniCode_Conv(Y_SYUREC.ID_NO, ID_NO)
                    Call UniCode_Conv(Y_SYUREC.KAIKEI_JGYOBA, KAIKEI_JGYOBA)
                    Call UniCode_Conv(Y_SYUREC.SHISAN_JGYOBA, SHISAN_JGYOBA)
                    
                    Call UniCode_Conv(Y_SYUREC.HIN_NO, HIN_NO)
                    Call UniCode_Conv(Y_SYUREC.DEN_NO, DEN_NO)
                    Call UniCode_Conv(Y_SYUREC.SURYO, SURYO)
                    Call UniCode_Conv(Y_SYUREC.MUKE_CODE, MUKE_CODE)
                    Call UniCode_Conv(Y_SYUREC.SYUKO_SYUSI, SYUKO_SYUSI)
                    
                    Call UniCode_Conv(Y_SYUREC.SHISAN_SYUSI, SHISAN_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.HOJYO_SYUSI, HOJYO_SYUSI)
                    
                    Call UniCode_Conv(Y_SYUREC.SYUKO_YMD, SYUKA_YMD)
                    Call UniCode_Conv(Y_SYUREC.TANKA, TANKA)
                    Call UniCode_Conv(Y_SYUREC.ODER_NO, ODER_NO)
                    Call UniCode_Conv(Y_SYUREC.ITEM_NO, ITEM_NO)
                    Call UniCode_Conv(Y_SYUREC.ODER_NO_R, ODER_NO_R)
                    '20011.10.31
                    Call UniCode_Conv(Y_SYUREC.KOSO_KEITAI, Left(KOSO_KEITAI, 10))
                    Call UniCode_Conv(Y_SYUREC.SYUKA_YMD, SYUKA_YMD)
                    
                    
                    If TANA_SPACE Then
                    
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, "")
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, "")
                        
                    Else
                        Call UniCode_Conv(Y_SYUREC.TANABAN1, TANABAN1)
                        Call UniCode_Conv(Y_SYUREC.TANABAN2, TANABAN2)
                        Call UniCode_Conv(Y_SYUREC.TANABAN3, TANABAN3)
                    End If
                    Call UniCode_Conv(Y_SYUREC.MUKE_NAME, MUKE_NAME)
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN)
                    Call UniCode_Conv(Y_SYUREC.CYU_KBN_NAME, CYU_KBN_NAME)
                    Call UniCode_Conv(Y_SYUREC.ORIGIN1, ORIGIN1)
                    Call UniCode_Conv(Y_SYUREC.ORIGIN2, ORIGIN2)
                    Call UniCode_Conv(Y_SYUREC.BIKOU2, BIKOU2)
                    Call UniCode_Conv(Y_SYUREC.HAN_KBN, HAN_KBN)
                    
                    Call UniCode_Conv(Y_SYUREC.CHOKU_KBN, CHOKU_KBN)
                    
    
                    Call UniCode_Conv(Y_SYUREC.UNIT_ID_NO, UNIT_ID_NO)
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_HIKIATE, ZAIKO_HIKIATE)
                    
                    Call UniCode_Conv(Y_SYUREC.GOKON_KANRI_NO, GOKON_KANRI_NO)
                    Call UniCode_Conv(Y_SYUREC.JYUCHU_ZAN, JYUCHU_ZAN)
                    Call UniCode_Conv(Y_SYUREC.KYOKYU_KBN, KYOKYU_KBN)
                    Call UniCode_Conv(Y_SYUREC.SHOHIN_SYUSI, SHOHIN_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.S_SHISAN_SYUSI, S_SHISAN_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.S_HOJYO_SYUSI, S_HOJYO_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.BIKOU1, BIKOU1)
                    Call UniCode_Conv(Y_SYUREC.CHOHA_KBN, CHOHA_KBN)
                    Call UniCode_Conv(Y_SYUREC.JYU_HIN_NO, JYU_HIN_NO)
                    Call UniCode_Conv(Y_SYUREC.HIN_NAME, HIN_NAME)
                    Call UniCode_Conv(Y_SYUREC.HIN_CHANGE_KBN, HIN_CHANGE_KBN)
                    Call UniCode_Conv(Y_SYUREC.MODULE_EXCHANGE, MODULE_EXCHANGE)
                    
                    Call UniCode_Conv(Y_SYUREC.ZAIKO_SYUSI, ZAIKO_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.ZAN_SHISAN_SYUSI, ZAN_SHISAN_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.ZAN_HOJYO_SYUSI, ZAN_HOJYO_SYUSI)
                    Call UniCode_Conv(Y_SYUREC.NOUKI_YMD, NOUKI_YMD)
                    Call UniCode_Conv(Y_SYUREC.SERVICE_KANRI_NO, SERVICE_KANRI_NO)
                    Call UniCode_Conv(Y_SYUREC.KISHU_CODE, KISHU_CODE)
                    
                    Call UniCode_Conv(Y_SYUREC.ENVIRONMENT_KBN, ENVIRONMENT_KBN)
                    
                    Call UniCode_Conv(Y_SYUREC.SS_CODE, SS_CODE)
                    
                    Call UniCode_Conv(Y_SYUREC.KEPIN_KAIJYO, KEPIN_KAIJYO)
                    Call UniCode_Conv(Y_SYUREC.HIN_NAI, "")
                    
                    Call UniCode_Conv(Y_SYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                    
                    Call UniCode_Conv(Y_SYUREC.INS_NOW, INS_NOW)
                    
                    
                    If Upd_com = BtOpInsert Then    '2008.02.23
                        Call UniCode_Conv(Y_SYUREC.PRINT_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                        Call UniCode_Conv(Y_SYUREC.TOK_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                        
                        
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, "")       '2006.07.20
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, "")              '2006.07.20
                        Call UniCode_Conv(Y_SYUREC.LK_MUKE_CODE, wkMUKE_CODE)   '2006.07.20
                        Call UniCode_Conv(Y_SYUREC.LK_SEQ_NO, "")               '2006.07.20
                        
                        
                        Call UniCode_Conv(Y_SYUREC.G_KENPIN_F, "")              '2006.09.07
                        Call UniCode_Conv(Y_SYUREC.KENPIN_SURYO, "")            '2006.09.07
                        
                        Call UniCode_Conv(Y_SYUREC.H_IO_KBN, "")
                        Call UniCode_Conv(Y_SYUREC.H_SOKO_CODE, "")
                        
                        
                        Call UniCode_Conv(Y_SYUREC.FILLER, "")
                    End If
            
                    Loop_Cnt = 0
    
                    Do
'                        sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                        sts = BTRV(Upd_com, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_SYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    GoTo Abort_Tran
'                                End If
                            
                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    GoTo Abort_Tran
                                End If
                            
                                DoEvents
                                Sleep (500)
                            
                            
                            
                            Case BtErrDEAD_LOCK
                                GoTo Abort_Tran
                            Case Else
'                                Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË")
                                'Call File_Error(sts, Upd_com, "èoâ◊ó\íË", 0)                           '2016.06.23
                                Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË", 1, Y_SYU_ID)             '2016.06.23
                                GoTo Abort_Tran
                        End Select
                    Loop
    
                    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    If sts <> BtNoErr Then
                        GoTo Abort_Tran
                    End If
        
        
        
        
                    Out_Cnt = Out_Cnt + 1
                    lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
                    DoEvents
        
        
        
        
        
        
        
                    If SYUKA_LOG_ON Then
                        Call SYUKA_LOG_OUT_PROC("INS", "AFT")
                    End If
                
                
                
                    'ì¸â◊êUë÷   2009.04.14
                    If Trim(StrConv(Y_SYUREC.MUKE_CODE, vbUnicode)) = "G11" Or Trim(StrConv(Y_SYUREC.MUKE_CODE, vbUnicode)) = "G22" Then
                        
                        
                        
                        
                        
                        ' "00023410"Çí«â¡ 2009.06.25 "00021397"Çí«â¡Å@2012.04.06
                        If (Trim(StrConv(Y_SYUREC.JGYOBA, vbUnicode)) = "00023510" Or Trim(StrConv(Y_SYUREC.JGYOBA, vbUnicode)) = "00023410" Or Trim(StrConv(Y_SYUREC.JGYOBA, vbUnicode)) = "00021397") Then
                            If Trim(StrConv(Y_SYUREC.DATA_KBN, vbUnicode)) = "7" Then
                                If Trim(StrConv(Y_SYUREC.TORI_KBN, vbUnicode)) = "19" Then
'                                    If Trim(StrConv(Y_SYUREC.SYUKO_SYUSI, vbUnicode)) = "00" Or _
'                                        Trim(StrConv(Y_SYUREC.SYUKO_SYUSI, vbUnicode)) = "01" Or _
'                                        Trim(StrConv(Y_SYUREC.SYUKO_SYUSI, vbUnicode)) = "07" Or _
'                                        Trim(StrConv(Y_SYUREC.SYUKO_SYUSI, vbUnicode)) = "08" Then
                                                                    'ì¸â◊ÉfÅ[É^çÏê¨
                                        Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_FIN)
                                        Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                                        Call UniCode_Conv(Y_NYUREC.JGYOBU, JGYOBU)
                                        Call UniCode_Conv(Y_NYUREC.NAIGAI, Soko_T(i, j).NAIGAI)
                                        Call UniCode_Conv(Y_NYUREC.TEXT_NO, Right(ID_NO, 9))
                                
                                
                                        Call UniCode_Conv(Y_NYUREC.JGYOBA, "")
                                        Call UniCode_Conv(Y_NYUREC.DATA_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.TORI_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.ID_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.HIN_NO, HIN_NO)
                                        Call UniCode_Conv(Y_NYUREC.DEN_NO, DEN_NO)
                                        Call UniCode_Conv(Y_NYUREC.SURYO, Format(CLng(SURYO), "0000000"))
                                        Call UniCode_Conv(Y_NYUREC.MUKE_CODE, "")
                                        Call UniCode_Conv(Y_NYUREC.SYUKO_SYUSI, "")
                                        Call UniCode_Conv(Y_NYUREC.SYUKO_YMD, SYUKA_YMD)
                                        Call UniCode_Conv(Y_NYUREC.TANKA, "")
                                        Call UniCode_Conv(Y_NYUREC.ODER_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.ITEM_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.ODER_NO_R, "")
                                        Call UniCode_Conv(Y_NYUREC.KOSO_KEITAI, "")
                                        Call UniCode_Conv(Y_NYUREC.SYUKA_YMD, SYUKA_YMD)
                                        Call UniCode_Conv(Y_NYUREC.TANABAN1, "")
                                        Call UniCode_Conv(Y_NYUREC.TANABAN2, "")
                                        Call UniCode_Conv(Y_NYUREC.TANABAN3, "")
                                        Call UniCode_Conv(Y_NYUREC.MUKE_NAME, "")
                                        Call UniCode_Conv(Y_NYUREC.CYU_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.CYU_KBN_NAME, "")
                                        Call UniCode_Conv(Y_NYUREC.ORIGIN1, "")
                                        Call UniCode_Conv(Y_NYUREC.ORIGIN2, "")
                                        Call UniCode_Conv(Y_NYUREC.BIKOU2, "")
                                        Call UniCode_Conv(Y_NYUREC.HAN_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.CHOKU_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.UNIT_ID_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.ZAIKO_HIKIATE, "")
                                        Call UniCode_Conv(Y_NYUREC.GOKON_KANRI_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.JYUCHU_ZAN, "")
                                        Call UniCode_Conv(Y_NYUREC.KYOKYU_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.SHOHIN_SYUSI, "")
                                        Call UniCode_Conv(Y_NYUREC.BIKOU1, "")
                                        Call UniCode_Conv(Y_NYUREC.CHOHA_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.JYU_HIN_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.HIN_NAME, HIN_NAME)
                                        Call UniCode_Conv(Y_NYUREC.HIN_CHANGE_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.MODULE_EXCHANGE, "")
                                        Call UniCode_Conv(Y_NYUREC.ZAIKO_SYUSI, "")
                                        Call UniCode_Conv(Y_NYUREC.NOUKI_YMD, "")
                                        Call UniCode_Conv(Y_NYUREC.SERVICE_KANRI_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.KI_HIN_NO, "")
                                        Call UniCode_Conv(Y_NYUREC.ENVIRONMENT_KBN, "")
                                        Call UniCode_Conv(Y_NYUREC.KAN_DT, Format(Now, "YYYYMMDD"))
                                
                                
                                        Last_Proc_F = True              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇË
                                
                                
                                        'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
                                        Call UniCode_Conv(K0_J_NYU.JGYOBU, JGYOBU)
                                        Call UniCode_Conv(K0_J_NYU.NAIGAI, Soko_T(i, j).NAIGAI)
                                        Call UniCode_Conv(K0_J_NYU.HIN_GAI, HIN_NO)
                            
                                        WK_Y_QTY = CLng(SURYO)
                            
                            
                                        Loop_Cnt = 0
                                        
                                        Do
                                            sts = BTRV(BtOpGetEqual + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                            Select Case sts
                                                Case BtNoErr
                                                    If CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) > WK_Y_QTY Then
                                                        WK_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) - WK_Y_QTY
                                                        Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(WK_Qty, "00000000"))
                                                
                                                        Loop_Cnt = 0
                                                        
                                                        Do
                                                        
                                                            sts = BTRV(BtOpUpdate, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                                            Select Case sts
                                                                Case BtNoErr
                                                                    Exit Do
                                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                                                    Beep
'                                                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                                                    If ans = vbCancel Then
'                                                                        Exit Function
'                                                                    End If
                                                                
                                                                
                                                                    Loop_Cnt = Loop_Cnt + 1
                                                                    If Loop_Cnt > 5 Then
                                                                        GoTo Abort_Tran
                                                                    End If
                                                                
                                                                    DoEvents
                                                                    Sleep (500)
                                                                
                                                                
                                                                
                                                                Case BtErrDEAD_LOCK
                                                                    'Exit Function          '2015.11.19
                                                                    GoTo Abort_Tran         '2015.11.19
                                                                Case Else
                                                                    'Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)                        '2016.06.23
                                                                    Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)               '2016.06.23
                                                                    'Exit Function          '2015.11.19
                                                                    GoTo Abort_Tran         '2015.11.19
                                                            End Select
                                                        
                                                        Loop
                                                        WK_E_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                    Else
                                                        
                                                        Loop_Cnt = 0
                                                        Do
                                                            sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
                                                            Select Case sts
                                                                Case BtNoErr
                                                                    Exit Do
                                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                                                    Beep
'                                                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                                                    If ans = vbCancel Then
'                                                                        Exit Function
'                                                                    End If
                                                                
                                                                
                                                                    Loop_Cnt = Loop_Cnt + 1
                                                                    If Loop_Cnt > 5 Then
                                                                        GoTo Abort_Tran
                                                                    End If
                                                                
                                                                    DoEvents
                                                                    Sleep (500)
                                                                
                                                                
                                                                Case BtErrDEAD_LOCK
                                                                    
                                                                    'Exit Function      '2015.11.19
                                                                    GoTo Abort_Tran     '2015.11.19
                                                            Case Else
                                                                    'Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)                        '2016.06.23
                                                                    Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)               '2016.06.23
                                                                    'Exit Function
                                                                    GoTo Abort_Tran     '2015.11.19
                                                            End Select
                                                        Loop
                                                        WK_E_QTY = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
                                                    End If
                                            
                                                    Exit Do
                                                Case BtErrKeyNotFound
                                                    WK_E_QTY = 0
                                                    Exit Do
                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                                    Beep
'                                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                                    If ans = vbCancel Then
'                                                        Exit Function
'                                                   End If
                                                
                                                
                                                    Loop_Cnt = Loop_Cnt + 1
                                                    If Loop_Cnt > 5 Then
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                    DoEvents
                                                    Sleep (500)
                                               
                                                
                                                Case BtErrDEAD_LOCK
                                                    'Exit Function      '2015.11.19
                                                    GoTo Abort_Tran     '2015.11.19
                                                Case Else
                                                    'Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿", 0)                  '2016.06.23
                                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿", 1, J_NYU_ID)         '2016.06.23
                                                    'Exit Function      '2015.11.19
                                                    GoTo Abort_Tran     '2015.11.19
                                            End Select
                                        Loop
                                                            'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
                                        Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, Format(WK_E_QTY, "00000000"))
                                
                                                            'ó\éZíPà å≥
                                        Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, StrConv(Y_SYUREC.KEY_MUKE_CODE, vbUnicode))
                                                            'ó\éZíPà êÊ
                                        Call UniCode_Conv(Y_NYUREC.YOSAN_TO, "")
                                                            'ïWèÄíIî‘
                                        Call UniCode_Conv(Y_NYUREC.HTANABAN, StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                                                                StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                                                                StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                                                                StrConv(ITEMREC.ST_DAN, vbUnicode))
                                        Call UniCode_Conv(Y_NYUREC.HIN_NAI, "")
                                                            'Hëqå… 2006.10.17
                                        Call UniCode_Conv(Y_NYUREC.H_SOKO, StrConv(Y_SYUREC.SYUKO_SYUSI, vbUnicode))
                        
                                                            'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
                                        Call UniCode_Conv(Y_NYUREC.NYU_LIST_OUT, " ")
                        
                                        
                                        
                                
'                If Trim(ORIGIN1) = "" Then
                
'''2011.01.19
'''                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode))
                    
                    
                    
                    
                    Call UniCode_Conv(K0_GENSAN.JGYOBU, JGYOBU)
                    Call UniCode_Conv(K0_GENSAN.NAIGAI, Soko_T(i, j).NAIGAI)
                    Call UniCode_Conv(K0_GENSAN.HIN_GAI, HIN_NO)
                    Call UniCode_Conv(K0_GENSAN.GENSANKOKU, "")


                    com = BtOpGetGreaterEqual
                    
                    GENSAN_CNT = 0
                    
                    
                    GENSANKOKU = ""
                    
                    Do
                        DoEvents
                    
                        sts = BTRV(com, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
                        Select Case sts
                            Case BtNoErr
                            
                                If StrConv(GENSANREC.JGYOBU, vbUnicode) <> StrConv(Y_NYUREC.JGYOBU, vbUnicode) Or _
                                    StrConv(GENSANREC.NAIGAI, vbUnicode) <> StrConv(Y_NYUREC.NAIGAI, vbUnicode) Or _
                                    StrConv(GENSANREC.HIN_GAI, vbUnicode) <> StrConv(Y_NYUREC.HIN_NO, vbUnicode) Then
                                    Exit Do
                                End If
                            
                            
                                GENSAN_CNT = GENSAN_CNT + 1
                                If GENSAN_CNT > 1 Then
                                    GENSANKOKU = ""
                                    Exit Do
                                End If
                            
                            
                                GENSANKOKU = StrConv(GENSANREC.GENSANKOKU, vbUnicode)
                            
                            Case BtErrEOF
                                Exit Do
                            
                            Case Else
                                'Call File_Error(sts, com, "å¥éYçëÉ}ÉXÉ^", 0)               '2016.06.23
                                Call File_Error(sts, com, "å¥éYçëÉ}ÉXÉ^", 1, GENSAN_ID)     '2016.06.23
                                'Exit Function      '2015.11.19
                                GoTo Abort_Tran     '2015.11.19
                        End Select
                    
                        com = BtOpGetNext
                                    
                    Loop
                    
                    
                    
                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, "")
                    If GENSAN_CNT = 1 Then
                    
                        Call UniCode_Conv(Y_NYUREC.GENSANKOKU, GENSANKOKU)
                    End If
                    
'''2011.01.19
                    
                    Call UniCode_Conv(Y_NYUREC.GEN_GENSANKOKU, StrConv(ITEMREC.TORI_GEN_GENSANKOKU, vbUnicode))
                    Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, StrConv(ITEMREC.TORI_SHIIRE_WORK_CENTER, vbUnicode))



'               Else
'
'                    Call UniCode_Conv(Y_NYUREC.GENSANKOKU, ORIGIN1)
'                    Call UniCode_Conv(Y_NYUREC.GEN_GENSANKOKU, "")
'                    Call UniCode_Conv(Y_NYUREC.SHIIRE_WORK_CENTER, "")
'
'                End If
                
                
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN, "")
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_ST, "")
                Call UniCode_Conv(Y_NYUREC.KANKYO_KBN_SURYO, "")
                                        
                Call UniCode_Conv(Y_NYUREC.ID_NO2, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))
                Call UniCode_Conv(Y_NYUREC.AITESAKI_CODE, "")
                Call UniCode_Conv(Y_NYUREC.JYUCHU_YMD, "")
                Call UniCode_Conv(Y_NYUREC.SHITEI_NOUKI_YMD, "")
                                        
                Call UniCode_Conv(Y_NYUREC.LIST_OUT_END_F, "0")
                Call UniCode_Conv(Y_NYUREC.LIST_NYU_KANRI_F, "8")
                Call UniCode_Conv(Y_NYUREC.LIST_NYU_CHECK_F, "0")
                
                
                
                WORK_SOKO = "90"
                
                Select Case JGYOBU
                    Case AIRCON, SENTAKU
                    
                    
                    Case Else
                        
                        WORK_SOKO = "81"
                        
                        '2009.06.25
                        If Trim(StrConv(Y_SYUREC.MUKE_CODE, vbUnicode)) = "G22" Then
                            WORK_SOKO = "80"
                        End If
                        '2009.06.25
                End Select
                
                
                
                
                
                
                
                
                
                
                
                Call UniCode_Conv(Y_NYUREC.NYUKO_TANABAN, WORK_SOKO & "010101")
                Call UniCode_Conv(Y_NYUREC.MAEGARI_SURYO, Format(WK_E_QTY, "00000000"))
                                        
                                        
                                        
                Call UniCode_Conv(Y_NYUREC.INS_TANTO, "2010")
                Call UniCode_Conv(Y_NYUREC.Ins_DateTime, INS_NOW)
                Call UniCode_Conv(Y_NYUREC.UPD_TANTO, "")
                Call UniCode_Conv(Y_NYUREC.UPD_DATETIME, "")
                                        
                                        
                                        
                                        Call UniCode_Conv(Y_NYUREC.FILLER, "")
                                        
                                        
                                        Loop_Cnt = 0
                                        
                                        
                                        Do
                                            sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
                                            Select Case sts
                                                Case BtNoErr
                                                    Exit Do
                                                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                                    Beep
'                                                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                                    If ans = vbCancel Then
'                                                        Exit Function
'                                                    End If
                                                
                                                    Loop_Cnt = Loop_Cnt + 1
                                                    If Loop_Cnt > 5 Then
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                    DoEvents
                                                    Sleep (500)
                                               
                                                
                                                Case Else
                                                    
                                                    
                                                    
                    '2010.05.24
                    If Fast_Flg Then
                        Open (FileName) For Output As DUP_SYUKANo
'                        Write #DUP_SYUKANo, , , "èoâ◊èdï°ÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS") '2015.11.19
                        Write #DUP_SYUKANo, , , "èoâ◊éÊçûÇ›àŸèÌÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")  '2015.11.19
'                        Write #DUP_SYUKANo, "èoâ◊ì˙", "ì`ï[áÇ", "éxï•êÊ∫∞ƒﬁ", "ëqå…/ÇrÇr∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"                  '2015.11.19
                        Write #DUP_SYUKANo, "ÉGÉâÅ[ì‡óe", "èoâ◊ì˙", "ì`ï[áÇ", "èoâ◊êÊ∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"      '2015.11.19
                        Fast_Flg = False
                    End If
                    
                    Write #DUP_SYUKANo, "[ì¸â◊êUë÷ÉfÅ[É^]",
                    Write #DUP_SYUKANo, SYUKA_YMD,
                    Write #DUP_SYUKANo, DEN_NO,
                    Write #DUP_SYUKANo, MUKE_CODE,
                    Write #DUP_SYUKANo, MUKE_NAME,
                    Write #DUP_SYUKANo, CYU_KBN,
                    Write #DUP_SYUKANo, CYU_KBN_NAME,
                    Write #DUP_SYUKANo, HIN_NO,
                    Write #DUP_SYUKANo, SURYO,
                    Write #DUP_SYUKANo, ID_NO

'                    Write #DUP_SYUKANo, "[ì¸â◊êUë÷ÉfÅ[É^]"

'                    Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
'                    Exit Function
                    Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)
                    GoTo Loop_Proc
                    '2010.05.24
                                                    
                                                    
                                            End Select
                                        Loop
                                    
                        '------------ 2005.12.30
                                        WORK_SOKO = "90"
                                        
                                        Select Case JGYOBU
                                            Case AIRCON, SENTAKU
                                                Call UniCode_Conv(K0_SOKO.Soko_No, WORK_SOKO)
                                                sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                                                Select Case sts
                                                    Case BtNoErr
                                                    Case Else
                                                        Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                                        'Exit Function      '2015.11.19
                                                        GoTo Abort_Tran     '2015.11.19
                                                End Select
                                
                                                If StrConv(SOKOREC.GOODS_ON_F, vbUnicode) = GOODS_ON Then
                                
                                                    SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                    MI_QTY = 0
                                                Else
                                                
                                                    If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                                                        MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                        SUMI_QTY = 0
                                                    Else
                                                        SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                        MI_QTY = 0
                                                    End If
                                                End If
                                                
                        '------------ 2005.12.30
                                            
                                            
                                            Case Else
                                                
                                                WORK_SOKO = "81"
                                                
                                                '2009.06.25
                                                If Trim(StrConv(Y_SYUREC.MUKE_CODE, vbUnicode)) = "G22" Then
                                                    WORK_SOKO = "80"
                                                End If
                                                '2009.06.25
                                                
                                                If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                                                    MI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                    SUMI_QTY = 0
                                                Else
                                                    SUMI_QTY = CLng(StrConv(Y_NYUREC.SURYO, vbUnicode))
                                                    MI_QTY = 0
                                                End If
                                        End Select
                                        
                                
                        '                Wk_SOKO = KASO_NYUKA_SOKO
                        '                If Trim(StrConv(HS_IN_SIJREC.YOSAN_FROM, vbUnicode)) <> "91H" Then
                        '                    Wk_SOKO = KASO_SMODOSHI_SOKO
                        '
                        '                End If
                                
                                        'ì¸â◊êîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ{Åj
                                        If Nyuko_Update_Proc(JGYOBU, _
                                                            Soko_T(i, j).NAIGAI, _
                                                            HIN_NO, _
                                                            StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
                                                            (WORK_SOKO & "01" & "01" & "01"), _
                                                            YOIN_TU_NYUKA, _
                                                            SUMI_QTY, MI_QTY, _
                                                            WS_NO, WS_NO, 5, _
                                                            StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode) & " ì`áÇ:" & DEN_NO, , , , MENU_NO, , KAMOKU_FURIKAE, _
                                                            StrConv(Y_NYUREC.GENSANKOKU, vbUnicode), _
                                                            StrConv(Y_NYUREC.SHIIRE_WORK_CENTER, vbUnicode), _
                                                            StrConv(Y_NYUREC.ID_NO2, vbUnicode), _
                                                            StrConv(Y_NYUREC.YOSAN_FROM, vbUnicode), _
                                                            StrConv(Y_NYUREC.YOSAN_TO, vbUnicode), Trim(StrConv(Y_SYUREC.MUKE_CODE, vbUnicode))) Then
                                            'Exit Function      '2015.11.19
                                            GoTo Abort_Tran     '2015.11.19
                                    
                                        End If
                                    
                                        'ëOéÿÇËêîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ|Åj
                                        If WK_E_QTY <> 0 Then
                                        'ç›å…ÉfÅ[É^LOCK
                                            If Zaiko_Lock_Proc((WORK_SOKO & "01" & "01" & "01"), _
                                                                JGYOBU, _
                                                                Soko_T(i, j).NAIGAI, _
                                                                HIN_NO, _
                                                                WS_NO, , , 5) Then
                                                'Exit Function      '2015.11.19
                                                GoTo Abort_Tran     '2015.11.19
                            
                                            End If
                                
                                            If StrConv(ITEMREC.GOODS_KBN, vbUnicode) = GOODS_ON Then
                                                MI_QTY = WK_E_QTY
                                            Else
                                                SUMI_QTY = WK_E_QTY
                                            End If
                                    
                                    
                                            If Syuko_Update_Proc(JGYOBU, _
                                                                Soko_T(i, j).NAIGAI, _
                                                                HIN_NO, _
                                                                StrConv(Y_NYUREC.SYUKA_YMD, vbUnicode), _
                                                                (WORK_SOKO & "01" & "01" & "01"), _
                                                                YOIN_MAE_SOUSAI, _
                                                                SUMI_QTY, MI_QTY, 0, _
                                                                WS_NO, WS_NO, 5) Then
                                                'Exit Function      '2015.11.19
                                                GoTo Abort_Tran     '2015.11.19
                                
                                            End If
                                    
                                    
                                    
                                    
                                    
                                    
                                        End If
 
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
'                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        End If
    
Loop_Proc:
    
    Loop
    
        
    Close #DUP_SYUKANo
        
    Syuka_Update_Proc = False

    Exit Function

Abort_Tran:
    
    
    
    If Fast_Flg Then
        Open (FileName) For Output As DUP_SYUKANo
'                        Write #DUP_SYUKANo, , , "èoâ◊èdï°ÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS") '2015.11.19
        Write #DUP_SYUKANo, , , "èoâ◊éÊçûÇ›àŸèÌÉäÉXÉg", , "çÏê¨ì˙ÅF", Format(Now, "YYYY/MM/DD HH:MM:SS")  '2015.11.19
'                        Write #DUP_SYUKANo, "èoâ◊ì˙", "ì`ï[áÇ", "éxï•êÊ∫∞ƒﬁ", "ëqå…/ÇrÇr∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"                  '2015.11.19
        Write #DUP_SYUKANo, "ÉGÉâÅ[ì‡óe", "èoâ◊ì˙", "ì`ï[áÇ", "èoâ◊êÊ∫∞ƒﬁ", "ñºèÃ", "íçï∂ãÊï™", "íçï∂ãÊï™ñºèÃ", "ïiî‘", "êîó ", "ì`ï[ÇhÇc"      '2015.11.19
        Fast_Flg = False
    End If


    Write #DUP_SYUKANo, "ÅÉÃß≤ŸèoóÕàŸèÌÅÑÅ@sts=" & sts,
    Write #DUP_SYUKANo, SYUKA_YMD,
    Write #DUP_SYUKANo, DEN_NO,
    Write #DUP_SYUKANo, MUKE_CODE,
    Write #DUP_SYUKANo, MUKE_NAME,
    Write #DUP_SYUKANo, CYU_KBN,
    Write #DUP_SYUKANo, CYU_KBN_NAME,
    Write #DUP_SYUKANo, HIN_NO,
    Write #DUP_SYUKANo, SURYO,
    Write #DUP_SYUKANo, ID_NO
    
    Close #DUP_SYUKANo          '2015.11.19
    
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function
                                            'ÉwÉbÉ_Å[àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Head(Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
    
    Printer.Print Tab(3);
    For i = 0 To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).CODE Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(37);
    Printer.Print "ÅñÅñÅñÅ@ïiî‘ïœçXÉäÉXÉgÅ@ÅñÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")
    
    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print "------- ïiî‘ÅiäOïîÅj-------";
    Printer.Print Tab(30);
    Printer.Print "------- ïiî‘Åiì‡ïîÅj-------";
    Printer.Print
    
    Printer.Print Tab(MGN_L);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 15);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 30);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 44);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 58);
    Printer.Print "ì`ï[ì˙ït";
    Printer.Print Tab(MGN_L + 69);
    Printer.Print "ì¸èoå…ãÊ";
    Printer.Print Tab(MGN_L + 78);
    Printer.Print "ì`ï[áÇ";
    Printer.Print Tab(MGN_L + 86);
    Printer.Print "ì¸èoêî";
    Printer.Print Tab(MGN_L + 93);
    Printer.Print "ëq";
    Printer.Print Tab(MGN_L + 96);
    Printer.Print "íçï∂ãÊ";
    Printer.Print Tab(MGN_L + 103);
    Printer.Print "èoâ◊êÊ"
    Printer.Print

    Lcnt = 7 + MGN_U

End Sub
                                            'ñæç◊àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Proc()

Dim Lcnt As Integer
Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim Emsg As String
Dim Wqty As Long
Dim i As Integer
Dim sts As Integer
Dim B_Jgyobu As String

    Lcnt = 99

    For i = 0 To LBox_Hin.ListCount - 1
        
'        Ldata = LBox_Hin.List(i)
'
'                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
        If Lcnt > LMAX Or _
           B_Jgyobu <> Left(Ldata, 1) Then
            Call P_Hin_Head(Lcnt, Left(Ldata, 1))
            B_Jgyobu = Left(Ldata, 1)
        End If
'
'                                        'ñæç◊àÛç¸
'        Ldata = Mid(Ldata, 11, Len(Ldata) - 11)                     'éñã∆ïîÅC√∑ΩƒáÇÅCçëì‡äOÅ@èúäO'
'
'        Printer.Print Tab(MGN_L);
'        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘ÅiäOïîÅj
'        Work = ChrCut(Ldata, 13)
'        If Right(Ldata, 1) = "1" Or Right(Ldata, 1) = "2" Then      'äOïîïiî‘ïœçXÅH
'            Printer.Print Tab(MGN_L + 15);
'            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘ÅiäOïîÅj
'        End If
'
'        Printer.Print Tab(MGN_L + 30);
'        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘Åiì‡ïîÅj
'        Work = ChrCut(Ldata, 13)
'        If Right(Ldata, 1) = "0" Then                               'ì‡ïîïiî‘ïœçXÅH
'            Printer.Print Tab(MGN_L + 44);
'            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘Åiì‡ïîÅj
'        End If
'
'        Printer.Print Tab(MGN_L + 58);                              'ì`ï[ì˙ït
'        Printer.Print ChrCut(Ldata, 4) & "/" & ChrCut(Ldata, 2) & "/" & ChrCut(Ldata, 2);
'
'        Printer.Print Tab(MGN_L + 69);                              'ì¸èoå…ãÊï™
'        wk_IO = ChrCut(Ldata, 1)
'        Select Case wk_IO
'            Case IO_KBN_URI
'                Printer.Print wk_IO & " " & (IO_KBN_0);
'            Case IO_KBN_NYU
'                Printer.Print wk_IO & " " & (IO_KBN_1);
'            Case IO_KBN_SYU
'                Printer.Print wk_IO & " " & (IO_KBN_2);
'            Case IO_KBN_ZAT
'                Printer.Print wk_IO & " " & (IO_KBN_3);
'            Case Else
'                Printer.Print wk_IO;
'        End Select
'
'        Printer.Print Tab(MGN_L + 78);
'        Printer.Print ChrCut(Ldata, 6);                             'ì`ï[áÇ
'
'        Printer.Print Tab(MGN_L + 85);                              'ì¸èoå…êî
'        Wqty = CLng(ChrCut(Ldata, 6))
'
'
'        sts = Numeric_Check(EDIT_ONLY, 7, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, Format(Wqty, "00000000"), Work)
'
'        Printer.Print Work;
'
'        Printer.Print Tab(MGN_L + 93);
'        Printer.Print ChrCut(Ldata, 2);                             'ëqå…ãÊï™ÅiŒΩƒÅj
'
'        Printer.Print Tab(MGN_L + 96);                              'íçï∂ãÊï™
'        Select Case Left(Ldata, 1)
'            Case CYU_KBN_TUK
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_1);
'            Case CYU_KBN_SPO
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_2);
'            Case CYU_KBN_HJU
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_3);
'            Case CYU_KBN_BOU
'                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_E);
'            Case Else
'                Printer.Print ChrCut(Ldata, 1);
'        End Select
'
'        Printer.Print Tab(MGN_L + 103);
'        Printer.Print ChrCut(Ldata, 5);                             'éxããêÊÅ^èoâ◊êÊ7
'
'        Printer.Print Tab(MGN_L + 110);                             'ïœçXÉÅÉbÉZÅ[ÉW
'        Select Case Left(Ldata, 1)
'            Case "0"
'                Printer.Print "ì‡ïîïœçX œΩ¿ïiî‘ì¸ë÷";
'            Case "1"
'                Printer.Print "äOïîïœçX œΩ¿ïiî‘ì¸ë÷";
'            Case "2"
'                Printer.Print "ç›å…óLÅIäOïîïœçXïsâ¬";
'        End Select
        
        Printer.Print LBox_Hin.List(i)
        
        Call LOG_OUT(LOG_F, LBox_Hin.List(i))
        
        Printer.Print

        Printer.Print

        Lcnt = Lcnt + 2
    Next i

    If Lcnt <> 99 Then
        Printer.EndDoc
        Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    End If

End Sub

Private Sub Form_Activate()

Dim Ret         As String


Dim i           As Integer
Dim FullPath    As String

    Call NG_File_Make_Proc

    '---------------------------------------------  éñã∆ïîñàÉÅÉCÉìÉãÅ[Év
    For i = 0 To UBound(JGYOBU_T)
        
        In_Cnt = 0
        Out_Cnt = 0

        lblJGYOBU(i).Caption = JGYOBU_T(i).NAME
        lblJGYOBU(i).ForeColor = JGYOBU_T(i).COLOR

        lblOUTCNT(i).Caption = Format(Out_Cnt, "#0")
        lblINCNT(i).Caption = Format(In_Cnt, "#0")
        DoEvents

        FileNo = FreeFile
        FileName = HS_IN_SIJ

        Ret = InStr(1, Trim(FileName), ".") - 1
        FileName = Left(Trim(FileName), Ret) & "_" & JGYOBU_T(i).CODE & Right(Trim(FileName), Len(Trim(FileName)) - Ret)

        On Error GoTo Error_Proc

        Open FileName For Input As #FileNo

        On Error GoTo 0


        If Nyuka_Update_Proc(JGYOBU_T(i).CODE) Then     'ì¸â◊ó\íËÉfÅ[É^çXêVèàóù

            Unload Me

        End If


        Close #FileNo

        '-----------------------------------------------
    
        FileNo = FreeFile
        FileName = HS_OUT_SIJ

        Ret = InStr(1, Trim(FileName), ".") - 1
        FileName = Left(Trim(FileName), Ret) & "_" & JGYOBU_T(i).CODE & Right(Trim(FileName), Len(Trim(FileName)) - Ret)
        
        On Error GoTo Error_Proc
        
'        Open fileName For Input As #FileNo
        Open FileName For Binary As #FileNo
    
        On Error GoTo 0
    
    
        If Syuka_Update_Proc(JGYOBU_T(i).CODE) Then  'èoâ◊ó\íËÉfÅ[É^çXêVèàóù

            Unload Me
        End If
    
    
        Close #FileNo
    
    
    
    
    Next i

    If Not Err_FLg Then
        Call NG_File_Kill_Proc
    End If

    Unload Me

Error_Proc:

End Sub

Private Sub Form_DblClick()
    PrintForm
End Sub

Private Sub Form_Load()
Dim i           As Integer
Dim j           As Integer

Dim c           As String * 128
Dim sts         As Integer


Dim sBuffer     As String * 255
Dim com         As String
    
Dim Max_Soko    As Integer
    
Dim GENSAN_WK   As Variant              '2016.12.28
    
    
    If App.PrevInstance Then
 '       Beep
 '       MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If


    F1020101.Caption = F1020101.Caption & Last_Update_Day


    Show
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                'èoâ◊ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If SYUKA_LOGF_GET_PROC() Then
        Beep
        MsgBox "èoâ◊ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                 'èoâ◊èdï°ÉfÅ[É^èoóÕÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "DUP_SYUKA_DATA", "SYS", c) Then
        Beep
        MsgBox "èoâ◊èdï°ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    DUP_SYUKA_DATA = Trim(c)
                               
    If JGYOB_TB_Set() Then      'éñã∆ïîÇÃälìæ
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                
    '---------------------------------------------- *
    '    SYS.INI -- > F102010.INI
    '   2015.03.04
    '---------------------------------------------- *
        
                                
                                
                                
                                'ëqå…ç≈ëÂêîÇéÊÇËçûÇ›
                                
    If GetIni(App.EXEName, "MAX_SOKO", App.EXEName, c) Then
        Max_Soko = 1
    Else
        If Not IsNumeric(RTrim(c)) Then
            Max_Soko = 1
        Else
            Max_Soko = CInt(RTrim(c))
        End If
    End If
                                    
                                
                                
                                
                                'ç›å…éÊÇËçûÇ›ópÉeÅ[ÉuÉãçÏê¨
    ReDim Soko_T(0 To UBound(JGYOBU_T), 0 To Max_Soko - 1)
                                'ëqå…èÓïÒéÊÇËçûÇ›
    For i = 0 To UBound(JGYOBU_T)
        j = 0
        Do
                                'óLå¯ëqå…älìæ
            If GetIni(App.EXEName, "SOKO" & JGYOBU_T(i).CODE & Format(j + 1, "0"), App.EXEName, c) Then
                Beep
                MsgBox "ëqå…èÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
                End
            End If
    
            If Trim(c) = "**" Then  'ëqå…éwíËèIóπ
                Exit Do
            End If
    
    
'            ReDim Preserve JSOKO_T(i).JSOKO_T(0 To j)
            Soko_T(i, j).HS_SOKO = Trim(c)
                                'çëì‡äOèÓïÒälìæ
            If GetIni(App.EXEName, "NAIG" & JGYOBU_T(i).CODE & Format(j + 1, "0"), App.EXEName, c) Then
                Beep
                MsgBox "çëì‡äOèÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
                End
            End If
            
            Soko_T(i, j).NAIGAI = Trim(c)
            j = j + 1
        Loop
    
    Next i
                                
                                
                                'ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæ
    If GetIni("FILE", "HS_SIJ_IN", "SYS", c) Then
        Beep
        MsgBox "ì¸å…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    HS_IN_SIJ = Trim(c)
                                
                                'èoå…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæ
    If GetIni("FILE", "HS_SIJ_OUT", "SYS", c) Then
        Beep
        MsgBox "èoå…ÉfÅ[É^ÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    HS_OUT_SIJ = Trim(c)
                                
                                
                                
                                'Åuí èÌì¸â◊ÅvóvàˆÇÃälìæ
    If GetIni("YOIN", "YOIN_TU_NYUKA", "SYS", c) Then
        Beep
        MsgBox "Åuí èÌì¸â◊ÅvóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_TU_NYUKA = Trim(c)
                                
                                'ÅuëOéÿëäéEÅvóvàˆÇÃälìæ
    If GetIni("YOIN", "YOIN_MAE_SOUSAI", "SYS", c) Then
        Beep
        MsgBox "ÅuëOéÿëäéEÅvóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_MAE_SOUSAI = Trim(c)
                                
                                'âºëzì¸â◊ëqå…ÇÃälìæ
    If GetIni("SYSTEM", "KASO_NYUKA", "SYS", c) Then
        Beep
        MsgBox "âºëzì¸â◊ëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    KASO_NYUKA_SOKO = Trim(c)
                                'âºëzéxããñﬂÇµëqå…ÇÃälìæ
    If GetIni("SYSTEM", "KASO_SMODOSHI ", "SYS", c) Then
        Beep
        MsgBox "âºëzì¸â◊ëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    KASO_SMODOSHI_SOKO = Trim(c)
                                
                                
                                'ÇªÇÃëºå¸ÇØêÊÅiçëì‡ÅjÇÃälìæ
    If GetIni(App.EXEName, "ETC_MTS_NAI", App.EXEName, c) Then
        Beep
        MsgBox "ÇªÇÃëºå¸ÇØêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    ETC_MTS_NAI = Trim(c)
                                
                                'ÇªÇÃëºå¸ÇØêÊÅiäCäOÅjÇÃälìæ
    If GetIni(App.EXEName, "ETC_MTS_GAI", App.EXEName, c) Then
        Beep
        MsgBox "ÇªÇÃëºå¸ÇØêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    ETC_MTS_GAI = Trim(c)
                                
                                
                                
'---------------------------------------------- '“∆≠∞áÇÇÃälìæ    2007.11.06
    If GetIni(App.EXEName, "MENU_NO", App.EXEName, c) Then
        MENU_NO = ""
    Else
        MENU_NO = RTrim(c)
    End If
                                
                                
                                'êÙëÛã@êÍóp
    If GetIni(App.EXEName, "CENTER", App.EXEName, c) Then
        MyCenter = "O"
    Else
        MyCenter = Trim(c)
    End If
                                
                                
                                
'---------------------------------------------- 'â»ñ⁄êUë÷ÇÃóvàˆ 2009.06.26
    KAMOKU_FURIKAE = YOIN_TU_NYUKA
    If GetIni(App.EXEName, "KAMOKU_FURIKAE", App.EXEName, c) Then
    Else
        KAMOKU_FURIKAE = RTrim(c)
    End If
                                
                                
                                'ÇªÇÃëºíºëóêÊÇÃälìæ
'    If GetIni(App.EXEName, "ETC_SS_NAI", "SYS", c) Then
'        Beep
'        MsgBox "ÇªÇÃëºíºëóêÊÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
'        End
'    End If
'    ETC_SS_NAI = Trim(c)
                                
                                '‹∞∏Ω√∞ºÆ›î‘çÜéÊÇËçûÇ›
    sBuffer = Space(255)
    If GetComputerNameA(sBuffer, 255) <> 0 Then
        com = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
    Else
        com = "??"
    End If
    WS_NO = RTrim(com)


'---------------------------------------------- 'íIî‘ê›íËèÓïÒÇÃälìæ    2009.03.07
    If GetIni(App.EXEName, "TANA_SPACE", App.EXEName, c) Then
        TANA_SPACE = False
    Else
        If Trim(c) = "1" Then
            TANA_SPACE = True
        Else
            TANA_SPACE = False
        End If
    End If



                                'ïiñºÇ…ÇÊÇÈèúäO 2011.07.04
    NOT_Hin_Name_F = False
    If GetIni(App.EXEName, "NOT_HIN_NAME", App.EXEName, c) Then
    Else
        NOT_Hin_Name = Split(Trim(c), ",", -1)
        NOT_Hin_Name_F = True
    End If
                                'ïiñºÇ…ÇÊÇÈèúäO 2011.07.04

'---------------------------------------------- 'è§ïiâª√ﬁÃ´Ÿƒ    2012.12.20
    If GetIni(App.EXEName, "GOODS_F", App.EXEName, c) Then
        GOODS_F = "0"
    Else
        If Trim(c) = "1" Then
            GOODS_F = "1"
        Else
            GOODS_F = "0"
        End If
    End If
'---------------------------------------------- 'è§ïiâª√ﬁÃ´Ÿƒ    2012.12.20
    
'---------------------------------------------- 'çXêVëŒè€å¥éYçë 2016.12.28
    If GetIni(App.EXEName, "GENSAN", App.EXEName, c) Then
        c = "*"
    End If
    GENSAN_WK = Split(Trim(c), ",", -1)

    For i = 0 To UBound(GENSAN_WK)
    
        ReDim Preserve GENSAN_T(0 To i)
        GENSAN_T(i) = GENSAN_WK(i)
    
    
    Next i
'---------------------------------------------- 'çXêVëŒè€å¥éYçë 2016.12.28






                                'ëqå…É}ÉXÉ^ÇnÇoÇdÇm
    If SOKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç\ê¨É}ÉXÉ^ÇnÇoÇdÇm '2005.12.30
    If P_COMPO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇnÇoÇdÇm
    If wITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If MTS_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'óvàˆÉ}ÉXÉ^ÇnÇoÇdÇm
    If YOIN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'íSìñé“É}ÉXÉ^ÇnÇoÇdÇm
    If TANTO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ÉRÅ[ÉhÉ}ÉXÉ^ÇnÇoÇdÇm   2005.12.30
    If P_CODE_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'å¥éYçëÉ}ÉXÉ^ÇnÇoÇdÇm   2010.07.08
    If GENSAN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                
                                'PNÉ}ÉXÉ^ÇnÇoÇdÇm   2010.09.01
    If PN_M_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
    If Country_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                
                                'ç›å…ÉfÅ[É^ÇnÇoÇdÇm
    If ZAIKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…à⁄ìÆóÇnÇoÇdÇm
    If IDO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊ó\íËÇnÇoÇdÇm
    If Y_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                'è∆çáópì¸â◊ó\íËÇnÇoÇdÇm 2007.06.15
    If Y_GLICS_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                'èoâ◊ó\íËÇnÇoÇdÇm
    If Y_SYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊¡™Ø∏√ﬁ∞¿ÇnÇoÇdÇm
    If J_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If
'î≠î‘É}ÉXÉ^ÇnÇoÇdÇm ################################################################## 2005/05/16 Add Å´
    If HATUBAN_Open(BtOpenNomal) Then
        Unload Me
    End If
'#################################################################################### 2005/05/16 Add Å™
                                
                                
    If P_SAGYO_LOG_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                'àÛç¸ÉtÉHÉìÉgê›íË
    With NormalFont
        .NAME = F1020101.FontName
        .Size = F1020101.FontSize
    End With
    Set Printer.Font = NormalFont

    Last_Proc_F = False         'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉOÉNÉäÉA


    'édå¸ÇØêÊälìæ       2005.12.30
    i = -1
    
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN04_CD)
    Call UniCode_Conv(K0_P_CODE.C_Code, "")
    com = BtOpGetGreater
    SHIMUKE_Flg = False
    
    Do
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_CODEREC.DATA_KBN, vbUnicode) <> P_KBN04_CD Then
                    Exit Do
                End If
            
                i = i + 1
                ReDim Preserve SHIMUKE_T(0 To i)
            
            
                SHIMUKE_Flg = True
            
                SHIMUKE_T(i).SHIMUKE_CODE = StrConv(P_CODEREC.C_Code, vbUnicode)
                SHIMUKE_T(i).JGYOBU = StrConv(P_CODEREC.OPTION1, vbUnicode)
                SHIMUKE_T(i).NAIGAI = StrConv(P_CODEREC.OPTION2, vbUnicode)
                            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Unload Me
        End Select
    
        com = BtOpGetNext
    Loop
        
    
    
    'édå¸ÇØêÊälìæ       2005.12.30


    Show
End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer

    DoEvents
    
'    If Last_Proc_F = True Then              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇËÅH
'        Call Last_Proc
'    End If

                                            'ëqå…É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^")              '2016.06.23
            Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^", 1, SOKO_ID)   '2016.06.23
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")              '2016.06.23
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^", 1, ITEM_ID)   '2016.06.23
        End If
    End If
                                            'ç\ê¨É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ç\ê¨É}ÉXÉ^")                  '2016.06.23
            Call File_Error(sts, BtOpClose, "ç\ê¨É}ÉXÉ^", 1, P_COMPO_ID)    '2016.06.23
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, wITEM_POS, wITEMREC, Len(wITEMREC), K0_wITEM, Len(K0_wITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")                  '2016.06.23
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^", ITEM_ID)          '2016.06.23
        End If
    End If
                                            'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "å¸ÇØêÊä«óùÉ}ÉXÉ^")            '2016.06.23
            Call File_Error(sts, BtOpClose, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 1, MTS_ID)  '2016.06.23
        End If
    End If
                                            'óvàˆÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")                  '2016.06.23
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^", 1, YOIN_ID)         '2016.06.23
        End If
    End If
                                            'íSìñé“É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "íSìñé“É}ÉXÉ^")                '2016.06.23
            Call File_Error(sts, BtOpClose, "íSìñé“É}ÉXÉ^", 1, TANTO_ID)      '2016.06.23
        End If
    End If
                                            'ÉRÅ[ÉhÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ÉRÅ[ÉhÉ}ÉXÉ^")                '2016.06.23
            Call File_Error(sts, BtOpClose, "ÉRÅ[ÉhÉ}ÉXÉ^", 1, P_CODE_ID)     '2016.06.23
        End If
    End If
                                            'å¥éYçëÉ}ÉXÉ^ÇbÇkÇnÇrÇd 2010.07.08
    sts = BTRV(BtOpClose, GENSAN_POS, GENSANREC, Len(GENSANREC), K0_GENSAN, Len(K0_GENSAN), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "å¥éYçëÉ}ÉXÉ^")                '2016.06.23
            Call File_Error(sts, BtOpClose, "å¥éYçëÉ}ÉXÉ^", 1, GENSAN_ID)     '2016.06.23
        End If
    End If
                                            'ç›å…ÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")                      '2016.06.23
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^", 1, ZAIKO_ID)          '2016.06.23
        End If
    End If
                                            'ç›å…à⁄ìÆóÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, IDO_POS, IDOREC, Len(IDOREC), K0_IDO, Len(K0_IDO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆó")                      '2016.06.23
            Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆó", 1, IDO_ID)            '2016.06.23
        End If
    End If
                                            'ì¸â◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ì¸â◊ó\íË")                        '2016.06.23
            Call File_Error(sts, BtOpClose, "ì¸â◊ó\íË", 1, Y_NYU_ID)            '2016.06.23
        End If
    End If
                                            'è∆çáópì¸â◊ó\íËÇbÇkÇnÇrÇd   2007.06.16
    sts = BTRV(BtOpClose, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "è∆çáópì¸â◊ó\íË")                  '2016.06.23
            Call File_Error(sts, BtOpClose, "è∆çáópì¸â◊ó\íË", 1, Y_GLICS_ID)    '2016.06.23
        End If
    End If
                                            'èoâ◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "èoâ◊ó\íË")                        '2016.06.23
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íË", 1, Y_SYU_ID)            '2016.06.23
        End If
    End If
                                            'ì¸â◊¡™Ø∏√ﬁ∞¿ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            'Call File_Error(sts, BtOpClose, "ì¸â◊¡™Ø∏√ﬁ∞¿")                    '2016.06.23
            Call File_Error(sts, BtOpClose, "ì¸â◊¡™Ø∏√ﬁ∞¿", J_NYU_ID)           '2016.06.23
        End If
    End If
                                            'ÇaÇîÇíÇâÇÖÇñÇÖÉäÉZÉbÉg
    sts = BTRV(BtOpReset, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set F1020101 = Nothing

    End
End Sub

Private Function Item_Check_Proc(Mode As Integer, JGYOBU As String, NAIGAI As String, HIN_GAI As String, _
                                                                                        Optional HIN_NAI As String = "             ", _
                                                                                        Optional HIN_NAME As String = "                         ", _
                                                                                        Optional GENSANKOKU As String = "                    ", _
                                                                                        Optional GEN_GENSANKOKU As String = "                    ", _
                                                                                        Optional SHIIRE_WORK_CENTER As String = "                    ", _
                                                                                        Optional KANKYO_KBN As String = "   ", _
                                                                                        Optional KANKYO_KBN_ST As String = "        ", _
                                                                                        Optional KANKYO_KBN_SURYO As String = "          ") As Integer
'----------------------------------------------------------------------------
'                   Åuïiñ⁄É}ÉXÉ^ÅvÉ`ÉFÉbÉNÅïçXêVèàóù
'----------------------------------------------------------------------------
Dim com         As Integer
Dim sts         As Integer
Dim ans         As Integer

Dim HIN_CHANGE  As Integer

    
    
Dim BEF_GAI     As String * 13
Dim BEF_NAI     As String * 13
    
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long
        
Dim i           As Integer
    
    
Dim sBuffer     As String * 255     '2009.01.21
Dim wkTanto     As String           '2009.01.21
    
Dim PN_M_STS    As Integer          '2010.09.01
    
    
    
Dim Loop_Cnt    As Integer          '2011.01.19
    
    
    Item_Check_Proc = True

    HIN_CHANGE = 0
    

    Call UniCode_Conv(K0_ITEM.JGYOBU, JGYOBU)
    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, HIN_GAI)

    Loop_Cnt = 0

    Do

        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                


                    If Mode = In_Mode Then          'ëŒì‡ïiî‘ïœçXÇÃÉ`ÉFÉbÉN
    '                Else
    
                        If Len(Trim(HIN_NAI)) <> 0 Then
                            If Trim(StrConv(ITEMREC.HIN_NAI, vbUnicode)) <> Trim(HIN_NAI) Then
                                HIN_CHANGE = NAI_CHANGE
                                BEF_NAI = StrConv(ITEMREC.HIN_NAI, vbUnicode)
                                'ì‡ïîïiî‘ì¸ÇÍë÷Ç¶
                                Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)
                            
                            
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                    
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                            
                            
                            
                            
                            
                            
                            End If
                        End If
                    
                    
                    
                                        
                        '---------------    2010.07.08  Å§
                        'å¥éYçëì¸ÇÍë÷Ç¶É`ÉFÉbÉN
                        If Len(Trim(GENSANKOKU)) <> 0 Or Len(Trim(GEN_GENSANKOKU)) <> 0 Or Len(Trim(SHIIRE_WORK_CENTER)) <> 0 Then
    '                        If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) <> Trim(GENSANKOKU) Then
                                'å¥éYçëì¸ÇÍë÷Ç¶
                                
                            
                                If Trim(GENSANKOKU) <> "" Then
                                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, GENSANKOKU)
                                Else
                                    Debug.Print
                                End If
                                
                                
    '                            If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) = "" Then
    '
    '                                Call UniCode_Conv(ITEMREC.GENSANKOKU, GENSANKOKU)
    '
    '
    '                            End If
                                
                                
                                Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, GEN_GENSANKOKU)
                                Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                            
                            
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                    
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                                
                                
                            
    '                        End If
                        End If
                        '---------------    2010.07.08  Å¢
                    
                    
                        '---------------    2010.07.27  Å§
                        'ä¬ã´ãÊï™É`ÉFÉbÉN
                        If Len(Trim(KANKYO_KBN)) <> 0 Or Len(Trim(KANKYO_KBN_ST)) <> 0 Or Len(Trim(KANKYO_KBN_SURYO)) <> 0 Then
                            
                            
                            
                            If Val(KANKYO_KBN_SURYO) = 0 Then
                            Else
                            
                                
                                'ä¬ã´ãÊï™ì¸ÇÍë÷Ç¶
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
                                    
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
                                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
                                
                                
                                'íSìñé“çXêVí«â¡ 2009.11.11
                                        
                                                                                        'çXêVíSìñé“
                                Call UniCode_Conv(ITEMREC.UPD_TANTO, "2010")
                                                                                        'çXêVì˙éû
                                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                            End If
                                
                            
                        End If
                        '---------------    2010.07.08  Å¢
                    
                    
                    
                    End If
                
                
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                
                com = BtOpInsert
                
                PN_M_STS = PN_M_GET(JGYOBU, HIN_GAI, 0)
                Select Case PN_M_STS
                
                    Case False
                    
                    Case BtErrKeyNotFound
                    
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")
                    
                    Case True
                        
                        Call UniCode_Conv(PN_MREC.UnitKbn, "")
                        Call UniCode_Conv(PN_MREC.NaiKbn, "")
                        Call UniCode_Conv(PN_MREC.GaiKbn, "")
                        Call UniCode_Conv(PN_MREC.HyoTan, "")
                        Call UniCode_Conv(PN_MREC.Tanka2, "")
                        Call UniCode_Conv(PN_MREC.Tanka3, "")
                        Call UniCode_Conv(PN_MREC.Tanka4, "")
                        Call UniCode_Conv(PN_MREC.MadeIn, "")
                        Call UniCode_Conv(PN_MREC.MadeInCode, "")

                
                End Select
                '2010.09.01
                
                
                
                
                Call Rclr_ITEMREC               '2012.02.11
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.JGYOBU, JGYOBU)   'éñã∆ïî
                Call UniCode_Conv(ITEMREC.NAIGAI, NAIGAI)   'çëì‡äO
                Call UniCode_Conv(ITEMREC.HIN_GAI, HIN_GAI) 'ïiî‘ÅiäOïîÅj
                                                            'ïiñº
                Call UniCode_Conv(ITEMREC.HIN_NAME, HIN_NAME)
    
                    
'2009.01.21                If Mode = In_Mode Then  'êVãKïiî‘éû*ÇÉZÉbÉg2008.10.29
                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
                    Call UniCode_Conv(ITEMREC.ST_SOKO, "**")
                    Call UniCode_Conv(ITEMREC.ST_RETU, "**")
                    Call UniCode_Conv(ITEMREC.ST_REN, "**")
                    Call UniCode_Conv(ITEMREC.ST_DAN, "**")
                    
'                Else
'                    Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
'                    Call UniCode_Conv(ITEMREC.ST_SOKO, "")
'                    Call UniCode_Conv(ITEMREC.ST_RETU, "")
'                    Call UniCode_Conv(ITEMREC.ST_REN, "")
'                    Call UniCode_Conv(ITEMREC.ST_DAN, "")
'                End If
    
                Call UniCode_Conv(ITEMREC.BEF_SOKO, "")
                Call UniCode_Conv(ITEMREC.BEF_RETU, "")
                Call UniCode_Conv(ITEMREC.BEF_REN, "")
                Call UniCode_Conv(ITEMREC.BEF_DAN, "")
    
                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, "")
    
                
                
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.HIN_NAI, StrConv(PN_MREC.SPn, vbUnicode))        'ïiî‘Åiì‡ïîÅj
                Else
                    Call UniCode_Conv(ITEMREC.HIN_NAI, HIN_NAI)         'ïiî‘Åiì‡ïîÅj
                End If
    
                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, "")           'îıçl ÉzÉXÉgëqå…
                Call UniCode_Conv(ITEMREC.BIKOU_TANA, "")           'îıçl ÉzÉXÉgíIî‘
'                Call UniCode_Conv(ITEMREC.SIZAI_CD, "")             'éëçﬁÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")      'ï‚è[ì_
                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")    'åéïΩãœèoâ◊êî
                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")          'ÉTÉìÉvÉãêî
                Call UniCode_Conv(ITEMREC.LAST_INP_DT, "")          'ç≈èIì¸â◊ì˙ït
    
'                Call UniCode_Conv(ITEMREC.LOCK_F, "")               'îrëºÉtÉâÉO
'                Call UniCode_Conv(ITEMREC.WEL_ID, "")               'égópéqã@ÇhÇc
'                Call UniCode_Conv(ITEMREC.PRG_ID, "")               'égópíÜÉvÉçÉOÉâÉÄ
    
                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")          'ç≈èIè∆çáì˙ït
                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "")         'ç≈èIè∆çáéûç›å…êî
'                Call UniCode_Conv(ITEMREC.MOTO_JIGYOBU, "")         'å≥éñéñã∆ïî
                Call UniCode_Conv(ITEMREC.BIKOU, "")                'àÛç¸îıçl
                Call UniCode_Conv(ITEMREC.IRI_QTY, "")              'àÛç¸ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.JAN_CODE, "")             'JanÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.HIN_CHANGE, "")           'ïiî‘ì«Ç›ë÷Ç¶
                Call UniCode_Conv(ITEMREC.GOODS_KBN, GOODS_ON)      'è§ïiâªóLñ≥
                Call UniCode_Conv(ITEMREC.PACKING_NO, "")           'å¬ëïî†áÇ
                Call UniCode_Conv(ITEMREC.GLICS1_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS2_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                Call UniCode_Conv(ITEMREC.GLICS3_TANA, "")          '∏ﬁÿØ∏ΩíIî‘1
                
                
                                
                
                
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.G_SHIIRE_KBN, "")             'ã∆ñ±ä«óùÅ@ édì¸ãÊï™
                Call UniCode_Conv(ITEMREC.G_HANBAI_KBN, "")             '           îÃîÑãÊï™
                Call UniCode_Conv(ITEMREC.G_SYUSHI, "")                 '           é˚éxíPà 
                Call UniCode_Conv(ITEMREC.G_KUMITATE, "")               '           ëgóßêªïi
                Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")              '           ïWèÄëeóòîÑâøíPâøÅ@9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_URITAN_DT, "")           '           ïWèÄëeóòîÑâøê›íËì˙
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "")              '           ïWèÄëeóòå¥âøíPâø  9(8)V99
                Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, "")           '           ïWèÄëeóòå¥âøê›íËì˙
                                            
                                            
                                                                        '           édì¸êÊèÓïÒ
                For i = 0 To 2
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).CODE, "")             '∫∞ƒﬁ
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA, "")            'édì¸íPâø
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).TANKA_DT, "")         'íPâøê›íËì˙
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LOT, "")              '€Øƒêî
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LEAD_TIME, "")        'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_DT, "")    'ÿ∞ƒﬁ¿≤—
                    Call UniCode_Conv(ITEMREC.G_SHIIRE_TBL(i).LAST_ORDER_QTY, "")   'ÿ∞ƒﬁ¿≤—
                
                Next i
                                            
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_KIN, "")          '           ëOåéç›å…ã‡äz
                Call UniCode_Conv(ITEMREC.G_SHIZAI_KBN, "")             '           éëçﬁãÊï™
                Call UniCode_Conv(ITEMREC.G_LABEL_NON, P_G_LABEL_ON)    '           ÉâÉxÉãì\ït
'*------------------------------------------ 2005.11.15 í«â¡(ã∆ñ±ä«óùçÄñ⁄) Å¢

'*------------------------------------------ 2005.11.15 í«â¡(è§ïi◊ÕﬁŸçÄñ⁄) Å§
                Call UniCode_Conv(ITEMREC.L_HIN_NAME_E, "")             'è§ïi◊ÕﬁŸ   ïiñº
                Call UniCode_Conv(ITEMREC.L_BIKOU, "")                  '           îıçl
                Call UniCode_Conv(ITEMREC.L_KAISHA_CODE, "")            '           âÔé–ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_KISHU1, "")                 '           ã@éÌ(1)
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
                Call UniCode_Conv(ITEMREC.L_KISHU3, "")                 '           ã@éÌ(3)
                Call UniCode_Conv(ITEMREC.L_PAPER, "")                  '           éÜ
                Call UniCode_Conv(ITEMREC.L_PLASTIC, "")                '           ÉvÉâÉXÉ`ÉbÉN
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.L_URIKIN1, "")                '           âøäi(1)
'                Call UniCode_Conv(ITEMREC.L_URIKIN2, "")                '           âøäi(2)
'                Call UniCode_Conv(ITEMREC.L_URIKIN3, "")                '           âøäi(3)
                
                
                                                                '           âøäi(1)
                If IsNumeric(StrConv(PN_MREC.Tanka2, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, Format(Val(StrConv(PN_MREC.Tanka2, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN1, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(2)
                If IsNumeric(StrConv(PN_MREC.Tanka3, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, Format(Val(StrConv(PN_MREC.Tanka3, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN2, "0000000000")
                End If
                                                                
                                                                
                                                                '           âøäi(3)
                If IsNumeric(StrConv(PN_MREC.Tanka4, vbUnicode)) Then
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, Format(Val(StrConv(PN_MREC.Tanka4, vbUnicode)), "0000000000"))
                Else
                    Call UniCode_Conv(ITEMREC.L_URIKIN3, "0000000000")
                End If
                '2010.09.01
                
                
                
                
                Call UniCode_Conv(ITEMREC.L_LABEL, "")                  '           ìKópã@éÌ◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_MAISU, "")                  '           ñáêî◊ÕﬁŸ
                Call UniCode_Conv(ITEMREC.L_KISHU_BIKOU, "")            '           ìKópã@éÌîıçl
                Call UniCode_Conv(ITEMREC.L_SAGYO_SHIJI, "")            '           çÏã∆éwé¶
                Call UniCode_Conv(ITEMREC.L_BIKOU3, "")                 '           îıçlÇR
                Call UniCode_Conv(ITEMREC.L_JGYOBU_CODE, "")            '           éñã∆ïîÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.L_IRI_QTY, "")                '           ì¸ÇËêî
                Call UniCode_Conv(ITEMREC.L_TANA1, "")                  '           íIî‘(1)
                Call UniCode_Conv(ITEMREC.L_TANA2, "")                  '           íIî‘(2)
                
                
                
'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å§
                
                Call UniCode_Conv(ITEMREC.S_TANTO, "")                  'é˚íPÅ^íSìñé“ÉRÅ[Éh
                Call UniCode_Conv(ITEMREC.ZAIKO_F, "")                  'ç›å…ä«óùëŒè€óLñ≥ 1:ëŒè€ 0:ëŒè€äO
    
                Call UniCode_Conv(ITEMREC.L_KISHU2, "")                 '           ã@éÌ(2)
    
                Call UniCode_Conv(ITEMREC.G_ZEN_ZAIKO_QTY, "")          '           ëOåéç›å…êîó 
                Call UniCode_Conv(ITEMREC.G_LAST_SYUKA_QTY, "")         '           ç≈èIèoâ◊êî
    
                Call UniCode_Conv(ITEMREC.G_S2_ZAI_QTY, "")             'GLICSç›å…(S2) ë‹à‰óp
                Call UniCode_Conv(ITEMREC.G_P2_ZAI_QTY, "")             'GLICSç›å…(P2) ë‹à‰óp
                    
                '2010.09.01
                Call UniCode_Conv(ITEMREC.K_KEITAI, "")                 'å¬ëïå`ë‘
                Call UniCode_Conv(ITEMREC.K_KEITAI, StrConv(PN_MREC.KKeitai, vbUnicode))
                '2010.09.01
    
    
    

    
'2010.09.01
'                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, "")               '’∆ØƒïîïiãÊï™
'                Call UniCode_Conv(ITEMREC.NAI_BUHIN, "")                'çëì‡ãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.GAI_BUHIN, "")                'äCäOãüããïîïiãÊï™   2006.07.28
'                Call UniCode_Conv(ITEMREC.HYO_TANKA, "")                'ïWèÄíPâø   2006.07.28


                Call UniCode_Conv(ITEMREC.UNIT_BUHIN, StrConv(PN_MREC.UnitKbn, vbUnicode))      '’∆ØƒïîïiãÊï™
                Call UniCode_Conv(ITEMREC.NAI_BUHIN, StrConv(PN_MREC.NaiKbn, vbUnicode))        'çëì‡ãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.GAI_BUHIN, StrConv(PN_MREC.GaiKbn, vbUnicode))        'äCäOãüããïîïiãÊï™   2006.07.28
                Call UniCode_Conv(ITEMREC.HYO_TANKA, StrConv(PN_MREC.HyoTan, vbUnicode))        'ïWèÄíPâø   2006.07.28
'2010.09.01
    
    
    
    
    
    
    
    
    
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.LAST_CODE, "")                'ç≈èIédì¸êÊÉRÅ[Éh   2007.05.29
                Call UniCode_Conv(ITEMREC.LAST_TANKA, "")               'ç≈èIédì¸íPâø       2007.05.29
    
                Call UniCode_Conv(ITEMREC.MAKER_CODE, "")               '“∞∂∞∫∞ƒﬁ           2007.06.06
                Call UniCode_Conv(ITEMREC.MAKER_NAME, "")               '“∞∂∞ñºèÃ           2007.06.06
    
    
                Call UniCode_Conv(ITEMREC.L_MARK, "")                   'çƒç´ïÔœ∞∏          2007.11.08
    
                Call UniCode_Conv(ITEMREC.SAI_SU, "")                   'çÀêî               2008.02.14
    
                Call UniCode_Conv(ITEMREC.D_KEISHIKI, "")               'å`éÆ               2008.02.14
                Call UniCode_Conv(ITEMREC.D_MATERIAL, "")               'çﬁéø               2008.02.14
                Call UniCode_Conv(ITEMREC.D_THICKNESS, "")              '¿ﬁ›Œﬁ∞ŸÅ@å˙Ç≥      2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.D_SIZE_W, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiWÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_D, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiDÅj   2008.02.14
                Call UniCode_Conv(ITEMREC.D_SIZE_H, "")                 '¿ﬁ›Œﬁ∞Ÿª≤ΩﬁÅiHÅj   2008.02.14
        
                Call UniCode_Conv(ITEMREC.D_PRINT, "")                  'àÛç¸Ç∑ÇÈÅ^ÇµÇ»Ç¢   2008.02.14
            
        
                Call UniCode_Conv(ITEMREC.S_KOUSU, "")                  'è§ïiâªÅ@çHêî       2008.02.14
        
                Call UniCode_Conv(ITEMREC.S_KOUSU_GENKA, "")            'è§ïiâªÅ@çHêîå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_BAIKA, "")            'è§ïiâªÅ@çHêîîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_KOUSU_SET_DATE, "")         'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
        
    
                Call UniCode_Conv(ITEMREC.S_SHIZAI_GENKA, "")           'è§ïiâªÅ@éëçﬁå¥âø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_BAIKA, "")           'è§ïiâªÅ@éëçﬁîÑâø   2008.02.14
                Call UniCode_Conv(ITEMREC.S_SHIZAI_SET_DATE, "")        'è§ïiâªÅ@íPâøê›íËì˙ 2008.02.14
    
    
                Call UniCode_Conv(ITEMREC.SE_USOU_F, "")                'óAëóî†Å@èoóÕÃ◊∏ﬁ   2008.02.14
    
                Call UniCode_Conv(ITEMREC.USE_TAPE_KIND, "")            'égópÉeÅ[ÉvéÌóﬁ     2008.02.14
                Call UniCode_Conv(ITEMREC.USE_TAPE_LNG, "")             'égópÉeÅ[Éví∑       2008.02.14
    
                Call UniCode_Conv(ITEMREC.H_TANA_MAKE, "")              'íIî‘É}Å[ÉN         2008.04.02
    
    
                Call UniCode_Conv(ITEMREC.SE_TANKA_MEMO, "")            'êøãÅíPâøÅ@ÉÅÉÇ     2008.04.15
    
                '2010.07.08 Å§
                'Call UniCode_Conv(ITEMREC.GENSANKOKU, "")              'å¥éYçë             2008.06.11
                Call UniCode_Conv(ITEMREC.xGENSANKOKU, "")              'å¥éYçë
                
                
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.GENSANKOKU, "")               'å¥éYçë
                Call UniCode_Conv(ITEMREC.GENSANKOKU, StrConv(PN_MREC.MadeIn, vbUnicode))
                '2010.09.01
                
                
                If Trim(GENSANKOKU) <> "" Or Trim(GEN_GENSANKOKU) <> "" Or Trim(SHIIRE_WORK_CENTER) <> "" Then
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, GEN_GENSANKOKU)
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)
                Else
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_GEN_GENSANKOKU, "")
                    Call UniCode_Conv(ITEMREC.TORI_SHIIRE_WORK_CENTER, "")
                End If
                '2010.07.08 Å¢
    
                '2010.09.01
                If Trim(StrConv(ITEMREC.TORI_GENSANKOKU, vbUnicode)) = "" Then
                    
                    Call UniCode_Conv(K0_Country.CountryCode, StrConv(PN_MREC.MadeInCode, vbUnicode))
                    sts = BTRV(BtOpGetEqual, Country_POS, CountryREC, Len(CountryREC), K0_Country, Len(K0_Country), 0)
                    Select Case sts
                        Case BtNoErr
                            Debug.Print
                        Case BtErrKeyNotFound
                            Call UniCode_Conv(CountryREC.CountryName2, "")
                        Case Else
                    
                            'Call File_Error(sts, BtOpGetEqual, "COUNTRY")                  '2016.06.23
                            Call File_Error(sts, BtOpGetEqual, "COUNTRY", 1, Country_ID)    '2016.06.23
                            Exit Function
                    
                    End Select
                
                    Call UniCode_Conv(ITEMREC.TORI_GENSANKOKU, StrConv(CountryREC.CountryName2, vbUnicode))
                
                
                End If
                '2010.09.01
    
    
    
    
    
                Call UniCode_Conv(ITEMREC.S_GAISO_TANKA, "")            'äOëïíPâø 9(8)V99   2008.06.12
                Call UniCode_Conv(ITEMREC.S_PPSC_KAKO_KOSU, "")         'PPSCâ¡çHíPâø9(8)   2008.06.12
                Call UniCode_Conv(ITEMREC.S_BU_KAKO_KOSU, "")           'BUâ¡çHíPâø9(8)     2008.06.12
    
    
                Call UniCode_Conv(ITEMREC.SEI_LOT, "")                  'ê∂éYÉçÉbÉg         2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_RATE, "")                 'ï™ÉåÅ[Ég           2008.07.07
                Call UniCode_Conv(ITEMREC.SEI_SYU_KON, "")              'èWçáç´ïÔ           2008.07.07
    
    
                Call UniCode_Conv(ITEMREC.SEI_TANKA_TANTO, "")          'íPâøê›íËíSìñé“     2008.07.09
    
                Call UniCode_Conv(ITEMREC.SHIMUKE_CODE, "")             'édå¸ÇØêÊ           2008.07.09

                Call UniCode_Conv(ITEMREC.SEI_KBN, "")                  'êøãÅãÊï™           2008.07.16

                Call UniCode_Conv(ITEMREC.SEI_LABEL_QTY, "")            'ÉâÉxÉãì\ÇËñáêî     2008.07.19

                Call UniCode_Conv(ITEMREC.SEI_SZI_CNT, "")              'éëçﬁåèêî     Å@    2008.08.20í«â¡
                Call UniCode_Conv(ITEMREC.SEI_DKN_CNT, "")              'ìØç´åèêî           2008.08.20í«â¡
         

'*------------------------------------------ 2008.08.26 êVãKí«â¡çÄñ⁄àÍéÆ Å¢
                
                
                                
                
                
                
                'Å´2009.02.20
                For i = 0 To 9
                    Call UniCode_Conv(ITEMREC.BEF_KOUTEI(i).BEF_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.MAIN_KOUTEI(i).MAIN_KOUTEI, "")
                    Call UniCode_Conv(ITEMREC.AFT_KOUTEI(i).AFT_KOUTEI, "")

                Next i


                Call UniCode_Conv(ITEMREC.SE_IO_TANKA_No, "")
                'Å™2009.02.20
                
                
                
                
                
                Call UniCode_Conv(ITEMREC.STAT, "1")                    'èÛë‘ãÊï™           2009.01.21
    

                sBuffer = Space(255)                                    '2009.01.21
                If GetComputerNameA(sBuffer, 255) <> 0 Then
                    wkTanto = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
                Else
                    wkTanto = "???"
                End If

                
                
                
                Call UniCode_Conv(ITEMREC.INSP_MESSAGE, "")             'åüïi“Øæ∞ºﬁ 2009.08.28
                Call UniCode_Conv(ITEMREC.S_SEIKYU_F, "")               'êøãÅÇe 2009.08.28
                
                Call UniCode_Conv(ITEMREC.BEF_S_KOUSU_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_SHIZAI_BAIKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_GAISO_TANKA, "")
                Call UniCode_Conv(ITEMREC.BEF_S_PPSC_KAKO_KOSU, "")
                Call UniCode_Conv(ITEMREC.BEF_S_BU_KAKO_KOSU, "")
            
                Call UniCode_Conv(ITEMREC.M_BIKOU, "")
                Call UniCode_Conv(ITEMREC.SHIYOU_NO, "")
                Call UniCode_Conv(ITEMREC.MITSUMORI_KBN, "")
                Call UniCode_Conv(ITEMREC.TANKA_KIRIKAE_DT, "")
                Call UniCode_Conv(ITEMREC.KIRIKAE_KBN, "")
                
                
                
                
                Call UniCode_Conv(ITEMREC.KANKYO_KBN, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, "")
                Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, "")
                
                
                If Trim(KANKYO_KBN) <> "" Or Trim(KANKYO_KBN_ST) <> "" Or Trim(KANKYO_KBN_SURYO) <> "" Then
                    
                    If Val(KANKYO_KBN_SURYO) <> 0 Then
                    
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN, KANKYO_KBN)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_ST, KANKYO_KBN_ST)
                        Call UniCode_Conv(ITEMREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)
                
                    End If
            
                End If
                
                
                                                                        'í«â¡íSìñé“
                '2010.09.01
'                Call UniCode_Conv(ITEMREC.INS_TANTO, wkTanto)
                If Mode = Out_Mode Then
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "ysyuk")
                Else
                    Call UniCode_Conv(ITEMREC.INS_TANTO, "yglcs")
                End If
                '2010.09.01
                                                                        
                                                                        'í«â¡ì˙éû
                Call UniCode_Conv(ITEMREC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))


                
                
                
                Call UniCode_Conv(ITEMREC.BEF_L_LABEL, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_1_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_2_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_3_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_4_L_PLASTIC, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PAPER, "")
                Call UniCode_Conv(ITEMREC.BEF_LAST_L_PLASTIC, "")
    
                
                
                Call UniCode_Conv(ITEMREC.BIKOU20, "")
                
                '2011.07.05
                Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "")
                
                If NOT_Hin_Name_F Then
                    For i = 0 To UBound(NOT_Hin_Name)
                        If InStr(1, RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode)), NOT_Hin_Name(i)) <> 0 Then
                            Call UniCode_Conv(ITEMREC.GOODS_OUT_F, "1")
                            Exit For
                        End If
                    Next i
                End If
                '2011.07.05
                
                Call UniCode_Conv(ITEMREC.FILLER, "")
                                                                        'çXêVíSìñé“
                Call UniCode_Conv(ITEMREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                        'çXêVì˙éû
                Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                                
                
                
                
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
            
                DoEvents
                Sleep (500)
           
            
            Case BtErrDEAD_LOCK
                Exit Function
                        
            Case Else
                'Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^", 0)            '2016.06.23
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^", 1, ITEM_ID)    '2016.06.23
                Exit Function
        End Select
    Loop
    
    Loop_Cnt = 0
    
    Do
        sts = BTRV(com, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
            
                DoEvents
                Sleep (500)
            
            
            
            Case BtErrDEAD_LOCK
                Exit Function
            Case Else
                'Call File_Error(sts, com, "ïiñ⁄É}ÉXÉ^", 0)
                Call File_Error(sts, com, "ïiñ⁄É}ÉXÉ^", 1, ITEM_ID)
                Exit Function
        End Select
    Loop
        
    If SHIMUKE_Flg Then
        If com = BtOpInsert Then
            'ç\ê¨É}ÉXÉ^ÇÃí«â¡       2005.12.30
            For i = 0 To UBound(SHIMUKE_T)
            
                If StrConv(ITEMREC.JGYOBU, vbUnicode) = SHIMUKE_T(i).JGYOBU And _
                    StrConv(ITEMREC.NAIGAI, vbUnicode) = SHIMUKE_T(i).NAIGAI Then
                                                                            'édå¸ÇØêÊ∫∞ƒﬁ
                    Call UniCode_Conv(P_COMPO_O_REC.SHIMUKE_CODE, SHIMUKE_T(i).SHIMUKE_CODE)
                                                                            'éñã∆ïî
                    Call UniCode_Conv(P_COMPO_O_REC.JGYOBU, SHIMUKE_T(i).JGYOBU)
                                                                            'çëì‡äO
                    Call UniCode_Conv(P_COMPO_O_REC.NAIGAI, SHIMUKE_T(i).NAIGAI)
                                                                            'ïiî‘
                    Call UniCode_Conv(P_COMPO_O_REC.HIN_GAI, StrConv(ITEMREC.HIN_GAI, vbUnicode))
                                                                            '√ﬁ∞¿ãÊï™
                    Call UniCode_Conv(P_COMPO_O_REC.DATA_KBN, P_HEAD)
                                                                            'í«î‘
                    Call UniCode_Conv(P_COMPO_O_REC.SEQNO, "000")
                                                                            'äÓñ{ÉNÉâÉX
                    Call UniCode_Conv(P_COMPO_O_REC.CLASS_CODE, "")
                                                                            'îıçl
                    Call UniCode_Conv(P_COMPO_O_REC.BIKOU, "")
                    
                    Call UniCode_Conv(P_COMPO_O_REC.FILLER, "")
                                                                            'çXêVíSìñé“
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                                            'çXêVì˙éû
                    Call UniCode_Conv(P_COMPO_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                
                    Loop_Cnt = 0
                    Do
                        sts = BTRV(BtOpInsert, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                        Select Case sts
                            Case BtNoErr, BtErrDuplicates
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                                Beep
'                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                                If ans = vbCancel Then
'                                    Exit Function
'                                End If
                            
                            
                                Loop_Cnt = Loop_Cnt + 1
                                If Loop_Cnt > 5 Then
                                    Exit Function
                                End If
                            
                                DoEvents
                                Sleep (500)
                            
                            
                            Case BtErrDEAD_LOCK
                                Exit Function
                            Case Else
                                'Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^", 0)              '2016.06.23
                                Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^", 1, P_COMPO_ID)   '2016.06.23
                                Exit Function
                        End Select
                    Loop
                
                
                End If
            Next i
        
        End If
        
    End If
        
    If HIN_CHANGE <> 0 Then
        LBox_Hin.AddItem JGYOBU & NAIGAI & StrConv(ITEMREC.HIN_GAI, vbUnicode) & BEF_GAI & StrConv(ITEMREC.HIN_NAI, vbUnicode) & BEF_NAI & NAI_CHANGE
    End If

    Item_Check_Proc = False

End Function

Sub NG_File_Make_Proc()
'----------------------------------------------------------------------------
'                   àŸèÌèIóπÉtÉ@ÉCÉãèoóÕèàóù
'----------------------------------------------------------------------------
Dim stream  As Integer                       'ÉtÉ@ÉCÉãî‘çÜ
Dim Buf     As String                           'ì«Ç›çûÇ›ÉoÉbÉtÉ@
Dim prog    As String
Dim sBuffer As String * 255
Dim com     As String

Dim NG_FILE As String
Dim c       As String * 128
    
    
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "NG_FILE", "SYS", c) Then
        Beep
        MsgBox "àŸèÌèIóπÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        Unload Me
    End If
    NG_FILE = RTrim(c)
    
    
    stream = FreeFile
    Open NG_FILE For Append As stream
    prog = StrConv(App.EXEName, vbUpperCase)
    
    Buf = (Date$ & " " & Time$ & " " & com & " " & prog)
    Print #stream, Buf
    Close stream
End Sub
Sub NG_File_Kill_Proc()
'----------------------------------------------------------------------------
'                   àŸèÌèIóπÉtÉ@ÉCÉãçÌèúèàóù    2008.10.07
'----------------------------------------------------------------------------
Dim stream  As Integer                       'ÉtÉ@ÉCÉãî‘çÜ
Dim Buf     As String                           'ì«Ç›çûÇ›ÉoÉbÉtÉ@
Dim prog    As String
Dim sBuffer As String * 255
Dim com     As String

Dim NG_FILE As String
Dim c       As String * 128
    
    
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "NG_FILE", "SYS", c) Then
        Beep
        MsgBox "àŸèÌèIóπÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        Unload Me
    End If
    NG_FILE = RTrim(c)
    
    On Error GoTo Err_Proc
    Kill (NG_FILE)

Err_Proc:

End Sub


Private Function Y_GLICS_PUT_PROC(JGYOBU As String, NAIGAI As String, INS_NOW As String, _
                                                                        TEXT_NO As String, _
                                                                        JGYOBU_Code As String, _
                                                                        CYOK_KBN As String, _
                                                                        DEN_DT As String, _
                                                                        IO_KBN As String, _
                                                                        PM_KBN As String, _
                                                                        DEN_SYU As String, _
                                                                        DEN_NO As String, _
                                                                        CYU_KBN As String, _
                                                                        HIN_GAI As String, _
                                                                        HIN_NAI As String, _
                                                                        HIN_NAME As String, _
                                                                        YOTEI_QTY As String, _
                                                                        YOSAN_FROM As String, _
                                                                        YOSAN_TO As String, _
                                                                        HOST_SOKO As String, _
                                                                        HOST_TANA As String, _
                                                                        SYUK_CODE As String, _
                                                                        SYUK_NAME As String, _
                                                                        GENSANKOKU As String, GEN_GENSANKOKU As String, SHIIRE_WORK_CENTER As String, KANKYO_KBN As String, KANKYO_KBN_ST As String, KANKYO_KBN_SURYO As String, ID_NO2 As String, AITESAKI_CODE As String, JYUCHU_YMD As String, SHITEI_NOUKI_YMD As String, MOTO_TEXT_NO As String) As Integer
'----------------------------------------------------------------------------
'           è∆çáópì¸â◊ó\íËÉtÉ@ÉCÉãèoóÕèàóù
'           2007.06.15
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim ans     As Integer
        
        
Dim Loop_Cnt    As Integer  '2011.01.19
        
    Y_GLICS_PUT_PROC = True
        
    Call UniCode_Conv(Y_GLICSREC.KAN_KBN, KAN_KBN_FIN)
    Call UniCode_Conv(Y_GLICSREC.DT_SYU, "0")
    Call UniCode_Conv(Y_GLICSREC.JGYOBU, JGYOBU)
    Call UniCode_Conv(Y_GLICSREC.NAIGAI, NAIGAI)
    Call UniCode_Conv(Y_GLICSREC.TEXT_NO, TEXT_NO)


    Call UniCode_Conv(Y_GLICSREC.JGYOBA, "")
    Call UniCode_Conv(Y_GLICSREC.DATA_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.TORI_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.ID_NO, "")
    Call UniCode_Conv(Y_GLICSREC.KAIKEI_JGYOBA, "")
    Call UniCode_Conv(Y_GLICSREC.SHISAN_JGYOBA, "")
    
    Call UniCode_Conv(Y_GLICSREC.HIN_NO, HIN_GAI)
    Call UniCode_Conv(Y_GLICSREC.DEN_NO, DEN_NO)
    
    
    '2008.01.10 É}ÉCÉiÉXÇÃëŒâû
    If YOTEI_QTY >= 0 Then
        Call UniCode_Conv(Y_GLICSREC.SURYO, Format(CLng(YOTEI_QTY), "0000000"))
    Else
        Call UniCode_Conv(Y_GLICSREC.SURYO, Format(CLng(YOTEI_QTY), "000000"))
    End If
    
    Call UniCode_Conv(Y_GLICSREC.MUKE_CODE, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKO_YMD, DEN_DT)
    Call UniCode_Conv(Y_GLICSREC.TANKA, "")
    Call UniCode_Conv(Y_GLICSREC.ODER_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ITEM_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ODER_NO_R, "")
    Call UniCode_Conv(Y_GLICSREC.KOSO_KEITAI, "")
    Call UniCode_Conv(Y_GLICSREC.SYUKA_YMD, DEN_DT)
    Call UniCode_Conv(Y_GLICSREC.TANABAN1, "")
    Call UniCode_Conv(Y_GLICSREC.TANABAN2, "")
    Call UniCode_Conv(Y_GLICSREC.TANABAN3, "")
    Call UniCode_Conv(Y_GLICSREC.MUKE_NAME, "")
    Call UniCode_Conv(Y_GLICSREC.CYU_KBN, CYU_KBN)
    Call UniCode_Conv(Y_GLICSREC.CYU_KBN_NAME, "")
    Call UniCode_Conv(Y_GLICSREC.ORIGIN1, "")
    Call UniCode_Conv(Y_GLICSREC.ORIGIN2, "")
    Call UniCode_Conv(Y_GLICSREC.BIKOU2, "")
    Call UniCode_Conv(Y_GLICSREC.HAN_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.CHOKU_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.UNIT_ID_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ZAIKO_HIKIATE, "")
    Call UniCode_Conv(Y_GLICSREC.GOKON_KANRI_NO, "")
    Call UniCode_Conv(Y_GLICSREC.JYUCHU_ZAN, "")
    Call UniCode_Conv(Y_GLICSREC.KYOKYU_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.SHOHIN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.S_SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.S_HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.BIKOU1, "")
    Call UniCode_Conv(Y_GLICSREC.CHOHA_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.JYU_HIN_NO, "")
    Call UniCode_Conv(Y_GLICSREC.HIN_NAME, HIN_NAME)
    Call UniCode_Conv(Y_GLICSREC.HIN_CHANGE_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.MODULE_EXCHANGE, "")
    Call UniCode_Conv(Y_GLICSREC.ZAIKO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.ZAN_SHISAN_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.ZAN_HOJYO_SYUSI, "")
    Call UniCode_Conv(Y_GLICSREC.NOUKI_YMD, "")
    Call UniCode_Conv(Y_GLICSREC.SERVICE_KANRI_NO, "")
    Call UniCode_Conv(Y_GLICSREC.KI_HIN_NO, "")
    Call UniCode_Conv(Y_GLICSREC.ENVIRONMENT_KBN, "")
    Call UniCode_Conv(Y_GLICSREC.SS_CODE, "")
    Call UniCode_Conv(Y_GLICSREC.KEPIN_KAIJYO, "")
    
    
    Call UniCode_Conv(Y_GLICSREC.KAN_DT, Format(Now, "YYYYMMDD"))


                        'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
    Call UniCode_Conv(Y_GLICSREC.BEF_NYU_QTY, "00000000")

                        'ó\éZíPà å≥
    Call UniCode_Conv(Y_GLICSREC.YOSAN_FROM, YOSAN_FROM)
                        'ó\éZíPà êÊ
    Call UniCode_Conv(Y_GLICSREC.YOSAN_TO, YOSAN_TO)
                        'ïWèÄíIî‘
    Call UniCode_Conv(Y_GLICSREC.HTANABAN, "")
    Call UniCode_Conv(Y_GLICSREC.HIN_NAI, HIN_NAI)
                        'Hëqå… 2006.10.17
    Call UniCode_Conv(Y_GLICSREC.H_SOKO, HOST_SOKO)

                        'ì¸â◊ÉäÉXÉgèoóÕÉtÉâÉO   2007.06.12
    Call UniCode_Conv(Y_GLICSREC.NYU_LIST_OUT, " ")
                        'íºëóãÊï™
    Call UniCode_Conv(Y_GLICSREC.CYOK_KBN, CYOK_KBN)
                        'ì¸èoå…ãÊï™
    Call UniCode_Conv(Y_GLICSREC.IO_KBN, IO_KBN)
                        'ê‘çïãÊï™
    Call UniCode_Conv(Y_GLICSREC.PM_KBN, PM_KBN)
                        'ì`ï[éÌï 
    Call UniCode_Conv(Y_GLICSREC.DEN_SYU, DEN_SYU)
                        'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(Y_GLICSREC.SYUK_CODE, SYUK_CODE)
                        'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(Y_GLICSREC.SYUK_NAME, SYUK_NAME)
                        'ë}ì¸îNåéì˙
    Call UniCode_Conv(Y_GLICSREC.INS_NOW, INS_NOW)
    
    
    
    
    
    '----------------   2010.07.08 Å§
    Call UniCode_Conv(Y_GLICSREC.GENSANKOKU, GENSANKOKU)                    'å¥éYçëñº
    Call UniCode_Conv(Y_GLICSREC.GEN_GENSANKOKU, GEN_GENSANKOKU)            'åªï®ï\é¶å¥éYçëñº
    Call UniCode_Conv(Y_GLICSREC.SHIIRE_WORK_CENTER, SHIIRE_WORK_CENTER)    'éëçﬁédì¸êÊ‹∞∏æ›¿∞
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN, KANKYO_KBN)                    'ä¬ã´éÌóﬁãÊï™
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN_ST, KANKYO_KBN_ST)              'ä¬ã´éÌóﬁãÊï™ìKópäJén
    Call UniCode_Conv(Y_GLICSREC.KANKYO_KBN_SURYO, KANKYO_KBN_SURYO)        'ä¬ã´éÌóﬁãÊï™êîó 
    Call UniCode_Conv(Y_GLICSREC.ID_NO2, ID_NO2)                            'ID_NO
    Call UniCode_Conv(Y_GLICSREC.AITESAKI_CODE, AITESAKI_CODE)              'ëäéËêÊ∫∞ƒﬁ
    Call UniCode_Conv(Y_GLICSREC.JYUCHU_YMD, JYUCHU_YMD)                    'éÛíçîNåéì˙
    Call UniCode_Conv(Y_GLICSREC.SHITEI_NOUKI_YMD, SHITEI_NOUKI_YMD)        'éwíËî[ä˙îNåéì˙
    Call UniCode_Conv(Y_GLICSREC.LIST_OUT_END_F, "")                        'ì¸å…ÿΩƒèoóÕF
    Call UniCode_Conv(Y_GLICSREC.NYUKO_TANABAN, "")                         'ì¸å…íIî‘
    Call UniCode_Conv(Y_GLICSREC.MAEGARI_SURYO, "")                         'ëOéÿëäéEêî
    '----------------   2010.07.08 Å¢
    
    
    
    '2011.03.23 î≠ê∂å≥ÉvÉçÉOÉâÉÄ
    Call UniCode_Conv(Y_GLICSREC.MOTO_PROG_ID, StrConv(App.EXEName, vbUpperCase))
    '2011.03.23 å≥ÉeÉLÉXÉgáÇ
    If Trim(MOTO_TEXT_NO) = "" Then
        Call UniCode_Conv(Y_GLICSREC.MOTO_TEXT_NO, "")
    Else
        Call UniCode_Conv(Y_GLICSREC.MOTO_TEXT_NO, MOTO_TEXT_NO)
    End If
    
    
    
    
    
    
    
    Call UniCode_Conv(Y_GLICSREC.FILLER, "")


    Loop_Cnt = 0

    Do
        sts = BTRV(BtOpInsert, Y_GLICS_POS, Y_GLICSREC, Len(Y_GLICSREC), K0_Y_GLICS, Len(K0_Y_GLICS), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
'                Beep
'                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_GLICSKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
'                If ans = vbCancel Then
'                    Exit Function
'                End If
            
            
            
                Loop_Cnt = Loop_Cnt + 1
                If Loop_Cnt > 5 Then
                    Exit Function
                End If
            
                DoEvents
                Sleep (500)
            
            
            Case BtErrDEAD_LOCK
                Exit Function
            Case Else
                'Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)                '2016.06.23
                Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 1, Y_GLICS_ID)     '2016.06.23
                Exit Function
        End Select
    Loop

    Y_GLICS_PUT_PROC = False

End Function


Private Function MAEGARI_PROC(JGYOBU As String, HIN_GAI As String, YOTEI_QTY As String) As Integer
'----------------------------------------------------------------------------
'           è∆çáópì¸â◊ó\íËÉtÉ@ÉCÉãèoóÕèàóù
'           2018.11.15
'----------------------------------------------------------------------------
Dim com             As Integer
Dim wkYOTEI_QTY     As Long
Dim sts             As Integer
        
    MAEGARI_PROC = True
    'ïîïiëOéÿèàóù
    Call UniCode_Conv(K0_J_NYU.JGYOBU, JGYOBU)
    Call UniCode_Conv(K0_J_NYU.NAIGAI, NAIGAI_NAI)
    Call UniCode_Conv(K0_J_NYU.HIN_GAI, HIN_GAI)
                
                                'ëOéÿÇË√ﬁ∞¿ì«çûÇ›
    sts = BTRV(BtOpGetEqual, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    Select Case sts
        Case BtNoErr
            com = BtOpUpdate
        Case BtErrKeyNotFound
            com = BtOpInsert
            
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ì¸â◊é¿ê—ÉfÅ[É^")
            Exit Function
    End Select
    
    If com = BtOpInsert Then
                                'êVãKí«â¡
                                                'éñã∆ïî
        Call UniCode_Conv(J_NYUREC.JGYOBU, JGYOBU)
                                                'çëì‡äO
        Call UniCode_Conv(J_NYUREC.NAIGAI, NAIGAI_NAI)
                                                'ïiñ⁄ÅiäOïîÅj
        Call UniCode_Conv(J_NYUREC.HIN_GAI, HIN_GAI)
                                                'é¿ê—êîó 
        Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(Val(YOTEI_QTY), "00000000"))
                                                'ìoò^ì˙
        Call UniCode_Conv(J_NYUREC.INS_DATE, Format(Now, "YYYYMMDD"))
        
        
        
        Call UniCode_Conv(J_NYUREC.FILLER, "")
    Else
                                                'é¿ê—êîó 
        wkYOTEI_QTY = Val(YOTEI_QTY) + Val(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
        Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(wkYOTEI_QTY, "00000000"))
    End If
    '*------------------------------------------------------'ëOéÿÇËÉfÅ[É^èoóÕ
    sts = BTRV(com, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    Select Case sts
        Case BtNoErr
        
        Case Else
            Call File_Error(sts, com, "ì¸â◊é¿ê—ÉfÅ[É^")
            Exit Function
                
    End Select

    MAEGARI_PROC = False


End Function
