VERSION 5.00
Begin VB.Form PM000101 
   Caption         =   "ä«óùÉ}ÉXÉ^ÉÅÉìÉeÉiÉìÉX"
   ClientHeight    =   8250
   ClientLeft      =   1920
   ClientTop       =   2430
   ClientWidth     =   13155
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   8250
   ScaleWidth      =   13155
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   11
      Left            =   8295
      MaxLength       =   1
      TabIndex        =   11
      Top             =   2160
      Width           =   240
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   18
      Left            =   2280
      MaxLength       =   1
      TabIndex        =   18
      Top             =   6240
      Width           =   240
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   16
      Left            =   2280
      MaxLength       =   15
      TabIndex        =   16
      Top             =   5040
      Width           =   1935
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   15
      Left            =   2280
      MaxLength       =   15
      TabIndex        =   15
      Top             =   4440
      Width           =   1935
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
      Index           =   14
      Left            =   2280
      MaxLength       =   30
      TabIndex        =   14
      Top             =   3840
      Width           =   3735
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
      Index           =   13
      Left            =   2280
      MaxLength       =   30
      TabIndex        =   13
      Top             =   3240
      Width           =   3735
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   12
      Left            =   2280
      MaxLength       =   5
      TabIndex        =   12
      Top             =   2760
      Width           =   735
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   17
      Left            =   2280
      MaxLength       =   1
      TabIndex        =   17
      Top             =   5760
      Width           =   240
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   10
      Left            =   8295
      MaxLength       =   4
      TabIndex        =   10
      Top             =   1800
      Width           =   615
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   9
      Left            =   6135
      MaxLength       =   1
      TabIndex        =   9
      Top             =   2160
      Width           =   240
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   8
      Left            =   6135
      MaxLength       =   4
      TabIndex        =   8
      Top             =   1800
      Width           =   615
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   7
      Left            =   8055
      MaxLength       =   2
      TabIndex        =   7
      Top             =   1320
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   6
      Left            =   7215
      MaxLength       =   2
      TabIndex        =   6
      Top             =   1320
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   5
      Left            =   6135
      MaxLength       =   4
      TabIndex        =   5
      Top             =   1320
      Width           =   615
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   4
      Left            =   2280
      MaxLength       =   5
      TabIndex        =   4
      Top             =   2040
      Width           =   735
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   3
      Left            =   2280
      MaxLength       =   5
      TabIndex        =   3
      Top             =   1680
      Width           =   735
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   2
      Left            =   2280
      MaxLength       =   8
      TabIndex        =   2
      Top             =   1320
      Width           =   1050
   End
   Begin VB.TextBox Text1 
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   1
      Left            =   2280
      MaxLength       =   2
      TabIndex        =   1
      Top             =   600
      Width           =   375
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H8000000F&
      Height          =   375
      IMEMode         =   4  'ëSäpÇ–ÇÁÇ™Ç»
      Index           =   0
      Left            =   1200
      Locked          =   -1  'True
      MaxLength       =   16
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   120
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.CommandButton Command1 
      Caption         =   "èI óπ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   30
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   29
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   28
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   27
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   26
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Caption         =   "êø ãÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   24
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   21
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   20
      TabStop         =   0   'False
      Top             =   7320
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Caption         =   "çX êV"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   19
      Top             =   7320
      Width           =   855
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "édì¸ã‡äzÅ@ä€Çﬂ"
      Height          =   255
      Index           =   24
      Left            =   420
      TabIndex        =   55
      Top             =   6360
      Width           =   1710
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "îÑè„ã‡äzÅ@ä€Çﬂ"
      Height          =   255
      Index           =   22
      Left            =   420
      TabIndex        =   54
      Top             =   5880
      Width           =   1710
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "FAXî‘çÜ"
      Height          =   255
      Index           =   21
      Left            =   1200
      TabIndex        =   53
      Top             =   5160
      Width           =   975
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ìdòbî‘çÜ"
      Height          =   255
      Index           =   20
      Left            =   1200
      TabIndex        =   52
      Top             =   4560
      Width           =   975
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ÉZÉìÉ^Å[ñº"
      Height          =   255
      Index           =   19
      Left            =   840
      TabIndex        =   51
      Top             =   3960
      Width           =   1335
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "âÔé–ñº"
      Height          =   255
      Index           =   18
      Left            =   1440
      TabIndex        =   50
      Top             =   3360
      Width           =   735
   End
   Begin VB.Label LblS_TANTO 
      Alignment       =   1  'âEëµÇ¶
      Height          =   255
      Left            =   3120
      TabIndex        =   49
      Top             =   2880
      Width           =   2415
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "è≥îFé“"
      Height          =   255
      Index           =   17
      Left            =   1440
      TabIndex        =   48
      Top             =   2880
      Width           =   735
   End
   Begin VB.Label Label 
      Caption         =   "Å¶ä€Çﬂ:(0:êÿéÃÇƒ 5:éléÃå‹ì¸ 9:êÿè„Ç∞)"
      Height          =   255
      Index           =   16
      Left            =   6720
      TabIndex        =   47
      Top             =   720
      Width           =   4695
   End
   Begin VB.Label Label 
      Caption         =   "    ä€Çﬂ"
      Height          =   255
      Index           =   15
      Left            =   7215
      TabIndex        =   46
      Top             =   2280
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "%"
      Height          =   255
      Index           =   14
      Left            =   9015
      TabIndex        =   45
      Top             =   1920
      Width           =   135
   End
   Begin VB.Label Label 
      Caption         =   "êVÅ@ê≈ó¶"
      Height          =   255
      Index           =   13
      Left            =   7215
      TabIndex        =   44
      Top             =   1920
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "    ä€Çﬂ"
      Height          =   255
      Index           =   12
      Left            =   5055
      TabIndex        =   43
      Top             =   2280
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "%"
      Height          =   255
      Index           =   11
      Left            =   6855
      TabIndex        =   42
      Top             =   1920
      Width           =   135
   End
   Begin VB.Label Label 
      Caption         =   "åªÅ@ê≈ó¶"
      Height          =   255
      Index           =   10
      Left            =   5055
      TabIndex        =   41
      Top             =   1920
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "ì˙"
      Height          =   255
      Index           =   9
      Left            =   8535
      TabIndex        =   40
      Top             =   1440
      Width           =   255
   End
   Begin VB.Label Label 
      Caption         =   "åé"
      Height          =   255
      Index           =   8
      Left            =   7695
      TabIndex        =   39
      Top             =   1440
      Width           =   255
   End
   Begin VB.Label Label 
      Caption         =   "îN"
      Height          =   255
      Index           =   7
      Left            =   6855
      TabIndex        =   38
      Top             =   1440
      Width           =   255
   End
   Begin VB.Label Label 
      Caption         =   "è¡îÔê≈ïœçXì˙ït"
      Height          =   255
      Index           =   6
      Left            =   4335
      TabIndex        =   37
      Top             =   1440
      Width           =   1695
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "îÑè„áÇ"
      Height          =   255
      Index           =   5
      Left            =   1200
      TabIndex        =   36
      Top             =   2160
      Width           =   975
   End
   Begin VB.Label Label 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "íçï∂áÇ"
      Height          =   255
      Index           =   4
      Left            =   1200
      TabIndex        =   35
      Top             =   1800
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "éwê}ï[áÇ"
      Height          =   255
      Index           =   3
      Left            =   1200
      TabIndex        =   34
      Top             =   1440
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "(ññì˙=31)"
      Height          =   255
      Index           =   1
      Left            =   2760
      TabIndex        =   33
      Top             =   720
      Width           =   1095
   End
   Begin VB.Label Label 
      Caption         =   "åéññí˜ì˙"
      Height          =   255
      Index           =   0
      Left            =   1200
      TabIndex        =   32
      Top             =   720
      Width           =   975
   End
   Begin VB.Label Label 
      Caption         =   "⁄∫∞ƒﬁáÇ"
      Height          =   255
      Index           =   2
      Left            =   120
      TabIndex        =   31
      Top             =   240
      Visible         =   0   'False
      Width           =   975
   End
End
Attribute VB_Name = "PM000101"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


Private Const ptxRec_No% = 0                '⁄∫∞ƒﬁáÇ(ì¸óÕïsâ¬)
Private Const ptxSHIME_DD% = 1              'åéññí˜Çﬂèàóù

Private Const ptxSASHIZU_NO% = 2            'éwê}èëáÇ
Private Const ptxORDER_NO% = 3              'î≠íçáÇ
Private Const ptxURIAGE_NO% = 4             'éëçﬁîÑè„⁄∫∞ƒﬁáÇ

Private Const ptxZEI_CHANGE_YY% = 5         'è¡îÔê≈ïœçXì˙ït îN
Private Const ptxZEI_CHANGE_MM% = 6         'è¡îÔê≈ïœçXì˙ït åé
Private Const ptxZEI_CHANGE_DD% = 7         'è¡îÔê≈ïœçXì˙ït ì˙

Private Const ptxNOW_ZEI_RITU% = 8          'êVÅ@è¡îÔê≈ó¶
Private Const ptxNOW_MARUME% = 9            'Å@Å@ä€Çﬂ

Private Const ptxNEW_ZEI_RITU% = 10         'êVÅ@è¡îÔê≈ó¶
Private Const ptxNEW_MARUME% = 11           'Å@Å@ä€Çﬂ

Private Const ptxSHONIN_CODE% = 12          'è≥îFíSìñ
Private Const ptxKAISHA_NAME% = 13          'âÔé–ñº
Private Const ptxCENTER_NAME% = 14          'ÉZÉìÉ^Å[ñº
Private Const ptxTEL_NO% = 15               'ìdòbî‘çÜ
Private Const ptxFAX_NO% = 16               'FAXî‘çÜ

Private Const ptxURI_MARUME% = 17           'îÑè„ã‡äzÅ@ä€Çﬂ
Private Const ptxSHI_MARUME% = 18           'édì¸ã‡äzÅ@ä€Çﬂ







Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------

    PM000101.MousePointer = vbHourglass

    Call Ctrl_Lock(PM000101)


End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------

    Call Ctrl_UnLock(PM000101)


    PM000101.MousePointer = vbDefault

End Sub

Private Function Error_Check_Proc(Mode As Integer) As Integer
'----------------------------------------------------------------------------
'                   ì¸óÕçÄñ⁄ÇÃÉGÉâÅ[É`ÉFÉbÉN
'----------------------------------------------------------------------------
    
Dim sts As Integer
    
    
    Error_Check_Proc = True
    
    Select Case Mode
    
        Case ptxSHIME_DD    'åéññí˜Çﬂì˙
            If Not IsNumeric(Text1(ptxSHIME_DD).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSHIME_DD).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxSHIME_DD).Text) < 1 Or CInt(Text1(ptxSHIME_DD).Text) > 31 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSHIME_DD).SetFocus
                Exit Function
            End If
    
            Text1(ptxSHIME_DD).Text = Format(CInt(Text1(ptxSHIME_DD).Text), "00")
    
        Case ptxSASHIZU_NO  'éwê}èëáÇ
            
            If Not IsNumeric(Text1(ptxSASHIZU_NO).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSASHIZU_NO).SetFocus
                Exit Function
            End If
    
'            If CLng(Text1(ptxSASHIZU_NO).Text) < 0 Or CLng(Text1(ptxSASHIZU_NO).Text) > 99999 Then     '2007.11.28
            If CLng(Text1(ptxSASHIZU_NO).Text) < 0 Or CLng(Text1(ptxSASHIZU_NO).Text) > 99999999 Then   '2007.11.28
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSASHIZU_NO).SetFocus
                Exit Function
            End If
            
'            Text1(ptxSASHIZU_NO).Text = Format(CLng(Text1(ptxSASHIZU_NO).Text), "00000")       '2007.11.28
            Text1(ptxSASHIZU_NO).Text = Format(CLng(Text1(ptxSASHIZU_NO).Text), "00000000")     '2007.11.28
    
        Case ptxORDER_NO    'î≠íçáÇ
            
            If Not IsNumeric(Text1(ptxORDER_NO).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxORDER_NO).SetFocus
                Exit Function
            End If
    
            If CLng(Text1(ptxORDER_NO).Text) < 0 Or CLng(Text1(ptxORDER_NO).Text) > 99999 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxORDER_NO).SetFocus
                Exit Function
            End If
            
            Text1(ptxORDER_NO).Text = Format(CLng(Text1(ptxORDER_NO).Text), "00000")
    
        Case ptxURIAGE_NO   'éëçﬁîÑè„⁄∫∞ƒﬁáÇ
            
            If Not IsNumeric(Text1(ptxURIAGE_NO).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxURIAGE_NO).SetFocus
                Exit Function
            End If
    
            If CLng(Text1(ptxURIAGE_NO).Text) < 0 Or CLng(Text1(ptxURIAGE_NO).Text) > 99999 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxURIAGE_NO).SetFocus
                Exit Function
            End If
            
            Text1(ptxURIAGE_NO).Text = Format(CLng(Text1(ptxURIAGE_NO).Text), "00000")
    
        Case ptxZEI_CHANGE_YY 'è¡îÔê≈ïœçXì˙ïtÅ@îN
            If Not IsNumeric(Text1(ptxZEI_CHANGE_YY).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_YY).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxZEI_CHANGE_YY).Text) < 1 Or CInt(Text1(ptxZEI_CHANGE_YY).Text) > 9999 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_YY).SetFocus
                Exit Function
            End If
            
            Text1(ptxZEI_CHANGE_YY).Text = Format(CInt(Text1(ptxZEI_CHANGE_YY).Text), "0000")
    
        Case ptxZEI_CHANGE_MM 'è¡îÔê≈ïœçXì˙ïtÅ@åé
            If Not IsNumeric(Text1(ptxZEI_CHANGE_MM).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_MM).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxZEI_CHANGE_MM).Text) < 1 Or CInt(Text1(ptxZEI_CHANGE_MM).Text) > 12 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_MM).SetFocus
                Exit Function
            End If
            
            Text1(ptxZEI_CHANGE_MM).Text = Format(CInt(Text1(ptxZEI_CHANGE_MM).Text), "00")
    
        Case ptxZEI_CHANGE_DD   'è¡îÔê≈ïœçXì˙ïtÅ@ì˙
            If Not IsNumeric(Text1(ptxZEI_CHANGE_DD).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_DD).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxZEI_CHANGE_DD).Text) < 1 Or CInt(Text1(ptxZEI_CHANGE_DD).Text) > 31 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_DD).SetFocus
                Exit Function
            End If
            
            Text1(ptxZEI_CHANGE_DD).Text = Format(CInt(Text1(ptxZEI_CHANGE_DD).Text), "00")
            'ì˙ïtOKÅH
            If Not IsDate(Text1(ptxZEI_CHANGE_YY).Text & "/" & Text1(ptxZEI_CHANGE_MM).Text & "/" & Text1(ptxZEI_CHANGE_DD).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxZEI_CHANGE_YY).SetFocus
                Exit Function
            End If
    
        Case ptxNOW_ZEI_RITU    'åªÅ@ê≈ó¶
            If Not IsNumeric(Text1(ptxNOW_ZEI_RITU).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_ZEI_RITU).SetFocus
                Exit Function
            End If
    
            If CDbl(Text1(ptxNOW_ZEI_RITU).Text) < 0 Or CDbl(Text1(ptxNOW_ZEI_RITU).Text) > 99.9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_ZEI_RITU).SetFocus
                Exit Function
            End If
            
            Text1(ptxNOW_ZEI_RITU).Text = Format(CDbl(Text1(ptxNOW_ZEI_RITU).Text), "#0.0")
    
        Case ptxNOW_MARUME      'åªÅ@ä€Çﬂ
            If Not IsNumeric(Text1(ptxNOW_MARUME).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_MARUME).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxNOW_MARUME).Text) <> 0 And _
                CInt(Text1(ptxNOW_MARUME).Text) <> 5 And _
                CInt(Text1(ptxNOW_MARUME).Text) <> 9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_MARUME).SetFocus
                Exit Function
            End If
            
        Case ptxNEW_ZEI_RITU    'êVÅ@ê≈ó¶
            If Not IsNumeric(Text1(ptxNEW_ZEI_RITU).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_ZEI_RITU).SetFocus
                Exit Function
            End If
    
            If CDbl(Text1(ptxNEW_ZEI_RITU).Text) < 0 Or CDbl(Text1(ptxNEW_ZEI_RITU).Text) > 99.9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNOW_ZEI_RITU).SetFocus
                Exit Function
            End If
            
            Text1(ptxNEW_ZEI_RITU).Text = Format(CDbl(Text1(ptxNEW_ZEI_RITU).Text), "#0.0")
    
        Case ptxNEW_MARUME      'åªÅ@ä€Çﬂ
            If Not IsNumeric(Text1(ptxNEW_MARUME).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNEW_MARUME).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxNEW_MARUME).Text) <> 0 And _
                CInt(Text1(ptxNEW_MARUME).Text) <> 5 And _
                CInt(Text1(ptxNEW_MARUME).Text) <> 9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxNEW_MARUME).SetFocus
                Exit Function
            End If
    
        Case ptxSHONIN_CODE     'è≥îFíSìñé“∫∞ƒﬁ
            If Trim(Text1(ptxSHONIN_CODE).Text) = "" Then
                LblS_TANTO.Caption = ""
            Else
                Call UniCode_Conv(K0_TANTO.TANTO_CODE, Text1(ptxSHONIN_CODE).Text)
            
                sts = BTRV(BtOpGetEqual, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
                Select Case sts
                    Case BtNoErr
                        LblS_TANTO.Caption = StrConv(TANTOREC.TANTO_NAME, vbUnicode)
                    Case BtErrKeyNotFound
                        LblS_TANTO.Caption = ""
                        MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                        Text1(ptxSHONIN_CODE).SetFocus
                        Exit Function
                    Case Else
                        Call File_Error(sts, BtOpGetEqual, "íSìñé“É}ÉXÉ^")
                        Exit Function
                End Select
            
            
            End If
    
    
        Case ptxKAISHA_NAME     'âÔé–ñº
        Case ptxCENTER_NAME     'âÔé–ñº
        Case ptxTEL_NO          'ìdòbî‘çÜ
        Case ptxFAX_NO          'FAXî‘çÜ
    
        Case ptxURI_MARUME      'îÑè„ã‡äzÅ@ä€Çﬂ
            If Not IsNumeric(Text1(ptxURI_MARUME).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxURI_MARUME).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxURI_MARUME).Text) <> 0 And _
                CInt(Text1(ptxURI_MARUME).Text) <> 5 And _
                CInt(Text1(ptxURI_MARUME).Text) <> 9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxURI_MARUME).SetFocus
                Exit Function
            End If
    
        Case ptxSHI_MARUME      'édì¸ã‡äzÅ@ä€Çﬂ
            If Not IsNumeric(Text1(ptxSHI_MARUME).Text) Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSHI_MARUME).SetFocus
                Exit Function
            End If
    
            If CInt(Text1(ptxSHI_MARUME).Text) <> 0 And _
                CInt(Text1(ptxSHI_MARUME).Text) <> 5 And _
                CInt(Text1(ptxSHI_MARUME).Text) <> 9 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB"
                Text1(ptxSHI_MARUME).SetFocus
                Exit Function
            End If
    
    
    
    End Select
        
        
    Error_Check_Proc = False
    

End Function
Private Function Item_Disp_Proc() As Integer
'----------------------------------------------------------------------------
'                   âÊñ ï\é¶
'----------------------------------------------------------------------------
Dim sts As Integer
Dim i   As Integer

    Item_Disp_Proc = True
    
    'ä«óùœΩ¿ÅiKEY=0Åjì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_KANRI.REC_NO, P_ST_KANRI_No)
    
    
    
    Text1(ptxRec_No).Text = P_ST_KANRI_No   '⁄∫∞ƒﬁáÇ
    
    sts = BTRV(BtOpGetEqual, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
    Select Case sts
        Case BtNoErr
            '⁄∫∞ƒﬁì‡óeÇÃï\é¶
                                            'åéññí˜Çﬂì˙
            Text1(ptxSHIME_DD).Text = StrConv(P_KANRIREC.SHIME_DD, vbUnicode)
                                            'éwê}èëáÇ
            Text1(ptxSASHIZU_NO).Text = StrConv(P_KANRIREC.SASHIZU_NO, vbUnicode)
                                            'î≠íçáÇ
            Text1(ptxORDER_NO).Text = StrConv(P_KANRIREC.ORDER_NO, vbUnicode)
                                            'éëçﬁîÑè„⁄∫∞ƒﬁáÇ
            Text1(ptxURIAGE_NO).Text = StrConv(P_KANRIREC.URIAGE_NO, vbUnicode)
                                            'è¡îÔê≈ïœçXì˙ït îN
            Text1(ptxZEI_CHANGE_YY).Text = Left(StrConv(P_KANRIREC.ZEI_CHANGE_YMD, vbUnicode), 4)
                                            'è¡îÔê≈ïœçXì˙ït åé
            Text1(ptxZEI_CHANGE_MM).Text = Mid(StrConv(P_KANRIREC.ZEI_CHANGE_YMD, vbUnicode), 5, 2)
                                            'è¡îÔê≈ïœçXì˙ït ì˙
            Text1(ptxZEI_CHANGE_DD).Text = Right(StrConv(P_KANRIREC.ZEI_CHANGE_YMD, vbUnicode), 2)
                                            'åªÅ@è¡îÔê≈ó¶
            Text1(ptxNOW_ZEI_RITU).Text = Format(CDbl(StrConv(P_KANRIREC.NOW_ZEI_RITU, vbUnicode)), "#0.0")
                                            'åªÅ@ä€Çﬂ
            Text1(ptxNOW_MARUME).Text = StrConv(P_KANRIREC.NOW_MARUME, vbUnicode)
                                            'êVÅ@è¡îÔê≈ó¶
            Text1(ptxNEW_ZEI_RITU).Text = Format(CDbl(StrConv(P_KANRIREC.NEW_ZEI_RITU, vbUnicode)), "#0.0")
                                            'êVÅ@ä€Çﬂ
            Text1(ptxNEW_MARUME).Text = StrConv(P_KANRIREC.NEW_MARUME, vbUnicode)
                                            'è≥îFíSìñé“
            Text1(ptxSHONIN_CODE).Text = Trim(StrConv(P_KANRIREC.SHONIN_CODE, vbUnicode))
        
            Call UniCode_Conv(K0_TANTO.TANTO_CODE, Text1(ptxSHONIN_CODE).Text)
        
            sts = BTRV(BtOpGetEqual, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
            Select Case sts
                Case BtNoErr
                    LblS_TANTO.Caption = StrConv(TANTOREC.TANTO_NAME, vbUnicode)
                Case BtErrKeyNotFound
                    LblS_TANTO.Caption = ""
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "íSìñé“É}ÉXÉ^")
                    Exit Function
            End Select
                                            'âÔé–ñº
            Text1(ptxKAISHA_NAME).Text = Trim(StrConv(P_KANRIREC.KAISHA_NAME, vbUnicode))
                                            'ÉZÉìÉ^Å[ñº
            Text1(ptxCENTER_NAME).Text = Trim(StrConv(P_KANRIREC.CENTER_NAME, vbUnicode))
                                            'ìdòbî‘çÜ
            Text1(ptxTEL_NO).Text = Trim(StrConv(P_KANRIREC.TEL_NO, vbUnicode))
                                            'FAXî‘çÜ
            Text1(ptxFAX_NO).Text = Trim(StrConv(P_KANRIREC.FAX_NO, vbUnicode))
                                            'îÑè„ã‡äzÅ@ä€Çﬂ
            Text1(ptxURI_MARUME).Text = StrConv(P_KANRIREC.URI_MARUME, vbUnicode)
                                            'édì¸ã‡äzÅ@ä€Çﬂ
            Text1(ptxSHI_MARUME).Text = StrConv(P_KANRIREC.SHI_MARUME, vbUnicode)
        
        
        Case BtErrKeyNotFound
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ä«óùÉ}ÉXÉ^")
            Exit Function
    End Select

    Item_Disp_Proc = False

End Function

Private Function Update_Proc() As Integer
'----------------------------------------------------------------------------
'                   ä«óùÉ}ÉXÉ^èoóÕ
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim ans     As Integer
Dim com     As Integer


    Update_Proc = True
    'ä«óùœΩ¿ÅiKEY=0Åjì«Ç›çûÇ›
    Call UniCode_Conv(K0_P_KANRI.REC_NO, P_ST_KANRI_No)
    
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                com = BtOpInsert
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_KANRI.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Update_Proc = True
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^")
                Exit Function
        
        End Select
    
    
    Loop
    '--------------------------------------------------------ÉåÉRÅ[Éhì‡óeï“èW
    
    Call UniCode_Conv(P_KANRIREC.REC_NO, P_ST_KANRI_No)                                 '⁄∫∞ƒﬁáÇ
    Call UniCode_Conv(P_KANRIREC.SHIME_DD, Text1(ptxSHIME_DD).Text)                     'åéññí˜Çﬂì˙
    
    Call UniCode_Conv(P_KANRIREC.xSASHIZU_NO, "")                                       'éwê}èëáÇ2007.11.28
    
    Call UniCode_Conv(P_KANRIREC.SASHIZU_NO, Text1(ptxSASHIZU_NO).Text)                 'éwê}èëáÇ
    Call UniCode_Conv(P_KANRIREC.ORDER_NO, Text1(ptxORDER_NO).Text)                     'íçï∂áÇ
    Call UniCode_Conv(P_KANRIREC.URIAGE_NO, Text1(ptxURIAGE_NO).Text)                   'éëçﬁîÑè„⁄∫∞ƒﬁáÇ
    Call UniCode_Conv(P_KANRIREC.ZEI_CHANGE_YMD, Text1(ptxZEI_CHANGE_YY).Text & _
                                            Text1(ptxZEI_CHANGE_MM).Text & _
                                            Text1(ptxZEI_CHANGE_DD).Text)               'è¡îÔê≈ïœçXì˙ït
    Call UniCode_Conv(P_KANRIREC.NOW_ZEI_RITU, Format(CDbl(Text1(ptxNOW_ZEI_RITU).Text), "00.0"))   'åªÅ@ê≈ó¶
    Call UniCode_Conv(P_KANRIREC.NOW_MARUME, Text1(ptxNOW_MARUME).Text)                             'åªÅ@Ç‹ÇÈÇﬂ
    Call UniCode_Conv(P_KANRIREC.NEW_ZEI_RITU, Format(CDbl(Text1(ptxNEW_ZEI_RITU).Text), "00.0"))   'êVÅ@ê≈ó¶
    Call UniCode_Conv(P_KANRIREC.NEW_MARUME, Text1(ptxNEW_MARUME).Text)                             'êVÅ@Ç‹ÇÈÇﬂ
    Call UniCode_Conv(P_KANRIREC.SHONIN_CODE, Text1(ptxSHONIN_CODE).Text)               'è≥îFíSìñé“
    Call UniCode_Conv(P_KANRIREC.KAISHA_NAME, Text1(ptxKAISHA_NAME).Text)               'âÔé–ñº
    Call UniCode_Conv(P_KANRIREC.CENTER_NAME, Text1(ptxCENTER_NAME).Text)               'ÉZÉìÉ^Å[ñº
    Call UniCode_Conv(P_KANRIREC.TEL_NO, Text1(ptxTEL_NO).Text)                         'ìdòbî‘çÜ
    Call UniCode_Conv(P_KANRIREC.FAX_NO, Text1(ptxFAX_NO).Text)                         'FAXî‘çÜ
    
    Call UniCode_Conv(P_KANRIREC.URI_MARUME, Text1(ptxURI_MARUME).Text)                 'îÑè„ã‡äzÅ@ä€Çﬂ
    Call UniCode_Conv(P_KANRIREC.SHI_MARUME, Text1(ptxSHI_MARUME).Text)                 'édì¸ã‡äzÅ@ä€Çﬂ
        
    
    Call UniCode_Conv(P_KANRIREC.FILLER, "")                                            'Filler
    
    
    Do
        
        DoEvents
        
        sts = BTRV(com, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_KANRI.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    sts = BTRV(BtOpUnlock, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
                    Exit Do
                End If
            Case Else
                Call File_Error(sts, com, "ä«óùÉ}ÉXÉ^")
                Exit Function
        End Select
    Loop

    Update_Proc = False


End Function


Private Sub Command1_Click(Index As Integer)

Dim ans As Integer
Dim i   As Integer

    Select Case Index
        Case P_CMD_Upd        'çXêV
            
            
            For i = ptxRec_No To ptxSHONIN_CODE
            
                If Error_Check_Proc(i) Then     'ÉGÉâÅ[É`ÉFÉbÉN
                    Exit Sub
                End If
            
            Next i
            
            Beep
            ans = MsgBox("çXêVÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If ans = vbYes Then
                If Update_Proc() Then
                    Unload Me
                End If
            End If
            Text1(ptxSASHIZU_NO).SetFocus
        Case P_CMD_DEL                      'çÌèú
        Case P_CMD_DSP                      'åüçı/ï\é¶
        
        Case 5                              'êøãÅä÷òAçÄñ⁄Ç÷ 2008.02.13
        
            PM000102.Show vbModal
        
        
        Case P_CMD_OUT                      '√ﬁ∞¿èoóÕ
        Case P_CMD_PRT                      'àÛç¸
        
        Case P_CMD_End                      'èIóπ
            Unload Me
    End Select

End Sub

Private Sub Form_DblClick()
'    PrintForm
End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
'----------------------------------------------------------------------------
'                   ÇjÇÖÇô ÇcÇèÇóÇé ëOèàóù
'----------------------------------------------------------------------------
    Select Case KeyCode
        Case vbKeyF1 To vbKeyF12
            Command1(KeyCode - vbKeyF1).Value = True
    End Select

End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub

Private Sub Form_Load()

Dim c       As String * 128

    If App.PrevInstance Then
        Beep
        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If

                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
'    If GetIni("FILE", "LOGF", "SYS", c) Then
    If GetIni(App.EXEName, "LOGF", App.EXEName, c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                
    PM000101.Caption = PM000101.Caption & LAST_UPDATE_DAY
                                
                                
                                'ä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If P_KANRI_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'íSìñé“É}ÉXÉ^ÇnÇoÇdÇm
    If TANTO_Open(BtOpenNomal) Then
        Unload Me
    End If
    
    Show
                                
                                'âÊñ èâä˙ê›íË
    If Item_Disp_Proc() Then
        Unload Me
    End If
                                
    Text1(ptxSHIME_DD).SetFocus
    
End Sub

Private Sub Form_Unload(CANCEL As Integer)
Dim sts As Integer
    
                                            'ä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ä«óùÉ}ÉXÉ^")
        End If
    End If
    
                                            'íSìñé“É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "íSìñé“É}ÉXÉ^")
        End If
    End If
    
    sts = BTRV(BtOpReset, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set PM000101 = Nothing

    End
End Sub

Private Sub Text1_GotFocus(Index As Integer)
    
    If Text1(Index).TabStop = True Then
        Text1(Index) = Trim(Text1(Index).Text)
        Text1(Index).SelStart = 0
        Text1(Index).SelLength = Len(Text1(Index).Text)
    End If

End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    
    If KeyCode <> vbKeyReturn Then Exit Sub
        
        
    If Error_Check_Proc(Index) Then     'ÉGÉâÅ[É`ÉFÉbÉN
        Exit Sub
    End If
        
        
    Call Tab_Ctrl(Shift)        'à⁄ìÆ
End Sub

