VERSION 5.00
Begin VB.Form F1020121 
   BackColor       =   &H00FFFFFF&
   Caption         =   "ì¸èoâ◊ó\íËÉfÅ[É^éÊçûÇ›Åuë‹à‰ópÅv"
   ClientHeight    =   6324
   ClientLeft      =   1908
   ClientTop       =   2388
   ClientWidth     =   11220
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   6324
   ScaleWidth      =   11220
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text1 
      Height          =   360
      Index           =   1
      Left            =   4800
      TabIndex        =   38
      Top             =   1560
      Visible         =   0   'False
      Width           =   1212
   End
   Begin VB.TextBox Text1 
      Height          =   360
      Index           =   0
      Left            =   3480
      TabIndex        =   37
      Top             =   1560
      Visible         =   0   'False
      Width           =   1212
   End
   Begin VB.ListBox LBox_Dup 
      ForeColor       =   &H00000080&
      Height          =   288
      Left            =   9840
      Sorted          =   -1  'True
      TabIndex        =   31
      Top             =   3240
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.CommandButton SelCmd 
      Caption         =   "çƒéÊçû"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   0
      Left            =   1440
      MaskColor       =   &H0080C0FF&
      TabIndex        =   4
      Top             =   3000
      UseMaskColor    =   -1  'True
      Visible         =   0   'False
      Width           =   1092
   End
   Begin VB.CommandButton SelCmd 
      Caption         =   "ì¡îÑ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   4
      Left            =   1440
      MaskColor       =   &H0080C0FF&
      TabIndex        =   3
      Top             =   2400
      UseMaskColor    =   -1  'True
      Visible         =   0   'False
      Width           =   1092
   End
   Begin VB.ListBox LBox_Hin 
      ForeColor       =   &H00000080&
      Height          =   288
      Left            =   9840
      Sorted          =   -1  'True
      TabIndex        =   16
      Top             =   2280
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.ListBox LBox_Etc 
      ForeColor       =   &H00000080&
      Height          =   288
      Left            =   9840
      Sorted          =   -1  'True
      TabIndex        =   14
      Top             =   1200
      Visible         =   0   'False
      Width           =   1215
   End
   Begin VB.CommandButton SelCmd 
      Caption         =   "ÇPï÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   1
      Left            =   1440
      MaskColor       =   &H0080C0FF&
      TabIndex        =   1
      Top             =   1200
      UseMaskColor    =   -1  'True
      Visible         =   0   'False
      Width           =   1092
   End
   Begin VB.CommandButton SelCmd 
      Caption         =   "ÇQï÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   2
      Left            =   1440
      MaskColor       =   &H0080C0FF&
      TabIndex        =   2
      Top             =   1800
      UseMaskColor    =   -1  'True
      Visible         =   0   'False
      Width           =   1092
   End
   Begin VB.CommandButton SelCmd 
      Caption         =   "ÇRï÷"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   3
      Left            =   1440
      MaskColor       =   &H0080C0FF&
      TabIndex        =   0
      Top             =   600
      UseMaskColor    =   -1  'True
      Visible         =   0   'False
      Width           =   1092
   End
   Begin VB.CommandButton Command 
      Caption         =   "èI  óπ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   28
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   25
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   23
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   21
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   19
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.Label Label3 
      BackColor       =   &H00FFFFFF&
      Caption         =   "Å^"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   612
      Index           =   3
      Left            =   8400
      TabIndex        =   42
      Top             =   4080
      Width           =   492
   End
   Begin VB.Label Label3 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   2
      Left            =   9000
      TabIndex        =   41
      Top             =   4080
      Width           =   1452
   End
   Begin VB.Label Label3 
      BackColor       =   &H00FFFFFF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   1
      Left            =   6720
      TabIndex        =   40
      Top             =   4080
      Width           =   1452
   End
   Begin VB.Label Label3 
      BackColor       =   &H00FFFFFF&
      Caption         =   "éÊçûÇ›èàóùíÜÅ@éÊçûÇ›åèêîÅÅ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   18
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   492
      Index           =   0
      Left            =   1680
      TabIndex        =   39
      Top             =   4080
      Width           =   4932
   End
   Begin VB.Label Label2 
      BackColor       =   &H8000000E&
      Caption         =   "ì¡îÑÇË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   252
      Index           =   1
      Left            =   4920
      TabIndex        =   36
      Top             =   1320
      Visible         =   0   'False
      Width           =   852
   End
   Begin VB.Label Label2 
      BackColor       =   &H8000000E&
      Caption         =   "SPIC"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   252
      Index           =   0
      Left            =   3720
      TabIndex        =   35
      Top             =   1320
      Visible         =   0   'False
      Width           =   612
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "èoâ◊èdï°ï™àÛç¸íÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   9
      Left            =   1920
      TabIndex        =   34
      Top             =   5040
      Visible         =   0   'False
      Width           =   4320
   End
   Begin VB.Label Label4 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "Åiïiî‘ïœçXï€óØï™ÅEèoâ◊èdï°ï™Åj"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   240
      Index           =   1
      Left            =   2640
      TabIndex        =   32
      Top             =   3240
      Visible         =   0   'False
      Width           =   3780
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "èoâ◊èdï°"
      ForeColor       =   &H00000080&
      Height          =   240
      Left            =   9840
      TabIndex        =   30
      Top             =   2880
      Visible         =   0   'False
      Width           =   960
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ï€óØÉfÅ[É^çƒèàóùíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   0
      Left            =   1920
      TabIndex        =   27
      Top             =   5040
      Visible         =   0   'False
      Width           =   4800
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ïiî‘ïœçXÉäÉXÉgàÛç¸íÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   7
      Left            =   2520
      TabIndex        =   26
      Top             =   5040
      Visible         =   0   'False
      Width           =   5280
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîFàÍóóàÛç¸íÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   6
      Left            =   1440
      TabIndex        =   24
      Top             =   5040
      Visible         =   0   'False
      Width           =   7680
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "éÛêMÉGÉâÅ[ÉäÉXÉgàÛç¸íÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   5
      Left            =   2400
      TabIndex        =   22
      Top             =   5040
      Visible         =   0   'False
      Width           =   5760
   End
   Begin VB.Label Label7 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ïiî‘ïœçX"
      ForeColor       =   &H00000080&
      Height          =   240
      Left            =   9840
      TabIndex        =   20
      Top             =   1920
      Visible         =   0   'False
      Width           =   960
   End
   Begin VB.Label Label5 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "éÛêM¥◊∞ÿΩƒ"
      ForeColor       =   &H00000080&
      Height          =   240
      Left            =   9840
      TabIndex        =   18
      Top             =   840
      Visible         =   0   'False
      Width           =   1200
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ÇRï÷éÊçûÇ›èàóùíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   3
      Left            =   3000
      TabIndex        =   12
      Top             =   5040
      Visible         =   0   'False
      Width           =   4320
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ÇQï÷éÊçûÇ›èàóùíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   2
      Left            =   3240
      TabIndex        =   11
      Top             =   5040
      Visible         =   0   'False
      Width           =   4320
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ÇPï÷éÊçûÇ›èàóùíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   1
      Left            =   3000
      TabIndex        =   9
      Top             =   5040
      Visible         =   0   'False
      Width           =   4320
   End
   Begin VB.Label Label4 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ÅiÅuÇRï÷ÅvÅuÇPï÷ÅvÅuÇQï÷ÅvîΩì]ï\é¶ÇÕñ{ì˙éÊçûÇ›çœÅj"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   240
      Index           =   0
      Left            =   2640
      TabIndex        =   8
      Top             =   840
      Visible         =   0   'False
      Width           =   6300
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ëOéÿÇËì¸â◊ÅAé¿ê—écÉ`ÉFÉbÉNíÜÅIÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   8
      Left            =   1440
      TabIndex        =   29
      Top             =   5040
      Visible         =   0   'False
      Width           =   7680
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ì¡îÑéÊçûÇ›èàóùíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   480
      Index           =   4
      Left            =   1920
      TabIndex        =   33
      Top             =   5040
      Visible         =   0   'False
      Width           =   4320
   End
End
Attribute VB_Name = "F1020121"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'#################################################################################################
'ÅmÉeÉLÉXÉgÉtÉ@ÉCÉãèàóùÇÃíçà”ÅIÅIÅn
'
'Å@Å@Ç±ÇÃÉvÉçÉOÉâÉÄÇ≈ÇÕÅAÉeÉLÉXÉgÉtÉ@ÉCÉãÇÉÜÅ[ÉUÅ[íËã`å^ÇÃç\ë¢ëÃÇ≈ì«èëÇ´ÇµÇƒÇ¢ÇÈÅB
'Å@Å@Ç±ÇÃå`éÆÇ…ÇÊÇÈÇhÅ|ÇnÇÕÅAÅuGETÅvÇ®ÇÊÇ—ÅuPUTÅvΩ√∞ƒ“›ƒÇ…ÇÊÇËçsÇ§éñÇ…Ç»ÇÈÇ™ÅAÇ±ÇÍÇÁÇÃΩ√∞ƒ“›ƒ
'Å@Å@ÇégópÇ∑ÇÈà◊Ç…ÇÕÅAÅuRANDOMÅvÇ‹ÇΩÇÕÅuBINARYÅvÉÇÅ[ÉhÇ≈ÅuOPENÅvÇµÇ»ÇØÇÍÇŒÇ»ÇÁÇ»Ç¢ÅB
'Å@Å@íAÇµÅAà»â∫ÇÃÉçÉWÉbÉNÇ≈ÇÕÅAÉeÉLÉXÉgÉtÉ@ÉCÉãÇÃë∂ç›ÇÉ`ÉFÉbÉNÇ∑ÇÈñ⁄ìIÇ≈ÅuINPUTÅvÉÇÅ[ÉhÇ…ÇÊÇÈ
'Å@Å@ÅuOPENÅvÇ‡çsÇ¡ÇƒÇ®ÇËÅAë∂ç›É`ÉFÉbÉNå„ÅAÇ∑ÇÆÇ…ì«çûÇ›ÇçsÇ§ólÇ»èÍçáÇ…ÇÕÅAàÍíUÅuCLOSEÅvÇµÇƒÇ©ÇÁ
'Å@Å@ÅuBINARYÉÇÅ[ÉhÇ≈OPENÅvÇµÇƒÇ¢ÇÈéñÇ…íçà”Ç™ïKóvÅB
'
'Å@Å@Å¶ÅDÅuINPUTÅvÉÇÅ[ÉhOPENÇ≈ÇÕÅAÅuINPUT#ÅvÅuOUTPUT#ÅvÇÃÇ›égópÇ≈Ç´ÇÈÇ™ÅAÇ±ÇÍÇÁÇÕç\ë¢ëÃÇÃÉÅÉìÉo
'Å@Å@Å@Å@íPà ÇÃÇhÅ|ÇnÇ…Ç»ÇÈÅB
'#################################################################################################
Private Type YUKO_SOKO_TBL1             'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÉeÅ[ÉuÉãÅiêÙëÛã@éñã∆ïîÅj
    HS_SOKO As String * 2
    NAIGAI As String * 1
End Type
Dim SOKO_T1(ZERO To 9) As YUKO_SOKO_TBL1

Dim WS_NO As String * 2                 '‹∞∏Ω√∞ºÆ›î‘çÜ

Dim HS_NaiG As String                   'çëì‡äOÅiåàíËì‡óeÅj••••Å@ŒΩƒ√ﬁ∞¿ì‡óeÇ…ÇÊÇËê›íË
Dim BEF_GAI As String * 13              'ïœçXëOïiî‘ÅiäOïîÅj
Dim BEF_NAI As String * 13              'ïœ çXëOïiî‘Åiì‡ïîÅj

Dim PRT_CAN As Boolean                  'àÛç¸ìríÜÉLÉÉÉìÉZÉãóvãÅ
Dim NormalFont As New StdFont           'àÛç¸ÉtÉHÉìÉg

Private Const LMAX% = 46                'ï≈ì‡ç≈ëÂçsêî
Private Const MGN_L% = 1                'ñæç◊àÛç¸äJénåÖà íuÅiÇPÇ©ÇÁÅj
Private Const MGN_U% = 1                'è„ó]îíÅiçsêîÅFÇPÇ©ÇÁÅj
Private Const MGN_L2% = 20              'ÅuâﬂèËëOéÿïiÿΩƒÅvñæç◊àÛç¸äJénåÖà íuÅiÇPÇ©ÇÁÅj
Private Const MGN_U2% = 1               'ÅuâﬂèËëOéÿïiÿΩƒÅvè„ó]îíÅiçsêîÅFÇPÇ©ÇÁÅj
Dim Pdate As String                     'àÛç¸äJénì˙ïtÅiÕØ¿ﬁ∞ópÅj
Dim Ptime As String                     'àÛç¸äJénéûçèÅiÕØ¿ﬁ∞ópÅj

Dim Proc_F As Integer                   'ïiî‘Åïç›å…óLñ≥Å@îªíËÉtÉâÉO
Dim Last_Proc_F As Integer              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉO

Dim Shori_Mode  As Integer
Private Const Text_Max% = 1
                                    
Private Const Er_Soko_NoT% = True       'ÉzÉXÉgëqå…àŸèÌ
Private Const Er_Item_NoT% = True       'ì`ï[ì˙ïtÅ^ïiî‘Å^ì¸èoå…ãÊï™àŸèÌ
Private Const Er_Dup_NoT% = True        'ì`ï[èdï°
Private Const Er_Muke_NoT% = True       'å¸ÇØêÊàŸèÌ
                                    
                                    'âÊñ èâä˙ï\é¶ÅièàóùçœÅuï÷Åvï\é¶Ç»Ç«Åj
Private Sub Scr_Init()
Dim i As Integer
Dim sts As Integer
Dim Work As String

    For i = 1 To 3
        Work = Format(Date, "ddd") & "." & Format(i, "0") & "00"
        sts = XX_SIJ_Open(Work, ZERO)
        If sts = False Then
            Close #XX_SIJ_No
            If Format(FileDateTime(Work), "yyyy/mm/dd") = Format(Date, "yyyy/mm/dd") Then
                SelCmd(i).Enabled = False
            Else
                SelCmd(i).Enabled = True
            End If
        Else
            SelCmd(i).Enabled = True
        End If
    Next i


End Sub
                                            'ÉzÉXÉgÉfÅ[É^éÊçûÇ›èàóù
Private Function Data_Inport() As Integer
Dim sts         As Integer
Dim ans         As Integer
Dim Command     As Integer
Dim FPass       As String
Dim Work        As String
Dim FP_XX_SIJ   As String
Dim FP_ER_SIJ   As String
Dim FP_CHGHIN   As String
Dim FP_SYUDUP   As String

Dim In_Cnt      As Integer

    On Error Resume Next    'FileCopy / Kill Ω√∞ƒ“›ƒÇ≈ÇÃÃß≤Ÿñ≥ÇµÇÕéüΩ√ØÃﬂÇé¿çs

    Call Input_Lock                                 'âÊñ çÄñ⁄ÉçÉbÉN

    MsgLab(Shori_Mode).Visible = True       'çXêVíÜ“Øæ∞ºﬁï\é¶
    DoEvents

'ÉzÉXÉgï÷ï ÉèÅ[ÉNÅ@çÌèú

    sts = GetIni("FILE", XX_SIJ_ID, "SYS", FPass)
    If sts <> False Then
        MsgBox "SYS.INI [FILE][" & XX_SIJ_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ "
        Call Log_Out(LOG_F, "SYS.INI [FILE][" & XX_SIJ_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ ")
        Unload Me
    End If
    FP_XX_SIJ = RTrim(FPass) & Format(Date, "ddd") & "." & Format(Shori_Mode, "0") & "00"
    Kill FP_XX_SIJ
    FP_ER_SIJ = RTrim(FPass) & Format(Date, "ddd") & "." & Format(Shori_Mode, "0") & "0E"
    Kill FP_XX_SIJ

'Ãß≤Ÿ OPEN
    Work = Format(Date, "ddd") & "." & Format(Shori_Mode, "0") & "00"
    If XX_SIJ_Open(Work, 1) Then            'éÊçûÇ›‹∞∏
        Unload Me
    End If

    Work = Format(Date, "ddd") & "." & Format(Shori_Mode, "0") & "0E"
    If ER_SIJ_Open(Work, 1) Then            'éÊçûÇ›‹∞∏[ëŒè€äO√ﬁ∞¿óp]
        Close #XX_SIJ_No
        Unload Me
    End If
    
    If CHGH_Open() Then                     'ïiî‘ïœçXï€óØ√ﬁ∞¿
        Unload Me
    End If
    
    If SYUDUP_Open() Then                   'èoâ◊ó\íËèdï°√ﬁ∞¿
        Unload Me
    End If


    Call Data_Load                          'ï÷ï éÊçûÇ›ÉèÅ[ÉNÇ…√ﬁ∞¿€∞ƒﬁ

        
    Close #CHGH_No                          'ïiî‘ïœçXï€óØ√ﬁ∞¿ CLOSE
    Close #SYUDUP_No                        'èoâ◊ó\íËèdï°√ﬁ∞¿ CLOSE
                                            
                                            
                                                'ïiî‘ïœçXï€óØ√ﬁ∞¿çÌèú
    sts = GetIni("FILE", CHGH_ID, "SYS", FP_CHGHIN)
    If sts <> False Then
        MsgBox "SYS.INI [FILE][" & CHGH_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ "
        Call Log_Out(LOG_F, "SYS.INI [FILE][" & CHGH_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ ")
        Unload Me
    End If
    FP_CHGHIN = RTrim(FP_CHGHIN)
    Kill FP_CHGHIN                          'ïiî‘ïœçXï€óØ√ﬁ∞¿ ÉNÉäÉA

                                                'èoâ◊ó\íËèdï°√ﬁ∞¿çÌèú
    sts = GetIni("FILE", SYUDUP_ID, "SYS", FP_SYUDUP)
    If sts <> False Then
        MsgBox "SYS.INI [FILE][" & SYUDUP_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ "
        Call Log_Out(LOG_F, "SYS.INI [FILE][" & SYUDUP_ID & "]ì«Ç›çûÇ›ÉGÉâÅ[ ")
        Unload Me
    End If
    FP_SYUDUP = RTrim(FP_SYUDUP)
    Kill FP_SYUDUP                          'èoâ◊ó\íËèdï°√ﬁ∞¿ ÉNÉäÉA

        
    If CHGH_Open() Then                     'ïiî‘ïœçXï€óØ√ﬁ∞¿
        Unload Me
    End If
        
    If SYUDUP_Open() Then                   'èoâ◊ó\íËèdï°√ﬁ∞¿
        Close #CHGH_No
        Unload Me
    End If
'ÉzÉXÉgÉfÅ[É^Å@É`ÉFÉbÉNÅïéÊçûÇ›
    LBox_Etc.Clear      'àÛç¸√ﬁ∞¿ópÿΩƒŒﬁØ∏ΩÅ@ÉNÉäÉA
    LBox_Hin.Clear
    LBox_Dup.Clear

    In_Cnt = ZERO

    Do
        If XX_SIJ_Get Then          'éÊçûÇ›‹∞∏ ì«çûÇ›
            Exit Do
        End If
        If Left(StrConv(XX_SIJREC.TEXT_NO, vbUnicode), 1) < " " Then    'EOF ?
            Exit Do
        End If

        sts = Data_Chk              '√ﬁ∞¿èdï°Å^çÄñ⁄ì‡óe É`ÉFÉbÉN
        
        If sts = False Then
                                    'ê‘ì`ÅEèoâ◊ämîFÅEí˘ê≥√ﬁ∞¿ÇÕàÛç¸ÇÃÇ› èoâ◊é¿ê—ÅEó«ïiï‘ïiï™í«â¡
            If StrConv(XX_SIJREC.PM_KBN, vbUnicode) = "-" Or _
               StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "2" Or _
               StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "3" Or _
               StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "4" Or _
               StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "5" Then
                Call PDat_Etc_Add("1", " ")         'ê‘ì`ÅEèoâ◊ämîFÅEí˘ê≥àÛç¸√ﬁ∞¿ï€ë∂
            Else
                Call Proc_Sel(In_Cnt)               'îÑè„(0)ÅCì¸â◊(1)√ﬁ∞¿çXêV
            End If
        End If
    Loop

    Close #XX_SIJ_No            'éÊçûÇ›‹∞∏ CLOSE
    Close #ER_SIJ_No            'éÊçûÇ›‹∞∏[ëŒè€äO√ﬁ∞¿óp] CLOSE
    Close #CHGH_No              'ïiî‘ïœçXï€óØ√ﬁ∞¿ CLOSE
    Close #SYUDUP_No            'èoâ◊èdï°ï€óØ√ﬁ∞¿ CLOSE

    MsgLab(Format(Shori_Mode, "0")).Visible = False      'çXêVíÜ“Øæ∞ºﬁ ∏ÿ±

    Pdate = Date
    Ptime = Time
    Printer.Orientation = vbPRORLandscape       'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    
'éÛêMÉGÉâÅ[ÉäÉXÉgàÛç¸
    If LBox_Etc.ListCount > ZERO Then
        MsgLab(5).Visible = True                'àÛç¸íÜ“Øæ∞ºﬁï\é¶
        DoEvents
        Set Printer.Font = NormalFont           'àÛç¸ÉtÉHÉìÉgê›íË
        Call P_Etc_Proc(ZERO)                   'éÛêMÉGÉâÅ[ÉäÉXÉgàÛç¸
        MsgLab(5).Visible = False               'àÛç¸íÜ“Øæ∞ºﬁÉNÉäÉA
'        DoEvents
    End If

'ê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîFàÍóóï\àÛç¸
    If LBox_Etc.ListCount > ZERO Then
        MsgLab(6).Visible = True                'àÛç¸íÜ“Øæ∞ºﬁï\é¶
        DoEvents
        Set Printer.Font = NormalFont           'àÛç¸ÉtÉHÉìÉgê›íË
        Call P_Etc_Proc(1)                      'ê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîFàÍóóï\àÛç¸
        MsgLab(6).Visible = False               'àÛç¸íÜ“Øæ∞ºﬁÉNÉäÉA
'        DoEvents
    End If

'ïiî‘ïœçXÉäÉXÉgàÛç¸
    If LBox_Hin.ListCount > ZERO Then
        MsgLab(7).Visible = True                'àÛç¸íÜ“Øæ∞ºﬁï\é¶
        DoEvents
        Set Printer.Font = NormalFont           'àÛç¸ÉtÉHÉìÉgê›íË
        Call P_Hin_Proc                         'ïiî‘ïœçXÉäÉXÉgàÛç¸
        MsgLab(7).Visible = False               'àÛç¸íÜ“Øæ∞ºﬁÉNÉäÉA
        DoEvents
    End If

'èoâ◊èdï°ÉäÉXÉgàÛç¸
    If LBox_Dup.ListCount > ZERO Then
        MsgLab(9).Visible = True                'àÛç¸íÜ“Øæ∞ºﬁï\é¶
        DoEvents
        Set Printer.Font = NormalFont           'àÛç¸ÉtÉHÉìÉgê›íË
        Call P_Dup_Proc                         'èoâ◊èdï°ÉäÉXÉgàÛç¸
        MsgLab(9).Visible = False               'àÛç¸íÜ“Øæ∞ºﬁÉNÉäÉA
        DoEvents
    End If


    Call Input_UnLock                               'âÊñ çÄñ⁄ÉçÉbÉNâèú

    Call Scr_Init                                   'âÊñ ÉNÉäÉA

End Function
                                            'ÉfÅ[É^ÉçÅ[Éh(äeã∆ïîï ŒΩƒ√ﬁ∞¿Å®ï÷ï éÊçûÇ›‹∞∏Åj
Private Sub Data_Load()
Dim sts As Integer
Dim Work As String

'ï÷ï éÊçûÇ›ÉèÅ[ÉNÇ…ÉfÅ[É^ÉçÅ[ÉhÅiïiî‘ï€óØÉfÅ[É^Åj
    Do
        If CHGH_Get Then            'ï€óØÉfÅ[É^ ì«çûÇ›
            Exit Do
        End If

        If Left(StrConv(CHGHREC.TEXT_NO, vbUnicode), 1) < " " Then    'EOF ?
            Exit Do
        End If

        If CHGH_Put(1) Then         'éÊçûÇ›‹∞∏èëçûÇ›
            Close #CHGH_No
            Unload Me
        End If
    Loop

'ï÷ï éÊçûÇ›ÉèÅ[ÉNÇ…ÉfÅ[É^ÉçÅ[ÉhÅièoâ◊ó\íËÉfÅ[É^Åj
    Do
        If SYUDUP_Get Then          'ï€óØÉfÅ[É^ ì«çûÇ›
            Exit Do
        End If

        If Left(StrConv(SYUDUPREC.TEXT_NO, vbUnicode), 1) < " " Then    'EOF ?
            Exit Do
        End If

        If SYUDUP_Put(1) Then       'éÊçûÇ›‹∞∏èëçûÇ›
            Close #CHGH_No
            Close #SYUDUP_No
            Unload Me
        End If
    Loop
'ï÷ï éÊçûÇ›ÉèÅ[ÉNÇ…ÉfÅ[É^ÉçÅ[ÉhÅiÅu1Å`3ï÷ÅvãyÇ—Åuì¡îÑÇËÅvéwíËéûÇÃÇ› Åj
'èdóvÅ@Å¶Å@ì¡îÑÇËÇÕÇSï÷Ç∆Ç›Ç»Ç∑Å@Å¶
    If Shori_Mode > ZERO Then
                                        'êÙëÛã@éñã∆ïî  ÉzÉXÉgéÛêMÉfÅ[É^éÊçûÇ›
        If HS_SIJ_Open1(ZERO, Format(Shori_Mode, "0")) = False Then
                                                        'Ãß≤Ÿñ≥ÇµÇ»ÇÁèàóùÇµÇ»Ç¢
            Close #HS_SIJ_No
                                                        'êÙëÛã@éñã∆ïîŒΩƒ√ﬁ∞¿ OPEN
            If HS_SIJ_Open1(1, Format(Shori_Mode, "0")) Then
                Unload Me
            End If

            Call Data_Load_Sub              '√∑ΩƒáÇ

            Close #HS_SIJ_No                'ŒΩƒ√ﬁ∞¿ CLOSE
        End If
    End If

'éÊçûÇ›ÉèÅ[ÉN çƒÇnÇoÇdÇm
    Close #XX_SIJ_No
    Work = Format(Date, "ddd") & "." & Format(Shori_Mode, "0") & "00"
    If XX_SIJ_Open(Work, 1) Then
        Close #CHGH_No
        Close #SYUDUP_No
        Unload Me
    End If

End Sub
                                            'éñã∆ïîï ÉfÅ[É^ÉçÅ[Éh(éñã∆ïîï ŒΩƒ√ﬁ∞¿Å®ï÷ï éÊçûÇ›‹∞∏Åj
Private Sub Data_Load_Sub()
Dim sts As Integer
Dim Put_Sel As Integer
Dim Work As String
Dim i As Integer

Dim In_Cnt  As Integer


    In_Cnt = ZERO
    
    Do
        DoEvents
        If HS_SIJ_Get Then          'ŒΩƒ√ﬁ∞¿ ì«çûÇ›
            Exit Do
        End If
        If Left(StrConv(HS_SIJREC.TEXT_NO, vbUnicode), 1) < " " Then
            Exit Do
        End If

        In_Cnt = In_Cnt + 1
                                
        Label3(2).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
                                
                                '√∑ΩƒáÇ
        Call UniCode_Conv(XX_SIJREC.TEXT_NO, StrConv(HS_SIJREC.TEXT_NO, vbUnicode))
                                'éñã∆ïîãÊï™
        Call UniCode_Conv(XX_SIJREC.JGYOBU, StrConv(HS_SIJREC.JGYOBU, vbUnicode))
                                'íºëóãÊï™
        Call UniCode_Conv(XX_SIJREC.CYOK_KBN, StrConv(HS_SIJREC.CYOK_KBN, vbUnicode))
                                'ì`ï[ì˙ït
        Call UniCode_Conv(XX_SIJREC.DEN_DT, StrConv(HS_SIJREC.DEN_DT, vbUnicode))
                                'ì¸èoå…ãÊï™
        Call UniCode_Conv(XX_SIJREC.IO_KBN, StrConv(HS_SIJREC.IO_KBN, vbUnicode))
                                'ê‘çïãÊï™
        Call UniCode_Conv(XX_SIJREC.PM_KBN, StrConv(HS_SIJREC.PM_KBN, vbUnicode))
                                'ì`ï[éÌï 
        Call UniCode_Conv(XX_SIJREC.DEN_SYU, StrConv(HS_SIJREC.DEN_SYU, vbUnicode))
                                'ì`ï[áÇ
        Call UniCode_Conv(XX_SIJREC.DEN_NO, StrConv(HS_SIJREC.DEN_NO, vbUnicode))
                                'íçï∂ãÊï™
        Call UniCode_Conv(XX_SIJREC.CYU_KBN, StrConv(HS_SIJREC.CYU_KBN, vbUnicode))
                                'ïiî‘ÅiäOïîÅj
        Call UniCode_Conv(XX_SIJREC.HIN_GAI, StrConv(HS_SIJREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
        Call UniCode_Conv(XX_SIJREC.HIN_NAI, StrConv(HS_SIJREC.HIN_NAI, vbUnicode))
                                'ïiñº
        Call UniCode_Conv(XX_SIJREC.HIN_NAME, StrConv(HS_SIJREC.HIN_NAME, vbUnicode))
                                'êîó 
        Call UniCode_Conv(XX_SIJREC.YOTEI_QTY, StrConv(HS_SIJREC.YOTEI_QTY, vbUnicode))
                                'ó\éZíPà Åiå≥Åj
        Call UniCode_Conv(XX_SIJREC.YOSAN_FROM, StrConv(HS_SIJREC.YOSAN_FROM, vbUnicode))
                                'ó\éZíPà ÅiêÊÅj
        Call UniCode_Conv(XX_SIJREC.YOSAN_TO, StrConv(HS_SIJREC.YOSAN_TO, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
        Call UniCode_Conv(XX_SIJREC.HOST_SOKO, StrConv(HS_SIJREC.HOST_SOKO, vbUnicode))
                                'íIî‘ÅiŒΩƒÅj
        Call UniCode_Conv(XX_SIJREC.HOST_TANA, StrConv(HS_SIJREC.HOST_TANA, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊ
        Call UniCode_Conv(XX_SIJREC.SYUK_CODE, StrConv(HS_SIJREC.SYUK_CODE, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊñº
        Call UniCode_Conv(XX_SIJREC.SYUK_NAME, StrConv(HS_SIJREC.SYUK_NAME, vbUnicode))
                                '⁄∫∞ƒﬁèIí[œ∞∏(@)
        Call UniCode_Conv(XX_SIJREC.REC_END, StrConv(HS_SIJREC.REC_END, vbUnicode))
                                'CR.LF
        Call UniCode_Conv(XX_SIJREC.CR_LF, StrConv(HS_SIJREC.CR_LF, vbUnicode))

        Put_Sel = True
                                                'éñã∆ïîãÊï™Å@îÕàÕäOÅH
        For i = ZERO To UBound(JGYOBU_T) - 1
            If JGYOBU_T(i).Code = " " Then
                Put_Sel = False
                Exit For
            End If
            If JGYOBU_T(i).Code = StrConv(HS_SIJREC.JGYOBU, vbUnicode) Then
                Exit For
            End If
        Next i
                                                'ÉzÉXÉgëqå…Å@îÕàÕäOÅH
        For i = ZERO To UBound(SOKO_T1) - 1
            If SOKO_T1(i).HS_SOKO = "  " Then
                Put_Sel = False
                Exit For
            End If
            If RTrim(StrConv(HS_SIJREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_T1(i).HS_SOKO) Then
                Exit For
            End If
        Next i
        
        If Put_Sel = True Then
            sts = XX_SIJ_Put                    'éÊçûÇ›‹∞∏èëçûÇ›ÅiëŒè€ëqå…Åj
        Else
        'ëŒè€äOÉzÉXÉgëqå…ÅIÅI   ÉGÉâÅ[ÉçÉO
            If Er_Soko_NoT Then
                Call Err_Log_Out("Çgëqå…ëŒè€äO")
            End If
            sts = ER_SIJ_Put                    'éÊçûÇ›‹∞∏èëçûÇ›ÅiëŒè€äOëqå…Åj
        End If
        If sts Then
            Close #HS_SIJ_No
            Close #XX_SIJ_No
            Unload Me
        End If
    Loop

End Sub
                                            'ÉfÅ[É^èdï°Å^çÄñ⁄ì‡óe É`ÉFÉbÉN
Private Function Data_Chk() As Integer

Dim sts     As Integer
Dim Work    As String
Dim i       As Integer

Dim MUKECHG As String * 10      '2001.07.04

    Data_Chk = False

'ÉfÅ[É^èdï°É`ÉFÉbÉNÅiçƒèàóùÉfÅ[É^ÅièIí[ÅÅÅuÅHÅvÅuÅñÅvÇÕÉ`ÉFÉbÉNñ≥ÇµÅj
    If StrConv(XX_SIJREC.REC_END, vbUnicode) <> "?" And StrConv(XX_SIJREC.REC_END, vbUnicode) <> "*" Then
        Call UniCode_Conv(K0_SEQCK.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
        If Shori_Mode = 4 Then
            Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "2")
        Else
            Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "1")
        End If
        sts = BTRV(BtOpGetEqual, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
        If sts Then
            If sts <> BtErrKeyNotFound Then
                Call File_Error(sts, BtOpGetEqual, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                Unload Me
            End If
            Call UniCode_Conv(SEQCKREC.LAST_TXTNO, "000000000")
        End If
                '
                'ÅuëOâÒ√∑ΩƒáÇÅÜç°âÒ√∑ΩƒáÇÅvÇÕÉGÉâÅ[
                'ÅiíAÇµÅAëOâÒ√∑ΩƒáÇÅÅ12(åé)éûÇÕñ≥èåèÇnÇjÅj
                '
        If Shori_Mode = 4 Then
                'ì¡îÑÇËÉfÅ[É^ÇÕÉeÉLÉXÉgáÇÇÃï÷ÅÅÇTÅAíçï∂ãÊï™ÅÅÇSà»äOÉGÉâÅ[
            If Mid(StrConv(XX_SIJREC.TEXT_NO, vbUnicode), 5, 1) <> "5" Or StrConv(XX_SIJREC.CYU_KBN, vbUnicode) <> CYU_KBN_TOK Then
                Data_Chk = True
                Exit Function
            End If
                'çì˙à»ëOÇÃÉeÉLÉXÉgáÇÇÃåéì˙ÇÕÉGÉâÅ[
            If Left(StrConv(XX_SIJREC.TEXT_NO, vbUnicode), 4) < Right(Format(Date, "yyyymmdd"), 4) Then
                Data_Chk = True
                Exit Function
            End If
        Else
'-----------ÉeÉLÉXÉgáÇÉ`ÉFÉbÉNñ≥å¯
'            If Left(StrConv(SEQCKREC.LAST_TXTNO, vbUnicode), 2) <> "12" Then
'                If StrConv(SEQCKREC.LAST_TXTNO, vbUnicode) >= StrConv(XX_SIJREC.TEXT_NO, vbUnicode) Then
'                    Data_Chk = True
'                    Exit Function
'                End If
'            End If
'-----------ÉeÉLÉXÉgáÇÉ`ÉFÉbÉNñ≥å¯
        End If
    Else
        If Shori_Mode > ZERO Then
                                'çƒèàóùóvãÅÇ∂Ç·Ç»ÇØÇÍÇŒ
            Select Case StrConv(XX_SIJREC.REC_END, vbUnicode)
                Case "?"
                    If CHin_Put() Then            'äOïîïiî‘ïœçXï€óØ√ﬁ∞¿çÏê¨
                        Unload Me
                    End If
                
                Case "*"
                    Call MAKE_SYUDUP_Put                    'èdï°ï€óØ√ﬁ∞¿çÏê¨
            End Select
            Data_Chk = True
            Exit Function
        End If
    End If
'éÊçûÇ›ÉfÅ[É^ çÄñ⁄ì‡óeÉ`ÉFÉbÉN
'   [¡™Ø∏ çÄñ⁄]
'       1) ó\íËì˙Å@Å@Å@ÅFì˙ït¡™Ø∏
'       2) ïiî‘ÅiäOïîÅjÅFÅÇãÛîí
'       4) ì¸èoå…ãÊï™Å@ÅFîÕàÕÅÅ"0Å`3"or"E" ÅC"=0"ÇÃéûÅAèoâ◊êÊÅÇãÛîí
'
'97.07.29  ì‡ïîïiî‘ÇÕÅuãÛîíÅvÇ‡â¬Ç∆Ç∑ÇÈÅBíAÇµÅAÅuãÛîíÅvÇÃéûÇÕÉ}ÉXÉ^ÇÃïiî‘Ç∆íuä∑Ç¶Ç»Ç¢ÅB
'
    Work = StrConv(XX_SIJREC.DEN_DT, vbUnicode)     'ì`ï[ì˙ït
    If IsDate(Left(Work, 4) & "/" & Mid(Work, 5, 2) & "/" & Right(Work, 2)) = False _
     Or StrConv(XX_SIJREC.HIN_GAI, vbUnicode) = Space(13) _
     Or StrConv(XX_SIJREC.IO_KBN, vbUnicode) < "0" _
     Or (StrConv(XX_SIJREC.IO_KBN, vbUnicode) > "3" _
       And StrConv(XX_SIJREC.IO_KBN, vbUnicode) <> "E") _
     Or (StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "0" _
       And StrConv(XX_SIJREC.SYUK_CODE, vbUnicode) = Space(5)) Then
        
        'ì`ï[ì˙ïtÅ^ïiî‘Å^ì¸èoå…ãÊï™àŸèÌÅIÅI   ÉGÉâÅ[ÉçÉO
        If Er_Item_NoT Then
            Call Err_Log_Out("ì`ï[ì˙ïtÅ^ïiî‘Å^ì¸èoå…ãÊï™àŸèÌ")
        End If
        
        Call PDat_Etc_Add("0", "0")                 '¥◊∞ÿΩƒàÛç¸√ﬁ∞¿ï€ë∂
        Data_Chk = True
        Exit Function
    End If


'çëì‡äOãÊï™ÇÃê›íË
    For i = ZERO To UBound(SOKO_T1)
        If SOKO_T1(i).HS_SOKO = "  " Then
            Exit For
        End If
        If RTrim(StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_T1(i).HS_SOKO) Then
            HS_NaiG = SOKO_T1(i).NAIGAI
            Exit For
        End If
    Next i


    If StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "0" Then
'ìØàÍèoâ◊ì`ï[ë∂ç›É`ÉFÉbÉN(éñã∆ïîÅ{íçï∂ãÊï™Å{ì`ï[áÇ)
                                                    'éñã∆ïî
        Call UniCode_Conv(K0_Y_SYU.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                                                    'íçï∂ãÊï™
        If StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_TOK Then
            Call UniCode_Conv(K0_Y_SYU.HS_CYU_KBN, CYU_KBN_SPO)
        Else
            Call UniCode_Conv(K0_Y_SYU.HS_CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
        End If
                                                    'ì`ï[áÇ
        Call UniCode_Conv(K0_Y_SYU.DEN_NO, StrConv(XX_SIJREC.DEN_NO, vbUnicode))
                                                    'ÇrÇrí«î‘ÅiãÛîíå≈íËÅj
        Call UniCode_Conv(K0_Y_SYU.SS_CODE, "")
        sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), ZERO)
        Select Case sts
            Case BtNoErr
                If StrConv(Y_SYUREC.TOK_KBN, vbUnicode) = "1" Then
                    If StrConv(XX_SIJREC.SYUK_CODE, vbUnicode) = StrConv(Y_SYUREC.SYUK_CODE, vbUnicode) And _
                        StrConv(XX_SIJREC.HIN_GAI, vbUnicode) = StrConv(Y_SYUREC.HIN_GAI, vbUnicode) And _
                        CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)) = CLng(StrConv(Y_SYUREC.YOTEI_QTY, vbUnicode)) Then
                                'ì¡îÑÇËéûÅAå¸ÇØêÊÅ^ïiî‘Å^êîó Ç™ìôÇµÇ¢Ç∆Ç´ÇÕéÃÇƒÇÈ
                    Else
        'ì`ï[ì˙ïtÅ^ïiî‘Å^ì¸èoå…ãÊï™àŸèÌÅIÅI   ÉGÉâÅ[ÉçÉO
                        If Er_Dup_NoT Then
                            Call Err_Log_Out("èdï°ì`ï[")
                        End If
                        
                        Call MAKE_SYUDUP_Put                    'èdï°ï€óØ√ﬁ∞¿çÏê¨
                        Call PDat_DUP_Add("0", "2")             '¥◊∞ÿΩƒàÛç¸√ﬁ∞¿ï€ë∂
                    End If
                Else
        'ì`ï[ì˙ïtÅ^ïiî‘Å^ì¸èoå…ãÊï™àŸèÌÅIÅI   ÉGÉâÅ[ÉçÉO
                    If Er_Dup_NoT Then
                        Call Err_Log_Out("èdï°ì`ï[")
                    End If
                    
                    Call MAKE_SYUDUP_Put                    'èdï°ï€óØ√ﬁ∞¿çÏê¨
                    Call PDat_DUP_Add("0", "2")             '¥◊∞ÿΩƒàÛç¸√ﬁ∞¿ï€ë∂
                End If
                Data_Chk = True
                Exit Function
            Case BtErrKeyNotFound
            Case Else
                Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË")
                Unload Me
        End Select
    
'å¸ÇØêÊÉRÅ[Éhì«ë÷èàóù 2001.07.04
        Call UniCode_Conv(K0_MTSCHG.RYAKU, StrConv(XX_SIJREC.SYUK_CODE, vbUnicode))
        sts = BTRV(BtOpGetEqual, MTSCHG_POS, MTSCHGREC, Len(MTSCHGREC), K0_MTSCHG, Len(K0_MTSCHG), ZERO)
        Select Case sts
            Case BtNoErr
                MUKECHG = StrConv(MTSCHGREC.MUKE_CODE, vbUnicode)
            Case BtErrKeyNotFound
                MUKECHG = StrConv(XX_SIJREC.SYUK_CODE, vbUnicode)
            Case Else
                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊì«ë÷É}ÉXÉ^")
                Unload Me
        End Select
'å¸ÇØêÊÉRÅ[Éhë∂ç›É`ÉFÉbÉN
        Call UniCode_Conv(K0_MTS.MUKE_CODE, MUKECHG)
        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), ZERO)
        Select Case sts
            Case BtNoErr
            Case BtErrKeyNotFound
                Call UniCode_Conv(K0_MTS.MUKE_CODE, ETS_MTS & HS_NaiG)
                sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), ZERO)
                Select Case sts
                    Case BtNoErr
                    Case BtErrKeyNotFound
                                            'ÇªÇÃëºå¸ÇØêÊëŒâûÇµÇ»Ç¢
                        If CHin_Put() Then              'äOïîïiî‘ïœçXï€óØ√ﬁ∞¿çÏê¨
                            Unload Me
                        End If
                        
                        'å¸ÇØêÊàŸèÌÅIÅI   ÉGÉâÅ[ÉçÉO
                        If Er_Muke_NoT Then
                            Call Err_Log_Out("å¸ÇØêÊàŸèÌ")
                        End If
                        
                        
                        Call PDat_Etc_Add("0", "1")     '¥◊∞ÿΩƒàÛç¸√ﬁ∞¿ï€ë∂
                        Data_Chk = True
                        Exit Function
                    Case Else
                        Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
                        Unload Me
                End Select
            Case Else
                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
                Unload Me
        End Select
    
    End If
End Function
                                            'ÉfÅ[É^èdï°É`ÉFÉbÉNópÉfÅ[É^Å@çXêV
Private Function Seq_Update() As Boolean

Dim sts     As Integer
Dim Command As Integer
Dim ans     As Integer

    Seq_Update = True
'èdï°É`ÉFÉbÉNópÉfÅ[É^çXêVÅiçƒèàóùÉfÅ[É^ÅièIí[ÅÅÅuÅHÅvÅuÅñÅvÇÕçXêVÇµÇ»Ç¢Åj
    If StrConv(XX_SIJREC.REC_END, vbUnicode) <> "?" And StrConv(XX_SIJREC.REC_END, vbUnicode) <> "*" Then
        Call UniCode_Conv(K0_SEQCK.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
        If Shori_Mode = 4 Then
            Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "2")
        Else
            Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "1")
        End If
        Do
            sts = BTRV(BtOpGetEqual + BtSNoWait, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
                        
            Select Case sts
                Case BtNoErr
                    Command = BtOpUpdate
                    Exit Do
                Case BtErrEOF, BtErrKeyNotFound
                    Command = BtOpInsert
                    Call UniCode_Conv(SEQCKREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                    If Shori_Mode = 4 Then
                        Call UniCode_Conv(SEQCKREC.SEQ_MODE, "2")
                    Else
                        Call UniCode_Conv(SEQCKREC.SEQ_MODE, "1")
                    End If
                    Call UniCode_Conv(SEQCKREC.LAST_TXTNO, "000000000")
                    Call UniCode_Conv(SEQCKREC.LAST_GET_DT, "00000000")
                    Call UniCode_Conv(SEQCKREC.LAST_GET_TM, "000000")
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        Exit Function
                    End If
                Case Else
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                    Exit Function
            End Select
        Loop
        
        Call UniCode_Conv(SEQCKREC.LAST_TXTNO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))   'ç≈èIÉeÉLÉXÉgáÇ
        Call UniCode_Conv(SEQCKREC.LAST_GET_DT, Format(Date, "yyyymmdd"))               'ç≈èIéÊçûÇ›ì˙ït
        Call UniCode_Conv(SEQCKREC.LAST_GET_DT, Format(Time, "hhmm"))                   'ç≈èIéÊçûÇ›éûçè
        
        Do
            sts = BTRV(Command, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
            
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        Exit Function
                    End If
                Case Else
                    Call File_Error(sts, Command, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                    Exit Function
            End Select
        Loop
    End If

    Seq_Update = False

End Function
                                            'îÑè„(0)ÅCì¸â◊(1)ÉfÅ[É^çXêV
Private Sub Proc_Sel(In_Cnt As Integer)
Dim sts As Integer
Dim ans As Integer
Dim Command As Integer
Dim i As Integer



    Proc_F = ZERO

    DoEvents
'ïiî‘É}ÉXÉ^ÉfÅ[É^ÅiäOïîÅjóLñ≥É`ÉFÉbÉN
    Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts = BtNoErr Then
        Proc_F = Proc_F + 1
        BEF_GAI = StrConv(ITEMREC.HIN_GAI, vbUnicode)
        BEF_NAI = StrConv(ITEMREC.HIN_NAI, vbUnicode)
    Else
        If sts <> BtErrEOF And sts <> BtErrKeyNotFound Then
            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
            Unload Me
        End If
    End If

'ïiî‘É}ÉXÉ^ÉfÅ[É^Åiì‡ïîÅjóLñ≥É`ÉFÉbÉN
    Call UniCode_Conv(K3_ITEM.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K3_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K3_ITEM.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K3_ITEM, Len(K3_ITEM), 3)
    If sts = BtNoErr Then
        Proc_F = Proc_F + 2
        BEF_GAI = StrConv(ITEMREC.HIN_GAI, vbUnicode)
        BEF_NAI = StrConv(ITEMREC.HIN_NAI, vbUnicode)
    Else
        If sts <> BtErrEOF And sts <> BtErrKeyNotFound Then
            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
            Unload Me
        End If
    End If
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
        Unload Me
    End If

'ÉfÅ[É^èàóùîªíË
    Select Case Proc_F
        Case ZERO, 3                   'ÅuäOïîÅÅñ≥ÇµÅCì‡ïîÅÅñ≥ÇµÅvÅuäOïîÅÅóLÇËÅCì‡ïîÅÅóLÇËÅv
            If Upd_Item() Then                                      'ïiñ⁄É}ÉXÉ^çXêV
                GoTo Abort_Tran
            End If
            
            If StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "1" Then
                If NyukaY_Put() Then        'ì¸â◊ó\íËìoò^
                    GoTo Abort_Tran
                End If
            
                In_Cnt = In_Cnt + 1
                                
                Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
            
            Else
                If SyukaY_Put() Then        'èoâ◊ó\íËìoò^
                    GoTo Abort_Tran
                End If
                
                In_Cnt = In_Cnt + 1
                                
                Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
            
            End If

        Case 1                      'ÅuäOïîÅÅóLÇËÅCì‡ïîÅÅñ≥ÇµÅvÅ®ì‡ïîïiî‘ïœçX
            If Upd_Item() Then              'ïiñ⁄É}ÉXÉ^çXêV
                GoTo Abort_Tran
            End If
            
            If StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "1" Then
                If NyukaY_Put() Then        'ì¸â◊ó\íËìoò^
                    GoTo Abort_Tran
                End If
                
                In_Cnt = In_Cnt + 1
                                
                Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
            
            Else
                If SyukaY_Put() Then        'èoâ◊ó\íËìoò^
                    GoTo Abort_Tran
                End If
                
                In_Cnt = In_Cnt + 1
                                
                Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
            
            End If
    
            Call PDat_Hin_Add("0")          'ïiî‘ïœçXÿΩƒ√ﬁ∞¿ï€ë∂Åiì‡ïîïiî‘ïœçXÅj

        Case Else                   'ÅuäOïîÅÅñ≥ÇµÅCì‡ïîÅÅóLÇËÅvÅ®äOïîïiî‘ïœçX
            sts = Hin_Chg_Chk()            'äOïîïiî‘ïœçXÅ@â¬î€¡™Ø∏
            Select Case sts
                Case False
                    If StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "1" Then      'ì¸èoâ◊ó\íËìoò^
                        If NyukaY_Put() Then    'ì¸â◊ó\íËìoò^
                            GoTo Abort_Tran
                        End If
                        
                        In_Cnt = In_Cnt + 1
                                
                        Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
                    
                    Else
                        If SyukaY_Put() Then    'èoâ◊ó\íËìoò^
                            GoTo Abort_Tran
                        End If
                        
                        In_Cnt = In_Cnt + 1
                                
                        Label3(1).Caption = StrConv(Format(In_Cnt, "#0"), vbWide)
                    
                    End If
                
                    Call PDat_Hin_Add("1")      'ïiî‘ïœçXÿΩƒ√ﬁ∞¿ï€ë∂ÅiäOïîïiî‘ïœçXÅj
                Case True
                                
                    If CHin_Put() Then            'äOïîïiî‘ïœçXï€óØ√ﬁ∞¿çÏê¨
                        GoTo Abort_Tran
                    End If
                
                    Call PDat_Hin_Add("2")      'ïiî‘ïœçXÿΩƒ√ﬁ∞¿ï€ë∂Åiç›å…óLÅIïiî‘ïœçXïsâ¬Åj
                Case Else
                    GoTo Abort_Tran
            End Select
    End Select
            
    If Seq_Update() Then            '√ﬁ∞¿èdï°¡™Ø∏óp√ﬁ∞¿Å@çXêV
        GoTo Abort_Tran
    End If
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "")
        GoTo Abort_Tran
    End If

    If StrConv(XX_SIJREC.PM_KBN, vbUnicode) <> "-" And _
        StrConv(XX_SIJREC.IO_KBN, vbUnicode) = "1" Then
        Call PDat_Etc_Add("1", " ") 'ê‘ì`ÅEèoâ◊ämîFÅEí˘ê≥àÛç¸√ﬁ∞¿ï€ë∂
    End If
    
    Exit Sub

Abort_Tran:
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "")
    End If

    Unload Me

End Sub
                                            '¢¥◊∞ÿΩƒ£¢ämîFÿΩƒ£àÛç¸ÉfÅ[É^ï€ë∂(Å® List Box)
                                            'Å@à¯êîÅ@ÿΩƒãÊï™ÅFÇOÅÅ¥◊∞ÿΩƒÅ@ÇPÅÅê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîF
Private Sub PDat_Etc_Add(List_Kbn As String, Err_Kbn As String)
Dim sts As Integer
Dim Work As String

    Work = List_Kbn                                             'ÿΩƒãÊï™
    Work = Work & StrConv(XX_SIJREC.JGYOBU, vbUnicode)          'éñã∆ïîãÊï™
    Work = Work & StrConv(XX_SIJREC.HIN_GAI, vbUnicode)         'ïiî‘ÅiäOïîÅj
    Work = Work & StrConv(XX_SIJREC.HIN_NAI, vbUnicode)         'ïiî‘Åiì‡ïîÅj
    Work = Work & StrConv(XX_SIJREC.DEN_DT, vbUnicode)          'ì`ï[ì˙ït
    Work = Work & StrConv(XX_SIJREC.IO_KBN, vbUnicode)          'ì¸èoå…ãÊï™
    Work = Work & StrConv(XX_SIJREC.DEN_NO, vbUnicode)          'ì`ï[áÇ
    Work = Work & StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)       'êîó 
    Work = Work & StrConv(XX_SIJREC.PM_KBN, vbUnicode)          'ê‘çïãÊï™
    Work = Work & StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)       'ëqå…ãÊï™ÅiŒΩƒÅj
    Work = Work & StrConv(XX_SIJREC.CYU_KBN, vbUnicode)         'íçï∂ãÊï™
    Work = Work & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)        'íºëóãÊï™
    Work = Work & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)      'ó\éZíPà Åiå≥Åj
    Work = Work & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)        'ó\éZíPà ÅiêÊÅj
    Work = Work & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)       'íIî‘ÅiŒΩƒÅj
'   Work = Work & StrConv(XX_SIJREC.SYUK_CODE, vbUnicode)       'éxããêÊÅ^èoâ◊êÊ
'   Work = Work & StrConv(XX_SIJREC.SYUK_NAME, vbUnicode)       'éxããêÊÅ^èoâ◊êÊñº
    Work = Work & Err_Kbn                                       'ÉGÉâÅ[ãÊï™
    
'    Work = Work & StrConv(XX_SIJREC.TEXT_NO, vbUnicode)     '√∑ΩƒáÇ
'    Work = Work & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)    'íºëóãÊï™
'    Work = Work & StrConv(XX_SIJREC.PM_KBN, vbUnicode)      'ê‘çïãÊï™
'    Work = Work & StrConv(XX_SIJREC.DEN_SYU, vbUnicode)     'ì`ï[éÌï 
'    Work = Work & StrConv(XX_SIJREC.HIN_NAME, vbUnicode)    'ïiñº
'    Work = Work & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)  'ó\éZíPà Åiå≥Åj
'    Work = Work & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)    'ó\éZíPà ÅiêÊÅj
'    Work = Work & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)   'íIî‘ÅiŒΩƒÅj

    LBox_Etc.AddItem Work

End Sub

                                            '¢¥◊∞ÿΩƒ£¢ämîFÿΩƒ£àÛç¸ÉfÅ[É^ï€ë∂(Å® List Box)
                                            'Å@à¯êîÅ@ÿΩƒãÊï™ÅFÇOÅÅ¥◊∞ÿΩƒÅ@ÇPÅÅê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîF
Private Sub PDat_DUP_Add(List_Kbn As String, Err_Kbn As String)
Dim sts As Integer
Dim Work As String

    Work = List_Kbn                                             'ÿΩƒãÊï™
    Work = Work & StrConv(XX_SIJREC.JGYOBU, vbUnicode)          'éñã∆ïîãÊï™
    Work = Work & StrConv(XX_SIJREC.HIN_GAI, vbUnicode)         'ïiî‘ÅiäOïîÅj
    Work = Work & StrConv(XX_SIJREC.HIN_NAI, vbUnicode)         'ïiî‘Åiì‡ïîÅj
    Work = Work & StrConv(XX_SIJREC.DEN_DT, vbUnicode)          'ì`ï[ì˙ït
    Work = Work & StrConv(XX_SIJREC.IO_KBN, vbUnicode)          'ì¸èoå…ãÊï™
    Work = Work & StrConv(XX_SIJREC.DEN_NO, vbUnicode)          'ì`ï[áÇ
    Work = Work & StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)       'êîó 
    Work = Work & StrConv(XX_SIJREC.PM_KBN, vbUnicode)          'ê‘çïãÊï™
    Work = Work & StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)       'ëqå…ãÊï™ÅiŒΩƒÅj
    Work = Work & StrConv(XX_SIJREC.CYU_KBN, vbUnicode)         'íçï∂ãÊï™
    Work = Work & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)        'íºëóãÊï™
    Work = Work & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)      'ó\éZíPà Åiå≥Åj
    Work = Work & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)        'ó\éZíPà ÅiêÊÅj
    Work = Work & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)       'íIî‘ÅiŒΩƒÅj
'   Work = Work & StrConv(XX_SIJREC.SYUK_CODE, vbUnicode)       'éxããêÊÅ^èoâ◊êÊ
'   Work = Work & StrConv(XX_SIJREC.SYUK_NAME, vbUnicode)       'éxããêÊÅ^èoâ◊êÊñº
    Work = Work & Err_Kbn                                       'ÉGÉâÅ[ãÊï™
    
'    Work = Work & StrConv(XX_SIJREC.TEXT_NO, vbUnicode)     '√∑ΩƒáÇ
'    Work = Work & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)    'íºëóãÊï™
'    Work = Work & StrConv(XX_SIJREC.PM_KBN, vbUnicode)      'ê‘çïãÊï™
'    Work = Work & StrConv(XX_SIJREC.DEN_SYU, vbUnicode)     'ì`ï[éÌï 
'    Work = Work & StrConv(XX_SIJREC.HIN_NAME, vbUnicode)    'ïiñº
'    Work = Work & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)  'ó\éZíPà Åiå≥Åj
'    Work = Work & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)    'ó\éZíPà ÅiêÊÅj
'    Work = Work & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)   'íIî‘ÅiŒΩƒÅj

    LBox_Dup.AddItem Work

End Sub

                                            '¢ïiî‘ïœçXÿΩƒ£àÛç¸ÉfÅ[É^ï€ë∂(Å® List Box)
                                            'Å@à¯êîÅ@ïœçXãÊï™ÅFÇOÅÅì‡ïîïiî‘ïœçXÅ@ÇPÅÅäOïîïiî‘ïœçX
Private Sub PDat_Hin_Add(Chg_Kbn As String)
Dim sts As Integer
Dim Work As String

    Work = StrConv(XX_SIJREC.JGYOBU, vbUnicode)                 'éñã∆ïîãÊï™
    Work = Work & StrConv(XX_SIJREC.TEXT_NO, vbUnicode)         '√∑ΩƒáÇ
    Work = Work & StrConv(XX_SIJREC.HIN_GAI, vbUnicode)         'ïiî‘ÅiäOïîÅj
    Work = Work & BEF_GAI
    Work = Work & StrConv(XX_SIJREC.HIN_NAI, vbUnicode)         'ïiî‘Åiì‡ïîÅj
    Work = Work & BEF_NAI
    Work = Work & StrConv(XX_SIJREC.DEN_DT, vbUnicode)          'ì`ï[ì˙ït
    Work = Work & StrConv(XX_SIJREC.IO_KBN, vbUnicode)          'ì¸èoå…ãÊï™
    Work = Work & StrConv(XX_SIJREC.DEN_NO, vbUnicode)          'ì`ï[áÇ
    Work = Work & StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)       'êîó 
    Work = Work & StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)       'ëqå…ãÊï™ÅiŒΩƒÅj
    Work = Work & StrConv(XX_SIJREC.CYU_KBN, vbUnicode)         'íçï∂ãÊï™
    Work = Work & StrConv(XX_SIJREC.SYUK_CODE, vbUnicode)       'éxããêÊÅ^èoâ◊êÊ
    Work = Work & Chg_Kbn                                       'ïœçXãÊï™
    Work = Work & HS_NaiG                                       'çëì‡äO
    
'    Work = Work & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)    'íºëóãÊï™
'    Work = Work & StrConv(XX_SIJREC.PM_KBN, vbUnicode)      'ê‘çïãÊï™
'    Work = Work & StrConv(XX_SIJREC.DEN_SYU, vbUnicode)     'ì`ï[éÌï 
'    Work = Work & StrConv(XX_SIJREC.HIN_NAME, vbUnicode)    'ïiñº
'    Work = Work & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)  'ó\éZíPà Åiå≥Åj
'    Work = Work & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)    'ó\éZíPà ÅiêÊÅj
'    Work = Work & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)   'íIî‘ÅiŒΩƒÅj
'    Work = Work & StrConv(XX_SIJREC.SYUK_NAME, vbUnicode)   'éxããêÊÅ^èoâ◊êÊñº

    LBox_Hin.AddItem Work

End Sub
                                            'äOïîïiî‘ïœçXÅ@â¬î€É`ÉFÉbÉN
Private Function Hin_Chg_Chk() As Integer

Dim sts         As Integer
Dim Work        As String
Dim ZAIKO_QTY   As Long
Dim ans         As Integer

    Hin_Chg_Chk = False

    Call UniCode_Conv(K3_ITEM.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K3_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K3_ITEM.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K3_ITEM, Len(K3_ITEM), 3)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Hin_Chg_Chk = SYS_ERR
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                Hin_Chg_Chk = SYS_ERR
                Exit Function
        End Select
    Loop

'ç›å…óLñ≥É`ÉFÉbÉN
    If Zaiko_Syukei_Proc(ZAIKO_QTY, StrConv(ITEMREC.JGYOBU, vbUnicode), StrConv(ITEMREC.NAIGAI, vbUnicode), StrConv(ITEMREC.HIN_GAI, vbUnicode)) Then
        Unload Me
    End If
    If ZAIKO_QTY <> ZERO Then
        Hin_Chg_Chk = True
        Exit Function
    End If

'ïiñ⁄É}ÉXÉ^Å@äOïîïiî‘ïœçX
    Do
    
        sts = BTRV(BtOpDelete, ITEM_POS, ITEMREC, Len(ITEMREC), K3_ITEM, Len(K3_ITEM), 3)
        
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Hin_Chg_Chk = SYS_ERR
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpDelete, "ïiñ⁄É}ÉXÉ^")
                Hin_Chg_Chk = SYS_ERR
                Exit Function
        End Select
    
    Loop

    Call UniCode_Conv(ITEMREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(ITEMREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
    
    Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
    
    Do
        sts = BTRV(BtOpInsert, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
        
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Hin_Chg_Chk = SYS_ERR
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "ïiñ⁄É}ÉXÉ^")
                Hin_Chg_Chk = SYS_ERR
                Exit Function
        End Select
    
    Loop
End Function
                                            'ïiñ⁄É}ÉXÉ^çXêV
Private Function Upd_Item() As Boolean
Dim sts As Integer
Dim ans As Integer
Dim Command As Integer
Dim Work As String

    Upd_Item = True

    Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
            Case BtNoErr
                Command = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                Command = BtOpInsert
                Call UniCode_Conv(ITEMREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                Call UniCode_Conv(ITEMREC.NAIGAI, HS_NaiG)
                Call UniCode_Conv(ITEMREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
                Call UniCode_Conv(ITEMREC.HIN_NAME, "")
                Call UniCode_Conv(ITEMREC.ST_SET_DT, "")
                Call UniCode_Conv(ITEMREC.ST_SOKO, "")
                Call UniCode_Conv(ITEMREC.ST_RETU, "")
                Call UniCode_Conv(ITEMREC.ST_REN, "")
                Call UniCode_Conv(ITEMREC.ST_DAN, "")
                Call UniCode_Conv(ITEMREC.BEF_SOKO, "")
                Call UniCode_Conv(ITEMREC.BEF_RETU, "")
                Call UniCode_Conv(ITEMREC.BEF_REN, "")
                Call UniCode_Conv(ITEMREC.BEF_DAN, "")
                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, "")
                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, "")
                Call UniCode_Conv(ITEMREC.BIKOU_TANA, "")
                Call UniCode_Conv(ITEMREC.SIZAI_CD, "")
                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")
                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")
                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "0")
                Call UniCode_Conv(ITEMREC.LAST_INP_DT, "")
                
                Call UniCode_Conv(ITEMREC.LOCK_F, "0")          'îrëºÉtÉâÉO
                Call UniCode_Conv(ITEMREC.WEL_ID, "")           'égópíÜéqã@ÇhÇc
                Call UniCode_Conv(ITEMREC.PRG_ID, "")           'égópíÜÉvÉçÉOÉâÉÄ
                
                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "0000000")
                
                Call UniCode_Conv(ITEMREC.FILLER, "")
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop
                                'ïiî‘Åiì‡ïîÅj(ÅÇãÛîíÇÃéûÇÃÇ›ÉZÉbÉg)
    If StrConv(XX_SIJREC.HIN_NAI, vbUnicode) <> Space(13) Then
        Call UniCode_Conv(ITEMREC.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
    End If
                                
Debug.Print StrConv(ITEMREC.HIN_NAI, vbUnicode)
                                'ïiñºÅiÅÇãÛîíÇÃéûÇÃÇ›ÉZÉbÉgÅj
    If StrConv(XX_SIJREC.HIN_NAME, vbUnicode) <> Space(25) Then
        Call UniCode_Conv(ITEMREC.HIN_NAME, StrConv(XX_SIJREC.HIN_NAME, vbUnicode))
    End If
                                'îıçlÅFŒΩƒëqå…ãÊï™
                                'Å@Å@Åmëqå…ãÊï™ÇÃì«ë÷Ç¶Å@ê›íËèåè]
                                'Å@Å@Å@á@éÛêMÉfÅ[É^ÇÃëqå…ãÊï™ÅÇãÛîí
                                'Å@Å@Å@áAÅ@Å@ÅVÅ@Å@Å@ëqå…ãÊï™ÅÑïiñ⁄œΩ¿ÇÃëqå…ãÊï™
    If StrConv(XX_SIJREC.HOST_SOKO, vbUnicode) <> Space(2) And _
       StrConv(XX_SIJREC.HOST_SOKO, vbUnicode) > StrConv(ITEMREC.BIKOU_SOKO, vbUnicode) Then
        Call UniCode_Conv(ITEMREC.BIKOU_SOKO, StrConv(XX_SIJREC.HOST_SOKO, vbUnicode))
    End If

                                'îıçlÅFŒΩƒíIî‘ÅiÅÇãÛîíÇÃéûÅj
    If StrConv(XX_SIJREC.HOST_TANA, vbUnicode) <> Space(8) Then
        Call UniCode_Conv(ITEMREC.BIKOU_TANA, StrConv(XX_SIJREC.HOST_TANA, vbUnicode))
    End If

    
    Do
        sts = BTRV(Command, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
            Case BtNoErr, BtErrEOF, BtErrKeyNotFound
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, Command, "ïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop

    Upd_Item = False

End Function
                                            'ì¸â◊ó\íËçÏê¨ Åï ì¸â◊çXêV
Private Function NyukaY_Put() As Boolean
Dim sts As Integer
Dim Work As String
Dim com As Integer
Dim W_Qty As Long
Dim W_Y_Qty As Long         'ì¸â◊ó\íËêî
Dim W_E_Qty As Long         'ëOéÿÇËì¸â◊êî
Dim W_Date As String        'èàóùì˙ït

Dim ans     As Integer

    NyukaY_Put = True
    Call UniCode_Conv(K4_Y_NYU.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K4_Y_NYU.TEXT_NO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))
    sts = BTRV(BtOpGetEqual, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K4_Y_NYU, Len(K4_Y_NYU), 4)
    Select Case sts
        Case BtNoErr
            Work = "Y_NYUKA.DAT DUP ""éñã∆ïî=" & StrConv(XX_SIJREC.JGYOBU, vbUnicode) & "TEXTNo=" & StrConv(XX_SIJREC.TEXT_NO, vbUnicode)
            Work = "ì`ï[ì˙ït=" & StrConv(XX_SIJREC.DEN_DT, vbUnicode) & "ì`ï[áÇ=" & StrConv(XX_SIJREC.DEN_NO, vbUnicode)
            Work = "ïiî‘=" & StrConv(XX_SIJREC.HIN_GAI, vbUnicode)
            Call Log_Out(LOG_F, Work)
            NyukaY_Put = False
            Exit Function
        Case BtErrKeyNotFound
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
            Exit Function
    End Select
'////////////////////////////////////////////////////////Å@ì¸â◊ÉfÅ[É^îrèúÉçÉWÉbÉN
'
'
'                 ÅiÅ@åöÅ@ê›Å@ó\Å@íËÅ@ínÅ@Åj
'1997.08.22
    If RTrim(StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)) = "555" And _
        RTrim(StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)) = "0" Then
        Call UniCode_Conv(XX_SIJREC.CYOK_KBN, "*")          'îrèúÉfÅ[É^ÇÕÅuíºëóãÊï™ÅvÇ…ÅuÅñÅvÇÉZÉbÉg
    End If

    If RTrim(StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)) = "111" And _
        RTrim(StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)) = "5" Then
        Call UniCode_Conv(XX_SIJREC.CYOK_KBN, "*")          'îrèúÉfÅ[É^ÇÕÅuíºëóãÊï™ÅvÇ…ÅuÅñÅvÇÉZÉbÉg
    End If

    If RTrim(StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)) = "555" And _
        RTrim(StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)) = "1" Then
        Call UniCode_Conv(XX_SIJREC.CYOK_KBN, "*")          'îrèúÉfÅ[É^ÇÕÅuíºëóãÊï™ÅvÇ…ÅuÅñÅvÇÉZÉbÉg
    End If

'
'
'        Call UniCode_Conv(XX_SIJREC.CYOK_KBN, "*")          'îrèúÉfÅ[É^ÇÕÅuíºëóãÊï™ÅvÇ…ÅuÅñÅvÇÉZÉbÉg
'
'
'////////////////////////////////////////////////////////


    W_Date = Format(Date, "yyyymmdd")

'ì¸â◊ó\íËçÏê¨
                                'äÆóπãÊï™
    Call UniCode_Conv(Y_NYUREC.KAN_KBN, KAN_KBN_ON)
                                'ÉfÅ[É^éÌï 
    Call UniCode_Conv(Y_NYUREC.DT_SYU, "0")
                                'ó\íËêîó 
    Call UniCode_Conv(Y_NYUREC.YOTEI_QTY, Format(CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)), "00000000"))
                                'ämíËêîó 
    Call UniCode_Conv(Y_NYUREC.FIX_QTY, "00000000")
                                'çëì‡äO
    Call UniCode_Conv(Y_NYUREC.NAIGAI, HS_NaiG)
                                'éñã∆ïîãÊï™
    Call UniCode_Conv(Y_NYUREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                                '√∑ΩƒáÇ
    If StrConv(XX_SIJREC.CYOK_KBN, vbUnicode) = "*" Then        'îrèúÉfÅ[É^ÅH
                                'íºëóãÊï™
        Call UniCode_Conv(Y_NYUREC.CYOK_KBN, "C")
    Else
                                'íºëóãÊï™
        Call UniCode_Conv(Y_NYUREC.CYOK_KBN, StrConv(XX_SIJREC.CYOK_KBN, vbUnicode))
    End If
    
    Call UniCode_Conv(Y_NYUREC.TEXT_NO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))
                                'ì`ï[ì˙ït
    Call UniCode_Conv(Y_NYUREC.DEN_DT, StrConv(XX_SIJREC.DEN_DT, vbUnicode))
                                'ì¸èoå…ãÊï™
    Call UniCode_Conv(Y_NYUREC.IO_KBN, StrConv(XX_SIJREC.IO_KBN, vbUnicode))
                                'ê‘çïãÊï™
    Call UniCode_Conv(Y_NYUREC.PM_KBN, StrConv(XX_SIJREC.PM_KBN, vbUnicode))
                                'ì`ï[éÌï 
    
    Call UniCode_Conv(Y_NYUREC.DEN_SYU, StrConv(XX_SIJREC.DEN_SYU, vbUnicode))
                                'ì`ï[áÇ
    Call UniCode_Conv(Y_NYUREC.DEN_NO, StrConv(XX_SIJREC.DEN_NO, vbUnicode))
                                'íçï∂ãÊï™
    Call UniCode_Conv(Y_NYUREC.CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
                                'ïiî‘ÅiäOïîÅj
    Call UniCode_Conv(Y_NYUREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
    Call UniCode_Conv(Y_NYUREC.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
                                'ïiñº
    Call UniCode_Conv(Y_NYUREC.HIN_NAME, StrConv(XX_SIJREC.HIN_NAME, vbUnicode))
                                'ó\éZíPà Åiå≥Åj
    Call UniCode_Conv(Y_NYUREC.YOSAN_FROM, StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode))
                                'ó\éZíPà ÅiêÊÅj
    Call UniCode_Conv(Y_NYUREC.YOSAN_TO, StrConv(XX_SIJREC.YOSAN_TO, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
    Call UniCode_Conv(Y_NYUREC.HOST_SOKO, StrConv(XX_SIJREC.HOST_SOKO, vbUnicode))
                                'íIî‘ÅiŒΩƒÅjÅ©Å@ïWèÄì¸å…íIî‘Åiïiñ⁄œΩ¿Åj
    Work = StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
           StrConv(ITEMREC.ST_RETU, vbUnicode) & _
           StrConv(ITEMREC.ST_REN, vbUnicode) & _
           StrConv(ITEMREC.ST_DAN, vbUnicode)
    Call UniCode_Conv(Y_NYUREC.HOST_TANA, Work)
                                'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(Y_NYUREC.SYUK_CODE, StrConv(XX_SIJREC.SYUK_CODE, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(Y_NYUREC.SYUK_NAME, StrConv(XX_SIJREC.SYUK_NAME, vbUnicode))
                                'êÊçsì¸â◊êî
    Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, "00000000")
                                'äÆóπì˙ït
    Call UniCode_Conv(Y_NYUREC.KAN_DT, W_Date)
                                'FILLER
    Call UniCode_Conv(Y_NYUREC.FILLER, "")


'îrèúï™ÇÃì¸â◊ÉfÅ[É^ÇÕÅAì¸â◊ó\íËìoò^ÇÃÇ›
    If StrConv(XX_SIJREC.CYOK_KBN, vbUnicode) = "*" Then        'îrèúëŒè€ÉfÅ[É^ÇÕì¸â◊çXêVñ≥Çµ
        Do
            sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), ZERO)
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        Exit Function
                    End If
                Case Else
                    Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
                    Exit Function
            End Select
        Loop
'íºëóîrèúï™ê≥èÌèIóπ
        NyukaY_Put = False
        Exit Function
    End If
    
    If Shori_Mode = ZERO Then       'çƒéÊÇËçûÇ›éwé¶éûÇÕÅAèàóùÇµÇ»Ç¢ 01.05.03 **
        NyukaY_Put = False
        Exit Function
    End If

    W_Y_Qty = CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode))
    Last_Proc_F = True              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇË

'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
    Call UniCode_Conv(K0_J_NYU.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_J_NYU.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K0_J_NYU.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))

    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
        Select Case sts
            Case BtNoErr
                If CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) > W_Y_Qty Then
                    W_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode)) - W_Y_Qty
                    Call UniCode_Conv(J_NYUREC.JITU_QTY, Format(W_Qty, "00000000"))
                    
                    Do
                        sts = BTRV(BtOpUpdate, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                                Beep
                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                                If ans = vbCancel Then
                                    Exit Function
                                End If
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "ì¸â◊¡™Ø∏√ﬁ∞¿")
                                Exit Function
                        End Select
                    
                    Loop
                    W_E_Qty = CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode))
                Else
                    Do
                        sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                                Beep
                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                                If ans = vbCancel Then
                                    Exit Function
                                End If
                            Case Else
                                Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿")
                                Exit Function
                        End Select
                    Loop
                    W_E_Qty = CLng(StrConv(J_NYUREC.JITU_QTY, vbUnicode))
                End If
                
                Exit Do
            Case BtErrKeyNotFound
                W_E_Qty = ZERO
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ì¸â◊¡™Ø∏√ﬁ∞¿")
                Exit Function
        End Select
    Loop

'ì¸â◊ó\íËÉfÅ[É^í«â¡Åiì¸â◊ï™Åj
                                'êÊçsì¸â◊êîÅiì¸â◊é¿ê—êîÅj
    Call UniCode_Conv(Y_NYUREC.BEF_NYU_QTY, Format(W_E_Qty, "00000000"))
    Do
        sts = BTRV(BtOpInsert, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), ZERO)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
                Exit Function
        End Select
    Loop

'ì¸â◊êîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ{Åj
    If Nyuko_Update_Proc(StrConv(XX_SIJREC.JGYOBU, vbUnicode), _
                            HS_NaiG, _
                            StrConv(XX_SIJREC.HIN_GAI, vbUnicode), _
                            StrConv(XX_SIJREC.DEN_DT, vbUnicode), _
                            (KASO_NYUKA_Soko & "01" & "01" & "01"), _
                            YOIN_TU_NYUKA, _
                            CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)), _
                            WS_NO) Then
        Exit Function
    
    End If


'ëOéÿÇËêîÇ≈ç›å…ÉfÅ[É^çXêVÅiÅ|Åj
    If W_E_Qty <> ZERO Then
'ç›å…ÉfÅ[É^LOCK
        If Zaiko_Lock_Proc((KASO_NYUKA_Soko & "01" & "01" & "01"), _
                            StrConv(XX_SIJREC.JGYOBU, vbUnicode), _
                            HS_NaiG, _
                            StrConv(XX_SIJREC.HIN_GAI, vbUnicode), _
                            WS_NO) Then
            Exit Function

        End If
        
        
        If Syuko_Update_Proc(StrConv(XX_SIJREC.JGYOBU, vbUnicode), _
                                HS_NaiG, _
                                StrConv(XX_SIJREC.HIN_GAI, vbUnicode), _
                                StrConv(XX_SIJREC.DEN_DT, vbUnicode), _
                                (KASO_NYUKA_Soko & "01" & "01" & "01"), _
                                YOIN_MAE_SOUSAI, _
                                W_E_Qty, _
                                WS_NO) Then
            Exit Function
    
        End If

'ç›å…ÉfÅ[É^UNLOCK
        If Zaiko_UNLock_Proc((KASO_NYUKA_Soko & "01" & "01" & "01"), _
                                StrConv(XX_SIJREC.JGYOBU, vbUnicode), _
                                HS_NaiG, _
                                StrConv(XX_SIJREC.HIN_GAI, vbUnicode), _
                            "") Then
            Exit Function
        End If
    End If
    
    NyukaY_Put = False

End Function
                                            'èoâ◊ó\íËçÏê¨
Private Function SyukaY_Put() As Boolean
Dim sts     As Integer
Dim Work    As String
Dim Command As Integer
                     
Dim ans     As Integer
    
    SyukaY_Put = True
                                'äÆóπãÊï™
    Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_SOFF_POFF_KOFF)
                                'ÉfÅ[É^éÌï 
    Call UniCode_Conv(Y_SYUREC.DT_SYU, "0")
                                'ó\íËêîó 
    Call UniCode_Conv(Y_SYUREC.YOTEI_QTY, Format(CLng(StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)), "00000000"))
                                'ämíËêîó 
    Call UniCode_Conv(Y_SYUREC.FIX_QTY, "00000000")
                                'çëì‡äO
    Call UniCode_Conv(Y_SYUREC.NAIGAI, HS_NaiG)
                                'éñã∆ïîãÊï™
    Call UniCode_Conv(Y_SYUREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                                '√∑ΩƒáÇ
    Call UniCode_Conv(Y_SYUREC.TEXT_NO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))
                                'íºëóãÊï™
    Call UniCode_Conv(Y_SYUREC.CYOK_KBN, StrConv(XX_SIJREC.CYOK_KBN, vbUnicode))
                                'ì`ï[ì˙ït
    Call UniCode_Conv(Y_SYUREC.DEN_DT, StrConv(XX_SIJREC.DEN_DT, vbUnicode))
                                'ì¸èoå…ãÊï™
    Call UniCode_Conv(Y_SYUREC.IO_KBN, StrConv(XX_SIJREC.IO_KBN, vbUnicode))
                                'ê‘çïãÊï™
    Call UniCode_Conv(Y_SYUREC.PM_KBN, StrConv(XX_SIJREC.PM_KBN, vbUnicode))
                                'ì`ï[éÌï 
    Call UniCode_Conv(Y_SYUREC.DEN_SYU, StrConv(XX_SIJREC.DEN_SYU, vbUnicode))
                                'ì`ï[áÇ
    Call UniCode_Conv(Y_SYUREC.DEN_NO, StrConv(XX_SIJREC.DEN_NO, vbUnicode))
                                'íçï∂ãÊï™Åiï‚è[Ç∆ΩŒﬂØƒÇÕÅuï‚è[ÅEΩŒﬂØƒÅvãÊï™Ç…íuä∑Ç¶Åj
                                            'ì¡îÑÇËÇ‡Åuï‚è[ÅEΩŒﬂØƒÅvãÊï™Ç…íuä∑Ç¶
    If StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_SPO Or _
       StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_HJU Or _
       StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_TOK Then
        Call UniCode_Conv(Y_SYUREC.CYU_KBN, CYU_KBN_HSP)
    Else
        Call UniCode_Conv(Y_SYUREC.CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
    End If
                                'ïiî‘ÅiäOïîÅj
    Call UniCode_Conv(Y_SYUREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
    Call UniCode_Conv(Y_SYUREC.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
                                'ïiñº
    Call UniCode_Conv(Y_SYUREC.HIN_NAME, StrConv(XX_SIJREC.HIN_NAME, vbUnicode))
                                'ó\éZíPà Åiå≥Åj
    Call UniCode_Conv(Y_SYUREC.YOSAN_FROM, StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode))
                                'ó\éZíPà ÅiêÊÅj
    Call UniCode_Conv(Y_SYUREC.YOSAN_TO, StrConv(XX_SIJREC.YOSAN_TO, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
    Call UniCode_Conv(Y_SYUREC.HOST_SOKO, StrConv(XX_SIJREC.HOST_SOKO, vbUnicode))
                                'íIî‘ÅiŒΩƒÅjÅ©Å@ïWèÄì¸å…íIî‘Åiïiñ⁄œΩ¿Åj
    Work = StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
           StrConv(ITEMREC.ST_RETU, vbUnicode) & _
           StrConv(ITEMREC.ST_REN, vbUnicode) & _
           StrConv(ITEMREC.ST_DAN, vbUnicode)
    Call UniCode_Conv(Y_SYUREC.HOST_TANA, Work)
                                'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(Y_SYUREC.SYUK_CODE, StrConv(XX_SIJREC.SYUK_CODE, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(Y_SYUREC.SYUK_NAME, StrConv(XX_SIJREC.SYUK_NAME, vbUnicode))
                                'äÆóπì˙ït
    Call UniCode_Conv(Y_SYUREC.KAN_DT, "")
                                'íçï∂ãÊï™ÅiŒΩƒÅj
    If StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_TOK Then
                                'ì¡îÑÇËÇÕÉXÉ|ÉbÉgÇ…íuÇ´ä∑Ç¶ÇÈ2001.06.21
        Call UniCode_Conv(Y_SYUREC.HS_CYU_KBN, CYU_KBN_SPO)
    Else
        Call UniCode_Conv(Y_SYUREC.HS_CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
    End If
                                'ÇrÇrí«î‘
    Call UniCode_Conv(Y_SYUREC.SS_CODE, "")
                                'égópéqã@ÇhÇc
    Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                                'égópíÜÉvÉçÉOÉâÉÄ
    Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                                'åüïiì˙ït
    Call UniCode_Conv(Y_SYUREC.KENPIN_DT, "")
                                
                                
                                'å¸ÇØêÊ∫∞ƒﬁ
    Call UniCode_Conv(Y_SYUREC.MUKE_CODE, StrConv(MTSREC.MUKE_CODE, vbUnicode))
                                'å¸ÇØêÊì«ë÷Ç¶∫∞ƒﬁ
    Call UniCode_Conv(Y_SYUREC.MUKE_CHG_CD, StrConv(MTSREC.MUKE_CHG_CD, vbUnicode))
                                'ì¡îÑÇËÉ}Å[ÉN   2001.06.21
    If StrConv(XX_SIJREC.CYU_KBN, vbUnicode) = CYU_KBN_TOK Then
        Call UniCode_Conv(Y_SYUREC.TOK_KBN, "1")
    Else
        Call UniCode_Conv(Y_SYUREC.TOK_KBN, " ")
    End If
                                'FILLER
    Call UniCode_Conv(Y_SYUREC.FILLER, "")
    
    Do
        sts = BTRV(BtOpInsert, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), ZERO)
        
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<Y_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "èoâ◊ó\íË")
                Exit Function
        End Select
    Loop
    
    If SYUKA_LOG_ON Then
        Call SYUKA_LOG_OUT_PROC("INS", "AFT")
    End If
        
    SyukaY_Put = False

End Function
                                            'äOïîïiî‘ïœçXï€óØÉfÅ[É^çÏê¨
Private Function CHin_Put() As Integer
           
    CHin_Put = True
                                '√∑ΩƒáÇ
    Call UniCode_Conv(CHGHREC.TEXT_NO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))
                                'éñã∆ïîãÊï™
    Call UniCode_Conv(CHGHREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                                'íºëóãÊï™
    Call UniCode_Conv(CHGHREC.CYOK_KBN, StrConv(XX_SIJREC.CYOK_KBN, vbUnicode))
                                'ì`ï[ì˙ït
    Call UniCode_Conv(CHGHREC.DEN_DT, StrConv(XX_SIJREC.DEN_DT, vbUnicode))
                                'ì¸èoå…ãÊï™
    Call UniCode_Conv(CHGHREC.IO_KBN, StrConv(XX_SIJREC.IO_KBN, vbUnicode))
                                'ê‘çïãÊï™
    Call UniCode_Conv(CHGHREC.PM_KBN, StrConv(XX_SIJREC.PM_KBN, vbUnicode))
                                'ì`ï[éÌï 
    Call UniCode_Conv(CHGHREC.DEN_SYU, StrConv(XX_SIJREC.DEN_SYU, vbUnicode))
                                'ì`ï[áÇ
    Call UniCode_Conv(CHGHREC.DEN_NO, StrConv(XX_SIJREC.DEN_NO, vbUnicode))
                                'íçï∂ãÊï™
    Call UniCode_Conv(CHGHREC.CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
                                'ïiî‘ÅiäOïîÅj
    Call UniCode_Conv(CHGHREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
    Call UniCode_Conv(CHGHREC.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
                                'ïiñº
    Call UniCode_Conv(CHGHREC.HIN_NAME, StrConv(XX_SIJREC.HIN_NAME, vbUnicode))
                                'êîó 
    Call UniCode_Conv(CHGHREC.YOTEI_QTY, StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode))
                                'ó\éZíPà Åiå≥Åj
    Call UniCode_Conv(CHGHREC.YOSAN_FROM, StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode))
                                'ó\éZíPà ÅiêÊÅj
    Call UniCode_Conv(CHGHREC.YOSAN_TO, StrConv(XX_SIJREC.YOSAN_TO, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
    Call UniCode_Conv(CHGHREC.HOST_SOKO, StrConv(XX_SIJREC.HOST_SOKO, vbUnicode))
                                'íIî‘ÅiŒΩƒÅj
    Call UniCode_Conv(CHGHREC.HOST_TANA, StrConv(XX_SIJREC.HOST_TANA, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(CHGHREC.SYUK_CODE, StrConv(XX_SIJREC.SYUK_CODE, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(CHGHREC.SYUK_NAME, StrConv(XX_SIJREC.SYUK_NAME, vbUnicode))
                                '⁄∫∞ƒﬁèIí[œ∞∏(@)
                                'Å@çƒèàóùéûÇÃèdï°¡™Ø∏âÒîÇÃà◊ÅAïiî‘ïœçXÉfÅ[É^ÇÃèIí[É}Å[ÉNÇ…ÇÕ
                                'Å@ÅuÅHÅvÇÉZÉbÉgÇ∑ÇÈÅièdï°¡™Ø∏Ç≈ÇÕÅuèIí[ÅÅÅHÅvÇÃéû¡™Ø∏ÇµÇ»Ç¢Åj
    Call UniCode_Conv(CHGHREC.REC_END, "?")
                                'CR & LF
    Call UniCode_Conv(CHGHREC.CR, Chr(13))
    Call UniCode_Conv(CHGHREC.LF, Chr(10))

    If CHGH_Put(ZERO) Then         'äOïîïiî‘ïœçXï€óØÉfÅ[É^èëçûÇ›
        Exit Function
    End If

    CHin_Put = False

End Function
                                            'èdï°èoâ◊ó\íËÉfÅ[É^çÏê¨
Private Sub MAKE_SYUDUP_Put()
                                '√∑ΩƒáÇ
    Call UniCode_Conv(SYUDUPREC.TEXT_NO, StrConv(XX_SIJREC.TEXT_NO, vbUnicode))
                                'éñã∆ïîãÊï™
    Call UniCode_Conv(SYUDUPREC.JGYOBU, StrConv(XX_SIJREC.JGYOBU, vbUnicode))
                                'íºëóãÊï™
    Call UniCode_Conv(SYUDUPREC.CYOK_KBN, StrConv(XX_SIJREC.CYOK_KBN, vbUnicode))
                                'ì`ï[ì˙ït
    Call UniCode_Conv(SYUDUPREC.DEN_DT, StrConv(XX_SIJREC.DEN_DT, vbUnicode))
                                'ì¸èoå…ãÊï™
    Call UniCode_Conv(SYUDUPREC.IO_KBN, StrConv(XX_SIJREC.IO_KBN, vbUnicode))
                                'ê‘çïãÊï™
    Call UniCode_Conv(SYUDUPREC.PM_KBN, StrConv(XX_SIJREC.PM_KBN, vbUnicode))
                                'ì`ï[éÌï 
    Call UniCode_Conv(SYUDUPREC.DEN_SYU, StrConv(XX_SIJREC.DEN_SYU, vbUnicode))
                                'ì`ï[áÇ
    Call UniCode_Conv(SYUDUPREC.DEN_NO, StrConv(XX_SIJREC.DEN_NO, vbUnicode))
                                'íçï∂ãÊï™
    Call UniCode_Conv(SYUDUPREC.CYU_KBN, StrConv(XX_SIJREC.CYU_KBN, vbUnicode))
                                'ïiî‘ÅiäOïîÅj
    Call UniCode_Conv(SYUDUPREC.HIN_GAI, StrConv(XX_SIJREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
    Call UniCode_Conv(SYUDUPREC.HIN_NAI, StrConv(XX_SIJREC.HIN_NAI, vbUnicode))
                                'ïiñº
    Call UniCode_Conv(SYUDUPREC.HIN_NAME, StrConv(XX_SIJREC.HIN_NAME, vbUnicode))
                                'êîó 
    Call UniCode_Conv(SYUDUPREC.YOTEI_QTY, StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode))
                                'ó\éZíPà Åiå≥Åj
    Call UniCode_Conv(SYUDUPREC.YOSAN_FROM, StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode))
                                'ó\éZíPà ÅiêÊÅj
    Call UniCode_Conv(SYUDUPREC.YOSAN_TO, StrConv(XX_SIJREC.YOSAN_TO, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
    Call UniCode_Conv(SYUDUPREC.HOST_SOKO, StrConv(XX_SIJREC.HOST_SOKO, vbUnicode))
                                'íIî‘ÅiŒΩƒÅj
    Call UniCode_Conv(SYUDUPREC.HOST_TANA, StrConv(XX_SIJREC.HOST_TANA, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊ
    Call UniCode_Conv(SYUDUPREC.SYUK_CODE, StrConv(XX_SIJREC.SYUK_CODE, vbUnicode))
                                'éxããêÊÅ^èoâ◊êÊñº
    Call UniCode_Conv(SYUDUPREC.SYUK_NAME, StrConv(XX_SIJREC.SYUK_NAME, vbUnicode))
                                '⁄∫∞ƒﬁèIí[œ∞∏(@)
                                'Å@çƒèàóùéûÇÃèdï°¡™Ø∏âÒîÇÃà◊ÅAïiî‘ïœçXÉfÅ[É^ÇÃèIí[É}Å[ÉNÇ…ÇÕ
                                'Å@Åu*ÅvÇÉZÉbÉgÇ∑ÇÈÅièdï°¡™Ø∏Ç≈ÇÕÅuèIí[ÅÅ*ÅvÇÃéû¡™Ø∏ÇµÇ»Ç¢Åj
    Call UniCode_Conv(SYUDUPREC.REC_END, "*")
                                'CR & LF
    Call UniCode_Conv(SYUDUPREC.CR, Chr(13))
    Call UniCode_Conv(SYUDUPREC.LF, Chr(10))

    If SYUDUP_Put(ZERO) Then       'èdï°èoâ◊ó\íËÉfÅ[É^èëçûÇ›
        Unload Me
    End If
End Sub

                                            'ÉwÉbÉ_Å[àÛç¸ÅiÅu¥◊∞ÿΩƒÅvÅuê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîFàÍóóï\ÅvÅj
Private Sub P_Etc_Head(Lst_Kbn As Integer, Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    Printer.Print


    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
                                        'ÉwÉbÉ_Å[ÅiÇPÅj
    Printer.Print Tab(3);
    For i = ZERO To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).Code Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(37);
    If Lst_Kbn = ZERO Then
        Printer.Print "ÅñÅñÅñÅ@éÛêMÉGÉâÅ[ÉäÉXÉgÅ@ÅñÅñÅñ";
    Else
        Printer.Print "ÅñÅñ ê‘ì`ÅAèoå…ÅAí˘ê≥ÉfÅ[É^ämîFÉäÉXÉgÅ@ÅñÅñ";
    End If
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")

    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print Tab(MGN_L);
    Printer.Print "ïiî‘ÅiäOïîÅj";
    Printer.Print Tab(MGN_L + 14);
    Printer.Print "ïiî‘Åiì‡ïîÅj";
    Printer.Print Tab(MGN_L + 28);
    Printer.Print "ì`ï[ì˙ït";
    Printer.Print Tab(MGN_L + 39);
    Printer.Print "ì¸èoå…ãÊï™";
    Printer.Print Tab(MGN_L + 50);
    Printer.Print "ì`ï[áÇ";
    Printer.Print Tab(MGN_L + 58);
    Printer.Print "ì¸å…êî";
    Printer.Print Tab(MGN_L + 68);
    Printer.Print "èoå…êî";
    Printer.Print Tab(MGN_L + 77);
    Printer.Print "ëqå…";
    Printer.Print Tab(MGN_L + 82);
    Printer.Print "ãÊï™";
    Printer.Print Tab(MGN_L + 92);
    Printer.Print "íºëó";
    Printer.Print Tab(MGN_L + 98);
    Printer.Print "ó\éZíPà Å@Å@ ïWèÄíIî‘"
    Printer.Print

    Lcnt = 6 + MGN_U

End Sub
                                            'ñæç◊àÛç¸ÅiÅu¥◊∞ÿΩƒÅvÅuê‘ì`ÅAí˘ê≥ÅAèoâ◊ämîFàÍóóï\ÅvÅj
Private Sub P_Etc_Proc(Lst_Kbn As Integer)

Dim Lcnt As Integer
Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim i As Integer
Dim sts As Integer
Dim B_Jgyobu As String

    Lcnt = 99
    B_Jgyobu = Space(1)

    For i = ZERO To LBox_Etc.ListCount - 1
        If Left(LBox_Etc.List(i), 1) = Lst_Kbn Then

            Ldata = LBox_Etc.List(i)

                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
            If Lcnt > LMAX Or _
               Mid(Ldata, 2, 1) <> B_Jgyobu Then
                Call P_Etc_Head(Left(Ldata, 1), Lcnt, Mid(Ldata, 2, 1))
                B_Jgyobu = Mid(Ldata, 2, 1)
            End If
                                        'ñæç◊àÛç¸
            Ldata = Mid(Ldata, 3, Len(Ldata) - 2)

            Printer.Print Tab(MGN_L);
            Printer.Print ChrCut(Ldata, 13);            'ïiî‘ÅiäOïîÅj

            Printer.Print Tab(MGN_L + 14);
            Printer.Print ChrCut(Ldata, 13);            'ïiî‘Åiì‡ïîÅj

            Printer.Print Tab(MGN_L + 28);              'ì`ï[ì˙ït
            Printer.Print ChrCut(Ldata, 4) & "/" & ChrCut(Ldata, 2) & "/" & ChrCut(Ldata, 2);

            Printer.Print Tab(MGN_L + 40);              'ì¸èoå…ãÊï™
            wk_IO = ChrCut(Ldata, 1)
            Select Case wk_IO
                Case IO_KBN_URI
                    Printer.Print wk_IO & " " & (IO_KBN_0);
                Case IO_KBN_NYU
                    Printer.Print wk_IO & " " & (IO_KBN_1);
                Case IO_KBN_SYU
                    Printer.Print wk_IO & " " & (IO_KBN_2);
                Case IO_KBN_ZAT
                    Printer.Print wk_IO & " " & (IO_KBN_3);
                Case IO_KBN_SYU_JITU
                    Printer.Print wk_IO & " " & (IO_KBN_4);
                Case IO_KBN_HENPIN
                    Printer.Print wk_IO & " " & (IO_KBN_5);
                Case Else
                    Printer.Print wk_IO;
            End Select

            Printer.Print Tab(MGN_L + 50);
            Printer.Print ChrCut(Ldata, 6);             'ì`ï[áÇ

                                                        'êîó 
            If wk_IO = IO_KBN_NYU Or wk_IO = IO_KBN_ZAT Or wk_IO = IO_KBN_HENPIN Then
                Printer.Print Tab(MGN_L + 57);          'ì¸å…êî
            Else
                Printer.Print Tab(MGN_L + 67);          'èoå…êî
            End If
            sts = Numeric_Check(EDIT_ONLY, 7, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, ChrCut(Ldata, 6), Work)
            
            Printer.Print Work;
            
            Printer.Print ChrCut(Ldata, 1);             ' ê‘çïãÊï™
            
            Printer.Print Tab(MGN_L + 78);
            Printer.Print ChrCut(Ldata, 2);             'ëqå…ãÊï™ÅiŒΩƒÅj

            Printer.Print Tab(MGN_L + 83);              'íçï∂ãÊï™
            Select Case Left(Ldata, 1)
                Case CYU_KBN_TUK
                    Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_1);
                Case CYU_KBN_SPO
                    Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_2);
                Case CYU_KBN_HJU
                    Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_3);
                Case CYU_KBN_TOK
                    Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_4);
                Case CYU_KBN_BOU
                    Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_E);
                Case Else
                    Printer.Print ChrCut(Ldata, 1);
            End Select

            Printer.Print Tab(MGN_L + 92);              ' íºëóãÊï™
            Select Case Left(Ldata, 1)
                Case "*"
                    Printer.Print ChrCut(Ldata, 1) & " íº";
                                    
                Case Else
                    Printer.Print ChrCut(Ldata, 1);
            End Select
            Printer.Print Tab(MGN_L + 98);
            Printer.Print ChrCut(Ldata, 5);             'ëäéËêÊ(å≥Åj
            Printer.Print " ";
            Printer.Print ChrCut(Ldata, 5);             'ëäéËêÊ(êÊÅj

            Printer.Print Tab(MGN_L + 111);
            Printer.Print ChrCut(Ldata, 8);             'ïWèÄíIî‘

            'Select Case Ldata
            '    Case "0"
            '        Printer.Print Tab(MGN_L + 115);
            '        Printer.Print "ÉfÅ[É^ÉGÉâÅ[";
            '    Case "1"
            '        Printer.Print Tab(MGN_L + 115);
            '        Printer.Print "èoâ◊êÊñ¢ìoò^";
            '    Case Else
            'End Select
                                                    '1997.10.30
'            Select Case Ldata
'                Case "2"
'                    Printer.Print "  ì`ï[èdï°";
'            End Select
                                                    '1997.10.30
            
            Printer.Print
            Printer.Print

            Lcnt = Lcnt + 2
        End If
    Next i

    If Lcnt <> 99 Then
        Printer.EndDoc
        Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    End If

End Sub
                                            'ÉwÉbÉ_Å[àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Head(Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
    
    Printer.Print Tab(3);
    For i = ZERO To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).Code Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(37);
    Printer.Print "ÅñÅñÅñÅ@ïiî‘ïœçXÉäÉXÉgÅ@ÅñÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")
    
    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print "------- ïiî‘ÅiäOïîÅj-------";
    Printer.Print Tab(30);
    Printer.Print "------- ïiî‘Åiì‡ïîÅj-------";
    Printer.Print
    
    Printer.Print Tab(MGN_L);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 15);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 30);
    Printer.Print "éÛêMÉfÅ[É^";
    Printer.Print Tab(MGN_L + 44);
    Printer.Print "É}ÉXÉ^";
    Printer.Print Tab(MGN_L + 58);
    Printer.Print "ì`ï[ì˙ït";
    Printer.Print Tab(MGN_L + 69);
    Printer.Print "ì¸èoå…ãÊ";
    Printer.Print Tab(MGN_L + 78);
    Printer.Print "ì`ï[áÇ";
    Printer.Print Tab(MGN_L + 86);
    Printer.Print "ì¸èoêî";
    Printer.Print Tab(MGN_L + 93);
    Printer.Print "ëq";
    Printer.Print Tab(MGN_L + 96);
    Printer.Print "íçï∂ãÊ";
    Printer.Print Tab(MGN_L + 103);
    Printer.Print "èoâ◊êÊ"
    Printer.Print

    Lcnt = 7 + MGN_U

End Sub
                                            'ñæç◊àÛç¸ÅiÅuïiî‘ïœçXÉäÉXÉgÅvÅj
Private Sub P_Hin_Proc()

Dim Lcnt As Integer
Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim Emsg As String
Dim Wqty As Long
Dim i As Integer
Dim sts As Integer
Dim B_Jgyobu As String

    Lcnt = 99

    For i = ZERO To LBox_Hin.ListCount - 1
        
        Ldata = LBox_Hin.List(i)

                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
        If Lcnt > LMAX Or _
           B_Jgyobu <> Left(Ldata, 1) Then
            Call P_Hin_Head(Lcnt, Left(Ldata, 1))
            B_Jgyobu = Left(Ldata, 1)
        End If

                                        'ñæç◊àÛç¸
        Ldata = Mid(Ldata, 11, Len(Ldata) - 11)                     'éñã∆ïîÅC√∑ΩƒáÇÅCçëì‡äOÅ@èúäO

        Printer.Print Tab(MGN_L);
        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘ÅiäOïîÅj
        Work = ChrCut(Ldata, 13)
        If Right(Ldata, 1) = "1" Or Right(Ldata, 1) = "2" Then      'äOïîïiî‘ïœçXÅH
            Printer.Print Tab(MGN_L + 15);
            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘ÅiäOïîÅj
        End If

        Printer.Print Tab(MGN_L + 30);
        Printer.Print ChrCut(Ldata, 13);                            'éÛêM√ﬁ∞¿ïiî‘Åiì‡ïîÅj
        Work = ChrCut(Ldata, 13)
        If Right(Ldata, 1) = "0" Then                               'ì‡ïîïiî‘ïœçXÅH
            Printer.Print Tab(MGN_L + 44);
            Printer.Print Work;                                     'É}ÉXÉ^ïiî‘Åiì‡ïîÅj
        End If

        Printer.Print Tab(MGN_L + 58);                              'ì`ï[ì˙ït
        Printer.Print ChrCut(Ldata, 4) & "/" & ChrCut(Ldata, 2) & "/" & ChrCut(Ldata, 2);

        Printer.Print Tab(MGN_L + 69);                              'ì¸èoå…ãÊï™
        wk_IO = ChrCut(Ldata, 1)
        Select Case wk_IO
            Case IO_KBN_URI
                Printer.Print wk_IO & " " & (IO_KBN_0);
            Case IO_KBN_NYU
                Printer.Print wk_IO & " " & (IO_KBN_1);
            Case IO_KBN_SYU
                Printer.Print wk_IO & " " & (IO_KBN_2);
            Case IO_KBN_ZAT
                Printer.Print wk_IO & " " & (IO_KBN_3);
            Case Else
                Printer.Print wk_IO;
        End Select

        Printer.Print Tab(MGN_L + 78);
        Printer.Print ChrCut(Ldata, 6);                             'ì`ï[áÇ

        Printer.Print Tab(MGN_L + 85);                              'ì¸èoå…êî
        Wqty = CLng(ChrCut(Ldata, 6))
        
        
        sts = Numeric_Check(EDIT_ONLY, 7, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, Format(Wqty, "00000000"), Work)
        
        Printer.Print Work;

        Printer.Print Tab(MGN_L + 93);
        Printer.Print ChrCut(Ldata, 2);                             'ëqå…ãÊï™ÅiŒΩƒÅj

        Printer.Print Tab(MGN_L + 96);                              'íçï∂ãÊï™
        Select Case Left(Ldata, 1)
            Case CYU_KBN_TUK
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_1);
            Case CYU_KBN_SPO
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_2);
            Case CYU_KBN_HJU
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_3);
            Case CYU_KBN_BOU
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_E);
            Case Else
                Printer.Print ChrCut(Ldata, 1);
        End Select

        Printer.Print Tab(MGN_L + 103);
        Printer.Print ChrCut(Ldata, 5);                             'éxããêÊÅ^èoâ◊êÊ

        Printer.Print Tab(MGN_L + 110);                             'ïœçXÉÅÉbÉZÅ[ÉW
        Select Case Left(Ldata, 1)
            Case "0"
                Printer.Print "ì‡ïîïœçX œΩ¿ïiî‘ì¸ë÷";
            Case "1"
                Printer.Print "äOïîïœçX œΩ¿ïiî‘ì¸ë÷";
            Case "2"
                Printer.Print "ç›å…óLÅIäOïîïœçXïsâ¬";
        End Select
        Printer.Print

        Printer.Print

        Lcnt = Lcnt + 2
    Next i

    If Lcnt <> 99 Then
        Printer.EndDoc
        Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    End If

End Sub
                                            'ñæç◊àÛç¸Åièoâ◊ó\íËèdï°ÉäÉXÉgÅj
Private Sub P_Dup_Proc()

Dim Lcnt As Integer
Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim i As Integer
Dim sts As Integer
Dim B_Jgyobu As String

    Lcnt = 99
    B_Jgyobu = Space(1)

    For i = ZERO To LBox_Dup.ListCount - 1

        Ldata = LBox_Dup.List(i)

                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
        If Lcnt > LMAX Or _
            Mid(Ldata, 2, 1) <> B_Jgyobu Then
            Call P_Dup_Head(Lcnt, Mid(Ldata, 2, 1))
            B_Jgyobu = Mid(Ldata, 2, 1)
        End If
                                        'ñæç◊àÛç¸
        Ldata = Mid(Ldata, 3, Len(Ldata) - 2)

        Printer.Print Tab(MGN_L);
        Printer.Print ChrCut(Ldata, 13);            'ïiî‘ÅiäOïîÅj

        Printer.Print Tab(MGN_L + 14);
        Printer.Print ChrCut(Ldata, 13);            'ïiî‘Åiì‡ïîÅj

        Printer.Print Tab(MGN_L + 28);              'ì`ï[ì˙ït
        Printer.Print ChrCut(Ldata, 4) & "/" & ChrCut(Ldata, 2) & "/" & ChrCut(Ldata, 2);

        Printer.Print Tab(MGN_L + 40);              'ì¸èoå…ãÊï™
        wk_IO = ChrCut(Ldata, 1)
        Select Case wk_IO
            Case IO_KBN_URI
                Printer.Print wk_IO & " " & (IO_KBN_0);
            Case IO_KBN_NYU
                Printer.Print wk_IO & " " & (IO_KBN_1);
            Case IO_KBN_SYU
                Printer.Print wk_IO & " " & (IO_KBN_2);
            Case IO_KBN_ZAT
                Printer.Print wk_IO & " " & (IO_KBN_3);
            Case IO_KBN_SYU_JITU
                Printer.Print wk_IO & " " & (IO_KBN_4);
            Case IO_KBN_HENPIN
                Printer.Print wk_IO & " " & (IO_KBN_5);
            Case Else
                Printer.Print wk_IO;
        End Select

        Printer.Print Tab(MGN_L + 50);
        Printer.Print ChrCut(Ldata, 6);             'ì`ï[áÇ

        Printer.Print Tab(MGN_L + 67);              'èoå…êî
            
        
        sts = Numeric_Check(EDIT_ONLY, 7, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, ChrCut(Ldata, 6), Work)
        
        Printer.Print Work;
            
        Printer.Print ChrCut(Ldata, 1);             ' ê‘çïãÊï™
            
        Printer.Print Tab(MGN_L + 78);
        Printer.Print ChrCut(Ldata, 2);             'ëqå…ãÊï™ÅiŒΩƒÅj

        Printer.Print Tab(MGN_L + 83);              'íçï∂ãÊï™
        Select Case Left(Ldata, 1)
            Case CYU_KBN_TUK
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_1);
            Case CYU_KBN_SPO
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_2);
            Case CYU_KBN_HJU
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_3);
            Case CYU_KBN_TOK
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_4);
            Case CYU_KBN_BOU
                Printer.Print ChrCut(Ldata, 1) & " " & (CYU_KBN_E);
            Case Else
                Printer.Print ChrCut(Ldata, 1);
        End Select

        Printer.Print Tab(MGN_L + 92);              ' íºëóãÊï™
        Select Case Left(Ldata, 1)
            Case "*"
                Printer.Print ChrCut(Ldata, 1) & " íº";
                                    
            Case Else
                Printer.Print ChrCut(Ldata, 1);
        End Select
        Printer.Print Tab(MGN_L + 98);
        Printer.Print ChrCut(Ldata, 5);             'ëäéËêÊ(å≥Åj
        Printer.Print " ";
        Printer.Print ChrCut(Ldata, 5);             'ëäéËêÊ(êÊÅj

        Printer.Print Tab(MGN_L + 111);
        Printer.Print ChrCut(Ldata, 8);             'ïWèÄíIî‘

            
        Printer.Print
        Printer.Print

        Lcnt = Lcnt + 2
    Next i

    If Lcnt <> 99 Then
        Printer.EndDoc
        Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    End If

End Sub
                                            'ÉwÉbÉ_Å[àÛç¸Åièoâ◊ó\íËèdï°ÉäÉXÉgÅj
Private Sub P_Dup_Head(Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    Printer.Print


    For i = 1 To MGN_U
        Printer.Print
    Next i

    Printer.Print
                                        'ÉwÉbÉ_Å[ÅiÇPÅj
    Printer.Print Tab(3);
    For i = ZERO To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).Code Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(37);
    Printer.Print "ÅñÅñ èoâ◊ó\íËèdï°ÉäÉXÉgÅ@ÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")

    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print Tab(MGN_L);
    Printer.Print "ïiî‘ÅiäOïîÅj";
    Printer.Print Tab(MGN_L + 14);
    Printer.Print "ïiî‘Åiì‡ïîÅj";
    Printer.Print Tab(MGN_L + 28);
    Printer.Print "ì`ï[ì˙ït";
    Printer.Print Tab(MGN_L + 39);
    Printer.Print "ì¸èoå…ãÊï™";
    Printer.Print Tab(MGN_L + 50);
    Printer.Print "ì`ï[áÇ";
    Printer.Print Tab(MGN_L + 58);
    Printer.Print "ì¸å…êî";
    Printer.Print Tab(MGN_L + 68);
    Printer.Print "èoå…êî";
    Printer.Print Tab(MGN_L + 77);
    Printer.Print "ëqå…";
    Printer.Print Tab(MGN_L + 82);
    Printer.Print "ãÊï™";
    Printer.Print Tab(MGN_L + 92);
    Printer.Print "íºëó";
    Printer.Print Tab(MGN_L + 98);
    Printer.Print "ó\éZíPà Å@Å@ ïWèÄíIî‘"
    Printer.Print

    Lcnt = 6 + MGN_U

End Sub
                                            'ï∂éöóÒÇÃêÿèoÇµ
Private Function ChrCut(Moto As String, Leng As Long) As String
    ChrCut = Left(Moto, Leng)

    If Len(Moto) <= Leng Then
        Moto = ""
        Exit Function
    End If

    Moto = Mid(Moto, Leng + 1, Len(Moto) - Leng)
End Function
                                            'ÉwÉbÉ_Å[àÛç¸ÅiÅuâﬂèËëOéÿïiÿΩƒÅvÅj
Private Sub P_Last_Head(Lcnt As Integer, JGYO_Kbn As String)
Dim i As Integer
Dim sts As Integer
Dim RetBuf As String

    If Lcnt <> 99 Then
        Printer.NewPage
    End If

    Printer.Print


    For i = 1 To MGN_U2
        Printer.Print
    Next i

    Printer.Print
                                        'ÉwÉbÉ_Å[ÅiÇPÅj
    Printer.Print Tab(3);
    For i = ZERO To UBound(JGYOBU_T)
        If JGYO_Kbn = JGYOBU_T(i).Code Then
            Printer.Print "Åi" & RTrim(JGYOBU_T(i).NAME) & "Åj";
            Exit For
        End If
    Next i
    Printer.Print Tab(39);
    Printer.Print "ÅñÅñÅñ âﬂèËëOéÿïiÉäÉXÉgÅ@ÅñÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Pdate & "  " & Ptime;
    Printer.Print "     P." & Format(Printer.Page, "000")

    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print Tab(MGN_L2 + 1);
    Printer.Print "çëì‡äO";
    Printer.Print Tab(MGN_L2 + 11);
    Printer.Print "ïiî‘ÅiäOïîÅj";
    Printer.Print Tab(MGN_L2 + 29);
    Printer.Print "ïiÅ@ñº";
    Printer.Print Tab(MGN_L2 + 62);
    Printer.Print "âﬂèËêî"
    Printer.Print

    Lcnt = 6 + MGN_U2

End Sub
                                            'ëOéÿÇËì¸â◊ÅAé¿ê—écÉ`ÉFÉbÉN
Private Sub Last_Proc()
Dim sts         As Integer
Dim Lcnt        As Integer
Dim Command     As Integer
Dim RetBuf      As String
Dim B_Jgyobu    As String

Dim ans         As Integer

    Call Input_Lock           'âÊñ çÄñ⁄ÉçÉbÉN

    MsgLab(7).Visible = True       'çXêVíÜ“Øæ∞ºﬁï\é¶
    DoEvents

'    Printer.Orientation = vbPRORLandscape   'ópéÜÇÃí∑ï”Çè„Ç…ÇµÇƒàÛç¸
    Set Printer.Font = NormalFont           'àÛç¸ÉtÉHÉìÉgê›íË
    Lcnt = 99
    B_Jgyobu = Space(1)

'ì¸â◊¡™Ø∏√ﬁ∞¿çXêV
    Command = BtOpGetFirst
    Do
        Do
            sts = BTRV(Command + BtSNoWait, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
            Select Case sts
                Case BtNoErr, BtErrKeyNotFound, BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        Exit Sub
                    End If
                Case Else
                    Call File_Error(sts, Command, "ì¸â◊¡™Ø∏√ﬁ∞¿")
                    Exit Sub
            End Select
        Loop

        If sts = BtErrKeyNotFound Or sts = BtErrEOF Then
            Exit Do
        End If

                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
        If Lcnt > LMAX Or _
           StrConv(J_NYUREC.JGYOBU, vbUnicode) <> B_Jgyobu Then
            Call P_Last_Head(Lcnt, StrConv(J_NYUREC.JGYOBU, vbUnicode))
            B_Jgyobu = StrConv(J_NYUREC.JGYOBU, vbUnicode)
        End If
                                        'ñæç◊àÛç¸
        Printer.Print Tab(MGN_L2 + 2);
        If StrConv(J_NYUREC.NAIGAI, vbUnicode) = "1" Then
            Printer.Print NAIGAI1;         'çëì‡
        Else
            Printer.Print NAIGAI2;         'äCäO
        End If

        Printer.Print Tab(MGN_L2 + 11);
        Printer.Print StrConv(J_NYUREC.HIN_GAI, vbUnicode);

        Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(J_NYUREC.JGYOBU, vbUnicode))
        Call UniCode_Conv(K0_ITEM.NAIGAI, StrConv(J_NYUREC.NAIGAI, vbUnicode))
        Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(J_NYUREC.HIN_GAI, vbUnicode))
        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
            Case BtNoErr
                Printer.Print Tab(MGN_L2 + 29);
                Printer.Print StrConv(ITEMREC.HIN_NAME, vbUnicode);
            Case BtErrKeyNotFound
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
                Exit Sub
        End Select

        sts = Numeric_Check(EDIT_ONLY, 10, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, StrConv(J_NYUREC.JITU_QTY, vbUnicode), RetBuf)
        Printer.Print Tab(MGN_L2 + 58);
        Printer.Print RetBuf;
        Printer.Print

        Printer.Print

        Lcnt = Lcnt + 2
''ë‹à‰ëOéÿÇËÉfÅ[É^ÇÕécÇ∑
''        Do
''            sts = BTRV(BtOpDelete, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
''            Select Case sts
''                Case BtNoErr
''                    Exit Do
''                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
''                    Beep
''                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<J_NYUKA.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
''                    If ans = vbCancel Then
''                        Exit Sub
''                    End If
''                Case Else
''                    Call File_Error(sts, BtOpDelete, "ì¸â◊¡™Ø∏√ﬁ∞¿")
''                    Exit Sub
''            End Select
''
''        Loop
        
        Command = BtOpGetNext
    Loop

    If Lcnt <> 99 Then
        Printer.EndDoc
    End If

End Sub
Private Sub RERUN_PROC()

Dim i   As Integer
Dim sts As Integer

'ã≠êßçƒé¿çsèàóù
    SelCmd(3).Enabled = True
    SelCmd(1).Enabled = True
    SelCmd(2).Enabled = True
    
    Label2(ZERO).Visible = True
    Text1(ZERO).Visible = True
                                                'êÙëÛã@ SPIC
    Call UniCode_Conv(K0_SEQCK.JGYOBU, "1")
    Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "1")
        
    sts = BTRV(BtOpGetEqual, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call UniCode_Conv(SEQCKREC.LAST_TXTNO, "000000000")
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
            Unload Me
    End Select

    Text1(ZERO).Text = StrConv(SEQCKREC.LAST_TXTNO, vbUnicode)

                                                'êÙëÛã@ ì¡îÑÇË
    Call UniCode_Conv(K0_SEQCK.JGYOBU, "1")
    Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "2")
        
    sts = BTRV(BtOpGetEqual, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call UniCode_Conv(SEQCKREC.LAST_TXTNO, "000000000")
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
            Unload Me
    End Select

    Text1(1).Text = StrConv(SEQCKREC.LAST_TXTNO, vbUnicode)


    Text1(ZERO).SetFocus
End Sub
Private Sub Command_Click(Index As Integer)

    Select Case Index
        Case 11
            Unload Me
        Case Else
            Beep
    End Select

End Sub
Private Sub Command_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)

    Select Case KeyCode
        Case vbKeyF12
            Command(11).Value = True
    End Select
End Sub

Private Sub Form_DblClick()
    PrintForm
End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
'----------------------------------------------------------------------------
'                   ÇjÇÖÇô ÇcÇèÇóÇé ëOèàóù
'----------------------------------------------------------------------------
    Select Case KeyCode
        Case vbKeyF1 To vbKeyF12
            Command(KeyCode - vbKeyF1).Value = True
        Case vbKeyZ
            If Shift = 1 Then
                Call RERUN_PROC
            End If
    End Select


End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = ZERO
    End If
End Sub
Private Sub Form_Load()
Dim i As Integer
Dim c As String * 128
Dim sts As Integer


Dim sBuffer As String * 255
Dim com     As String
    
    If App.PrevInstance Then
        Beep
        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If

    Show
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                'èoâ◊ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If SYUKA_LOGF_GET_PROC() Then
        Beep
        MsgBox "èoâ◊ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                
                                'ÉVÉXÉeÉÄó\ñÒçœóvàˆéÊÇËçûÇ›
    If SYSTEM_YOIN_Set() Then
        Beep
        MsgBox "ÉVÉXÉeÉÄó\ñÒçœóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

                                'éñã∆ïîéÊÇËçûÇ›
    If JGYOB_TB_Set Then
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                'óLå¯ŒΩƒëqå…éÊÇËçûÇ›Åië|èúã@Åj
    For i = ZERO To UBound(SOKO_T1) - 1
        SOKO_T1(i).HS_SOKO = "  "
        SOKO_T1(i).NAIGAI = " "
    Next i

    i = ZERO
    Do
        If GetIni("NYUSYU_OK_SOKO", "SOKO1" & RTrim(Format(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [NYUSYU_OK_SOKO] [SOKO] READ ERROR")
            End
        End If
        If RTrim(c) = "**" Then
            Exit Do
        End If
        SOKO_T1(i).HS_SOKO = RTrim(c)
        If GetIni("NYUSYU_OK_SOKO", "NAIG1" & RTrim(Format(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [NYUSYU_OK_SOKO] [NAIG] READ ERROR")
            End
        End If
        SOKO_T1(i).NAIGAI = RTrim(c)
        i = i + 1
    Loop

    If Kaso_Soko_No_Set() Then
        Beep
        MsgBox "âºëzëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
                                '‹∞∏Ω√∞ºÆ›î‘çÜéÊÇËçûÇ›
    sBuffer = Space(255)
    If GetComputerNameA(sBuffer, 255) <> ZERO Then
        com = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
    Else
        com = "??"
    End If
    WS_NO = RTrim(com)

                                'ëqå…É}ÉXÉ^ÇnÇoÇdÇm
    If SOKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇnÇoÇdÇm
    If wITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If MTS_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'å¸ÇØêÊì«ë÷É}ÉXÉ^ÇnÇoÇdÇmÅ@2001.07.04
    If MTSCHG_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'óvàˆÉXÉ^ÇnÇoÇdÇm
    If YOIN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…ÉfÅ[É^ÇnÇoÇdÇm
    If ZAIKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…à⁄ìÆóÇnÇoÇdÇm
    If IDO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊ó\íËÇnÇoÇdÇm
    If Y_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'èoâ◊ó\íËÇnÇoÇdÇm
    If Y_SYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ì¸â◊¡™Ø∏√ﬁ∞¿ÇnÇoÇdÇm
    If J_NYU_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ó\íËéÊçûÇ›¡™Ø∏ÇnÇoÇdÇm
    If SEQCK_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'àÛç¸ÉtÉHÉìÉgê›íË
    With NormalFont
        .NAME = F1020121.FontName
        .Size = F1020121.FontSize
    End With
    Set Printer.Font = NormalFont
                                'âÊñ èâä˙ê›íË
    Call Scr_Init
    
    Last_Proc_F = False         'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLñ≥ÉtÉâÉOÉNÉäÉA

    Shori_Mode = 3
    Call Data_Inport            'ÉzÉXÉgÉfÅ[É^éÊçûÇ›èàóù
    
    Unload Me



End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
    If UnloadMode = vbFormControlMenu Then Cancel = 1
End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer

    If Last_Proc_F = True Then              'ì¸â◊¡™Ø∏√ﬁ∞¿çÌèúèàóùÅ@é¿çsóLÇËÅH
        Call Last_Proc
    End If

                                            'ëqå…É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^")
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, wITEM_POS, wITEMREC, Len(wITEMREC), K0_wITEM, Len(K0_wITEM), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
        End If
    End If
                                            'å¸ÇØêÊì«ë÷É}ÉXÉ^ÇbÇkÇnÇrÇdÅ@2001.07.04
    sts = BTRV(BtOpClose, MTSCHG_POS, MTSCHGREC, Len(MTSCHGREC), K0_MTSCHG, Len(K0_MTSCHG), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "å¸ÇØêÊì«ë÷É}ÉXÉ^")
        End If
    End If
                                            'óvàˆÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")
        End If
    End If
                                            'ç›å…ÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")
        End If
    End If
                                            'ç›å…à⁄ìÆóÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, IDO_POS, IDOREC, Len(IDOREC), K0_IDO, Len(K0_IDO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆó")
        End If
    End If
                                            'ì¸â◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_NYU_POS, Y_NYUREC, Len(Y_NYUREC), K0_Y_NYU, Len(K0_Y_NYU), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊ó\íË")
        End If
    End If
                                            'èoâ◊ó\íËÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íË")
        End If
    End If
                                            'ì¸â◊¡™Ø∏√ﬁ∞¿ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊¡™Ø∏√ﬁ∞¿")
        End If
    End If
                                            'ó\íËéÊçûÇ›¡™Ø∏ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ó\íËéÊçûÇ›¡™Ø∏")
        End If
    End If
                                            'ÇaÇîÇíÇâÇÖÇñÇÖÉäÉZÉbÉg
    sts = BTRV(BtOpReset, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), ZERO)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    Set F1020121 = Nothing

    End
End Sub


Private Sub SelCmd_Click(Index As Integer)

Dim ans As Integer
        
    Beep
    ans = MsgBox("Åu" & SelCmd(Index).Caption & "Åv" & "Å@éÊçûÇ›èàóùÅ@é¿çsÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
    If ans = vbYes Then
        If Text1(ZERO).Visible Then
            Call SEQCHEK_PUT
        End If
        Shori_Mode = Index
        Call Data_Inport            'ÉzÉXÉgÉfÅ[É^éÊçûÇ›èàóù
    End If

End Sub
Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------

    F1020121.MousePointer = vbHourglass

    Call Ctrl_Lock(F1020121)

End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------

    Call Ctrl_UnLock(F1020121)

    F1020121.MousePointer = vbDefault

End Sub

Private Sub Text1_GotFocus(Index As Integer)
    
    If Text1(Index).TabStop = True Then
        Text1(Index) = Trim(Text1(Index).Text)
        Text1(Index).SelStart = ZERO
        Text1(Index).SelLength = Len(Text1(Index).Text)
    End If


End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    
Dim i   As Integer
    
    If KeyCode <> vbKeyReturn Then Exit Sub
            

    For i = Index + 1 To Text_Max
        If Text1(i).Enabled And Text1(i).Visible And Text1(i).TabStop Then
            Text1(i).SetFocus
            Exit For
        End If
    Next i

End Sub

Private Sub SEQCHEK_PUT()
    
Dim sts As Integer
Dim com As Integer
Dim ans As Integer
                                    'êÙëÛã@ SPIC
    Call UniCode_Conv(K0_SEQCK.JGYOBU, "1")
    Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "1")
        
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
    
        Select Case sts
            Case BtNoErr
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                com = BtOpInsert
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCHK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Unload Me
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                Unload Me
        End Select

    Loop

    If com = BtOpInsert Then
        Call UniCode_Conv(SEQCKREC.JGYOBU, "1")
        Call UniCode_Conv(SEQCKREC.SEQ_MODE, "1")
    End If

    Call UniCode_Conv(SEQCKREC.LAST_TXTNO, Text1(ZERO).Text)
    Call UniCode_Conv(SEQCKREC.LAST_GET_DT, Format(Date, "yyyymmdd"))
    Call UniCode_Conv(SEQCKREC.LAST_GET_TM, Format(Time, "HHmmss"))

    Do
        sts = BTRV(com, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCHK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Unload Me
                End If
            Case Else
                Call File_Error(sts, com, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                Unload Me
        End Select
    
    Loop

                                    'êÙëÛã@ ì¡îÑÇË
    Call UniCode_Conv(K0_SEQCK.JGYOBU, "1")
    Call UniCode_Conv(K0_SEQCK.SEQ_MODE, "2")
        
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
    
        Select Case sts
            Case BtNoErr
                com = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                com = BtOpInsert
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCHK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Unload Me
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                Unload Me
        End Select

    Loop

    If com = BtOpInsert Then
        Call UniCode_Conv(SEQCKREC.JGYOBU, "1")
        Call UniCode_Conv(SEQCKREC.SEQ_MODE, "2")
    End If

    Call UniCode_Conv(SEQCKREC.LAST_TXTNO, Text1(1).Text)
    Call UniCode_Conv(SEQCKREC.LAST_GET_DT, Format(Date, "yyyymmdd"))
    Call UniCode_Conv(SEQCKREC.LAST_GET_TM, Format(Time, "HHmmss"))

    Do
        sts = BTRV(com, SEQCK_POS, SEQCKREC, Len(SEQCKREC), K0_SEQCK, Len(K0_SEQCK), ZERO)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<SEQCHK.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Unload Me
                End If
            Case Else
                Call File_Error(sts, com, "ó\íËéÊçûÇ›É`ÉFÉbÉN")
                Unload Me
        End Select
    
    Loop

End Sub


Private Sub Err_Log_Out(Mesg As String)
Dim Work_Rec    As String

                                '√∑ΩƒáÇ
        Work_Rec = StrConv(XX_SIJREC.TEXT_NO, vbUnicode)
                                'éñã∆ïîãÊï™
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.JGYOBU, vbUnicode)
                                'íºëóãÊï™
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.CYOK_KBN, vbUnicode)
                                'ì`ï[ì˙ït
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.DEN_DT, vbUnicode)
                                'ì¸èoå…ãÊï™
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.IO_KBN, vbUnicode)
                                'ê‘çïãÊï™
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.PM_KBN, vbUnicode)
                                'ì`ï[éÌï 
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.DEN_SYU, vbUnicode)
                                'ì`ï[áÇ
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.DEN_NO, vbUnicode)
                                'íçï∂ãÊï™
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.CYU_KBN, vbUnicode)
                                'ïiî‘ÅiäOïîÅj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.HIN_GAI, vbUnicode)
                                'ïiî‘Åiì‡ïîÅj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.HIN_NAI, vbUnicode)
                                'ïiñº
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.HIN_NAME, vbUnicode)
                                'êîó 
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.YOTEI_QTY, vbUnicode)
                                'ó\éZíPà Åiå≥Åj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.YOSAN_FROM, vbUnicode)
                                'ó\éZíPà ÅiêÊÅj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.YOSAN_TO, vbUnicode)
                                'ëqå…ãÊï™ÅiŒΩƒÅj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.HOST_SOKO, vbUnicode)
                                'íIî‘ÅiŒΩƒÅj
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.HOST_TANA, vbUnicode)
                                'éxããêÊÅ^èoâ◊êÊ
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.SYUK_CODE, vbUnicode)
                                'éxããêÊÅ^èoâ◊êÊñº
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.SYUK_NAME, vbUnicode)
                                '⁄∫∞ƒﬁèIí[œ∞∏(@)
        Work_Rec = Work_Rec & StrConv(XX_SIJREC.REC_END, vbUnicode)

        Call Log_Out(LOG_F, Mesg & " " & Work_Rec)

End Sub
