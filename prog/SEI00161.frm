VERSION 5.00
Object = "{77DDF307-D82B-4757-8B3A-106EC9D75D4B}#8.0#0"; "tdbg8.ocx"
Object = "{3B7C8863-D78F-101B-B9B5-04021C009402}#1.2#0"; "RICHTX32.OCX"
Begin VB.Form SEI00161 
   Caption         =   "[êøãÅÉVÉXÉeÉÄ]å©êœèëçÏê¨èàóù"
   ClientHeight    =   12375
   ClientLeft      =   2025
   ClientTop       =   -3210
   ClientWidth     =   18360
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   12375
   ScaleWidth      =   18360
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   62
      Left            =   12840
      TabIndex        =   69
      Top             =   11160
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   57
      Left            =   12840
      TabIndex        =   63
      Top             =   10800
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   52
      Left            =   12840
      TabIndex        =   57
      Top             =   10440
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   47
      Left            =   12840
      TabIndex        =   51
      Top             =   10080
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   42
      Left            =   12840
      TabIndex        =   45
      Top             =   9720
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   37
      Left            =   12840
      TabIndex        =   39
      Top             =   9360
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   32
      Left            =   12840
      TabIndex        =   33
      Top             =   9000
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   27
      Left            =   12840
      TabIndex        =   27
      Top             =   8640
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   22
      Left            =   12840
      TabIndex        =   21
      Top             =   8280
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   17
      Left            =   12840
      TabIndex        =   15
      Top             =   7920
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   12
      Left            =   12840
      TabIndex        =   10
      Text            =   "99999999.99"
      Top             =   7560
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   60
      Left            =   10680
      TabIndex        =   67
      Top             =   11160
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   55
      Left            =   10680
      TabIndex        =   61
      Top             =   10800
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   50
      Left            =   10680
      TabIndex        =   55
      Top             =   10440
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   45
      Left            =   10680
      TabIndex        =   49
      Top             =   10080
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   40
      Left            =   10680
      TabIndex        =   43
      Top             =   9720
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   35
      Left            =   10680
      TabIndex        =   37
      Top             =   9360
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   30
      Left            =   10680
      TabIndex        =   31
      Top             =   9000
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   25
      Left            =   10680
      TabIndex        =   25
      Top             =   8640
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   20
      Left            =   10680
      TabIndex        =   19
      Top             =   8280
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   15
      Left            =   10680
      TabIndex        =   13
      Top             =   7920
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   10680
      TabIndex        =   8
      Text            =   "999.99"
      Top             =   7560
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   63
      Left            =   14160
      TabIndex        =   70
      TabStop         =   0   'False
      Top             =   11160
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   58
      Left            =   14160
      TabIndex        =   64
      TabStop         =   0   'False
      Top             =   10800
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   53
      Left            =   14160
      TabIndex        =   58
      TabStop         =   0   'False
      Top             =   10440
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   48
      Left            =   14160
      TabIndex        =   52
      TabStop         =   0   'False
      Top             =   10080
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   43
      Left            =   14160
      TabIndex        =   46
      TabStop         =   0   'False
      Top             =   9720
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   38
      Left            =   14160
      TabIndex        =   40
      TabStop         =   0   'False
      Top             =   9360
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   33
      Left            =   14160
      TabIndex        =   34
      TabStop         =   0   'False
      Top             =   9000
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   28
      Left            =   14160
      TabIndex        =   28
      TabStop         =   0   'False
      Top             =   8640
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   23
      Left            =   14160
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   8280
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   18
      Left            =   14160
      TabIndex        =   16
      TabStop         =   0   'False
      Top             =   7920
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   13
      Left            =   14160
      TabIndex        =   82
      TabStop         =   0   'False
      Top             =   7560
      Width           =   1335
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   10
      Left            =   8520
      TabIndex        =   66
      Top             =   11280
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   9
      Left            =   8520
      TabIndex        =   60
      Top             =   10920
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   8
      Left            =   8520
      TabIndex        =   54
      Top             =   10560
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   7
      Left            =   8520
      TabIndex        =   48
      Top             =   10200
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   6
      Left            =   8520
      TabIndex        =   42
      Top             =   9840
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   5
      Left            =   8520
      TabIndex        =   36
      Top             =   9480
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   4
      Left            =   8520
      TabIndex        =   30
      Top             =   9120
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   3
      Left            =   8520
      TabIndex        =   24
      Top             =   8760
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   2
      Left            =   8520
      TabIndex        =   18
      Top             =   8400
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   1
      Left            =   8520
      TabIndex        =   12
      Top             =   8040
      Width           =   375
   End
   Begin VB.CheckBox Check1 
      Height          =   240
      Index           =   0
      Left            =   8520
      TabIndex        =   7
      Top             =   7680
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      IMEMode         =   3  'µÃå≈íË
      Index           =   66
      Left            =   17520
      MaxLength       =   1
      TabIndex        =   80
      Top             =   960
      Width           =   255
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      IMEMode         =   1  'µ›
      Index           =   65
      Left            =   14040
      MaxLength       =   20
      TabIndex        =   2
      Top             =   960
      Width           =   2175
   End
   Begin TrueDBGrid80.TDBDropDown TDBDropDown2 
      Height          =   2055
      Left            =   4560
      TabIndex        =   120
      Top             =   3840
      Width           =   1935
      _ExtentX        =   3413
      _ExtentY        =   3625
      _LayoutType     =   4
      _RowHeight      =   -2147483647
      _WasPersistedAsPixels=   0
      Columns(0)._VlistStyle=   0
      Columns(0)._MaxComboItems=   5
      Columns(0).ValueItems(0)._DefaultItem=   0
      Columns(0).ValueItems(0).Value=   "aaaa"
      Columns(0).ValueItems(0).Value.vt=   8
      Columns(0).ValueItems(0).DisplayValue=   "aaaa"
      Columns(0).ValueItems(0).DisplayValue.vt=   8
      Columns(0).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
      Columns(0).ValueItems.Count=   1
      Columns(0).DataField=   ""
      Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns.Count   =   1
      Splits(0)._UserFlags=   0
      Splits(0).ExtendRightColumn=   -1  'True
      Splits(0).MarqueeStyle=   3
      Splits(0).AllowRowSizing=   0   'False
      Splits(0).RecordSelectors=   0   'False
      Splits(0).RecordSelectorWidth=   688
      Splits(0).DividerColor=   14215660
      Splits(0).SpringMode=   0   'False
      Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
      Splits(0)._ColumnProps(0)=   "Columns.Count=1"
      Splits(0)._ColumnProps(1)=   "Column(0).Width=4366"
      Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
      Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=4233"
      Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
      Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
      Splits.Count    =   1
      AllowRowSizing  =   0   'False
      Appearance      =   1
      BorderStyle     =   1
      ColumnHeaders   =   -1  'True
      DataMode        =   4
      DefColWidth     =   0
      Enabled         =   -1  'True
      HeadLines       =   1
      RowDividerStyle =   2
      LayoutName      =   ""
      LayoutFileName  =   ""
      LayoutURL       =   ""
      EmptyRows       =   0   'False
      ListField       =   ""
      DataField       =   "ub_grid2"
      IntegralHeight  =   0   'False
      FetchRowStyle   =   0   'False
      AlternatingRowStyle=   0   'False
      ColumnFooters   =   0   'False
      FootLines       =   1
      DeadAreaBackColor=   14215660
      ValueTranslate  =   0   'False
      RowDividerColor =   14215660
      RowSubDividerColor=   14215660
      _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
      _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
      _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
      _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
      _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(5)   =   ":id=0,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(8)   =   ":id=1,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
      _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(11)  =   ":id=2,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(12)  =   ":id=2,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(13)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(14)  =   ":id=3,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(15)  =   ":id=3,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(16)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(17)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
      _StyleDefs(18)  =   "EditorStyle:id=7,.parent=1"
      _StyleDefs(19)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
      _StyleDefs(20)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
      _StyleDefs(21)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
      _StyleDefs(22)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
      _StyleDefs(23)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
      _StyleDefs(24)  =   "Splits(0).Style:id=13,.parent=1"
      _StyleDefs(25)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
      _StyleDefs(26)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
      _StyleDefs(27)  =   "Splits(0).FooterStyle:id=15,.parent=3"
      _StyleDefs(28)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
      _StyleDefs(29)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
      _StyleDefs(30)  =   "Splits(0).EditorStyle:id=17,.parent=7"
      _StyleDefs(31)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
      _StyleDefs(32)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
      _StyleDefs(33)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
      _StyleDefs(34)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
      _StyleDefs(35)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
      _StyleDefs(36)  =   "Splits(0).Columns(0).Style:id=28,.parent=13"
      _StyleDefs(37)  =   "Splits(0).Columns(0).HeadingStyle:id=25,.parent=14"
      _StyleDefs(38)  =   "Splits(0).Columns(0).FooterStyle:id=26,.parent=15"
      _StyleDefs(39)  =   "Splits(0).Columns(0).EditorStyle:id=27,.parent=17"
      _StyleDefs(40)  =   "Named:id=33:Normal"
      _StyleDefs(41)  =   ":id=33,.parent=0"
      _StyleDefs(42)  =   "Named:id=34:Heading"
      _StyleDefs(43)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(44)  =   ":id=34,.wraptext=-1"
      _StyleDefs(45)  =   "Named:id=35:Footing"
      _StyleDefs(46)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(47)  =   "Named:id=36:Selected"
      _StyleDefs(48)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(49)  =   "Named:id=37:Caption"
      _StyleDefs(50)  =   ":id=37,.parent=34,.alignment=2"
      _StyleDefs(51)  =   "Named:id=38:HighlightRow"
      _StyleDefs(52)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(53)  =   "Named:id=39:EvenRow"
      _StyleDefs(54)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
      _StyleDefs(55)  =   "Named:id=40:OddRow"
      _StyleDefs(56)  =   ":id=40,.parent=33"
      _StyleDefs(57)  =   "Named:id=41:RecordSelector"
      _StyleDefs(58)  =   ":id=41,.parent=34"
      _StyleDefs(59)  =   "Named:id=42:FilterBar"
      _StyleDefs(60)  =   ":id=42,.parent=33"
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   64
      Left            =   15480
      TabIndex        =   71
      Top             =   11160
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   61
      Left            =   12000
      TabIndex        =   68
      Top             =   11160
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   59
      Left            =   15480
      TabIndex        =   65
      Top             =   10800
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   56
      Left            =   12000
      TabIndex        =   62
      Top             =   10800
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   54
      Left            =   15480
      TabIndex        =   59
      Top             =   10440
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   51
      Left            =   12000
      TabIndex        =   56
      Top             =   10440
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   49
      Left            =   15480
      TabIndex        =   53
      Top             =   10080
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   46
      Left            =   12000
      TabIndex        =   50
      Top             =   10080
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   44
      Left            =   15480
      TabIndex        =   47
      Top             =   9720
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   41
      Left            =   12000
      TabIndex        =   44
      Top             =   9720
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   39
      Left            =   15480
      TabIndex        =   41
      Top             =   9360
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   36
      Left            =   12000
      TabIndex        =   38
      Top             =   9360
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   34
      Left            =   15480
      TabIndex        =   35
      Top             =   9000
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   31
      Left            =   12000
      TabIndex        =   32
      Top             =   9000
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   29
      Left            =   15480
      TabIndex        =   29
      Top             =   8640
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   26
      Left            =   12000
      TabIndex        =   26
      Top             =   8640
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   24
      Left            =   15480
      TabIndex        =   23
      Top             =   8280
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   21
      Left            =   12000
      TabIndex        =   20
      Top             =   8280
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   19
      Left            =   15480
      TabIndex        =   17
      Top             =   7920
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   16
      Left            =   12000
      TabIndex        =   14
      Top             =   7920
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      IMEMode         =   3  'µÃå≈íË
      Index           =   14
      Left            =   15480
      TabIndex        =   11
      Top             =   7560
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   12000
      TabIndex        =   9
      Top             =   7560
      Width           =   855
   End
   Begin VB.ComboBox Combo1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   1
      Left            =   2520
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   4
      Top             =   1440
      Width           =   5055
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      IMEMode         =   3  'µÃå≈íË
      Index           =   8
      Left            =   1440
      MaxLength       =   8
      TabIndex        =   3
      Top             =   1440
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   69
      Left            =   5760
      Locked          =   -1  'True
      TabIndex        =   86
      TabStop         =   0   'False
      Top             =   10200
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   68
      Left            =   5760
      Locked          =   -1  'True
      TabIndex        =   85
      TabStop         =   0   'False
      Top             =   9600
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.TextBox Text1 
      Alignment       =   1  'âEëµÇ¶
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   67
      Left            =   5760
      Locked          =   -1  'True
      TabIndex        =   84
      TabStop         =   0   'False
      Top             =   9240
      Visible         =   0   'False
      Width           =   855
   End
   Begin RichTextLib.RichTextBox RichTextBox1 
      Height          =   1575
      Index           =   0
      Left            =   600
      TabIndex        =   72
      Top             =   8070
      Width           =   4335
      _ExtentX        =   7646
      _ExtentY        =   2778
      _Version        =   393217
      Appearance      =   0
      TextRTF         =   $"SEI00161.frx":0000
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      IMEMode         =   3  'µÃå≈íË
      Index           =   2
      Left            =   1440
      MaxLength       =   20
      TabIndex        =   1
      Text            =   "AD-HHSJ10P"
      Top             =   960
      Width           =   2535
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   3
      Left            =   4680
      Locked          =   -1  'True
      TabIndex        =   75
      TabStop         =   0   'False
      Top             =   1080
      Width           =   4335
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   4
      Left            =   10560
      Locked          =   -1  'True
      TabIndex        =   76
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   5
      Left            =   11160
      Locked          =   -1  'True
      TabIndex        =   77
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   6
      Left            =   11760
      Locked          =   -1  'True
      TabIndex        =   78
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   7
      Left            =   12360
      Locked          =   -1  'True
      TabIndex        =   79
      TabStop         =   0   'False
      Top             =   1080
      Width           =   375
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      IMEMode         =   3  'µÃå≈íË
      Index           =   0
      Left            =   1440
      MaxLength       =   5
      TabIndex        =   0
      Top             =   480
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Caption         =   "íPâøçXêV"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   13320
      TabIndex        =   93
      ToolTipText     =   "è§ïiâªíPâøÇïiñ⁄É}ÉXÉ^Å[Ç…ìoò^ÇµÇ‹Ç∑"
      Top             =   0
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VB.CommandButton Command1 
      Caption         =   "å©êœèëî≠çs"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   11760
      TabIndex        =   92
      ToolTipText     =   "è§ïiâªíPâøå©êœèë(EXCEL)ÇçÏê¨ÇµÇ‹Ç∑"
      Top             =   0
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VB.TextBox Text1 
      BackColor       =   &H8000000F&
      BorderStyle     =   0  'Ç»Çµ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   1
      Left            =   2400
      Locked          =   -1  'True
      TabIndex        =   74
      TabStop         =   0   'False
      Top             =   600
      Width           =   2415
   End
   Begin VB.ComboBox Combo1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   0
      Left            =   1440
      Style           =   2  'ƒﬁ€ØÃﬂ¿ﬁ≥› ÿΩƒ
      TabIndex        =   5
      Top             =   1920
      Visible         =   0   'False
      Width           =   2295
   End
   Begin VB.CommandButton Command1 
      Caption         =   "íPâøåvéZ"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   5760
      TabIndex        =   91
      ToolTipText     =   "è§ïiâªíPâøÇåvéZÇµÇ‹Ç∑(F9)"
      Top             =   0
      Width           =   1575
   End
   Begin VB.CommandButton Command1 
      Caption         =   "å©êœèëî≠çs/ï€ë∂"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   3480
      TabIndex        =   90
      ToolTipText     =   "è§ïiâªç\ê¨Çï€ë∂ÇµÇ‹Ç∑"
      Top             =   0
      Width           =   2055
   End
   Begin VB.PictureBox Picture1 
      Height          =   255
      Left            =   11040
      ScaleHeight     =   195
      ScaleWidth      =   195
      TabIndex        =   88
      Top             =   0
      Visible         =   0   'False
      Width           =   255
   End
   Begin VB.CommandButton Command1 
      Caption         =   "ì«çû"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   1800
      TabIndex        =   89
      ToolTipText     =   "è§ïiâªç\ê¨Çì«Ç›çûÇ›Ç‹Ç∑ÅiÇe5Åj"
      Top             =   0
      Width           =   1455
   End
   Begin VB.CommandButton Command1 
      Caption         =   "ï¬Ç∂ÇÈ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   480
      TabIndex        =   87
      Top             =   0
      Width           =   1215
   End
   Begin TrueDBGrid80.TDBDropDown TDBDropDown1 
      Height          =   2055
      Left            =   1440
      TabIndex        =   101
      Top             =   3720
      Width           =   1935
      _ExtentX        =   3413
      _ExtentY        =   3625
      _LayoutType     =   4
      _RowHeight      =   -2147483647
      _WasPersistedAsPixels=   0
      Columns(0)._VlistStyle=   0
      Columns(0)._MaxComboItems=   5
      Columns(0).ValueItems(0)._DefaultItem=   0
      Columns(0).ValueItems(0).Value=   "aaaa"
      Columns(0).ValueItems(0).Value.vt=   8
      Columns(0).ValueItems(0).DisplayValue=   "aaaa"
      Columns(0).ValueItems(0).DisplayValue.vt=   8
      Columns(0).ValueItems(0)._PropDict=   "_DefaultItem,517,2"
      Columns(0).ValueItems.Count=   1
      Columns(0).DataField=   ""
      Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns.Count   =   1
      Splits(0)._UserFlags=   0
      Splits(0).ExtendRightColumn=   -1  'True
      Splits(0).MarqueeStyle=   3
      Splits(0).AllowRowSizing=   0   'False
      Splits(0).RecordSelectors=   0   'False
      Splits(0).RecordSelectorWidth=   688
      Splits(0).DividerColor=   14215660
      Splits(0).SpringMode=   0   'False
      Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
      Splits(0)._ColumnProps(0)=   "Columns.Count=1"
      Splits(0)._ColumnProps(1)=   "Column(0).Width=4366"
      Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
      Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=4233"
      Splits(0)._ColumnProps(4)=   "Column(0)._EditAlways=0"
      Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
      Splits.Count    =   1
      AllowRowSizing  =   0   'False
      Appearance      =   1
      BorderStyle     =   1
      ColumnHeaders   =   -1  'True
      DataMode        =   4
      DefColWidth     =   0
      Enabled         =   -1  'True
      HeadLines       =   1
      RowDividerStyle =   2
      LayoutName      =   ""
      LayoutFileName  =   ""
      LayoutURL       =   ""
      EmptyRows       =   0   'False
      ListField       =   ""
      DataField       =   "ub_grid2"
      IntegralHeight  =   0   'False
      FetchRowStyle   =   0   'False
      AlternatingRowStyle=   0   'False
      ColumnFooters   =   0   'False
      FootLines       =   1
      DeadAreaBackColor=   14215660
      ValueTranslate  =   0   'False
      RowDividerColor =   14215660
      RowSubDividerColor=   14215660
      _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
      _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
      _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
      _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
      _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(5)   =   ":id=0,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(8)   =   ":id=1,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
      _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(11)  =   ":id=2,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(12)  =   ":id=2,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(13)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(14)  =   ":id=3,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(15)  =   ":id=3,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(16)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(17)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
      _StyleDefs(18)  =   "EditorStyle:id=7,.parent=1"
      _StyleDefs(19)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
      _StyleDefs(20)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
      _StyleDefs(21)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
      _StyleDefs(22)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
      _StyleDefs(23)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
      _StyleDefs(24)  =   "Splits(0).Style:id=13,.parent=1"
      _StyleDefs(25)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
      _StyleDefs(26)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
      _StyleDefs(27)  =   "Splits(0).FooterStyle:id=15,.parent=3"
      _StyleDefs(28)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
      _StyleDefs(29)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
      _StyleDefs(30)  =   "Splits(0).EditorStyle:id=17,.parent=7"
      _StyleDefs(31)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
      _StyleDefs(32)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
      _StyleDefs(33)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
      _StyleDefs(34)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
      _StyleDefs(35)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
      _StyleDefs(36)  =   "Splits(0).Columns(0).Style:id=28,.parent=13"
      _StyleDefs(37)  =   "Splits(0).Columns(0).HeadingStyle:id=25,.parent=14"
      _StyleDefs(38)  =   "Splits(0).Columns(0).FooterStyle:id=26,.parent=15"
      _StyleDefs(39)  =   "Splits(0).Columns(0).EditorStyle:id=27,.parent=17"
      _StyleDefs(40)  =   "Named:id=33:Normal"
      _StyleDefs(41)  =   ":id=33,.parent=0"
      _StyleDefs(42)  =   "Named:id=34:Heading"
      _StyleDefs(43)  =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(44)  =   ":id=34,.wraptext=-1"
      _StyleDefs(45)  =   "Named:id=35:Footing"
      _StyleDefs(46)  =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(47)  =   "Named:id=36:Selected"
      _StyleDefs(48)  =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(49)  =   "Named:id=37:Caption"
      _StyleDefs(50)  =   ":id=37,.parent=34,.alignment=2"
      _StyleDefs(51)  =   "Named:id=38:HighlightRow"
      _StyleDefs(52)  =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(53)  =   "Named:id=39:EvenRow"
      _StyleDefs(54)  =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
      _StyleDefs(55)  =   "Named:id=40:OddRow"
      _StyleDefs(56)  =   ":id=40,.parent=33"
      _StyleDefs(57)  =   "Named:id=41:RecordSelector"
      _StyleDefs(58)  =   ":id=41,.parent=34"
      _StyleDefs(59)  =   "Named:id=42:FilterBar"
      _StyleDefs(60)  =   ":id=42,.parent=33"
   End
   Begin TrueDBGrid80.TDBGrid TDBGrid1 
      Height          =   4575
      Index           =   0
      Left            =   120
      TabIndex        =   6
      Top             =   2520
      Width           =   17895
      _ExtentX        =   31565
      _ExtentY        =   8070
      _LayoutType     =   4
      _RowHeight      =   -2147483647
      _WasPersistedAsPixels=   0
      Columns(0)._VlistStyle=   0
      Columns(0)._MaxComboItems=   5
      Columns(0).Caption=   "áÇ"
      Columns(0).DataField=   ""
      Columns(0)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(1)._VlistStyle=   1
      Columns(1)._MaxComboItems=   5
      Columns(1).Caption=   "éÌï "
      Columns(1).DataField=   ""
      Columns(1).DropDown=   "TDBDropDown1"
      Columns(1).DropDown.vt=   8
      Columns(1)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(2)._VlistStyle=   1
      Columns(2)._MaxComboItems=   5
      Columns(2).Caption=   "éñã∆ïî"
      Columns(2).DataField=   ""
      Columns(2).DropDown=   "TDBDropDown2"
      Columns(2).DropDown.vt=   8
      Columns(2)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(3)._VlistStyle=   0
      Columns(3)._MaxComboItems=   5
      Columns(3).Caption=   "ç\ê¨ïiî‘"
      Columns(3).DataField=   ""
      Columns(3)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(4)._VlistStyle=   0
      Columns(4)._MaxComboItems=   5
      Columns(4).Caption=   "ïiÅ@ñº"
      Columns(4).DataField=   ""
      Columns(4)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(5)._VlistStyle=   0
      Columns(5)._MaxComboItems=   5
      Columns(5).Caption=   "íÒèoïiñº"
      Columns(5).DataField=   ""
      Columns(5)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(6)._VlistStyle=   0
      Columns(6)._MaxComboItems=   5
      Columns(6).Caption=   "àıêî"
      Columns(6).DataField=   ""
      Columns(6)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(7)._VlistStyle=   0
      Columns(7)._MaxComboItems=   5
      Columns(7).Caption=   "íPà "
      Columns(7).DataField=   ""
      Columns(7)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(8)._VlistStyle=   0
      Columns(8)._MaxComboItems=   5
      Columns(8).Caption=   "íÒèoíPâø"
      Columns(8).DataField=   ""
      Columns(8)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(9)._VlistStyle=   0
      Columns(9)._MaxComboItems=   5
      Columns(9).Caption=   "íÒèoã‡äz"
      Columns(9).DataField=   ""
      Columns(9)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(10)._VlistStyle=   0
      Columns(10)._MaxComboItems=   5
      Columns(10).Caption=   "édì¸Åó"
      Columns(10).DataField=   ""
      Columns(10)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(11)._VlistStyle=   0
      Columns(11)._MaxComboItems=   5
      Columns(11).Caption=   "îÃîÑÅó"
      Columns(11).DataField=   ""
      Columns(11)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(12)._VlistStyle=   0
      Columns(12)._MaxComboItems=   5
      Columns(12).Caption=   "çáåvã‡äz"
      Columns(12).DataField=   ""
      Columns(12)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns(13)._VlistStyle=   0
      Columns(13)._MaxComboItems=   5
      Columns(13).Caption=   "àÛç¸èá"
      Columns(13).DataField=   ""
      Columns(13)._PropDict=   "_MaxComboItems,516,2;_VlistStyle,514,3"
      Columns.Count   =   14
      Splits(0)._UserFlags=   0
      Splits(0).RecordSelectorWidth=   688
      Splits(0).DividerColor=   14215660
      Splits(0).SpringMode=   0   'False
      Splits(0)._PropDict=   "_ColumnProps,515,0;_UserFlags,518,3"
      Splits(0)._ColumnProps(0)=   "Columns.Count=14"
      Splits(0)._ColumnProps(1)=   "Column(0).Width=900"
      Splits(0)._ColumnProps(2)=   "Column(0).DividerColor=0"
      Splits(0)._ColumnProps(3)=   "Column(0)._WidthInPix=794"
      Splits(0)._ColumnProps(4)=   "Column(0)._ColStyle=8705"
      Splits(0)._ColumnProps(5)=   "Column(0).Order=1"
      Splits(0)._ColumnProps(6)=   "Column(1).Width=2196"
      Splits(0)._ColumnProps(7)=   "Column(1).DividerColor=0"
      Splits(0)._ColumnProps(8)=   "Column(1)._WidthInPix=2090"
      Splits(0)._ColumnProps(9)=   "Column(1)._ColStyle=256"
      Splits(0)._ColumnProps(10)=   "Column(1).Button=1"
      Splits(0)._ColumnProps(11)=   "Column(1).Order=2"
      Splits(0)._ColumnProps(12)=   "Column(2).Width=1958"
      Splits(0)._ColumnProps(13)=   "Column(2).DividerColor=0"
      Splits(0)._ColumnProps(14)=   "Column(2)._WidthInPix=1852"
      Splits(0)._ColumnProps(15)=   "Column(2)._ColStyle=512"
      Splits(0)._ColumnProps(16)=   "Column(2).Button=1"
      Splits(0)._ColumnProps(17)=   "Column(2).Order=3"
      Splits(0)._ColumnProps(18)=   "Column(3).Width=2831"
      Splits(0)._ColumnProps(19)=   "Column(3).DividerColor=0"
      Splits(0)._ColumnProps(20)=   "Column(3)._WidthInPix=2725"
      Splits(0)._ColumnProps(21)=   "Column(3)._ColStyle=512"
      Splits(0)._ColumnProps(22)=   "Column(3).Order=4"
      Splits(0)._ColumnProps(23)=   "Column(4).Width=3757"
      Splits(0)._ColumnProps(24)=   "Column(4).DividerColor=0"
      Splits(0)._ColumnProps(25)=   "Column(4)._WidthInPix=3651"
      Splits(0)._ColumnProps(26)=   "Column(4)._ColStyle=8704"
      Splits(0)._ColumnProps(27)=   "Column(4).AllowFocus=0"
      Splits(0)._ColumnProps(28)=   "Column(4).Order=5"
      Splits(0)._ColumnProps(29)=   "Column(5).Width=5159"
      Splits(0)._ColumnProps(30)=   "Column(5).DividerColor=0"
      Splits(0)._ColumnProps(31)=   "Column(5)._WidthInPix=5054"
      Splits(0)._ColumnProps(32)=   "Column(5)._ColStyle=512"
      Splits(0)._ColumnProps(33)=   "Column(5).Order=6"
      Splits(0)._ColumnProps(34)=   "Column(6).Width=1931"
      Splits(0)._ColumnProps(35)=   "Column(6).DividerColor=0"
      Splits(0)._ColumnProps(36)=   "Column(6)._WidthInPix=1826"
      Splits(0)._ColumnProps(37)=   "Column(6)._ColStyle=514"
      Splits(0)._ColumnProps(38)=   "Column(6).Order=7"
      Splits(0)._ColumnProps(39)=   "Column(7).Width=1005"
      Splits(0)._ColumnProps(40)=   "Column(7).DividerColor=0"
      Splits(0)._ColumnProps(41)=   "Column(7)._WidthInPix=900"
      Splits(0)._ColumnProps(42)=   "Column(7)._ColStyle=512"
      Splits(0)._ColumnProps(43)=   "Column(7).Order=8"
      Splits(0)._ColumnProps(44)=   "Column(8).Width=2143"
      Splits(0)._ColumnProps(45)=   "Column(8).DividerColor=0"
      Splits(0)._ColumnProps(46)=   "Column(8)._WidthInPix=2037"
      Splits(0)._ColumnProps(47)=   "Column(8)._ColStyle=514"
      Splits(0)._ColumnProps(48)=   "Column(8).Order=9"
      Splits(0)._ColumnProps(49)=   "Column(9).Width=2117"
      Splits(0)._ColumnProps(50)=   "Column(9).DividerColor=0"
      Splits(0)._ColumnProps(51)=   "Column(9)._WidthInPix=2011"
      Splits(0)._ColumnProps(52)=   "Column(9)._ColStyle=8706"
      Splits(0)._ColumnProps(53)=   "Column(9).Order=10"
      Splits(0)._ColumnProps(54)=   "Column(10).Width=1879"
      Splits(0)._ColumnProps(55)=   "Column(10).DividerColor=0"
      Splits(0)._ColumnProps(56)=   "Column(10)._WidthInPix=1773"
      Splits(0)._ColumnProps(57)=   "Column(10)._ColStyle=514"
      Splits(0)._ColumnProps(58)=   "Column(10).Order=11"
      Splits(0)._ColumnProps(59)=   "Column(11).Width=2143"
      Splits(0)._ColumnProps(60)=   "Column(11).DividerColor=0"
      Splits(0)._ColumnProps(61)=   "Column(11)._WidthInPix=2037"
      Splits(0)._ColumnProps(62)=   "Column(11)._ColStyle=514"
      Splits(0)._ColumnProps(63)=   "Column(11).Order=12"
      Splits(0)._ColumnProps(64)=   "Column(12).Width=2117"
      Splits(0)._ColumnProps(65)=   "Column(12).DividerColor=0"
      Splits(0)._ColumnProps(66)=   "Column(12)._WidthInPix=2011"
      Splits(0)._ColumnProps(67)=   "Column(12)._ColStyle=8706"
      Splits(0)._ColumnProps(68)=   "Column(12).AllowFocus=0"
      Splits(0)._ColumnProps(69)=   "Column(12).Order=13"
      Splits(0)._ColumnProps(70)=   "Column(13).Width=1482"
      Splits(0)._ColumnProps(71)=   "Column(13).DividerColor=0"
      Splits(0)._ColumnProps(72)=   "Column(13)._WidthInPix=1376"
      Splits(0)._ColumnProps(73)=   "Column(13).Order=14"
      Splits.Count    =   1
      PrintInfos(0)._StateFlags=   3
      PrintInfos(0).Name=   "piInternal 0"
      PrintInfos(0).PageHeaderFont=   "Size=12,Charset=128,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=ÇlÇr ÉSÉVÉbÉN"
      PrintInfos(0).PageFooterFont=   "Size=12,Charset=128,Weight=400,Underline=0,Italic=0,Strikethrough=0,Name=ÇlÇr ÉSÉVÉbÉN"
      PrintInfos(0).PageHeaderHeight=   0
      PrintInfos(0).PageFooterHeight=   0
      PrintInfos.Count=   1
      AllowAddNew     =   -1  'True
      DataMode        =   4
      DefColWidth     =   0
      HeadLines       =   2
      FootLines       =   1
      MultipleLines   =   0
      CellTipsWidth   =   0
      DeadAreaBackColor=   14215660
      RowDividerColor =   14215660
      RowSubDividerColor=   14215660
      DirectionAfterEnter=   1
      MaxRows         =   250000
      _PropDict       =   "_ExtentX,2003,3;_ExtentY,2004,3;_LayoutType,512,2;_RowHeight,16,3;_StyleDefs,513,0;_WasPersistedAsPixels,516,2"
      _StyleDefs(0)   =   "_StyleRoot:id=0,.parent=-1,.alignment=3,.valignment=0,.bgcolor=&H80000005&"
      _StyleDefs(1)   =   ":id=0,.fgcolor=&H80000008&,.wraptext=0,.locked=0,.transparentBmp=0"
      _StyleDefs(2)   =   ":id=0,.fgpicPosition=0,.bgpicMode=0,.appearance=0,.borderSize=0,.ellipsis=0"
      _StyleDefs(3)   =   ":id=0,.borderColor=&H80000005&,.borderType=0,.bold=0,.fontsize=1200,.italic=0"
      _StyleDefs(4)   =   ":id=0,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(5)   =   ":id=0,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(6)   =   "Style:id=1,.parent=0,.namedParent=33,.bold=0,.fontsize=975,.italic=0"
      _StyleDefs(7)   =   ":id=1,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(8)   =   ":id=1,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(9)   =   "CaptionStyle:id=4,.parent=2,.namedParent=37"
      _StyleDefs(10)  =   "HeadingStyle:id=2,.parent=1,.namedParent=34,.bold=0,.fontsize=975,.italic=0"
      _StyleDefs(11)  =   ":id=2,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(12)  =   ":id=2,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(13)  =   "FooterStyle:id=3,.parent=1,.namedParent=35,.bold=0,.fontsize=975,.italic=0"
      _StyleDefs(14)  =   ":id=3,.underline=0,.strikethrough=0,.charset=128"
      _StyleDefs(15)  =   ":id=3,.fontname=ÇlÇr ÉSÉVÉbÉN"
      _StyleDefs(16)  =   "InactiveStyle:id=5,.parent=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(17)  =   "SelectedStyle:id=6,.parent=1,.namedParent=36"
      _StyleDefs(18)  =   "EditorStyle:id=7,.parent=1"
      _StyleDefs(19)  =   "HighlightRowStyle:id=8,.parent=1,.namedParent=38"
      _StyleDefs(20)  =   "EvenRowStyle:id=9,.parent=1,.namedParent=39"
      _StyleDefs(21)  =   "OddRowStyle:id=10,.parent=1,.namedParent=40"
      _StyleDefs(22)  =   "RecordSelectorStyle:id=11,.parent=2,.namedParent=41"
      _StyleDefs(23)  =   "FilterBarStyle:id=12,.parent=1,.namedParent=42"
      _StyleDefs(24)  =   "Splits(0).Style:id=13,.parent=1"
      _StyleDefs(25)  =   "Splits(0).CaptionStyle:id=22,.parent=4"
      _StyleDefs(26)  =   "Splits(0).HeadingStyle:id=14,.parent=2"
      _StyleDefs(27)  =   "Splits(0).FooterStyle:id=15,.parent=3"
      _StyleDefs(28)  =   "Splits(0).InactiveStyle:id=16,.parent=5"
      _StyleDefs(29)  =   "Splits(0).SelectedStyle:id=18,.parent=6"
      _StyleDefs(30)  =   "Splits(0).EditorStyle:id=17,.parent=7"
      _StyleDefs(31)  =   "Splits(0).HighlightRowStyle:id=19,.parent=8"
      _StyleDefs(32)  =   "Splits(0).EvenRowStyle:id=20,.parent=9"
      _StyleDefs(33)  =   "Splits(0).OddRowStyle:id=21,.parent=10"
      _StyleDefs(34)  =   "Splits(0).RecordSelectorStyle:id=23,.parent=11"
      _StyleDefs(35)  =   "Splits(0).FilterBarStyle:id=24,.parent=12"
      _StyleDefs(36)  =   "Splits(0).Columns(0).Style:id=70,.parent=13,.alignment=2,.locked=-1"
      _StyleDefs(37)  =   "Splits(0).Columns(0).HeadingStyle:id=67,.parent=14,.alignment=2"
      _StyleDefs(38)  =   "Splits(0).Columns(0).FooterStyle:id=68,.parent=15"
      _StyleDefs(39)  =   "Splits(0).Columns(0).EditorStyle:id=69,.parent=17"
      _StyleDefs(40)  =   "Splits(0).Columns(1).Style:id=28,.parent=13,.alignment=0"
      _StyleDefs(41)  =   "Splits(0).Columns(1).HeadingStyle:id=25,.parent=14,.alignment=0"
      _StyleDefs(42)  =   "Splits(0).Columns(1).FooterStyle:id=26,.parent=15"
      _StyleDefs(43)  =   "Splits(0).Columns(1).EditorStyle:id=27,.parent=17"
      _StyleDefs(44)  =   "Splits(0).Columns(2).Style:id=66,.parent=13,.alignment=0"
      _StyleDefs(45)  =   "Splits(0).Columns(2).HeadingStyle:id=63,.parent=14,.alignment=2"
      _StyleDefs(46)  =   "Splits(0).Columns(2).FooterStyle:id=64,.parent=15"
      _StyleDefs(47)  =   "Splits(0).Columns(2).EditorStyle:id=65,.parent=17"
      _StyleDefs(48)  =   "Splits(0).Columns(3).Style:id=32,.parent=13,.alignment=0"
      _StyleDefs(49)  =   "Splits(0).Columns(3).HeadingStyle:id=29,.parent=14,.alignment=2"
      _StyleDefs(50)  =   "Splits(0).Columns(3).FooterStyle:id=30,.parent=15"
      _StyleDefs(51)  =   "Splits(0).Columns(3).EditorStyle:id=31,.parent=17"
      _StyleDefs(52)  =   "Splits(0).Columns(4).Style:id=46,.parent=13,.alignment=0,.bgcolor=&H80000016&"
      _StyleDefs(53)  =   ":id=46,.locked=-1"
      _StyleDefs(54)  =   "Splits(0).Columns(4).HeadingStyle:id=43,.parent=14,.alignment=2"
      _StyleDefs(55)  =   "Splits(0).Columns(4).FooterStyle:id=44,.parent=15"
      _StyleDefs(56)  =   "Splits(0).Columns(4).EditorStyle:id=45,.parent=17"
      _StyleDefs(57)  =   "Splits(0).Columns(5).Style:id=78,.parent=13,.alignment=0"
      _StyleDefs(58)  =   "Splits(0).Columns(5).HeadingStyle:id=75,.parent=14,.alignment=2"
      _StyleDefs(59)  =   "Splits(0).Columns(5).FooterStyle:id=76,.parent=15"
      _StyleDefs(60)  =   "Splits(0).Columns(5).EditorStyle:id=77,.parent=17"
      _StyleDefs(61)  =   "Splits(0).Columns(6).Style:id=50,.parent=13,.alignment=1"
      _StyleDefs(62)  =   "Splits(0).Columns(6).HeadingStyle:id=47,.parent=14,.alignment=2"
      _StyleDefs(63)  =   "Splits(0).Columns(6).FooterStyle:id=48,.parent=15"
      _StyleDefs(64)  =   "Splits(0).Columns(6).EditorStyle:id=49,.parent=17"
      _StyleDefs(65)  =   "Splits(0).Columns(7).Style:id=82,.parent=13,.alignment=0"
      _StyleDefs(66)  =   "Splits(0).Columns(7).HeadingStyle:id=79,.parent=14,.alignment=2"
      _StyleDefs(67)  =   "Splits(0).Columns(7).FooterStyle:id=80,.parent=15"
      _StyleDefs(68)  =   "Splits(0).Columns(7).EditorStyle:id=81,.parent=17"
      _StyleDefs(69)  =   "Splits(0).Columns(8).Style:id=86,.parent=13,.alignment=1"
      _StyleDefs(70)  =   "Splits(0).Columns(8).HeadingStyle:id=83,.parent=14,.alignment=2"
      _StyleDefs(71)  =   "Splits(0).Columns(8).FooterStyle:id=84,.parent=15"
      _StyleDefs(72)  =   "Splits(0).Columns(8).EditorStyle:id=85,.parent=17"
      _StyleDefs(73)  =   "Splits(0).Columns(9).Style:id=90,.parent=13,.alignment=1,.bgcolor=&H80000016&"
      _StyleDefs(74)  =   ":id=90,.locked=-1"
      _StyleDefs(75)  =   "Splits(0).Columns(9).HeadingStyle:id=87,.parent=14,.alignment=2"
      _StyleDefs(76)  =   "Splits(0).Columns(9).FooterStyle:id=88,.parent=15"
      _StyleDefs(77)  =   "Splits(0).Columns(9).EditorStyle:id=89,.parent=17"
      _StyleDefs(78)  =   "Splits(0).Columns(10).Style:id=54,.parent=13,.alignment=1,.bgcolor=&H80000005&"
      _StyleDefs(79)  =   ":id=54,.locked=0"
      _StyleDefs(80)  =   "Splits(0).Columns(10).HeadingStyle:id=51,.parent=14,.alignment=2"
      _StyleDefs(81)  =   "Splits(0).Columns(10).FooterStyle:id=52,.parent=15"
      _StyleDefs(82)  =   "Splits(0).Columns(10).EditorStyle:id=53,.parent=17"
      _StyleDefs(83)  =   "Splits(0).Columns(11).Style:id=58,.parent=13,.alignment=1,.bgcolor=&H80000005&"
      _StyleDefs(84)  =   ":id=58,.locked=0"
      _StyleDefs(85)  =   "Splits(0).Columns(11).HeadingStyle:id=55,.parent=14,.alignment=2"
      _StyleDefs(86)  =   "Splits(0).Columns(11).FooterStyle:id=56,.parent=15"
      _StyleDefs(87)  =   "Splits(0).Columns(11).EditorStyle:id=57,.parent=17"
      _StyleDefs(88)  =   "Splits(0).Columns(12).Style:id=62,.parent=13,.alignment=1,.bgcolor=&H8000000F&"
      _StyleDefs(89)  =   ":id=62,.locked=-1"
      _StyleDefs(90)  =   "Splits(0).Columns(12).HeadingStyle:id=59,.parent=14,.alignment=2"
      _StyleDefs(91)  =   "Splits(0).Columns(12).FooterStyle:id=60,.parent=15"
      _StyleDefs(92)  =   "Splits(0).Columns(12).EditorStyle:id=61,.parent=17"
      _StyleDefs(93)  =   "Splits(0).Columns(13).Style:id=98,.parent=13"
      _StyleDefs(94)  =   "Splits(0).Columns(13).HeadingStyle:id=95,.parent=14"
      _StyleDefs(95)  =   "Splits(0).Columns(13).FooterStyle:id=96,.parent=15"
      _StyleDefs(96)  =   "Splits(0).Columns(13).EditorStyle:id=97,.parent=17"
      _StyleDefs(97)  =   "Named:id=33:Normal"
      _StyleDefs(98)  =   ":id=33,.parent=0"
      _StyleDefs(99)  =   "Named:id=34:Heading"
      _StyleDefs(100) =   ":id=34,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(101) =   ":id=34,.wraptext=-1"
      _StyleDefs(102) =   "Named:id=35:Footing"
      _StyleDefs(103) =   ":id=35,.parent=33,.valignment=2,.bgcolor=&H8000000F&,.fgcolor=&H80000012&"
      _StyleDefs(104) =   "Named:id=36:Selected"
      _StyleDefs(105) =   ":id=36,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(106) =   "Named:id=37:Caption"
      _StyleDefs(107) =   ":id=37,.parent=34,.alignment=2"
      _StyleDefs(108) =   "Named:id=38:HighlightRow"
      _StyleDefs(109) =   ":id=38,.parent=33,.bgcolor=&H8000000D&,.fgcolor=&H8000000E&"
      _StyleDefs(110) =   "Named:id=39:EvenRow"
      _StyleDefs(111) =   ":id=39,.parent=33,.bgcolor=&HFFFF00&"
      _StyleDefs(112) =   "Named:id=40:OddRow"
      _StyleDefs(113) =   ":id=40,.parent=33"
      _StyleDefs(114) =   "Named:id=41:RecordSelector"
      _StyleDefs(115) =   ":id=41,.parent=34"
      _StyleDefs(116) =   "Named:id=42:FilterBar"
      _StyleDefs(117) =   ":id=42,.parent=33"
   End
   Begin RichTextLib.RichTextBox RichTextBox1 
      Height          =   975
      Index           =   1
      Left            =   600
      TabIndex        =   73
      Top             =   10110
      Width           =   4335
      _ExtentX        =   7646
      _ExtentY        =   1720
      _Version        =   393217
      Appearance      =   0
      TextRTF         =   $"SEI00161.frx":00BE
   End
   Begin VB.TextBox Text1 
      Appearance      =   0  'Ã◊Øƒ
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   6090
      MaxLength       =   8
      TabIndex        =   81
      Top             =   8520
      Visible         =   0   'False
      Width           =   975
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "çáåvã‡äz"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   17
      Left            =   8040
      TabIndex        =   105
      Top             =   1920
      Width           =   2415
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "íÒèoíPâø"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   14
      Left            =   12840
      TabIndex        =   132
      Top             =   7200
      Width           =   1335
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "êîó "
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   13
      Left            =   10680
      TabIndex        =   131
      Top             =   7200
      Width           =   1335
   End
   Begin VB.Label lblZEN_GOUKEI_KIN 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   11880
      TabIndex        =   130
      Top             =   1560
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.Label lblZEN_T_GOUKEI_KIN 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   10440
      TabIndex        =   129
      Top             =   1560
      Width           =   1455
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ëOâÒçáåvã‡äz"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   11
      Left            =   8040
      TabIndex        =   128
      Top             =   1560
      Width           =   2415
   End
   Begin VB.Label lblGOUKEI_T_KIN 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   10440
      TabIndex        =   127
      Top             =   1920
      Width           =   1455
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "íÒèoã‡äz"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   10
      Left            =   14160
      TabIndex        =   126
      Top             =   7200
      Width           =   1335
   End
   Begin VB.Line Line13 
      X1              =   8160
      X2              =   9240
      Y1              =   11160
      Y2              =   11160
   End
   Begin VB.Line Line12 
      X1              =   8160
      X2              =   9240
      Y1              =   10800
      Y2              =   10800
   End
   Begin VB.Line Line11 
      X1              =   8160
      X2              =   9240
      Y1              =   10440
      Y2              =   10440
   End
   Begin VB.Line Line10 
      X1              =   9240
      X2              =   8160
      Y1              =   10080
      Y2              =   10080
   End
   Begin VB.Line Line9 
      X1              =   9240
      X2              =   8160
      Y1              =   9720
      Y2              =   9720
   End
   Begin VB.Line Line8 
      X1              =   8160
      X2              =   9240
      Y1              =   9360
      Y2              =   9360
   End
   Begin VB.Line Line7 
      X1              =   9240
      X2              =   8160
      Y1              =   9000
      Y2              =   9000
   End
   Begin VB.Line Line6 
      X1              =   9240
      X2              =   8160
      Y1              =   8640
      Y2              =   8640
   End
   Begin VB.Line Line5 
      X1              =   9240
      X2              =   8160
      Y1              =   8280
      Y2              =   8280
   End
   Begin VB.Line Line4 
      X1              =   9240
      X2              =   8160
      Y1              =   7920
      Y2              =   7920
   End
   Begin VB.Line Line3 
      X1              =   8160
      X2              =   9240
      Y1              =   11520
      Y2              =   11520
   End
   Begin VB.Line Line2 
      X1              =   8160
      X2              =   8160
      Y1              =   7560
      Y2              =   11520
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "å©êœèëï\é¶Ã◊∏ﬁ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   9
      Left            =   8160
      TabIndex        =   125
      Top             =   7200
      Width           =   1095
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "3ÅFë≈êÿÇË"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   8
      Left            =   16320
      TabIndex        =   124
      Top             =   1080
      Width           =   1095
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ïîçﬁíSìñé“"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   4
      Left            =   12840
      TabIndex        =   123
      Top             =   1080
      Width           =   1095
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ïiñº"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   3
      Left            =   4080
      TabIndex        =   122
      Top             =   1080
      Width           =   495
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "ïWèÄíIî‘"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   2
      Left            =   9240
      TabIndex        =   121
      Top             =   1080
      Width           =   1095
   End
   Begin VB.Label lblGOUKEI_KIN 
      Alignment       =   1  'âEëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Left            =   11880
      TabIndex        =   83
      Top             =   1920
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ã‡Å@äz"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   15
      Left            =   15480
      TabIndex        =   119
      Top             =   7200
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ä«óùîÔ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   10
      Left            =   9240
      TabIndex        =   118
      Top             =   11160
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ç´ïÔASSY"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   9
      Left            =   9240
      TabIndex        =   117
      Top             =   10800
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ïõéëçﬁ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   8
      Left            =   9240
      TabIndex        =   116
      Top             =   10440
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ç´ïÔçﬁ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   7
      Left            =   9240
      TabIndex        =   115
      Top             =   10080
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ê›íuçHéñê‡ñæèë"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   6
      Left            =   9240
      TabIndex        =   114
      Top             =   9720
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "ïiî‘ï\é¶◊ÕﬁŸ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   5
      Left            =   9240
      TabIndex        =   113
      Top             =   9360
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "PEéëçﬁ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   4
      Left            =   9240
      TabIndex        =   112
      Top             =   9000
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "PEâ¡çH"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   3
      Left            =   9240
      TabIndex        =   111
      Top             =   8640
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "PFâ¡çH"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   2
      Left            =   9240
      TabIndex        =   110
      Top             =   8280
      Width           =   1455
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "íPà "
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   19
      Left            =   12000
      TabIndex        =   109
      Top             =   7200
      Width           =   855
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "çÏã∆çHíˆ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   16
      Left            =   9240
      TabIndex        =   108
      Top             =   7200
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "è§ïiâªçHóø"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   1
      Left            =   9240
      TabIndex        =   107
      Top             =   7920
      Width           =   1455
   End
   Begin VB.Label lblTitle 
      Alignment       =   2  'íÜâõëµÇ¶
      Appearance      =   0  'Ã◊Øƒ
      BorderStyle     =   1  'é¿ê¸
      Caption         =   "íÜêºçHóø"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H80000008&
      Height          =   375
      Index           =   0
      Left            =   9240
      TabIndex        =   106
      Top             =   7560
      Width           =   1455
   End
   Begin VB.Label Label1 
      Caption         =   "ïiñº∂√∫ﬁÿ∞"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   63
      Left            =   240
      TabIndex        =   104
      Top             =   1560
      Width           =   1215
   End
   Begin VB.Label Label1 
      Caption         =   "å©êœèëîıçl"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   195
      Index           =   100
      Left            =   630
      TabIndex        =   102
      Top             =   9930
      Width           =   1095
   End
   Begin VB.Label Label1 
      Caption         =   "éwê}ï[îıçl"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   81
      Left            =   600
      TabIndex        =   100
      Top             =   7890
      Width           =   1095
   End
   Begin VB.Line Line1 
      X1              =   0
      X2              =   17520
      Y1              =   2400
      Y2              =   2400
   End
   Begin VB.Label Label1 
      Caption         =   "íSìñé“"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   12
      Left            =   720
      TabIndex        =   99
      Top             =   600
      Width           =   735
   End
   Begin VB.Label Label1 
      Caption         =   "-"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   7
      Left            =   12120
      TabIndex        =   98
      Top             =   1080
      Width           =   255
   End
   Begin VB.Label Label1 
      Caption         =   "-"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   6
      Left            =   11520
      TabIndex        =   97
      Top             =   1080
      Width           =   255
   End
   Begin VB.Label Label1 
      Caption         =   "-"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   5
      Left            =   10920
      TabIndex        =   96
      Top             =   1080
      Width           =   255
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "êeïiî‘"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   1
      Left            =   480
      TabIndex        =   95
      Top             =   1080
      Width           =   855
   End
   Begin VB.Label Label1 
      Caption         =   "édå¸êÊ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   0
      Left            =   720
      TabIndex        =   94
      Top             =   2040
      Visible         =   0   'False
      Width           =   735
   End
   Begin VB.Label Label1 
      Alignment       =   1  'âEëµÇ¶
      Caption         =   "íPâøêÿë÷ì˙"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   104
      Left            =   5130
      TabIndex        =   103
      Top             =   8520
      Visible         =   0   'False
      Width           =   975
   End
   Begin VB.Menu SHORI_MENU 
      Caption         =   "èàóùëIë"
      Begin VB.Menu SHORI 
         Caption         =   "ï¬Ç∂ÇÈ"
         Index           =   0
         Shortcut        =   {F12}
      End
      Begin VB.Menu SHORI 
         Caption         =   "åüçı"
         Index           =   1
         Shortcut        =   {F5}
      End
      Begin VB.Menu SHORI 
         Caption         =   "ï€ë∂"
         Index           =   2
      End
      Begin VB.Menu SHORI 
         Caption         =   "íPâøåvéZ"
         Index           =   3
         Shortcut        =   {F9}
      End
      Begin VB.Menu SHORI 
         Caption         =   "å©êœèëî≠çs"
         Index           =   4
      End
      Begin VB.Menu SHORI 
         Caption         =   "íPâøìoò^"
         Index           =   5
      End
      Begin VB.Menu SHORI 
         Caption         =   "âÊñ àÛç¸"
         Index           =   6
      End
   End
End
Attribute VB_Name = "SEI00161"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


'------------------------------------   'ÉeÉLÉXÉgíËã`

Private Const ptxTanto_Code% = 0            'íSìñé“ÉRÅ[Éh
Private Const ptxTanto_Name% = 1            'íSìñé“ñºèÃ
Private Const ptxHin_Gai% = 2               'ïiî‘
Private Const ptxHin_Name% = 3              'ïiñº

Private Const ptxST_SOKO% = 4               'ïWèÄíIî‘Å@ ëqå…
Private Const ptxST_RETU% = 5               'ïWèÄíIî‘   óÒ
Private Const ptxST_REN% = 6                'ïWèÄíIî‘Å@ òA
Private Const ptxST_DAN% = 7                'ïWèÄíIî‘Å@ íi

Private Const ptxCATEGORY_CODE% = 8         'ïiñº∂√∫ﬁÿ∞∫∞ƒﬁ

Private Const ptxTANKA_KIRIKAE_DT% = 9      'íPâøêÿë÷ì˙



'--------------------------------
Private Const ptxNAKANISHI_QTY% = 10        'íÜêºçHóøÅ@êîó 
Private Const ptxNAKANISHI_TANI% = 11       'íÜêºçHóøÅ@íPà 
Private Const ptxNAKANISHI_T_TAN% = 12      'íÜêºçHóøÅ@íÒèoíPâø
Private Const ptxNAKANISHI_T_KIN% = 13      'íÜêºçHóøÅ@íÒèoã‡äz
Private Const ptxNAKANISHI_KIN% = 14        'íÜêºçHóøÅ@ã‡äz


Private Const ptxSHOHIN_QTY% = 15           'è§ïiâªçHóøÅ@êîó 
Private Const ptxSHOHIN_TANI% = 16          'è§ïiâªçHóøÅ@íPà 
Private Const ptxSHOHIN_T_TAN% = 17         'è§ïiâªçHóøÅ@íÒèoíPâø
Private Const ptxSHOHIN_T_KIN% = 18         'è§ïiâªçHóøÅ@íÒèoã‡äz
Private Const ptxSHOHIN_KIN% = 19           'è§ïiâªçHóøÅ@ã‡äz

Private Const ptxPF_KAKOU_QTY% = 20         'PFâ¡çHÅ@êîó 
Private Const ptxPF_KAKOU_TANI% = 21        'PFâ¡çHÅ@íPà 
Private Const ptxPF_KAKOU_T_TAN% = 22       'PFâ¡çHÅ@íÒèoíPâø
Private Const ptxPF_KAKOU_T_KIN% = 23       'PFâ¡çHÅ@íÒèoã‡äz
Private Const ptxPF_KAKOU_KIN% = 24         'PFâ¡çHÅ@ã‡äz

Private Const ptxPE_KAKOU_QTY% = 25         'PEâ¡çHÅ@êîó 
Private Const ptxPE_KAKOU_TANI% = 26        'PEâ¡çHÅ@íPà 
Private Const ptxPE_KAKOU_T_TAN% = 27       'PEâ¡çHÅ@íÒèoíPâø
Private Const ptxPE_KAKOU_T_KIN% = 28       'PEâ¡çHÅ@íÒèoã‡äz
Private Const ptxPE_KAKOU_KIN% = 29         'PEâ¡çHÅ@ã‡äz

Private Const ptxPE_SHIZAI_QTY% = 30        'PEéëçﬁÅ@êîó 
Private Const ptxPE_SHIZAI_TANI% = 31       'PEéëçﬁÅ@íPà 
Private Const ptxPE_SHIZAI_T_TAN% = 32      'PEéëçﬁÅ@íÒèoíPâø
Private Const ptxPE_SHIZAI_T_KIN% = 33      'PEéëçﬁÅ@íÒèoã‡äz
Private Const ptxPE_SHIZAI_KIN% = 34        'PEéëçﬁÅ@ã‡äz

Private Const ptxHINBAN_LABEL_QTY% = 35     'ïiî‘ï\é¶◊ÕﬁŸÅ@êîó 
Private Const ptxHINBAN_LABEL_TANI% = 36    'ïiî‘ï\é¶◊ÕﬁŸÅ@íPà 
Private Const ptxHINBAN_LABEL_T_TAN% = 37   'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoíPâø
Private Const ptxHINBAN_LABEL_T_KIN% = 38   'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz
Private Const ptxHINBAN_LABEL_KIN% = 39     'ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz

Private Const ptxKOUJI_SETSU_QTY% = 40      'ê›íuçHéñê‡ñæèëÅ@êîó 
Private Const ptxKOUJI_SETSU_TANI% = 41     'ê›íuçHéñê‡ñæèëÅ@íPà 
Private Const ptxKOUJI_SETSU_T_TAN% = 42    'ê›íuçHéñê‡ñæèëÅ@íÒèoíPâø
Private Const ptxKOUJI_SETSU_T_KIN% = 43    'ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz
Private Const ptxKOUJI_SETSU_KIN% = 44      'ê›íuçHéñê‡ñæèëÅ@ã‡äz


Private Const ptxKONPOU_QTY% = 45           'ç´ïÔçﬁÅ@êîó 
Private Const ptxKONPOU_TANI% = 46          'ç´ïÔçﬁÅ@íPà 
Private Const ptxKONPOU_T_TAN% = 47         'ç´ïÔçﬁÅ@íÒèoíPâø
Private Const ptxKONPOU_T_KIN% = 48         'ç´ïÔçﬁÅ@íÒèoã‡äz
Private Const ptxKONPOU_KIN% = 49           'ç´ïÔçﬁÅ@ã‡äz

Private Const ptxFUKU_SHIZAI_QTY% = 50      'ïõéëçﬁÅ@êîó 
Private Const ptxFUKU_SHIZAI_TANI% = 51     'ïõéëçﬁÅ@íPà 
Private Const ptxFUKU_SHIZAI_T_TAN% = 52    'ïõéëçﬁÅ@íÒèoíPâø
Private Const ptxFUKU_SHIZAI_T_KIN% = 53    'ïõéëçﬁÅ@íÒèoã‡äz
Private Const ptxFUKU_SHIZAI_KIN% = 54      'ïõéëçﬁÅ@ã‡äz

Private Const ptxKONPOU_ASSY_QTY% = 55      'ç´ïÔASSYÅ@êîó 
Private Const ptxKONPOU_ASSY_TANI% = 56     'ç´ïÔASSYÅ@íPà 
Private Const ptxKONPOU_ASSY_T_TAN% = 57    'ç´ïÔASSYÅ@íÒèoíPâø
Private Const ptxKONPOU_ASSY_T_KIN% = 58    'ç´ïÔASSYÅ@íÒèoã‡äz
Private Const ptxKONPOU_ASSY_KIN% = 59      'ç´ïÔASSYÅ@ã‡äz

Private Const ptxKANRI_QTY% = 60            'ä«óùîÔÅ@êîó 
Private Const ptxKANRI_TANI% = 61           'ä«óùîÔÅ@íPà 
Private Const ptxKANRI_T_TAN% = 62          'ä«óùîÔÅ@íÒèoíPâø
Private Const ptxKANRI_T_KIN% = 63          'ä«óùîÔÅ@íÒèoã‡äz
Private Const ptxKANRI_KIN% = 64            'ä«óùîÔÅ@ã‡äz






'---------------------------------------    2017.07.08
Private Const ptxBuzai_Tanto_Name% = 65     'ïîçﬁíSìñé“
Private Const ptxNAI_BUHIN% = 66            'çëì‡ãüãããÊï™Åi3ÅFë≈êÿÇËÅj


'Private Const ptxNAKANISHI_T_KIN% = 37      'íÜêºçHóøÅ@íÒèoã‡äz
'Private Const ptxSHOHIN_T_KIN% = 38         'è§ïiâªçHóøÅ@íÒèoã‡äz
'Private Const ptxPF_KAKOU_T_KIN% = 39       'PFâ¡çHÅ@íÒèoã‡äz
'Private Const ptxPE_KAKOU_T_KIN% = 40       'PEâ¡çHÅ@íÒèoã‡äz
'Private Const ptxPE_SHIZAI_T_KIN% = 41      'PFéëçﬁÅ@íÒèoã‡äz
'Private Const ptxHINBAN_LABEL_T_KIN% = 42   'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz
'Private Const ptxKOUJI_SETSU_T_KIN% = 43    'ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz
'Private Const ptxKONPOU_T_KIN% = 44         'ç´ïÔçﬁÅ@íÒèoã‡äz
'Private Const ptxFUKU_SHIZAI_T_KIN% = 45    'ïõéëçﬁÅ@íÒèoã‡äz
'Private Const ptxKONPOU_ASSY_T_KIN% = 46    'ç´ïÔASSYÅ@íÒèoã‡äz
'Private Const ptxKANRI_T_KIN% = 47         'ä«óùîÔÅ@íÒèoã‡äz



'---------------------------------------    2017.07.08





Private Const ptxS_CLASS_CODE% = 67        'è§ïiâª∏◊Ω
Private Const ptxF_CLASS_CODE% = 68        'ïtâ¡∏◊Ω
Private Const ptxN_CLASS_CODE% = 69        'ì‡êE∏◊Ω





'------------------------------------   'ÉRÉìÉ{íËã`
Private Const pcmbSHIMUKE% = 0          'édå¸ÇØêÊ
Private Const pcmbCATEGORY_Name% = 1    'ïiñº∂√∫ﬁÿ∞


'------------------------------------   'ÉäÉbÉ`ÉeÉLÉXÉgÉ{ÉbÉNÉXíËã`
Private Const prchBIKOU% = 0            'îıçl
Private Const prchM_BIKOU% = 1          'å©êœèëîıçl



'------------------------------------   '¡™Ø∏É{ÉbÉNÉXíËã`   2017.07.08
Private Const chkNAKANISHI_F% = 0           'íÜêºçHóø
Private Const chkSHOHIN_F% = 1              'è§ïiâªçHóø
Private Const chkPF_KAKOU_F% = 2            'PFâ¡çH
Private Const chkPE_KAKOU_F% = 3            'PEâ¡çH
Private Const chkPE_SHIZAI_F% = 4           'PFéëçﬁ
Private Const chkHINBAN_LABEL_F% = 5        'ïiî‘ï\é¶◊ÕﬁŸ
Private Const chkKOUJI_SETSU_F% = 6         'ê›íuçHéñê‡ñæèë
Private Const chkKONPOU_F% = 7              'ç´ïÔçﬁ
Private Const chkFUKU_SHIZAI_F% = 8         'ïõéëçﬁ
Private Const chkKONPOU_ASSY_F% = 9         'ç´ïÔASSY
Private Const chkKANRI_F% = 10              'ä«óùîÔ
    


'------------------------------------   'ç\ê¨ïi
Private Const pGrdKOUSEI% = 0


Private Const Min_Row% = 1              'ç≈è¨çsêî

Dim Max_Row   As Integer                'ÉOÉäÉbÉhç≈ëÂï\é¶åèêî

Private Const Min_Col% = 0              'ç≈è¨óÒêî
Private Const Max_Col% = 13             'ç≈ëÂóÒêîÅ@9-->13 2017.07.08



Private Const ColNO% = 0                'áÇ
Private Const ColKO_SYUBETSU% = 1       'éÌï 
Private Const ColKO_JGYOBU% = 2         'éñã∆ïî
Private Const ColKO_S_HIN_GAI% = 3      'éwê}ï[ïiî‘
Private Const ColKO_HIN_NAME% = 4       'ïiñº
Private Const ColKO_T_HIN_NAME% = 5     'íÒèoïiñº   2017.07.08
Private Const ColKO_QTY% = 6            'àıêî
Private Const ColKO_TANI% = 7           'íPà    2017.07.08
Private Const ColKO_T_TANKA% = 8        'íÒèoíPâø   2017.07.08
Private Const ColKO_T_KINGAKU% = 9      'íÒèoã‡äz   2017.07.08
Private Const ColG_ST_SHITAN% = 10      'édì¸Åó
Private Const ColG_ST_URITAN% = 11      'îÑè„Åó

Private Const ColG_KINGAKU% = 12        'çáåvã‡äz

Private Const ColPRINT_SEQ% = 13        'àÛç¸èá
                                        
                                        

'-----------------------------------    ÉhÉçÉbÉvÉ_ÉEÉì
Dim SYUBETSU        As New XArrayDB
Dim JGYOBU          As New XArrayDB



'-----------------------------------    å©êœèëï\é¶ÉtÉâÉO  2017.09.28
Dim Print_FLG(0 To 10)  As Integer

'-----------------------------------    àÛç¸ëŒè€Å@éÌï       2017.09.28
Dim Print_SYUBETSU()    As String * 2
'-----------------------------------    àÛç¸èá(ç\ê¨)  2017.11.10
Private Type Print_SEQ_Tag
    C_Code      As String * 10
    Print_SEQ   As String * 2
End Type

Private Print_SEQ() As Print_SEQ_Tag
'-----------------------------------    àÛç¸èá(çÏã∆çHíˆ)  2017.11.10
Private KOUTEI()    As String * 2

Dim svHin_Gai       As String           'ïiî‘
Dim svSHIMUKE_CODE  As String           'édå¸ÇØêÊ
Dim svCATEGORY_CODE As String           'ïiñº∂√∫ﬁÿ∞∫∞ƒﬁ




Dim EXCEL_TEMPLATE  As String           'EXCEL√›Ãﬂ⁄∞ƒ

Dim Save_Dir        As String           'EXCELï€ë∂êÊÃ´Ÿ¿ﬁ

Dim HIN_INV         As Boolean          'ñ¢ìoò^ïiî‘ÇÃìoò^â¬î€

'--------------------------------------- EXCELópíËêî
Private Const xlCalculationManual% = -4135
Private Const xlLeft% = -4131
Private Const xlCenter% = -4108
Private Const xlBottom% = -4107
Private Const xlNone% = -4142
Private Const xlContinuous% = 1
Private Const xlThin% = 2
Private Const xlAutomatic% = -4105
Private Const xlRight% = -4152
Private Const xlDiagonalDown% = 5
Private Const xlDiagonalUp% = 6
Private Const xlEdgeLeft% = 7
Private Const xlEdgeTop% = 8
Private Const xlEdgeBottom% = 9
Private Const xlEdgeRight% = 10
Private Const xlInsideVertical% = 11
Private Const xlInsideHorizontal% = 12
Private Const xlThick% = 4
Private Const xlCalculationAutomatic% = -4105
Private Const xlPortrait% = 1
'--------------------------------------- EXCELópíËêî

'--------------------------------------- EXCELóÒà íu
Private Const xlHin_Name% = 3           'ïiñº
Private Const xlKO_QTY% = 8             'êîó 
Private Const xlTANI% = 9               'íPà 
Private Const xlG_ST_URITAN% = 10       'íPâø
Private Const xlG_KINGAKU% = 11         'ã‡äz
'--------------------------------------- EXCELóÒà íu
 




'Private Const LAST_UPDATE_DAY$ = "[SEI0016] 2017.11.22 15:00"
Private Const LAST_UPDATE_DAY$ = "[SEI0016] 2017.11.29 14:30"

Private Sub Combo1_Change(Index As Integer)
Dim i   As Integer
    
    
    Select Case Index
    
        Case pcmbSHIMUKE
        
        
            If Trim(svHin_Gai) = (Text1(ptxHin_Gai).Text) Then
            Else
                For i = 2 To 5
                    Command1(i).Enabled = False
                Next i
            End If
    
    
    
                        'ïiñº∂√∫ﬁÿ∞ÇÃÉZÉbÉg
'            If ITEM_CATEGORY_Set_Proc() Then
'                Unload Me
'            End If
    
        Case pcmbCATEGORY_Name
    
            If Trim(Right(Combo1(Index).Text, 8)) = Trim(Text1(ptxCATEGORY_CODE).Text) Then
            Else
                Text1(ptxCATEGORY_CODE).Text = Trim(Right(Combo1(Index).Text, 8))
            End If
    End Select

End Sub

Private Sub Combo1_GotFocus(Index As Integer)


    Select Case Index
        Case pcmbSHIMUKE
            svSHIMUKE_CODE = Right(Combo1(pcmbSHIMUKE).Text, 2)
    
        Case pcmbCATEGORY_Name
            svCATEGORY_CODE = Text1(ptxCATEGORY_CODE).Text
    
    End Select

End Sub

Private Sub Combo1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)

    If KeyCode <> vbKeyReturn Then
        Exit Sub
    End If


    Select Case Index
        Case pcmbSHIMUKE
            svSHIMUKE_CODE = Right(Combo1(pcmbSHIMUKE).Text, 2)
    
        Case pcmbCATEGORY_Name
            If Trim(Right(Combo1(Index).Text, 8)) = Trim(Text1(ptxCATEGORY_CODE).Text) Then
            Else
                Text1(ptxCATEGORY_CODE).Text = Trim(Right(Combo1(Index).Text, 8))
            
            End If
    End Select



End Sub

Private Sub Combo1_LostFocus(Index As Integer)
Dim i   As Integer
    
    
    Select Case Index
        Case pcmbSHIMUKE
        
            If Trim(svSHIMUKE_CODE) = Right(Combo1(pcmbSHIMUKE).Text, 2) Then
            Else
                For i = 2 To 5
                    Command1(i).Enabled = False
                Next i
            End If
                        'ïiñº∂√∫ﬁÿ∞ÇÃÉZÉbÉg
            If ITEM_CATEGORY_Set_Proc() Then
                Unload Me
            End If
        
        
            'ïiñºÉJÉeÉSÉäÉB
            For i = 0 To Combo1(pcmbCATEGORY_Name).ListCount - 1
                If Trim(Text1(ptxCATEGORY_CODE).Text) = Trim(Right(Combo1(pcmbCATEGORY_Name).List(i), 8)) Then
                    Text1(ptxCATEGORY_CODE).Text = Trim(Right(Combo1(pcmbCATEGORY_Name).List(i), 8))
                    Combo1(pcmbCATEGORY_Name).ListIndex = i
                    Exit For
                End If
            Next i
            If i > Combo1(pcmbCATEGORY_Name).ListCount - 1 Then
                Combo1(pcmbCATEGORY_Name).ListIndex = 0
            End If
        
        
        
        
        Case pcmbCATEGORY_Name
            If Trim(Right(Combo1(Index).Text, 8)) = Trim(Text1(ptxCATEGORY_CODE).Text) Then
            Else
                Text1(ptxCATEGORY_CODE).Text = Trim(Right(Combo1(Index).Text, 8))
            End If
    End Select
End Sub

Private Sub Command1_Click(Index As Integer)


Dim ans     As Integer
Dim i       As Integer

Dim MESG    As String

Dim yn      As Integer

Dim gyo_su  As Integer



    Select Case Index
    
        Case 0      'èIóπ
            Unload Me
    
        Case 1      'åüçıÅiï\é¶Åj
        
        
            If Detail_Disp_Proc() Then
                Unload Me
            End If
        
            Text1(ptxCATEGORY_CODE).SetFocus
        
        
        Case 2      'ï€ë∂
            
            
            
            
            For i = ptxTanto_Code To ptxN_CLASS_CODE
            
                If Error_Check_Proc(i) Then
                    Exit Sub
                End If
            
            
            Next i
            If Grid_Error_Check_Proc() Then
                Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
                
            
            '    TDBGrid1(pGrdKOUSEI).Refresh
                TDBGrid1(pGrdKOUSEI).Update
            
                TDBGrid1(pGrdKOUSEI).SetFocus
                Exit Sub
            End If
        
            
            
            
            If LenB(StrConv(RTrim(RichTextBox1(prchBIKOU).Text), vbFromUnicode)) > 120 Then
                yn = MsgBox("îıçlÇ™åÖêîÉIÅ[ÉoÅ[ÇµÇƒÇ¢Ç‹Ç∑(ç≈ëÂ120ï∂éö)ÅAÉIÅ[ÉoÇµÇΩï∂éöÇÕêÿÇËéÃÇƒÇÁÇÍÇ‹Ç∑ÅB", vbYesNo, "ämîFì¸óÕ")
                If yn = vbNo Then
                    RichTextBox1(prchBIKOU).SetFocus
                    Exit Sub
                End If
            End If
            
            gyo_su = SendMessage(RichTextBox1(prchBIKOU).hwnd, EM_GETLINECOUNT, 0&, 0&)
            If gyo_su > 5 Then
                MsgBox "îıçlç≈ëÂàÛéöçsêîÇÕÇTçsÇ≈Ç∑ÅBì‡óeÇämîFÇµÇƒâ∫Ç≥Ç¢ÅB"
                RichTextBox1(prchBIKOU).SetFocus
                Exit Sub
            End If
            
'>>>>>>>>>  2017.07.08
'            MESG = "è§ïiâªç\ê¨ÉfÅ[É^Çï€ë∂ÇµÇ‹Ç∑ÅB" & vbCrLf
'            MESG = MESG & "Å@Å@éÌï Å^éñã∆ïîÅ^ïiî‘Å^àıêî" & vbCrLf
'            MESG = MESG & "Å@Å@éwê}ï[îıçl" & vbCrLf
'            MESG = MESG & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & vbCrLf
        
        
            If TANKA_KEISAN_Proc() Then     '2017.11.21
                Unload Me                   '2017.11.21
            End If                          '2017.11.21
        
        
            
            MESG = "è§ïiâªç\ê¨ÉfÅ[É^Çï€ë∂ÇµÅAíPâøÇçXêVÇµÇ‹Ç∑ÅB" & vbCrLf & vbCrLf
            MESG = MESG & "Å@éÌï Å^éñã∆ïîÅ^ïiî‘Å^àıêîÅ^éwê}ï[îıçl" & vbCrLf & vbCrLf
            
            
            MESG = MESG & "Å@çáåvã‡äz:" & lblGOUKEI_KIN & vbCrLf
            MESG = MESG & "Å@ê›íËì˙:" & Format(Now, "YYYY/MM/DD") & vbCrLf
            MESG = MESG & "Å@íSìñé“:" & Text1(ptxTanto_Code).Text & " " & Text1(ptxTanto_Name).Text
            MESG = MESG & "ÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & vbCrLf
        
        
        
        
'>>>>>>>>>  2017.07.08
        
        
            ans = MsgBox(MESG, vbYesNo + vbDefaultButton2 + vbExclamation, "è§ïiâªç\ê¨ÇÃï€ë∂ämîF")
            If ans = vbYes Then
'                If Tanka_Update_Proc() Then     '2017.07.08
'                    Unload Me                   '2017.07.08
'                End If                          '2017.07.08
                
                
                
                If Update_Proc() Then
                    Unload Me
                End If
            
            
            
            
                
                'àÛç¸èáÇ…ï¿Ç◊ë÷Ç¶   2017.11.10
                KOUSEI.QuickSort Min_Row, KOUSEI.UpperBound(1), ColPRINT_SEQ, XORDER_ASCEND, XTYPE_STRING, ColKO_S_HIN_GAI, XORDER_ASCEND, XTYPE_STRING
                
                Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
                
                TDBGrid1(pGrdKOUSEI).ReBind
                TDBGrid1(pGrdKOUSEI).Update
                TDBGrid1(pGrdKOUSEI).MoveFirst
                'àÛç¸èáÇ…ï¿Ç◊ë÷Ç¶   2017.11.10
            
            
            
            
                If Estimate_Proc() Then         '2017.07.08
                    Unload Me                   '2017.07.08
                End If                          '2017.07.08
            
            
            
            
                If Detail_Disp_Proc() Then
                    Unload Me
                End If
            
            End If
        
            Command1(4).Enabled = True          '2013.01.17
                    
            Text1(ptxTanto_Code).SetFocus
        
        Case 3      'íPâøåvéZ
        
            For i = ptxTanto_Code To ptxN_CLASS_CODE
            
                If Error_Check_Proc(i) Then
                    Exit Sub
                End If
            
            Next i
        
            If Grid_Error_Check_Proc() Then
                Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
                
            
            '    TDBGrid1(pGrdKOUSEI).Refresh
                TDBGrid1(pGrdKOUSEI).Update
            
                TDBGrid1(pGrdKOUSEI).SetFocus
                Exit Sub
            End If
        
            If TANKA_KEISAN_Proc() Then
                Unload Me
            End If
        
            Command1(4).Enabled = True          '2013.01.17
        
        Case 4      'å©êœèëî≠çs
            
            If Estimate_Proc() Then
                Unload Me
            End If
        
        Case 5      'íPâøìoò^
            
            For i = ptxTanto_Code To ptxKANRI_KIN
            
                If Error_Check_Proc(i) Then
                    Exit Sub
                End If
            
            
            Next i
            
            
            If Grid_Error_Check_Proc() Then
                Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
                
            
            '    TDBGrid1(pGrdKOUSEI).Refresh
                TDBGrid1(pGrdKOUSEI).Update
            
                TDBGrid1(pGrdKOUSEI).SetFocus
                Exit Sub
            End If
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2011.12.21
            If TANKA_KEISAN_Proc() Then
                Unload Me
            End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2011.12.21
            
            
            MESG = "íPâøÇìoò^ÇµÇ‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©ÅH" & vbCrLf
            MESG = MESG & "çáåvã‡äz:" & lblGOUKEI_KIN & vbCrLf
            MESG = MESG & "ê›íËì˙:" & Format(Now, "YYYY/MM/DD") & vbCrLf
            MESG = MESG & "íSìñé“:" & Text1(ptxTanto_Code).Text & " " & Text1(ptxTanto_Name).Text

            
            
            
            ans = MsgBox(MESG, vbYesNo + vbDefaultButton1 + vbExclamation, "ämîFì¸óÕ")
            If ans = vbYes Then
                If Tanka_Update_Proc() Then
                    Unload Me
                End If
            
                If Detail_Disp_Proc() Then
                    Unload Me
                End If
            
            
            End If
                    
            Command1(4).Enabled = True          '2013.01.17
            
            Text1(ptxTanto_Code).SetFocus
    
    
    End Select






End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub

Private Sub Form_Load()
Dim c       As String * 128
Dim sts     As Integer

Dim wkVAL   As Variant  '2017.09.28
Dim i       As Integer  '2017.09.28


'    If App.PrevInstance Then
'        Beep
'        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
'        End
'    End If


    
    'ÉXÉeÅ[É^ÉXÉEÉBÉìÉhÉEÇçÏê¨Ç∑ÇÈ
    hStatusWnd = CreateStatusWindow(WS_VISIBLE Or WS_CHILD Or CCS_BOTTOM Or SBARS_SIZEGRIP, _
        "[êøãÅÉVÉXÉeÉÄ]ëÂç„éñÅ@å©êœèëçÏê¨èàóù", Me.hwnd, 0)
    'ç≈å„ÇÃóvëfÇ-1Ç…Ç∑ÇÈÇ∆
    'êeÉEÉBÉìÉhÉEÇÃëSëÃÇÃïùÇÃécÇËÇÃïùÇ
    'é©ìÆìIÇ…äÑÇËìñÇƒÇÈ
    Call SendMessageAny(hStatusWnd, SB_SIMPLE, 0, -1)



                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                
                                
                                
'---------------------------------------------- 'éñã∆ïîéÊÇËçûÇ›
    If JGYOB_TB_Set Then
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
                                
                                
                                'ñ¢ìoò^ïiî‘ÇÃìoò^â¬î€ÇÃälìæ
    If GetIni(App.EXEName, "HIN_INV", App.EXEName, c) Then
        HIN_INV = False
    Else
        If Trim(c) = "0" Then
            HIN_INV = False
        Else
            HIN_INV = True
        End If
    End If
'------------------------------------------------------ å©êœèëÅ@ï\é¶ÉtÉâÉO  2017.09.28
    If GetIni(App.EXEName, "PRINT_FLG", App.EXEName, c) Then
        c = "0,0,0,0,0,0,0,0,0,0,0"
    End If


    wkVAL = Split(c, ",", -1)

    If UBound(wkVAL) <> 10 Then
        MsgBox "å©êœèëï\é¶ÉtÉâÉOÅ@èâä˙íl SEI0016.INI [PRINT_FLG] Çê≥ÇµÇ≠ê›íËÇµÇƒâ∫Ç≥Ç¢ÅB"
    End If

    
    For i = 0 To UBound(wkVAL)
    
        Print_FLG(i) = wkVAL(i)
            
    
    Next i

'------------------------------------------------------ àÛç¸ëŒè€éÌï   2017.09.28
    
    Erase Print_SYUBETSU
    
    If GetIni(App.EXEName, "Print_SYUBETSU", App.EXEName, c) Then
        c = "*"
    End If


    wkVAL = Split(c, ",", -1)


    
    For i = 0 To UBound(wkVAL)
    
        ReDim Preserve Print_SYUBETSU(0 To i)
        Print_SYUBETSU(i) = wkVAL(i)
            
    
    Next i


'------------------------------------------------------ EXCELópçÄñ⁄

    If GetIni(App.EXEName, "EXCEL_TEMPLATE", App.EXEName, c) Then
        EXCEL_TEMPLATE = ""
    Else
        EXCEL_TEMPLATE = Trim(c)
    End If


    If GetIni(App.EXEName, "save_dir", App.EXEName, c) Then
        Save_Dir = ""
    Else
        Save_Dir = Trim(c)
    End If



'------------------------------------------------------ àÛç¸èá      2017.11.10
    Erase Print_SEQ

    i = 0
    Do
        i = i + 1
        If GetIni(App.EXEName, "C_CODE" & Format(i, "00"), App.EXEName, c) Then
        
        Else
            If Trim(c) = "**" Then
                Exit Do
            End If
            
            ReDim Preserve Print_SEQ(0 To i - 1)
            Print_SEQ(i - 1).C_Code = Format(i, "00")
            Print_SEQ(i - 1).Print_SEQ = Trim(c)
        End If
    
    Loop

    Erase KOUTEI

    i = 0
    Do
        i = i + 1
        If GetIni(App.EXEName, "KOUTEI" & Format(i, "00"), App.EXEName, c) Then
        Else
            
            If Trim(c) = "**" Then
                Exit Do
            End If
            
            ReDim Preserve KOUTEI(0 To i - 1)
            KOUTEI(i - 1) = Trim(c)
        End If
    
    
    Loop

                                'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñºÉJÉeÉSÉäÉ}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_CATEGORY_Open(BtOpenRead) Then
        Unload Me
    End If
                                'ç\ê¨É}ÉXÉ^ÇnÇoÇdÇm
    If P_COMPO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ÉRÅ[ÉhÉ}ÉXÉ^ÇnÇoÇdÇm
    If P_CODE_Open(BtOpenRead) Then
        Unload Me
    End If
                                'íSìñé“É}ÉXÉ^ÇnÇoÇdÇm
    If TANTO_Open(BtOpenRead) Then
        Unload Me
    End If
                                'ïiñ⁄íPâøïœçXóöóÇnÇoÇdÇm
    If ITEM_HST_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^
    If ITEM_O_Open(BtOpenNomal) Then
        Unload Me
    End If
                                '(àÍéü)ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If tmpITEM_O_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
                                
                                
                                
                                'ç\ê¨É}ÉXÉ^ÇnÇoÇdÇm
    If wP_COMPO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                
    
    '∫∞ƒﬁœΩ¿íËã`
    Call P_CODE_TBL_Proc
    
    'édå¸ÇØêÊÇÃÉZÉbÉg
    If Code_Set_Proc(pcmbSHIMUKE, P_KBN04_CD, 0) Then
        Unload Me
    End If
    Combo1(pcmbSHIMUKE).ListIndex = 0


    'ïiñº∂√∫ﬁÿ∞ÇÃÉZÉbÉg
    If ITEM_CATEGORY_Set_Proc() Then
        Unload Me
    End If




    'éÌï ÉZÉbÉg
    If SYUBETSU_Set_Proc() Then
        Unload Me
    End If

    'éñãõïîÉZÉbÉg
    If JGYOBU_Set_Proc() Then
        Unload Me
    End If

'    Load SEI00162          2017.09.28

    SEI00161.Caption = SEI00161.Caption & " " & LAST_UPDATE_DAY

    Call Init_Proc

End Sub

Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer
Dim yn  As Integer
                                            
                                            
    yn = MsgBox("èIóπÇµÇ‹Ç∑Ç©ÅH", vbYesNo, "ämîFì¸óÕ")
    If yn = vbNo Then
        Cancel = True
        Exit Sub
    End If
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ç\ê¨É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç\ê¨É}ÉXÉ^")
        End If
    End If
                                            'ÉRÅ[ÉhÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç\ê¨É}ÉXÉ^")
        End If
    End If
                                            'íSìñé“É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "íSìñé“É}ÉXÉ^")
        End If
    End If
    
    
    
    
    sts = BTRV(BtOpReset, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If

    Set SEI00161 = Nothing
'    Set SEI00162 = Nothing     2017.09.28

    End
End Sub

Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------
Dim i   As Integer


    SEI00161.MousePointer = vbHourglass

    Call Ctrl_Lock(SEI00161)



End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------
Dim i   As Integer

    Call Ctrl_UnLock(SEI00161)


    SEI00161.MousePointer = vbDefault

End Sub


Private Sub SHORI_Click(Index As Integer)
    Select Case Index
        Case 0 To 5
            Command1(Index).Value = True

        Case 6      'âÊñ àÛç¸
        
            Call Form_HCopy(Picture1, vbPRPSA4, vbPRORLandscape)

    End Select
                    
    
    


End Sub






Private Function Init_Proc(Optional Start_Pos As Integer = 0) As Integer
'----------------------------------------------------------------------------
'                   âÊñ èâä˙âª
'----------------------------------------------------------------------------
Dim i           As Integer

Dim Row         As Integer

Dim c           As String * 128
                                
                                
                                

                                
                                
                                
    Init_Proc = True
                                
                                
    For i = Start_Pos To ptxN_CLASS_CODE
        Text1(i).Text = ""
    Next i
                                
                                
    For i = prchBIKOU To prchM_BIKOU
        RichTextBox1(i).Text = ""
    Next i
                                
                                
    For i = pcmbCATEGORY_Name To pcmbCATEGORY_Name
        Combo1(i).ListIndex = -1
    Next i
                                
    If SYUBETSU_Set_Proc() Then
        Exit Function
    End If
                                
                                
    If JGYOBU_Set_Proc() Then
        Exit Function
    End If
                                
    
    
    
    Init_Proc = True


End Function
Private Function ITEM_CATEGORY_Set_Proc() As Integer
'----------------------------------------------------------------------------
'                   ïiñºÉJÉeÉSÉäÉBÅ[É}ÉXÉ^ÇÉhÉçÉbÉvÉ_ÉEÉìÉäÉXÉgÇ…ÉZÉbÉgÇ∑ÇÈÅB
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer



Dim i           As Integer
    
    ITEM_CATEGORY_Set_Proc = True
    
    Call UniCode_Conv(K0_ITEM_CATEGORY.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM_CATEGORY.CATEGORY_CODE, "")


    Combo1(pcmbCATEGORY_Name).Clear


    Combo1(pcmbCATEGORY_Name).AddItem "Ç»Çµ" & Space(76) & Space(8)


    com = BtOpGetGreater

    Do
        DoEvents
    
        sts = BTRV(com, ITEM_CATEGORY_POS, ITEM_CATEGORYREC, Len(ITEM_CATEGORYREC), K0_ITEM_CATEGORY, Len(K0_ITEM_CATEGORY), 0)
            
        Select Case sts
            Case BtNoErr
            
                                
                If StrConv(ITEM_CATEGORYREC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Then

                    Exit Do

                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "ïiñºÉJÉeÉSÉäÉ}ÉXÉ^")
                Exit Function
        
        End Select

        
        Combo1(pcmbCATEGORY_Name).AddItem StrConv(ITEM_CATEGORYREC.CATEGORY_NAME, vbUnicode) & StrConv(ITEM_CATEGORYREC.CATEGORY_CODE, vbUnicode)
        
        com = BtOpGetNext
    
    Loop



    If Combo1(pcmbCATEGORY_Name).ListCount > 1 Then
        Combo1(pcmbCATEGORY_Name).ListIndex = 0
    End If

    ITEM_CATEGORY_Set_Proc = False
    



End Function
Private Function SYUBETSU_Set_Proc() As Integer
'----------------------------------------------------------------------------
'                   ÉRÅ[ÉhÉ}ÉXÉ^ÇÉhÉçÉbÉvÉ_ÉEÉìÉäÉXÉgÇ…ÉZÉbÉgÇ∑ÇÈÅB
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer



Dim i           As Integer
    
    SYUBETSU_Set_Proc = True
    
    Set SYUBETSU = Nothing
    
    
    
    
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN06_CD)
    Call UniCode_Conv(K0_P_CODE.C_Code, "")

    com = BtOpGetGreater

    i = 0
    Do
        DoEvents
    
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
            
        Select Case sts
            Case BtNoErr
            
                                
                If StrConv(P_CODEREC.DATA_KBN, vbUnicode) <> P_KBN06_CD Then
                    
                    Exit Do
                
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        
        End Select

        
        i = i + 1
        SYUBETSU.ReDim 1, i, 0, 0
        
        
        SYUBETSU(i, 0) = Trim(StrConv(P_CODEREC.C_RNAME, vbUnicode)) & "            " & _
                                Left(StrConv(P_CODEREC.C_Code, vbUnicode), 2)
        
        
        com = BtOpGetNext
    
    Loop

    Set TDBDropDown1.Array = SYUBETSU
    TDBDropDown1.ReBind

    SYUBETSU_Set_Proc = False
    



End Function
Private Function JGYOBU_Set_Proc() As Integer
'----------------------------------------------------------------------------
'                   éñã∆ïîÇÉhÉçÉbÉvÉ_ÉEÉìÉäÉXÉgÇ…ÉZÉbÉgÇ∑ÇÈÅB
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer



Dim i           As Integer
    
    JGYOBU_Set_Proc = True
    
    Set JGYOBU = Nothing
    
    i = 0
    Do
        If i > UBound(JGYOBU_T) Then
            Exit Do
        End If
        
        i = i + 1
        
        JGYOBU.ReDim 1, i, 0, 0
        JGYOBU(i, 0) = Trim(JGYOBU_T(i - 1).NAME) & "            " & Trim(JGYOBU_T(i - 1).CODE)
    
    Loop
    
    
    

    Set TDBDropDown2.Array = JGYOBU
    TDBDropDown2.ReBind

    JGYOBU_Set_Proc = False
    



End Function



Private Sub TDBGrid1_AfterColUpdate(Index As Integer, ByVal ColIndex As Integer)

Dim sts             As Integer
Dim Bookmark        As Variant
    
    
Dim i               As Integer
Dim j               As Integer
    
    
Dim wkDouble        As Double
    
    
 Dim c              As String * 128
    
    
    If TDBGrid1(pGrdKOUSEI).Bookmark = Null Then
        Exit Sub
    End If
    
    If TDBGrid1(pGrdKOUSEI).Bookmark <= 0 Then
        Exit Sub
    End If
    
                    
                    
                    
    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    TDBGrid1(pGrdKOUSEI).Update
                    
                    
                    
    Select Case ColIndex
        
        Case ColKO_SYUBETSU
        
                       
            If GetIni(App.EXEName, "C_CODE" & Right(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_SYUBETSU), 2), App.EXEName, c) Then
                c = ""
            End If
                 
                    
            KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColPRINT_SEQ) = Trim(c)
        
        Case ColKO_JGYOBU
        Case ColKO_S_HIN_GAI
        
            ' éwê}ï[ïiî‘ÇÃçÌèú
            If Trim(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI)) = "" And _
                Trim(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU)) = "" Then
                
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_SYUBETSU) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_HIN_NAME) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN) = ""
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN) = ""
            
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = ""
                
'                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_UMU) = ""  2017.09.27
                
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = ""
                    
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_HIN_NAME) = ""    '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_TANI) = ""          '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA) = ""       '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_KINGAKU) = ""     '2017.09.28
            
            
            
            
            Else
                
                
                'ïiî‘
                Call UniCode_Conv(K0_ITEM.JGYOBU, Right(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU), 1))
                Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)
                
                '2013.01.17
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI) = StrConv(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI), vbUpperCase)
                Call UniCode_Conv(K0_ITEM.HIN_GAI, KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI))
            
                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrKeyNotFound
                        
                        If HIN_INV Then
                            'ñ¢ìoò^ïiî‘Å@â¬Å@éëçﬁÇ∆ÇµÇƒÇ®Ç≠
                            Call UniCode_Conv(ITEMREC.JGYOBU, SHIZAI)
                            Call UniCode_Conv(ITEMREC.NAIGAI, NAIGAI_NAI)
                            Call UniCode_Conv(ITEMREC.HIN_NAME, "ñ¢ìoò^ïiî‘")
                            Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "00000000.00")
                            Call UniCode_Conv(ITEMREC.G_ST_URITAN, "00000000.00")
                        Else
                            MsgBox "[" & Format(TDBGrid1(pGrdKOUSEI).Bookmark, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                            Exit Sub
                        End If
                    Case Else
                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄œΩ¿")
                        Unload Me
                
                End Select
                
                
                
                
                
                Call UniCode_Conv(ITEM_O_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                Call UniCode_Conv(ITEM_O_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
                Call UniCode_Conv(ITEM_O_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
                
'                Call UniCode_Conv(ITEM_O_REC.KO_JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))                             '2017.10.16
                Call UniCode_Conv(ITEM_O_REC.KO_JGYOBU, Right(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU), 1))  '2017.10.16
                
                Call UniCode_Conv(ITEM_O_REC.KO_NAIGAI, NAIGAI_NAI)
                'Call UniCode_Conv(ITEM_O_REC.KO_HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))                                   '2017.10.16
                Call UniCode_Conv(ITEM_O_REC.KO_HIN_GAI, KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI))        '2017.10.16
               
                sts = BTRV(BtOpGetEqual, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrKeyNotFound
                    
                        Call Rclr_ITEM_O_REC
                    
                    Case Else
                        Call File_Error(sts, BtOpGetEqual, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        Unload Me
                
                End Select
                
                
                'ïiñº
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_HIN_NAME) = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
                'àıêî
                If KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = "" Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = "1.00"
                End If
                
                'édì¸íPâø
                If Not IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN) = Format(0, "#0.00")
                Else
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN) = Format(Val(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)), "#0.00")
                End If
                
                'îÑè„íPâø
                If Not IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN) = Format(0, "#0.00")
                Else
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN) = Format(Val(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)), "#0.00")
                End If
                
                
                'çáåvã‡äz
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN))), 2)
                        
'               >>>>>>> çÌèú    2017.09.28
                'éqïîïiÅ@óLñ≥
'                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_UMU) = ""  2017.09.28
'                'éqïîïiÅ@É`ÉFÉbÉN
'                Call UniCode_Conv(K0_wP_COMPO.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2))
'                Call UniCode_Conv(K0_wP_COMPO.JGYOBU, Right(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU), 1))
'                Call UniCode_Conv(K0_wP_COMPO.NAIGAI, NAIGAI_NAI)
'                Call UniCode_Conv(K0_wP_COMPO.HIN_GAI, KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI))
'
'                Call UniCode_Conv(K0_wP_COMPO.DATA_KBN, P_KOSOU)
'                Call UniCode_Conv(K0_wP_COMPO.SEQNO, "000")
'
'                sts = BTRV(BtOpGetGreaterEqual, wP_COMPO_POS, wP_COMPO_K_REC, Len(wP_COMPO_K_REC), K0_wP_COMPO, Len(K0_wP_COMPO), 0)
'                Select Case sts
'                   Case BtNoErr
'
'
'                        If StrConv(wP_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2) Or _
'                            StrConv(wP_COMPO_K_REC.JGYOBU, vbUnicode) <> Right(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_JGYOBU), 1) Or _
'                            StrConv(wP_COMPO_K_REC.NAIGAI, vbUnicode) <> NAIGAI_NAI Or _
'                            Trim(StrConv(wP_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_S_HIN_GAI)) Then
'
'                        Else
'                            'éqïîïiÅ@óLñ≥
'                            KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_UMU) = "  Å§"
'
'                        End If
'
'
'                    Case BtErrEOF
'                    Case Else
'                        Call File_Error(sts, BtOpGetNext, "ç\ê¨É}ÉXÉ^")
'                        Unload Me
'                End Select
'               >>>>>>> çÌèú    2017.09.28
'
            
            
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_HIN_NAME) = StrConv(ITEM_O_REC.T_HIN_NAME, vbUnicode)     '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_TANI) = StrConv(ITEM_O_REC.TANI, vbUnicode)                 '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA) = Format(Val(StrConv(ITEM_O_REC.TANI, vbUnicode)), "#0.00")      '2017.09.28
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA))), 2)
            
            
            
            
            
            End If
                

        Case ColKO_QTY
            If KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = "" Then
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = "1.00"
            End If

            If Not IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) Then
                MsgBox "[" & Format(TDBGrid1(pGrdKOUSEI).Bookmark, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(àıêî)"
            Else
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = Format(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY), "0.00")
    
                'çáåvã‡äz
                If IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN)) Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN))), 2)
                Else
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = "0"
                End If
                'íÒèoã‡äz   '2017.09.28
                If IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA)) Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA))), 2)
                Else
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_KINGAKU) = "0"
                End If
                
            End If


        Case ColKO_T_TANKA  'íÒèoíPâø   2017.09.29
            If Not IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA)) Then
                MsgBox "[" & Format(TDBGrid1(pGrdKOUSEI).Bookmark, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÒèoíPâø)"
            Else
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA) = Format(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA), "#0.00")
                
                If Not IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) Then
                    KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY) = "1.00"
                End If
            
                
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_T_TANKA))), 2)
            End If

        Case ColG_ST_SHITAN

            If Not IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN)) Then
                MsgBox "[" & Format(TDBGrid1(pGrdKOUSEI).Bookmark, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(édì¸íPâø)"
            Else
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN) = Format(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_SHITAN), "#0.00")
            End If


        Case ColG_ST_URITAN

            If Not IsNumeric(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN)) Then
                MsgBox "[" & Format(TDBGrid1(pGrdKOUSEI).Bookmark, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(îÑè„íPâø)"
            Else
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN) = Format(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN), "#0.00")
    
                'çáåvã‡äz
                KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColKO_QTY)) * CCur(KOUSEI(TDBGrid1(pGrdKOUSEI).Bookmark, ColG_ST_URITAN))), 2)
            End If


    End Select


    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    

    TDBGrid1(pGrdKOUSEI).Refresh
    TDBGrid1(pGrdKOUSEI).Update

    TDBGrid1(pGrdKOUSEI).SetFocus


End Sub



Private Sub TDBGrid1_BeforeInsert(Index As Integer, Cancel As Integer)
    
    KOUSEI.ReDim Min_Row, KOUSEI.Count(1), Min_Col, Max_Col

End Sub

Private Sub TDBGrid1_DblClick(Index As Integer)

    If TDBGrid1(pGrdKOUSEI).Bookmark = Null Then
        Exit Sub
    End If
    
    If TDBGrid1(pGrdKOUSEI).Bookmark <= 0 Then
        Exit Sub
    End If

    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    TDBGrid1(pGrdKOUSEI).Update

'    SEI00162.Show vbModal  2017.09.28


    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    TDBGrid1(pGrdKOUSEI).ReBind
    
    TDBGrid1(pGrdKOUSEI).Update




End Sub

Private Sub Text1_Change(Index As Integer)
Dim i   As Integer
    
    
    Select Case Index
        Case ptxHin_Gai
            If Trim(svHin_Gai) = (Text1(ptxHin_Gai).Text) Then
            Else
                For i = 2 To 5
                    Command1(i).Enabled = False
                Next i
            
            
            
            
            End If
    
    
    
    
    End Select



End Sub

Private Sub Text1_GotFocus(Index As Integer)
    If Text1(Index).TabStop = True Then
        Text1(Index) = Trim(Text1(Index).Text)
        Text1(Index).SelStart = 0
        Text1(Index).SelLength = Len(Text1(Index).Text)
    End If


    
    Select Case Index
        Case ptxHin_Gai
            svHin_Gai = Text1(ptxHin_Gai).Text
        Case ptxCATEGORY_CODE
            svCATEGORY_CODE = Text1(ptxCATEGORY_CODE).Text
    End Select



End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    
    If KeyCode <> vbKeyReturn Then
        Exit Sub
    End If

    If Error_Check_Proc(Index) Then   'ÉGÉâÅ[É`ÉFÉbÉN
        Exit Sub
    End If
        
        
    Call Tab_Ctrl(Shift)        'à⁄ìÆ
End Sub
Private Function Error_Check_Proc(Mode As Integer) As Integer
'----------------------------------------------------------------------------
'                   ì¸óÕçÄñ⁄ÇÃÉGÉâÅ[É`ÉFÉbÉN
'----------------------------------------------------------------------------
    
Dim sts         As Integer
    
    
Dim Mi_Qty      As Long
Dim Sumi_Qty    As Long
    
Dim i           As Integer
Dim j           As Integer
Dim k           As Integer
    
Dim yn          As Integer
        
Dim INV_F       As Boolean

Dim NEW_ITEM    As Integer          '2017.09.28
    
    
    
    Error_Check_Proc = True
    
    Select Case Mode
    
    
        Case ptxTanto_Code     'íSìñé“
        
            Call UniCode_Conv(K0_TANTO.TANTO_CODE, Text1(ptxTanto_Code).Text)

            sts = BTRV(BtOpGetEqual, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
            Select Case sts
                Case BtNoErr
                    Text1(ptxTanto_Name).Text = StrConv(TANTOREC.TANTO_NAME, vbUnicode)
                Case BtErrKeyNotFound
                    Text1(ptxTanto_Name).Text = ""
            
                    MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íSìñé“)"
                    Text1(Mode).SetFocus
                    Exit Function
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "íSìñé“É}ÉXÉ^")
                    Exit Function
                
            
            
            End Select
        Case ptxHin_Gai         'ïiî‘
    
            
            Text1(ptxHin_Gai).Text = Trim(StrConv(Text1(ptxHin_Gai).Text, vbUpperCase))
            
            Call UniCode_Conv(K0_ITEM.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
            Call UniCode_Conv(K0_ITEM.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
            Call UniCode_Conv(K0_ITEM.HIN_GAI, Text1(ptxHin_Gai).Text)


            sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            Select Case sts
                Case BtNoErr
                
                    Text1(ptxHin_Name).Text = StrConv(ITEMREC.HIN_NAME, vbUnicode)
                
                    If Trim(StrConv(ITEMREC.ST_SOKO, vbUnicode)) = "" Then
                        Text1(ptxST_SOKO).Text = ""
                        Text1(ptxST_RETU).Text = ""
                        Text1(ptxST_REN).Text = ""
                        Text1(ptxST_DAN).Text = ""
                    Else
                        Text1(ptxST_SOKO).Text = StrConv(ITEMREC.ST_SOKO, vbUnicode)
                        Text1(ptxST_RETU).Text = StrConv(ITEMREC.ST_RETU, vbUnicode)
                        Text1(ptxST_REN).Text = StrConv(ITEMREC.ST_REN, vbUnicode)
                        Text1(ptxST_DAN).Text = StrConv(ITEMREC.ST_DAN, vbUnicode)
                    End If
                
                
                Case BtErrKeyNotFound

                    Text1(ptxHin_Name).Text = ""

                    MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                    Text1(Mode).SetFocus
                    Exit Function
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
                    Exit Function

            End Select
        
        
        
        
        
        
        
        
        Case ptxCATEGORY_CODE               ' ïiñº∂√∫ﬁÿ∞∫∞ƒﬁ
        
            For i = 0 To Combo1(pcmbCATEGORY_Name).ListCount - 1
                If Trim(Text1(Mode).Text) = Trim(Right(Combo1(pcmbCATEGORY_Name).List(i), 8)) Then
                    Combo1(pcmbCATEGORY_Name).ListIndex = i
                    Exit For
                End If
            Next i
            If i > Combo1(pcmbCATEGORY_Name).ListCount - 1 Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiñºÉJÉeÉSÉäÅ[Å@ñ¢ìoò^)"
                Text1(Mode).SetFocus
                Exit Function
            End If



'>>>>>>>>>>>>>>>>>>>>>>>    2017.09.28
        Case ptxNAKANISHI_KIN           'íÜêºçHóøÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÜêºçHóøÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxSHOHIN_KIN              'è§ïiâªçHóøÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(è§ïiâªçHóøÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxPF_KAKOU_KIN            'PFâ¡çHÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFâ¡çHÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxPE_KAKOU_KIN            'PEâ¡çHÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEâ¡çHÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxPE_SHIZAI_KIN           'PFéëçﬁÅ@ã‡äz
            
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFéëçﬁÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxHINBAN_LABEL_KIN        'ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If


        Case ptxKOUJI_SETSU_KIN         'ê›íuçHéñê‡ñæèëÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ê›íuçHéñê‡ñæèëÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If


        Case ptxKONPOU_KIN              'ç´ïÔçﬁÅ@ã‡äz
            
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔçﬁÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxFUKU_SHIZAI_KIN         'ïõéëçﬁÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïõéëçﬁÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        Case ptxKONPOU_ASSY_KIN         'ç´ïÔASSYÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔASSYÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If


        Case ptxKANRI_KIN               'ä«óùîÔÅ@ã‡äz

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ä«óùîÔÅ@ã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If


        Case ptxBuzai_Tanto_Name             'ïîçﬁíSìñé“
        
            If Text1(Mode).Text = "" Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïîçﬁíSìñé“)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxNAI_BUHIN               'çëì‡ãüãããÊï™Åi3ÅFë≈êÿÇËÅj
            If Text1(Mode).Text <> "" And Text1(Mode).Text <> "3" Then
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ë≈êÿÇË)"
                Text1(Mode).SetFocus
                Exit Function
            End If



        Case ptxNAKANISHI_T_KIN         'íÜêºçHóøÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÜêºçHóøÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        
        
        Case ptxSHOHIN_T_KIN            'è§ïiâªçHóøÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(è§ïiâªçHóøÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxPF_KAKOU_T_KIN          'PFâ¡çHÅ@íÒèoã‡äz
        
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFâ¡çHÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxPE_KAKOU_T_KIN          'PEâ¡çHÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEâ¡çHÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        
        Case ptxPE_SHIZAI_T_KIN         'PFéëçﬁÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFéëçﬁÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxHINBAN_LABEL_T_KIN      'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxKOUJI_SETSU_T_KIN       'ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        
        Case ptxKONPOU_T_KIN            'ç´ïÔçﬁÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔçﬁÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxFUKU_SHIZAI_T_KIN       'ïõéëçﬁÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïõéëçﬁÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
        Case ptxKONPOU_ASSY_T_KIN       'ç´ïÔASSYÅ@íÒèoã‡äz
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔASSYÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

        
        Case ptxKANRI_T_KIN              'ä«óùîÔÅ@íÒèoã‡äz
    
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ä«óùîÔÅ@íÒèoã‡äz)"
                Text1(Mode).SetFocus
                Exit Function
            End If

'>>>>>>>>>>>>>>>>>>>>>>>    2017.09.28

'>>>>>>>>>>>>>>>>>>>>>>>    2017.11.07
        Case ptxNAKANISHI_QTY           'íÜêºçHóøÅ@êîó 
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÜêºçHóøÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxNAKANISHI_TANI          'íÜêºçHóøÅ@íPà 
        Case ptxNAKANISHI_T_TAN         'íÜêºçHóøÅ@íÒèoíPâø
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÜêºçHóøÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxSHOHIN_QTY              'è§ïiâªçHóøÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(è§ïiâªçHóøÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        Case ptxSHOHIN_TANI             'è§ïiâªçHóøÅ@íPà 
        Case ptxSHOHIN_T_TAN            'è§ïiâªçHóøÅ@íÒèoíPâø
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(è§ïiâªçHóøÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxPF_KAKOU_QTY            'PFâ¡çHÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFâ¡çHÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxPF_KAKOU_TANI           'PFâ¡çHÅ@íPà 
        Case ptxPF_KAKOU_T_TAN          'PFâ¡çHÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PFâ¡çHÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxPE_KAKOU_QTY            'PEâ¡çHÅ@êîó 
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEâ¡çHÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        Case ptxPE_KAKOU_TANI           'PEâ¡çHÅ@íPà 
        Case ptxPE_KAKOU_T_TAN          'PEâ¡çHÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEâ¡çHÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxPE_SHIZAI_QTY           'PEéëçﬁÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEéëçﬁÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        Case ptxPE_SHIZAI_TANI          'PEéëçﬁÅ@íPà 
        Case ptxPE_SHIZAI_T_TAN         'PEéëçﬁÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(PEéëçﬁÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxHINBAN_LABEL_QTY        'ïiî‘ï\é¶◊ÕﬁŸÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘ï\é¶◊ÕﬁŸÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxHINBAN_LABEL_TANI       'ïiî‘ï\é¶◊ÕﬁŸÅ@íPà 
        Case ptxHINBAN_LABEL_T_TAN      'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If



        Case ptxKOUJI_SETSU_QTY         'ê›íuçHéñê‡ñæèëÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ê›íuçHéñê‡ñæèëÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        
        Case ptxKOUJI_SETSU_TANI        'ê›íuçHéñê‡ñæèëÅ@íPà 
        Case ptxKOUJI_SETSU_T_TAN       'ê›íuçHéñê‡ñæèëÅ@íÒèoíPâø
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ê›íuçHéñê‡ñæèëÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxKONPOU_QTY              'ç´ïÔçﬁÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔçﬁÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        Case ptxKONPOU_TANI             'ç´ïÔçﬁÅ@íPà 
        Case ptxKONPOU_T_TAN            'ç´ïÔçﬁÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔçﬁÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If



        Case ptxFUKU_SHIZAI_QTY         'ïõéëçﬁÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïõéëçﬁÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxFUKU_SHIZAI_TANI        'ïõéëçﬁÅ@íPà 
        Case ptxFUKU_SHIZAI_T_TAN       'ïõéëçﬁÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïõéëçﬁÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxKONPOU_ASSY_QTY         'ç´ïÔASSYÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔASSYÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxKONPOU_ASSY_TANI        'ç´ïÔASSYÅ@íPà 
        Case ptxKONPOU_ASSY_T_TAN       'ç´ïÔASSYÅ@íÒèoíPâø


            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ç´ïÔASSYÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If


        Case ptxKANRI_QTY               'ä«óùîÔÅ@êîó 
        
            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ä«óùîÔÅ@êîó )"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode).Text) And IsNumeric(Text1(Mode + 2).Text) Then
                Text1(Mode + 3).Text = Format(CDbl(Text1(Mode).Text) * CDbl(Text1(Mode + 2).Text), "#0")
            End If
        
        
        Case ptxKANRI_TANI              'ä«óùîÔÅ@íPà 
        Case ptxKANRI_T_TAN             'ä«óùîÔÅ@íÒèoíPâø

            If Text1(Mode).Text = "" Then
                Text1(Mode).Text = "0"
            End If
            
            If IsNumeric(Text1(Mode).Text) Then
                Text1(Mode).Text = Format(CDbl(Text1(Mode).Text), "#0.00")
            Else
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ä«óùîÔÅ@íÒèoíPâø)"
                Text1(Mode).SetFocus
                Exit Function
            End If
        
            If IsNumeric(Text1(Mode - 2).Text) And IsNumeric(Text1(Mode).Text) Then
                Text1(Mode + 1).Text = Format(CDbl(Text1(Mode - 2).Text) * CDbl(Text1(Mode).Text), "#0")
            End If





'>>>>>>>>>>>>>>>>>>>>>>>    2017.11.07


            
    
    
    End Select
        
    Error_Check_Proc = False
    

End Function

Private Function Code_Set_Proc(Index As Integer, KBN As String, Mode As Integer) As Integer
'----------------------------------------------------------------------------
'                   ÉRÅ[ÉhÉ}ÉXÉ^ÇÉRÉìÉ{Ç…ÉZÉbÉgÇ∑ÇÈÅB
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer
Dim Key_Len     As Integer
Dim OPTION1     As Integer
Dim OPTION2     As Integer

Dim wkOption    As String



Dim i           As Integer
    
    Code_Set_Proc = True
    
    Combo1(Index).Clear
    
    For i = 0 To UBound(P_KBN_TBL)
    
        If KBN = P_KBN_TBL(i).KBN_CD Then
            Key_Len = P_KBN_TBL(i).KBN_Len
            Exit For
        End If
    
    Next i
    
    If i > UBound(P_KBN_TBL) Then
        Exit Function
    End If
    
    If Mode = 1 Then
        Combo1(Index).AddItem Space(Key_Len)
    End If
    
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, KBN)
    Call UniCode_Conv(K0_P_CODE.C_Code, "")

    com = BtOpGetGreater

    Do
        DoEvents
    
        sts = BTRV(com, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
            
        Select Case sts
            Case BtNoErr
            
                                
                If StrConv(P_CODEREC.DATA_KBN, vbUnicode) <> KBN Then
                    
                    Exit Do
                
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "ÉRÅ[ÉhÉ}ÉXÉ^")
                Exit Function
        
        End Select

        wkOption = ""
        If P_KBN_TBL(i).KBN_OP1 Then
            wkOption = Trim(StrConv(P_CODEREC.OPTION1, vbUnicode))
        End If
        If P_KBN_TBL(i).KBN_OP2 Then
            wkOption = wkOption & Trim(StrConv(P_CODEREC.OPTION2, vbUnicode))
        End If
        
        
        
        Combo1(Index).AddItem StrConv(P_CODEREC.C_RNAME, vbUnicode) & "            " & _
                                Left(StrConv(P_CODEREC.C_Code, vbUnicode), Key_Len) & wkOption
        
        
        com = BtOpGetNext
    
    Loop

    Code_Set_Proc = False
    



End Function


Private Function P_COMPO_Disp_Proc() As Integer
'----------------------------------------------------------------------------
'                   ç\ê¨É}ÉXÉ^ÇÃì«Ç›çûÇ›Åïï\é¶
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
    
Dim Row         As Long
    
Dim FAST_FLG    As Boolean
    
    P_COMPO_Disp_Proc = True
    Call Input_Lock             '2008.01.15
    
        
    
    
            

    

    Set KOUSEI = Nothing

    
    
    Call UniCode_Conv(K0_P_COMPO.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2))
    Call UniCode_Conv(K0_P_COMPO.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_P_COMPO.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_P_COMPO.HIN_GAI, Text1(ptxHin_Gai).Text)
       
    Call UniCode_Conv(K0_P_COMPO.DATA_KBN, P_HEAD)
    Call UniCode_Conv(K0_P_COMPO.SEQNO, "000")
       
    sts = BTRV(BtOpGetEqual, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
        
    Select Case sts
        Case BtNoErr
        
            FAST_FLG = True
        
            'îıçl
            RichTextBox1(prchBIKOU).Text = RTrim(StrConv(P_COMPO_O_REC.BIKOU, vbUnicode))
        
            'è§ïiâª∏◊Ω  2017.09.28
            'Text1(ptxS_CLASS_CODE).Text = Trim(StrConv(P_COMPO_O_REC.CLASS_CODE, vbUnicode))
            'ïtâ¡∏◊Ω    2017.09.28
            'Text1(ptxF_CLASS_CODE).Text = Trim(StrConv(P_COMPO_O_REC.F_CLASS_CODE, vbUnicode))
            'ì‡êE∏◊Ω    2017.09.28
            'Text1(ptxN_CLASS_CODE).Text = Trim(StrConv(P_COMPO_O_REC.N_CLASS_CODE, vbUnicode))

        
        Case BtErrKeyNotFound
            
            FAST_FLG = False
            
            'îıçl
            RichTextBox1(prchBIKOU).Text = ""
        
            'è§ïiâª∏◊Ω  2017.09.28
            'Text1(ptxS_CLASS_CODE).Text = ""
            'ïtâ¡∏◊Ω    2017.09.28
            'Text1(ptxF_CLASS_CODE).Text = ""
            'ì‡êE∏◊Ω    2017.09.28
            'Text1(ptxN_CLASS_CODE).Text = ""
        
        
        Case Else
            
            Set KOUSEI = Nothing
            
            
            Call Input_UnLock           '2008.01.15
            P_COMPO_Disp_Proc = sts
            Exit Function
    End Select

    '--------------------------------   ÅuéqÅvèÓïÒ
    
    Set KOUSEI = Nothing
    
    
    
    If FAST_FLG Then
    
        Row = Min_Row - 1
        
        Do
            DoEvents
            
            sts = BTRV(BtOpGetNext, P_COMPO_POS, P_COMPO_K_REC, Len(P_COMPO_K_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
            Select Case sts
                Case BtNoErr
                
                                
                    If StrConv(P_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2) Or _
                        StrConv(P_COMPO_K_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                        StrConv(P_COMPO_K_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                        Trim(StrConv(P_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                    
                        Exit Do
                
                    End If
                
                Case BtErrEOF
                    Exit Do
                Case Else
                    Call Input_UnLock             '2008.01.15
                    Call File_Error(sts, BtOpGetNext, "ç\ê¨É}ÉXÉ^")
                    Exit Function
            End Select
            
            
            
            
            Row = Row + 1
                        
            If Grid_Set_Proc(Row) Then
                Exit Function
            End If
            
            
            
        Loop
    End If


    
    
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "0000")

    com = BtOpGetGreater
    
    Do
        DoEvents
        
        sts = BTRV(com, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
        Select Case sts
            Case BtNoErr
            
                            
                If StrConv(ITEM_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                    StrConv(ITEM_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                    Trim(StrConv(ITEM_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                
                    Exit Do
            
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call Input_UnLock             '2008.01.15
                Call File_Error(sts, BtOpGetNext, "ç\ê¨É}ÉXÉ^")
                Exit Function
        End Select
        
        
        
        
        If Trim(StrConv(ITEM_O_REC.KO_HIN_GAI, vbUnicode)) = "" Then
        
            Row = Row + 1
                        
            If Grid_Set_ITEM_O_Proc(Row) Then
                Exit Function
            End If
        End If
        
        com = BtOpGetNext
        
        
    Loop




    If Row < 49 Then
        For Row = Row + 1 To 50

            KOUSEI.ReDim Min_Row, Row, Min_Col, Max_Col
            KOUSEI(Row, ColNO) = Row
            KOUSEI(Row, ColKO_S_HIN_GAI) = ""
        Next Row
    End If


    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    
    
    TDBGrid1(pGrdKOUSEI).Bookmark = Null
    
    TDBGrid1(pGrdKOUSEI).ReBind
    TDBGrid1(pGrdKOUSEI).Update
    TDBGrid1(pGrdKOUSEI).ScrollBars = dbgAutomatic
    
    If KOUSEI.Count(1) > 0 Then
        TDBGrid1(pGrdKOUSEI).MoveFirst
    End If















    Call Input_UnLock

    
    
    P_COMPO_Disp_Proc = False

End Function
Private Function Grid_Set_Proc(Row As Long) As Integer


'----------------------------------------------------------------------------
'                   ç\ê¨É}ÉXÉ^==>GridÉeÅ[ÉuÉã
'----------------------------------------------------------------------------

Dim sts         As Integer
Dim i           As Integer
Dim j           As Integer
    
Dim com         As Integer
    
Dim NEW_ITEM    As Integer      '2017.09.27
    
    
    Grid_Set_Proc = True

    

    KOUSEI.ReDim Min_Row, Row, Min_Col, Max_Col
    
    'No
    KOUSEI(Row, ColNO) = Row
    
    
    'éÌï 
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN06_CD)
    Call UniCode_Conv(K0_P_CODE.C_Code, StrConv(P_COMPO_K_REC.KO_SYUBETSU, vbUnicode))
    sts = BTRV(BtOpGetEqual, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        
    Select Case sts
        Case BtNoErr
            KOUSEI(Row, ColKO_SYUBETSU) = Trim(StrConv(P_CODEREC.C_RNAME, vbUnicode)) & "            " & _
                                Left(StrConv(P_CODEREC.C_Code, vbUnicode), 2)
        
        
        
        Case BtErrKeyNotFound
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^")
            Exit Function
    
    End Select
    
    
    'éñã∆ïî
    For i = 0 To UBound(JGYOBU_T)
    
        If Trim(JGYOBU_T(i).CODE) = StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode) Then
            KOUSEI(Row, ColKO_JGYOBU) = Trim(JGYOBU_T(i).NAME) & "            " & Trim(JGYOBU_T(i).CODE)
            Exit For
        End If
    Next i
    
    'éwê}ï[ïiî‘
    KOUSEI(Row, ColKO_S_HIN_GAI) = StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode)
        
    'ïiñº
    Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM.NAIGAI, StrConv(P_COMPO_K_REC.KO_NAIGAI, vbUnicode))
    Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode))
    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        
    Select Case sts
        Case BtNoErr
            KOUSEI(Row, ColKO_HIN_NAME) = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
        Case BtErrKeyNotFound
            KOUSEI(Row, ColKO_HIN_NAME) = ""
            
        
            Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "00000000.00")
            Call UniCode_Conv(ITEMREC.G_ST_URITAN, "00000000.00")
        
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
            Exit Function
    
    End Select
    
    
    
    '>>>>>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^ì«çûÇ›  2017.09.28
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, StrConv(P_COMPO_K_REC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, StrConv(P_COMPO_K_REC.NAIGAI, vbUnicode))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, StrConv(P_COMPO_K_REC.HIN_GAI, vbUnicode))
    
    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, Format(Row, "000"))
    
    
    
    sts = BTRV(BtOpGetEqual, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
        
    Select Case sts
        Case BtNoErr
            NEW_ITEM = 0
        Case BtErrKeyNotFound
            NEW_ITEM = 1
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
            Exit Function
    
    End Select
    '>>>>>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^ì«çûÇ›  2017.09.28
       
    
    
    
    
    
    
    
    
    
    'íÒèoïiñº   2017.09.28
    If NEW_ITEM = 0 Then
        KOUSEI(Row, ColKO_T_HIN_NAME) = Trim(StrConv(ITEM_O_REC.T_HIN_NAME, vbUnicode))
    Else
        KOUSEI(Row, ColKO_T_HIN_NAME) = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
    End If
    
    
    
    
    'àıêî
    If IsNumeric(StrConv(P_COMPO_K_REC.KO_QTY, vbUnicode)) Then
        KOUSEI(Row, ColKO_QTY) = Format(CDbl(StrConv(P_COMPO_K_REC.KO_QTY, vbUnicode)), "#0.00")
    Else
        KOUSEI(Row, ColKO_QTY) = "1.00"
    End If
    
    'íPà    2017.09.28
    If NEW_ITEM = 0 Then
        KOUSEI(Row, ColKO_TANI) = Trim(StrConv(ITEM_O_REC.TANI, vbUnicode))
    End If
    'íÒèoíPâø   2017.09.28
    If NEW_ITEM = 0 Then
        If IsNumeric(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)) Then
            KOUSEI(Row, ColKO_T_TANKA) = Format(CDbl(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)), "#0.00")
        End If
    End If
    'íÒèoã‡äz   2017.09.28
    If NEW_ITEM = 0 Then
        If IsNumeric(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)) Then
            KOUSEI(Row, ColKO_T_KINGAKU) = Format(CDbl(StrConv(ITEM_O_REC.T_KINGAKU, vbUnicode)), "#0")
        End If
    End If
    
    
    
    
    
    
    
    'édì¸íPâø
    If IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then
        KOUSEI(Row, ColG_ST_SHITAN) = Format(CDbl(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)), "#0.00")
    Else
        KOUSEI(Row, ColG_ST_SHITAN) = "0.00"
    End If
    
    'îÑè„íPâø
    If IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
        KOUSEI(Row, ColG_ST_URITAN) = Format(CDbl(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)), "#0.00")
    Else
        KOUSEI(Row, ColG_ST_URITAN) = "0.00"
    End If
    
    
    'çáåvã‡äz
    KOUSEI(Row, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(Row, ColKO_QTY)) * CCur(KOUSEI(Row, ColG_ST_URITAN))), 2)
    
    'àÛç¸èá 2017.11.10
    For i = 0 To UBound(Print_SEQ)
        If Trim(Print_SEQ(i).C_Code) = Trim(Right(KOUSEI(Row, ColKO_SYUBETSU), 2)) Then
            KOUSEI(Row, ColPRINT_SEQ) = Print_SEQ(i).Print_SEQ
            Exit For
        End If
    Next i
    
    
    
    '>>>>>>>>>>>>>>>>éqïîïiÅ@É`ÉFÉbÉN   2017.09.28  DEL
'    'éqïîïiÅ@óLñ≥
'    KOUSEI(Row, ColKO_UMU) = ""
'
'
'
'    Call UniCode_Conv(K0_wP_COMPO.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2))
'    Call UniCode_Conv(K0_wP_COMPO.JGYOBU, StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode))
'    Call UniCode_Conv(K0_wP_COMPO.NAIGAI, StrConv(P_COMPO_K_REC.KO_NAIGAI, vbUnicode))
'    Call UniCode_Conv(K0_wP_COMPO.HIN_GAI, StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode))
'
'    Call UniCode_Conv(K0_wP_COMPO.DATA_KBN, P_KOSOU)
'    Call UniCode_Conv(K0_wP_COMPO.SEQNO, "000")
'
'    sts = BTRV(BtOpGetGreaterEqual, wP_COMPO_POS, wP_COMPO_K_REC, Len(wP_COMPO_K_REC), K0_wP_COMPO, Len(K0_wP_COMPO), 0)
'    Select Case sts
'       Case BtNoErr
'
'
'            If StrConv(wP_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2) Or _
'                StrConv(wP_COMPO_K_REC.JGYOBU, vbUnicode) <> StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode) Or _
'                StrConv(wP_COMPO_K_REC.NAIGAI, vbUnicode) <> StrConv(P_COMPO_K_REC.KO_NAIGAI, vbUnicode) Or _
'                Trim(StrConv(wP_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode)) Then
'
'            Else
'                'éqïîïiÅ@óLñ≥
'                KOUSEI(Row, ColKO_UMU) = "  Å§"
'
'            End If
'
'
'        Case BtErrEOF
'        Case Else
'            Call File_Error(sts, BtOpGetNext, "ç\ê¨É}ÉXÉ^")
'            Exit Function
'    End Select
    '>>>>>>>>>>>>>>>>éqïîïiÅ@É`ÉFÉbÉN   2017.09.28  DEL
        
    
    
    
    
    
    
    Grid_Set_Proc = False
End Function


Private Function Grid_Set_ITEM_O_Proc(Row As Long) As Integer


'----------------------------------------------------------------------------
'                   ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^==>GridÉeÅ[ÉuÉã
'----------------------------------------------------------------------------

Dim sts         As Integer
Dim i           As Integer
Dim j           As Integer
    
Dim com         As Integer
    
Dim NEW_ITEM    As Integer      '2017.09.27
    
    
    Grid_Set_ITEM_O_Proc = True

    

    KOUSEI.ReDim Min_Row, Row, Min_Col, Max_Col
    
    'No
    KOUSEI(Row, ColNO) = Row
    
    
    'éÌï 
    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN06_CD)
    Call UniCode_Conv(K0_P_CODE.C_Code, StrConv(ITEM_O_REC.KO_SYUBETSU, vbUnicode))
    sts = BTRV(BtOpGetEqual, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
        
    Select Case sts
        Case BtNoErr
            KOUSEI(Row, ColKO_SYUBETSU) = Trim(StrConv(P_CODEREC.C_RNAME, vbUnicode)) & "            " & _
                                Left(StrConv(P_CODEREC.C_Code, vbUnicode), 2)
        
        
        
        Case BtErrKeyNotFound
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^")
            Exit Function
    
    End Select
    
    
    'éñã∆ïî
    For i = 0 To UBound(JGYOBU_T)
    
        If Trim(JGYOBU_T(i).CODE) = StrConv(ITEM_O_REC.KO_JGYOBU, vbUnicode) Then
            KOUSEI(Row, ColKO_JGYOBU) = Trim(JGYOBU_T(i).NAME) & "            " & Trim(JGYOBU_T(i).CODE)
            Exit For
        End If
    Next i
    
    
    
    
       
    
    
    
    
    
    
    
    
    
    'íÒèoïiñº   2017.09.28
    If NEW_ITEM = 0 Then
        KOUSEI(Row, ColKO_T_HIN_NAME) = Trim(StrConv(ITEM_O_REC.T_HIN_NAME, vbUnicode))
    Else
        KOUSEI(Row, ColKO_T_HIN_NAME) = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
    End If
    
    
    
    
    'àıêî
    If IsNumeric(StrConv(ITEM_O_REC.KO_QTY, vbUnicode)) Then
        KOUSEI(Row, ColKO_QTY) = Format(CDbl(StrConv(ITEM_O_REC.KO_QTY, vbUnicode)), "#0.00")
    Else
        KOUSEI(Row, ColKO_QTY) = "1.00"
    End If
    
    'íPà 
    KOUSEI(Row, ColKO_TANI) = Trim(StrConv(ITEM_O_REC.TANI, vbUnicode))
    'íÒèoíPâø
    If IsNumeric(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)) Then
        KOUSEI(Row, ColKO_T_TANKA) = Format(CDbl(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)), "#0.00")
    End If
    'íÒèoã‡äz
    If IsNumeric(StrConv(ITEM_O_REC.T_TANKA, vbUnicode)) Then
        KOUSEI(Row, ColKO_T_KINGAKU) = Format(CDbl(StrConv(ITEM_O_REC.T_KINGAKU, vbUnicode)), "#0")
    End If
    
    
    
    
    
    
    
    'édì¸íPâø
    KOUSEI(Row, ColG_ST_SHITAN) = "0.00"
    
    'îÑè„íPâø
    KOUSEI(Row, ColG_ST_URITAN) = "0.00"
    
    
    'çáåvã‡äz
    KOUSEI(Row, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(Row, ColKO_QTY)) * CCur(KOUSEI(Row, ColG_ST_URITAN))), 2)
    
    'àÛç¸èá 2017.11.10
    For i = 0 To UBound(Print_SEQ)
        If Trim(Print_SEQ(i).C_Code) = Trim(Right(KOUSEI(Row, ColKO_SYUBETSU), 2)) Then
            KOUSEI(Row, ColPRINT_SEQ) = Print_SEQ(i).Print_SEQ
            Exit For
        End If
    Next i
    
    
    
    
    
    
    
    
    
    Grid_Set_ITEM_O_Proc = False
End Function


' ------------------------------------------------------------------------
'       éwíËÇµÇΩê∏ìxÇÃêîílÇ…êÿÇËè„Ç∞ÇµÇ‹Ç∑ÅB
'
' @Param    dValue      ä€ÇﬂëŒè€ÇÃî{ê∏ìxïÇìÆè¨êîì_êîÅB
' @Param    iDigits     ñﬂÇËílÇÃóLå¯åÖêîÇÃê∏ìxÅB
' @Return               iDigits Ç…ìôÇµÇ¢ê∏ìxÇÃêîílÇ…êÿÇËè„Ç∞ÇÁÇÍÇΩêîílÅB
' ------------------------------------------------------------------------
Private Function ToRoundUp(ByVal dValue As Currency, ByVal iDigits As Integer) As Currency
    Dim dCoef As Double

    
        


    dCoef = (10 ^ iDigits)



    
    
    
    Select Case CDbl(dValue * dCoef) - Fix(dValue * dCoef)
        Case Is > 0
            ToRoundUp = (Int(dValue * dCoef) + 1) / dCoef
        Case Is < 0
            ToRoundUp = (Fix(dValue * dCoef) - 1) / dCoef
        Case Else
            ToRoundUp = dValue
    End Select




End Function

' ------------------------------------------------------------------------
'       éwíËÇµÇΩê∏ìxÇÃêîílÇ…êÿÇËéÃÇƒÇµÇ‹Ç∑ÅB
'
' @Param    dValue      ä€ÇﬂëŒè€ÇÃî{ê∏ìxïÇìÆè¨êîì_êîÅB
' @Param    iDigits     ñﬂÇËílÇÃóLå¯åÖêîÇÃê∏ìxÅB
' @Return               iDigits Ç…ìôÇµÇ¢ê∏ìxÇÃêîílÇ…êÿÇËéÃÇƒÇÁÇÍÇΩêîílÅB
' ------------------------------------------------------------------------
Public Function ToRoundDown(ByVal dValue As Currency, ByVal iDigits As Integer) As Currency
    Dim dCoef As Double

    dCoef = (10 ^ iDigits)

    Select Case CDbl(dValue * dCoef) - Fix(dValue * dCoef)
        Case Is > 0
            ToRoundDown = Int(dValue * dCoef) / dCoef
        Case Is < 0
            ToRoundDown = Fix(dValue * dCoef) / dCoef
        Case Else
            ToRoundDown = dValue
    End Select
End Function





' ------------------------------------------------------------------------
'       éwíËÇµÇΩê∏ìxÇÃêîílÇ…éléÃå‹ì¸ÇµÇ‹Ç∑ÅB
'
' @Param    dValue      ä€ÇﬂëŒè€ÇÃî{ê∏ìxïÇìÆè¨êîì_êîÅB
' @Param    iDigits     ñﬂÇËílÇÃóLå¯åÖêîÇÃê∏ìxÅB
' @Return               iDigits Ç…ìôÇµÇ¢ê∏ìxÇÃêîílÇ…éléÃå‹ì¸Ç≥ÇÍÇΩêîílÅB
' ------------------------------------------------------------------------
Public Function ToHalfAdjust(ByVal dValue As Currency, ByVal iDigits As Integer) As Currency
    Dim dCoef As Double

    dCoef = (10 ^ iDigits)

    If dValue > 0 Then
        ToHalfAdjust = Int(CDbl(dValue * dCoef + 0.5)) / dCoef
    Else
        ToHalfAdjust = Fix(CDbl(dValue * dCoef - 0.5)) / dCoef
    End If
End Function
Private Function Estimate_Proc() As Integer
'----------------------------------------------------------------------------
'                   ÇdÇwÇbÇdÇkÅiå‰å©êœèëÅjèoóÕ
'       2009.06.02
'----------------------------------------------------------------------------
Dim excelApplication    As Object
Dim excelWorkBook       As Object
Dim excelSheet          As Object

    
Dim i                   As Integer
Dim j                   As Integer
    
Dim Row                 As Integer
    
Dim Fsw                 As Boolean
    
Dim com                 As Integer
Dim sts                 As Integer
    
    
Dim LCnt                As Integer
Dim PCnt                As Integer
    
    
Dim Start_Line          As Integer
Dim End_Line            As Integer
Dim Total_Line          As Integer
    
Dim Clear_Start_Line    As Integer
Dim Clear_End_Line      As Integer
    
Dim Total_Kingaku       As Double
        
Dim Print_FLG           As Integer          '2017.10.06
    
    
    Estimate_Proc = True
    
    
    If Error_Check_Proc(ptxTanto_Code) Then
        Estimate_Proc = False
        Exit Function
    End If
    
    
    
    Call Input_Lock
    
    
    
    Set excelApplication = CreateObject("Excel.Application")
    

    If Trim(EXCEL_TEMPLATE) = "" Then
        Set excelWorkBook = excelApplication.Workbooks.Add
    
    Else
                                                        '√›Ãﬂ⁄∞ƒÃﬁØ∏ÇäJÇ≠
        Set excelWorkBook = excelApplication.Workbooks.Open(EXCEL_TEMPLATE)
    End If

    Set excelSheet = excelWorkBook.Worksheets(1)
    
    excelSheet.NAME = Trim(Text1(ptxHin_Gai).Text)
    
    
    
    'excelApplication.Visible = True
        
    excelApplication.Calculation = xlCalculationManual
    excelApplication.ScreenUpdating = False
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   äJénèàóù


'-----------------------    ÉpÉiÉ\ÉjÉbÉNíSìñé“  2017.09.28
    excelSheet.Application.Cells(6, 5).Value = Text1(ptxBuzai_Tanto_Name).Text

'-----------------------    íSìñé“Å@2017.07.08
    excelSheet.Application.Cells(2, 11).Value = Text1(ptxTanto_Name).Text





'-----------------------    ïiñº
'    excelSheet.Application.Cells(20, 3).Value = Text1(ptxHin_Name).Text                                                '2017.10.13
    excelSheet.Application.Cells(20, 3).Value = Trim(Text1(ptxHin_Gai).Text) & " " & Trim(Text1(ptxHin_Name).Text)      '2017.10.13

'-----------------------    çáåvã‡äz
    excelSheet.Application.Cells(20, 10).Value = Val(lblGOUKEI_T_KIN.Caption)
'-----------------------    çáåvã‡äz
    excelSheet.Application.Cells(44, 11).Value = Val(lblGOUKEI_T_KIN.Caption)



    Row = 22


    LCnt = 1
    PCnt = 1


    Start_Line = 1
    End_Line = 54


    Clear_Start_Line = 23
    Clear_End_Line = 43


    Total_Line = 20

    Total_Kingaku = 0
    For i = 1 To KOUSEI.UpperBound(1)
        
        
        If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) <> "" Or Trim(KOUSEI(i, ColKO_T_HIN_NAME)) <> "" Then
        
 '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>àÛç¸ì‡óeÇëSÇƒâÊñ ÇÊÇË 2017.10.06
            Print_FLG = 0
            For j = 0 To UBound(Print_SYUBETSU)
                If Right(KOUSEI(i, ColKO_SYUBETSU), 2) = Print_SYUBETSU(j) Then
        
                    Print_FLG = 1
            
                End If
            Next j
            If Print_FLG = 1 Then
    
    
   
                If LCnt > PCnt * 21 Then
                    PCnt = PCnt + 1
                    Row = Row + 33
                    LCnt = 0


                    Total_Line = Total_Line + 54
                    excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(End_Line)).Copy
                    Start_Line = Start_Line + 54
                    End_Line = End_Line + 54
                    excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(Start_Line)).pastespecial


                    Clear_Start_Line = Clear_Start_Line + 54
                    Clear_End_Line = Clear_End_Line + 54

                    excelSheet.Application.Range(excelSheet.Application.Cells(Clear_Start_Line, 3), excelSheet.Application.Cells(Clear_End_Line, 11)).ClearContents

                End If


                Row = Row + 1
                LCnt = LCnt + 1


                Fsw = True
   
        
        
                 excelSheet.Application.Cells(Row, xlHin_Name).Value = KOUSEI(i, ColKO_T_HIN_NAME)
                 excelSheet.Application.Cells(Row, xlKO_QTY).Value = KOUSEI(i, ColKO_QTY)
                 excelSheet.Application.Cells(Row, xlTANI).Value = Trim(KOUSEI(i, ColKO_TANI))
                 'excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = KOUSEI(i, ColG_ST_URITAN)
                 excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = KOUSEI(i, ColKO_T_TANKA)
                 excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = KOUSEI(i, ColKO_T_KINGAKU)
        
                
                
            End If
        End If
    Next i
            
            
            
            
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>  2017.11.10 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
'    For i = chkNAKANISHI_F To chkKANRI_F
'        If Check1(i).Value = 1 Then
'
'
'            If LCnt > PCnt * 21 Then
'                PCnt = PCnt + 1
'                Row = Row + 33
'                LCnt = 0
'
'
'                Total_Line = Total_Line + 54
'                excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(End_Line)).Copy
'                Start_Line = Start_Line + 54
'                End_Line = End_Line + 54
'                excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(Start_Line)).pastespecial
'
'
'                Clear_Start_Line = Clear_Start_Line + 54
'                Clear_End_Line = Clear_End_Line + 54
'
'                excelSheet.Application.Range(excelSheet.Application.Cells(Clear_Start_Line, 3), excelSheet.Application.Cells(Clear_End_Line, 11)).ClearContents
'
'            End If
'
'
'            Row = Row + 1
'            LCnt = LCnt + 1
'
'
'
'
'
'            excelSheet.Application.Cells(Row, xlHin_Name).Value = lblTitle(i).Caption
''>>>>>>>>   2017.10.16
'            Select Case i
'                Case 0
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(10).Text
'                Case 1
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(12).Text
'                Case 2
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(14).Text
'                Case 3
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(16).Text
'                Case 4
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(18).Text
'                Case 5
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(20).Text
'                Case 6
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(22).Text
'                Case 7
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(24).Text
'                Case 8
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(26).Text
'                Case 9
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(28).Text
'                Case 10
'                    excelSheet.Application.Cells(Row, xlTANI).Value = Text1(30).Text
'            End Select
''>>>>>>>>   2017.10.16
'
'            excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Text1(i + 37).Text
'
'
'
'
'        End If
'
'    Next i
'
'>>>>>>>>>>>>>>>>>>>>>>>>>  2017.11.10 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
'>>>>>>>>>>>>>>>>>>>>>>>>>  2017.11.10 çHêîÇîCà”ÇÃàÛç¸èáÇ…ïœçX<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
For i = 0 To UBound(KOUTEI)
    If Check1(KOUTEI(i) - 1).Value = vbChecked Then
        
        If LCnt > PCnt * 21 Then
            PCnt = PCnt + 1
            Row = Row + 33
            LCnt = 0


            Total_Line = Total_Line + 54
            excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(End_Line)).Copy
            Start_Line = Start_Line + 54
            End_Line = End_Line + 54
            excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(Start_Line)).pastespecial


            Clear_Start_Line = Clear_Start_Line + 54
            Clear_End_Line = Clear_End_Line + 54

            excelSheet.Application.Range(excelSheet.Application.Cells(Clear_Start_Line, 3), excelSheet.Application.Cells(Clear_End_Line, 11)).ClearContents

        End If


        Row = Row + 1
        LCnt = LCnt + 1


        excelSheet.Application.Cells(Row, xlHin_Name).Value = lblTitle(KOUTEI(i) - 1).Caption


        Select Case KOUTEI(i) - 1
            Case 0
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(10).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(11).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(12).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(13).Text)
            Case 1
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(15).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(16).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(17).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(18).Text)
            Case 2
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(20).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(21).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(22).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(23).Text)
            Case 3
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(25).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(26).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(27).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(28).Text)
            Case 4
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(30).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(31).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(32).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(33).Text)
            Case 5
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(35).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(36).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(37).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(38).Text)
            Case 6
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(40).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(41).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(42).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(43).Text)
            Case 7
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(45).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(46).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(47).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(48).Text)
            Case 8
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(50).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(51).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(52).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(53).Text)
            Case 9
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(55).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(56).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(57).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(58).Text)
            Case 10
                excelSheet.Application.Cells(Row, xlKO_QTY).Value = Text1(60).Text
                excelSheet.Application.Cells(Row, xlTANI).Value = Trim(Text1(61).Text)
                excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = Text1(62).Text
                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Val(Text1(63).Text)
        End Select

    End If

Next i
'>>>>>>>>>>>>>>>>>>>>>>>>>  2017.11.10 çHêîÇîCà”ÇÃàÛç¸èáÇ…ïœçX<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

 
 
 
 
 
 
 
 '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>àÛç¸ì‡óeÇëSÇƒâÊñ ÇÊÇË 2017.10.06
            

'            Call UniCode_Conv(K0_wP_COMPO.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2))
'            Call UniCode_Conv(K0_wP_COMPO.JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))
'            Call UniCode_Conv(K0_wP_COMPO.NAIGAI, NAIGAI_NAI)
'            Call UniCode_Conv(K0_wP_COMPO.HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))
'
'            Call UniCode_Conv(K0_wP_COMPO.DATA_KBN, P_KOSOU)
'            Call UniCode_Conv(K0_wP_COMPO.SEQNO, "000")
'
'            com = BtOpGetGreater
'
'            Fsw = False
'
'
'            Do
'                DoEvents
'                sts = BTRV(com, wP_COMPO_POS, wP_COMPO_K_REC, Len(wP_COMPO_K_REC), K0_wP_COMPO, Len(K0_wP_COMPO), 0)
'                Select Case sts
'                    Case BtNoErr
'
'
'                        If StrConv(wP_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2) Or _
'                            StrConv(wP_COMPO_K_REC.JGYOBU, vbUnicode) <> Right(KOUSEI(i, ColKO_JGYOBU), 1) Or _
'                            StrConv(wP_COMPO_K_REC.NAIGAI, vbUnicode) <> NAIGAI_NAI Or _
'                            Trim(StrConv(wP_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(KOUSEI(i, ColKO_S_HIN_GAI)) Then
'
'                            Exit Do
'
'                        End If
'
'
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(wP_COMPO_K_REC.KO_JGYOBU, vbUnicode))
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, StrConv(wP_COMPO_K_REC.KO_NAIGAI, vbUnicode))
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(wP_COMPO_K_REC.KO_HIN_GAI, vbUnicode))
'
'
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                        Select Case sts
'                            Case BtNoErr
'                            Case BtErrKeyNotFound
'                                Call UniCode_Conv(ITEMREC.HIN_GAI, "ñ¢ìoò^ïiî‘")
'                                Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")
'                            Case Else
'                                Call Input_UnLock
'                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
'                                Exit Function
'                        End Select
'
'
'
'
'
'
'
'                        If LCnt > PCnt * 21 Then
'                            PCnt = PCnt + 1
'                            Row = Row + 33
'                            LCnt = 0
'
'
'                            Total_Line = Total_Line + 54
'                            excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(End_Line)).Copy
'                            Start_Line = Start_Line + 54
'                            End_Line = End_Line + 54
'                            excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(Start_Line)).pastespecial
'
'
'                            Clear_Start_Line = Clear_Start_Line + 54
'                            Clear_End_Line = Clear_End_Line + 54
'
'                            excelSheet.Application.Range(excelSheet.Application.Cells(Clear_Start_Line, 3), excelSheet.Application.Cells(Clear_End_Line, 11)).ClearContents
'
'                        End If
'
'
'                        Row = Row + 1
'                        LCnt = LCnt + 1
'
'
'                        Fsw = True
'
'
'                        excelSheet.Application.Cells(Row, xlHin_Name).Value = RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
'                        excelSheet.Application.Cells(Row, xlTANI).Value = ""
'
'                        If IsNumeric(StrConv(wP_COMPO_K_REC.KO_QTY, vbUnicode)) And _
'                            IsNumeric(KOUSEI(i, ColKO_QTY)) Then
'                            excelSheet.Application.Cells(Row, xlKO_QTY).Value = ToHalfAdjust(CCur(CCur(StrConv(wP_COMPO_K_REC.KO_QTY, vbUnicode)) * CCur(KOUSEI(i, ColKO_QTY))), 2)
'                        Else
'                            excelSheet.Application.Cells(Row, xlKO_QTY).Value = ""
'                        End If
'
'
'                        If IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
'                            excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = CDbl(StrConv(ITEMREC.G_ST_URITAN, vbUnicode))
'                        Else
'                            excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = ""
'                        End If
'
'                        If IsNumeric(excelSheet.Application.Cells(Row, xlKO_QTY).Value) And _
'                            IsNumeric(excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value) Then
'
'                            excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = ToHalfAdjust(CCur(CCur(excelSheet.Application.Cells(Row, xlKO_QTY).Value) * CCur(excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value)), 2)
'                            Total_Kingaku = Total_Kingaku + excelSheet.Application.Cells(Row, xlG_KINGAKU).Value
'                        End If
'
'                    Case BtErrEOF
'                        Exit Do
'                    Case Else
'                        Call Input_UnLock             '2008.01.15
'                        Call File_Error(sts, BtOpGetNext, "ç\ê¨É}ÉXÉ^")
'                        Exit Function
'                End Select
'
'
'            Loop
'
'            If Not Fsw Then
'
'                If LCnt > PCnt * 21 Then
'                    PCnt = PCnt + 1
'                    Row = Row + 33
'                    LCnt = 0
'
'                    Total_Line = Total_Line + 54
'                    excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(End_Line)).Copy
'                    Start_Line = Start_Line + 54
'                    End_Line = End_Line + 54
'                    excelSheet.Application.Range(excelSheet.Application.Rows(Start_Line), excelSheet.Application.Rows(Start_Line)).pastespecial
'
'
'                    Clear_Start_Line = Clear_Start_Line + 54
'                    Clear_End_Line = Clear_End_Line + 54
'
'                    excelSheet.Application.Range(excelSheet.Application.Cells(Clear_Start_Line, 3), excelSheet.Application.Cells(Clear_End_Line, 11)).ClearContents
'
'                End If
'
'
'
'                Row = Row + 1
'                LCnt = LCnt + 1
'
'                Call UniCode_Conv(K0_ITEM.JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))
'                Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))
'
'
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                Select Case sts
'                    Case BtNoErr
'                    Case BtErrKeyNotFound
'                        Call UniCode_Conv(ITEMREC.HIN_GAI, "ñ¢ìoò^ïiî‘")
'                        Call UniCode_Conv(ITEMREC.G_ST_URITAN, "")
'                    Case Else
'                        Call Input_UnLock
'                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
'                        Exit Function
'                End Select
'
'
'
'                excelSheet.Application.Cells(Row, xlHin_Name).Value = RTrim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
'                excelSheet.Application.Cells(Row, xlTANI).Value = ""
'
'                excelSheet.Application.Cells(Row, xlKO_QTY).Value = KOUSEI(i, ColKO_QTY)
'
'
'                If IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
'                    excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = CDbl(StrConv(ITEMREC.G_ST_URITAN, vbUnicode))
'                Else
'                    excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value = ""
'                End If
'
'                If IsNumeric(excelSheet.Application.Cells(Row, xlKO_QTY).Value) And _
'                    IsNumeric(excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value) Then
'
'                    excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = ToHalfAdjust(CCur(CCur(excelSheet.Application.Cells(Row, xlKO_QTY).Value) * CCur(excelSheet.Application.Cells(Row, xlG_ST_URITAN).Value)), 2)
'                    Total_Kingaku = Total_Kingaku + excelSheet.Application.Cells(Row, xlG_KINGAKU).Value
'
'                End If
'
'
'            End If
'
'        End If
'
'
'    Next i
'
'
'
''    For i = ptxNAKANISHI_KIN To ptxKANRI_KIN               '2017.06.12
'    For i = ptxNAKANISHI_KIN To ptxKANRI_KIN Step 2         '2017.06.12
'
'        If IsNumeric(Text1(i).Text) Then
'            If CDbl(Text1(i).Text) <> 0 Then
'
'
'
'                Row = Row + 1
'
'
'
'
'                excelSheet.Application.Cells(Row, xlHin_Name).Value = lblTitle(i).Caption
'                excelSheet.Application.Cells(Row, xlTANI).Value = Text1(i - 1).Text
'                excelSheet.Application.Cells(Row, xlG_KINGAKU).Value = Text1(i).Text
'
'                Total_Kingaku = Total_Kingaku + excelSheet.Application.Cells(Row, xlG_KINGAKU).Value
'
'
'
'            End If
'        End If
'
'    Next i
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>àÛç¸ì‡óeÇëSÇƒâÊñ ÇÊÇË 2017.10.06

    'excelSheet.Application.Cells(Total_Line, xlG_KINGAKU - 1).Value = Total_Kingaku                    '2017.10.13


    excelSheet.PageSetup.printarea = excelSheet.Application.Range(excelSheet.Application.Cells(1, 1), excelSheet.Application.Cells(End_Line, 12)).address

    excelSheet.Application.Cells(1, 1).Select


'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   èIóπèàóù
    excelApplication.Calculation = xlCalculationAutomatic
    
    
    excelApplication.ScreenUpdating = True
    excelApplication.Visible = True
    
    
    excelApplication.displayalerts = False
'    excelWorkBook.saveas FileName:=(Save_Dir & Trim(Text1(ptxHin_Gai).Text))       '2017.07.08
    excelWorkBook.saveas FileName:=(Save_Dir & Trim(Text1(ptxHin_Gai).Text)) & "-" & Format(Now, "YYYYMMDD hhmmss")      '2017.07.08
    
    
    
    
    Set excelSheet = Nothing
    
    Set excelWorkBook = Nothing
    

    
    Set excelApplication = Nothing

    
    
    Call Input_UnLock
    
    
    
    
    Estimate_Proc = False
End Function

Private Function Detail_Disp_Proc() As Integer
''----------------------------------------------------------------------------
'                   åªç›ílâÊñ ï\é¶
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer
Dim wkint       As Integer
Dim wkDouble    As Double

Dim wkKUSATU    As Variant
Dim c           As String * 128

Dim wkBikou     As String

Dim INV_F       As Boolean

Dim CATE_ST_SEC As Long


Dim NEW_ITEM    As Integer          '2017.09.28

    Detail_Disp_Proc = True
    
    
    If Error_Check_Proc(ptxTanto_Code) Then
        Detail_Disp_Proc = False
        Exit Function
    End If
    
    
    'ïiñ⁄É}ÉXÉ^ì«Ç›çûÇ›
    Call UniCode_Conv(K0_ITEM.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM.HIN_GAI, Text1(ptxHin_Gai).Text)

    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound

            Text1(ptxHin_Name).Text = ""
            Text1(ptxST_SOKO).Text = ""
            Text1(ptxST_RETU).Text = ""
            Text1(ptxST_REN).Text = ""
            Text1(ptxST_DAN).Text = ""
            MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
            Detail_Disp_Proc = False
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
            Exit Function

    End Select
    
    
    
    
    '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2017.11.15
    If ITEM_O_RESET_PROC() Then
        Exit Function
    End If
    '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2017.11.15
    
    
    
    
    
    
    
    '>>>>>>>>>>ëÂç„éñ å©êœópïiñ⁄É}ÉXÉ^  ì«çûÇ›  2017.09.28
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)

    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "000")     '2017.11.08

    sts = BTRV(BtOpGetEqual, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
    Select Case sts
        Case BtNoErr
            NEW_ITEM = 0
        
        Case BtErrKeyNotFound

            NEW_ITEM = 1
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ëÂç„éñ å©êœópïiñ⁄É}ÉXÉ^")
            Exit Function

    End Select
    
    
'>>>>>>>>>>>>>  2017.09.27
    If NEW_ITEM = 1 Then
            
        Check1(0).Value = Print_FLG(0)
        Check1(1).Value = Print_FLG(1)
        Check1(2).Value = Print_FLG(2)
        Check1(3).Value = Print_FLG(3)
        Check1(4).Value = Print_FLG(4)
        Check1(5).Value = Print_FLG(5)
        Check1(6).Value = Print_FLG(6)
        Check1(7).Value = Print_FLG(7)
        Check1(8).Value = Print_FLG(8)
        Check1(9).Value = Print_FLG(9)
        Check1(10).Value = Print_FLG(10)
    
'>>>>>>>>>> 2017.10.20
    
        For i = ptxNAKANISHI_TANI To ptxKANRI_KIN
            Text1(i).Text = ""
        Next i
    
    
'>>>>>>>>>> 2017.10.20
    
    
    Else
        
        Check1(0).Value = Val(StrConv(ITEM_O_REC.NAKANISHI_F, vbUnicode))
        Check1(1).Value = Val(StrConv(ITEM_O_REC.SHOHIN_F, vbUnicode))
        Check1(2).Value = Val(StrConv(ITEM_O_REC.PF_KAKOU_F, vbUnicode))
        Check1(3).Value = Val(StrConv(ITEM_O_REC.PE_KAKOU_F, vbUnicode))
        Check1(4).Value = Val(StrConv(ITEM_O_REC.PE_SHIZAI_F, vbUnicode))
        Check1(5).Value = Val(StrConv(ITEM_O_REC.HINBAN_LABEL_F, vbUnicode))
        Check1(6).Value = Val(StrConv(ITEM_O_REC.KOUJI_SETSU_F, vbUnicode))
        Check1(7).Value = Val(StrConv(ITEM_O_REC.KONPOU_F, vbUnicode))
        Check1(8).Value = Val(StrConv(ITEM_O_REC.FUKU_SHIZAI_F, vbUnicode))
        Check1(9).Value = Val(StrConv(ITEM_O_REC.KONPOU_ASSY_F, vbUnicode))
        Check1(10).Value = Val(StrConv(ITEM_O_REC.KANRI_F, vbUnicode))
    
        
        Text1(ptxNAKANISHI_TANI).Text = StrConv(ITEM_O_REC.NAKANISHI_TANI, vbUnicode)       'íÜêºçHóøÅ@íPà 
                                                                                            'íÜêºçHóøÅ@ã‡äz
        Text1(ptxNAKANISHI_KIN).Text = Format(Val(StrConv(ITEM_O_REC.NAKANISHI_KIN, vbUnicode)), "#0")
            
        Text1(ptxSHOHIN_TANI).Text = StrConv(ITEM_O_REC.SHOHIN_TANI, vbUnicode)             'è§ïiâªçHóøÅ@íPà 
                                                                                            'è§ïiâªçHóøÅ@ã‡äz
        Text1(ptxSHOHIN_KIN).Text = Format(Val(StrConv(ITEM_O_REC.SHOHIN_KIN, vbUnicode)), "#0")
        
            
        Text1(ptxPF_KAKOU_TANI).Text = StrConv(ITEM_O_REC.PF_KAKOU_TANI, vbUnicode)         'PFâ¡çHÅ@íPà 
                                                                                            'PFâ¡çHÅ@ã‡äz
        Text1(ptxPF_KAKOU_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PF_KAKOU_KIN, vbUnicode)), "#0")
            
        Text1(ptxPE_KAKOU_TANI).Text = StrConv(ITEM_O_REC.PE_KAKOU_TANI, vbUnicode)         'PEâ¡çHÅ@íPà 
                                                                                            'PEâ¡çHÅ@ã‡äz
        Text1(ptxPE_KAKOU_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PE_KAKOU_KIN, vbUnicode)), "#0")
            
        Text1(ptxPE_SHIZAI_TANI).Text = StrConv(ITEM_O_REC.PE_SHIZAI_TANI, vbUnicode)       'PEéëçﬁÅ@íPà 
                                                                                            'PEéëçﬁÅ@ã‡äz
        Text1(ptxPE_SHIZAI_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PE_SHIZAI_KIN, vbUnicode)), "#0")
    
        Text1(ptxHINBAN_LABEL_TANI).Text = StrConv(ITEM_O_REC.HINBAN_LABEL_TANI, vbUnicode) 'ïiî‘ï\é¶◊ÕﬁŸÅ@íPà 
                                                                                            'ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz
        Text1(ptxHINBAN_LABEL_KIN).Text = Format(Val(StrConv(ITEM_O_REC.HINBAN_LABEL_KIN, vbUnicode)), "#0")
    
        Text1(ptxKOUJI_SETSU_TANI).Text = StrConv(ITEM_O_REC.KOUJI_SETSU_TANI, vbUnicode)   'ê›íuçHéñê‡ñæèëÅ@íPà 
                                                                                            'ê›íuçHéñê‡ñæèëÅ@ã‡äz
        Text1(ptxKOUJI_SETSU_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KOUJI_SETSU_KIN, vbUnicode)), "#0")
    
        Text1(ptxKONPOU_TANI).Text = StrConv(ITEM_O_REC.KONPOU_TANI, vbUnicode)             'ç´ïÔçﬁÅ@íPà 
                                                                                            'ç´ïÔçﬁÅ@ã‡äz
        Text1(ptxKONPOU_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_KIN, vbUnicode)), "#0")
    
        Text1(ptxFUKU_SHIZAI_TANI).Text = StrConv(ITEM_O_REC.FUKU_SHIZAI_TANI, vbUnicode)   'ïõéëçﬁÅ@íPà 
                                                                                            'ïõéëçﬁÅ@ã‡äz
        Text1(ptxFUKU_SHIZAI_KIN).Text = Format(Val(StrConv(ITEM_O_REC.FUKU_SHIZAI_KIN, vbUnicode)), "#0")
    
        Text1(ptxKONPOU_ASSY_TANI).Text = StrConv(ITEM_O_REC.KONPOU_ASSY_TANI, vbUnicode)   'ç´ïÔASSYÅ@íPà 
                                                                                            'ç´ïÔASSYÅ@ã‡äz
        Text1(ptxKONPOU_ASSY_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_ASSY_KIN, vbUnicode)), "#0")
    
        Text1(ptxKANRI_TANI).Text = StrConv(ITEM_O_REC.KANRI_TANI, vbUnicode)               'ä«óùîÔÅ@íPà 
                                                                                            'ä«óùîÔÅ@ã‡äz
        Text1(ptxKANRI_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KANRI_KIN, vbUnicode)), "#0")
    
    
    
                                                                                            'íÜêºçHóøÅ@íÒèoã‡äz
        Text1(ptxNAKANISHI_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.NAKANISHI_T_KIN, vbUnicode)), "#0")
                                                                                            'è§ïiâªçHóøÅ@íÒèoã‡äz
        Text1(ptxSHOHIN_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.SHOHIN_T_KIN, vbUnicode)), "#0")
                                                                                            'PFâ¡çHÅ@íÒèoã‡äz
        Text1(ptxPF_KAKOU_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PF_KAKOU_T_KIN, vbUnicode)), "#0")
                                                                                            'PEâ¡çHÅ@íÒèoã‡äz
        Text1(ptxPE_KAKOU_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PE_KAKOU_T_KIN, vbUnicode)), "#0")
                                                                                            'PEéëçﬁÅ@íÒèoã‡äz
        Text1(ptxPE_SHIZAI_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.PE_SHIZAI_T_KIN, vbUnicode)), "#0")
                                                                                            'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz
        Text1(ptxHINBAN_LABEL_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.HINBAN_LABEL_T_KIN, vbUnicode)), "#0")
                                                                                            'ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz
        Text1(ptxKOUJI_SETSU_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KOUJI_SETSU_T_KIN, vbUnicode)), "#0")
                                                                                            'ç´ïÔçﬁÅ@íÒèoã‡äz
        Text1(ptxKONPOU_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_T_KIN, vbUnicode)), "#0")
                                                                                            'ïõéëçﬁÅ@íÒèoã‡äz
        Text1(ptxFUKU_SHIZAI_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.FUKU_SHIZAI_T_KIN, vbUnicode)), "#0")
                                                                                            'ç´ïÔASSYÅ@íÒèoã‡äz
        Text1(ptxKONPOU_ASSY_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_ASSY_T_KIN, vbUnicode)), "#0")
                                                                                            'ä«óùîÔÅ@íÒèoã‡äz
        Text1(ptxKANRI_T_KIN).Text = Format(Val(StrConv(ITEM_O_REC.KANRI_T_KIN, vbUnicode)), "#0")
    
'>>>>>>>>>>>>>  ã‡äz--ÅÑíÒèoã‡äz    2017.07.08

'>>>>>>>>>>>>>  êîó /íÒèoíPâø        2017.11.08
                                                                                            'íÜêºçHóøÅ@êîó 
        Text1(ptxNAKANISHI_QTY).Text = Format(Val(StrConv(ITEM_O_REC.NAKANISHI_QTY, vbUnicode)), "#0.00")
                                                                                            'è§ïiâªçHóøÅ@êîó 
        Text1(ptxSHOHIN_QTY).Text = Format(Val(StrConv(ITEM_O_REC.SHOHIN_QTY, vbUnicode)), "#0.00")
                                                                                            'PFâ¡çHÅ@êîó 
        Text1(ptxPF_KAKOU_QTY).Text = Format(Val(StrConv(ITEM_O_REC.PF_KAKOU_QTY, vbUnicode)), "#0.00")
                                                                                            'PEâ¡çHÅ@êîó 
        Text1(ptxPE_KAKOU_QTY).Text = Format(Val(StrConv(ITEM_O_REC.PE_KAKOU_QTY, vbUnicode)), "#0.00")
                                                                                            'PEéëçﬁÅ@êîó 
        Text1(ptxPE_SHIZAI_QTY).Text = Format(Val(StrConv(ITEM_O_REC.PE_SHIZAI_QTY, vbUnicode)), "#0.00")
                                                                                            'ïiî‘ï\é¶◊ÕﬁŸÅ@êîó 
        Text1(ptxHINBAN_LABEL_QTY).Text = Format(Val(StrConv(ITEM_O_REC.HINBAN_LABEL_QTY, vbUnicode)), "#0.00")
                                                                                            'ê›íuçHéñê‡ñæèëÅ@êîó 
        Text1(ptxKOUJI_SETSU_QTY).Text = Format(Val(StrConv(ITEM_O_REC.KOUJI_SETSU_QTY, vbUnicode)), "#0.00")
                                                                                            'ç´ïÔçﬁÅ@êîó 
        Text1(ptxKONPOU_QTY).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_QTY, vbUnicode)), "#0.00")
                                                                                            'ïõéëçﬁÅ@êîó 
        Text1(ptxFUKU_SHIZAI_QTY).Text = Format(Val(StrConv(ITEM_O_REC.FUKU_SHIZAI_QTY, vbUnicode)), "#0.00")
                                                                                            'ç´ïÔASSYÅ@êîó 
        Text1(ptxKONPOU_ASSY_QTY).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_ASSY_QTY, vbUnicode)), "#0.00")
                                                                                            'ä«óùîÔÅ@êîó 
        Text1(ptxKANRI_QTY).Text = Format(Val(StrConv(ITEM_O_REC.KANRI_QTY, vbUnicode)), "#0.00")


                                                                                            'íÜêºçHóøÅ@íÒèoíPâø
        Text1(ptxNAKANISHI_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.NAKANISHI_T_TAN, vbUnicode)), "#0.00")
                                                                                            'è§ïiâªçHóøÅ@íÒèoíPâø
        Text1(ptxSHOHIN_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.SHOHIN_T_TAN, vbUnicode)), "#0.00")
                                                                                            'PFâ¡çHÅ@íÒèoíPâø
        Text1(ptxPF_KAKOU_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.PF_KAKOU_T_TAN, vbUnicode)), "#0.00")
                                                                                            'PEâ¡çHÅ@íÒèoíPâø
        Text1(ptxPE_KAKOU_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.PE_KAKOU_T_TAN, vbUnicode)), "#0.00")
                                                                                            'PEéëçﬁÅ@íÒèoíPâø
        Text1(ptxPE_SHIZAI_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.PE_SHIZAI_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoíPâø
        Text1(ptxHINBAN_LABEL_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.HINBAN_LABEL_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ê›íuçHéñê‡ñæèëÅ@íÒèoíPâø
        Text1(ptxKOUJI_SETSU_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.KOUJI_SETSU_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ç´ïÔçﬁÅ@íÒèoíPâø
        Text1(ptxKONPOU_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ïõéëçﬁÅ@íÒèoíPâø
        Text1(ptxFUKU_SHIZAI_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.FUKU_SHIZAI_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ç´ïÔASSYÅ@íÒèoíPâø
        Text1(ptxKONPOU_ASSY_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.KONPOU_ASSY_T_TAN, vbUnicode)), "#0.00")
                                                                                            'ä«óùîÔÅ@íÒèoíPâø
        Text1(ptxKANRI_T_TAN).Text = Format(Val(StrConv(ITEM_O_REC.KANRI_T_TAN, vbUnicode)), "#0.00")

'>>>>>>>>>>>>>  êîó /íÒèoíPâø        2017.11.08
    
    End If
    
    
    
    For i = 2 To 5      '2013.01.16 5-->6
        Command1(i).Enabled = True
    Next i
    
    
    'ïiñº
    Text1(ptxHin_Name).Text = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
        
    'ïWèÄíIî‘
    Text1(ptxST_SOKO).Text = StrConv(ITEMREC.ST_SOKO, vbUnicode)
    Text1(ptxST_RETU).Text = StrConv(ITEMREC.ST_RETU, vbUnicode)
    Text1(ptxST_REN).Text = StrConv(ITEMREC.ST_REN, vbUnicode)
    Text1(ptxST_DAN).Text = StrConv(ITEMREC.ST_DAN, vbUnicode)
    
    
    
    'çëì‡ãüãããÊï™   2017.07.08
'    Text1(ptxNAI_BUHIN).Text = Trim(StrConv(ITEMREC.NAI_BUHIN, vbUnicode))
    
    
    
    'ïiñºÉJÉeÉSÉäÉB
    Text1(ptxCATEGORY_CODE).Text = Trim(StrConv(ITEMREC.CATEGORY_CODE, vbUnicode))
    For i = 0 To Combo1(pcmbCATEGORY_Name).ListCount - 1
        If Trim(Text1(ptxCATEGORY_CODE).Text) = Trim(Right(Combo1(pcmbCATEGORY_Name).List(i), 8)) Then
            Text1(ptxCATEGORY_CODE).Text = Trim(Right(Combo1(pcmbCATEGORY_Name).List(i), 8))
            Combo1(pcmbCATEGORY_Name).ListIndex = i
            Exit For
        End If
    Next i
    If i > Combo1(pcmbCATEGORY_Name).ListCount - 1 Then
        Combo1(pcmbCATEGORY_Name).ListIndex = 0
    End If
    'å©êœèëîıçl
    wkBikou = Replace(StrConv(ITEMREC.M_BIKOU, vbUnicode), Chr(0), " ")
    RichTextBox1(prchM_BIKOU).Text = RTrim(wkBikou)
    
    'íPâøêÿë÷ì˙
    Text1(ptxTANKA_KIRIKAE_DT).Text = RTrim(StrConv(ITEMREC.TANKA_KIRIKAE_DT, vbUnicode))

'>>>>>>>>>>>>>  2017.09.27
    'ë≈êÿÇË
    If StrConv(ITEMREC.NAI_BUHIN, vbUnicode) = "3" Then
        Text1(ptxNAI_BUHIN) = "3"
    Else
        Text1(ptxNAI_BUHIN) = ""
    End If
    'ëOâÒíÒèoã‡äzçáåvÅ^çáåvã‡äz
    If NEW_ITEM = 0 Then
    
        lblZEN_T_GOUKEI_KIN = Format(Val(StrConv(ITEM_O_REC.GOUKEI_T_KIN, vbUnicode)), "#0")
        lblZEN_GOUKEI_KIN = Format(Val(StrConv(ITEM_O_REC.GOUKEI_KIN, vbUnicode)), "#0")
    Else                            '2017.10.20
        lblZEN_T_GOUKEI_KIN = "0"   '2017.10.20
        lblZEN_GOUKEI_KIN = "0"     '2017.10.20
    End If
'>>>>>>>>>>>>>  2017.09.27
        
        
    
    
    
    
    
    
    
    
    '-----------------------------------    ç\ê¨ïiï\é¶
    If P_COMPO_Disp_Proc() Then
        Exit Function
    End If
    

    
    
    

    If TANKA_KEISAN_Proc() Then
        Unload Me
    End If

    DoEvents

    If CLng(lblZEN_T_GOUKEI_KIN.Caption) <> CLng(lblGOUKEI_T_KIN.Caption) Then      '2107.11.13
        MsgBox "ëOâÒçáåvã‡äzÇ∆çáåvã‡äzÇ™àŸÇ»Ç¡ÇƒÇ¢Ç‹Ç∑ÅBñæç◊ì‡óeÇämîFÇµÇƒâ∫Ç≥Ç¢ÅB" '2107.11.13
    End If                                                                          '2107.11.13
    



    Detail_Disp_Proc = False

End Function

Private Function TANKA_KEISAN_Proc() As Integer

Dim i               As Integer
Dim j               As Integer

Dim wkKingaku       As Double
Dim wk_T_Kingaku    As Double


    TANKA_KEISAN_Proc = True
    
'    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
'    TDBGrid1(pGrdKOUSEI).ReBind
'    TDBGrid1(pGrdKOUSEI).Update
    
    wkKingaku = 0
    wk_T_Kingaku = 0
    
    For i = 1 To KOUSEI.UpperBound(1)
    
    Debug.Print Trim(KOUSEI(i, ColNO)) & Trim(KOUSEI(i, ColKO_T_HIN_NAME))
    
        If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) = "" And Trim(KOUSEI(i, ColKO_T_HIN_NAME)) = "" Then
            Exit For
        Else
            
            
            If IsNumeric(KOUSEI(i, ColG_KINGAKU)) Then
                wkKingaku = wkKingaku + Val(KOUSEI(i, ColG_KINGAKU))
            End If
            For j = 0 To UBound(Print_SYUBETSU)
            
                If Right(KOUSEI(i, ColKO_SYUBETSU), 2) = Print_SYUBETSU(j) Then
                    If IsNumeric(KOUSEI(i, ColKO_T_KINGAKU)) Then
                        wk_T_Kingaku = wk_T_Kingaku + Val(KOUSEI(i, ColKO_T_KINGAKU))
                        Exit For
                    End If
                End If
            Next j
        End If
    
    
    Next i
    
    
    For i = ptxNAKANISHI_KIN To ptxKANRI_KIN Step 2
        If IsNumeric(Text1(i).Text) Then
            wkKingaku = wkKingaku + Val(Text1(i).Text)
        End If
    Next i
    
    
    j = 8
    For i = chkNAKANISHI_F To chkKANRI_F
        j = j + 5
        If Check1(i).Value = 1 Then
            
            wk_T_Kingaku = wk_T_Kingaku + Val(Text1(j).Text)
        
        End If
    
    Next i
    
    
    lblGOUKEI_KIN.Caption = Format(wkKingaku, "#0")
    lblGOUKEI_T_KIN.Caption = Format(wk_T_Kingaku, "#0")
        
    
'    TDBGrid1(pGrdKOUSEI).ScrollBars = dbgAutomatic
    
    TANKA_KEISAN_Proc = False

End Function





Private Function Tanka_Update_Proc() As Integer
'----------------------------------------------------------------------------
'                   íPâøìoò^èàóù
'----------------------------------------------------------------------------
Dim sts     As Integer
Dim com     As Integer
    
Dim ans     As Integer
    
    Tanka_Update_Proc = True
    
    Text1(ptxHin_Gai).Text = Trim(StrConv(Text1(ptxHin_Gai).Text, vbUpperCase))
    
    Call UniCode_Conv(K0_ITEM.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM.HIN_GAI, Text1(ptxHin_Gai).Text)


    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                        
                Exit Do
            
            Case BtErrKeyNotFound
    
                Text1(ptxHin_Name).Text = ""
    
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                Unload Me
                Exit Do
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            
            
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                Exit Function
    
        End Select
    Loop
        
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, StrConv(ITEMREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, StrConv(ITEMREC.NAIGAI, vbUnicode))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, StrConv(ITEMREC.HIN_GAI, vbUnicode))
    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "000")
        
    Do
    
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            
        Select Case sts
            Case BtNoErr
                com = BtOpUpdate
            
                Exit Do
                            
            Case BtErrKeyNotFound
                
                com = BtOpInsert
            
                Call Rclr_ITEM_O_REC
            
                Exit Do
            
            
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM_O.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select

    Loop
    
    Call UniCode_Conv(ITEM_O_REC.JGYOBU, StrConv(ITEMREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(ITEM_O_REC.NAIGAI, StrConv(ITEMREC.NAIGAI, vbUnicode))
    Call UniCode_Conv(ITEM_O_REC.HIN_GAI, StrConv(ITEMREC.HIN_GAI, vbUnicode))
    
    
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_TANI, Text1(ptxNAKANISHI_TANI).Text) 'íÜêºçHóøÅ@íPà 
    If IsNumeric(Text1(ptxNAKANISHI_KIN).Text) Then                                'íÜêºçHóøÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.NAKANISHI_KIN, Format(CDbl(Text1(ptxNAKANISHI_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.NAKANISHI_KIN, "00000000.00")
    End If
    
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_TANI, Text1(ptxSHOHIN_TANI).Text)       'íÜêºçHóøÅ@íPà 
    If IsNumeric(Text1(ptxSHOHIN_KIN).Text) Then                                'íÜêºçHóøÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.SHOHIN_KIN, Format(CDbl(Text1(ptxSHOHIN_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.SHOHIN_KIN, "00000000.00")
    End If
    
    
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_TANI, Text1(ptxPF_KAKOU_TANI).Text)   'PFâ¡çHÅ@íPà 
    If IsNumeric(Text1(ptxPF_KAKOU_KIN).Text) Then                              'PFâ¡çHÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_KIN, Format(CDbl(Text1(ptxPF_KAKOU_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_KIN, "00000000.00")
    End If
    
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_TANI, Text1(ptxPE_KAKOU_TANI).Text)   'PEâ¡çHÅ@íPà 
    If IsNumeric(Text1(ptxPE_KAKOU_KIN).Text) Then                              'PEâ¡çHÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_KIN, Format(CDbl(Text1(ptxPE_KAKOU_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_KIN, "00000000.00")
    End If
    
    
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_TANI, Text1(ptxPE_SHIZAI_TANI).Text) 'PEéëçﬁÅ@íPà 
    If IsNumeric(Text1(ptxPE_SHIZAI_KIN).Text) Then                             'PEéëçﬁÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_KIN, Format(CDbl(Text1(ptxPE_SHIZAI_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_KIN, "00000000.00")
    End If
    
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_TANI, Text1(ptxHINBAN_LABEL_TANI).Text)   'ïiî‘ï\é¶◊ÕﬁŸÅ@íPà 
    If IsNumeric(Text1(ptxHINBAN_LABEL_KIN).Text) Then                                  'ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_KIN, Format(CDbl(Text1(ptxHINBAN_LABEL_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_KIN, "00000000.00")
    End If
    
    
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_TANI, Text1(ptxKOUJI_SETSU_TANI).Text)     'ê›íuçHéñê‡ñæèëÅ@íPà 
    If IsNumeric(Text1(ptxKOUJI_SETSU_KIN).Text) Then                                   'ê›íuçHéñê‡ñæèëÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_KIN, Format(CDbl(Text1(ptxKOUJI_SETSU_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_KIN, "00000000.00")
    End If
    
    Call UniCode_Conv(ITEM_O_REC.KONPOU_TANI, Text1(ptxKONPOU_TANI).Text)       'ç´ïÔçﬁÅ@íPà 
    If IsNumeric(Text1(ptxKONPOU_KIN).Text) Then                                'ç´ïÔçﬁÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.KONPOU_KIN, Format(CDbl(Text1(ptxKONPOU_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.KONPOU_KIN, "00000000.00")
    End If
    
    
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_TANI, Text1(ptxFUKU_SHIZAI_TANI).Text) 'ïõéëçﬁÅ@íPà 
    If IsNumeric(Text1(ptxFUKU_SHIZAI_KIN).Text) Then                               'ïõéëçﬁÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_KIN, Format(CDbl(Text1(ptxFUKU_SHIZAI_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_KIN, "00000000.00")
    End If

    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_TANI, Text1(ptxKONPOU_ASSY_TANI).Text) 'ç´ïÔASSYÅ@íPà 
    If IsNumeric(Text1(ptxKONPOU_ASSY_KIN).Text) Then                               'ç´ïÔASSYÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_KIN, Format(CDbl(Text1(ptxKONPOU_ASSY_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_KIN, "00000000.00")
    End If


    Call UniCode_Conv(ITEM_O_REC.KANRI_TANI, Text1(ptxKANRI_TANI).Text)     'ç´ïÔASSYÅ@íPà 
    If IsNumeric(Text1(ptxKANRI_KIN).Text) Then                             'ç´ïÔASSYÅ@ã‡äz
        Call UniCode_Conv(ITEM_O_REC.KANRI_KIN, Format(CDbl(Text1(ptxKANRI_KIN).Text), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.KANRI_KIN, "00000000.00")
    End If


    If IsNumeric(lblGOUKEI_KIN.Caption) Then                                'çáåvã‡äz
        Call UniCode_Conv(ITEM_O_REC.GOUKEI_KIN, Format(CDbl(lblGOUKEI_KIN.Caption), "00000000.00"))
    Else
        Call UniCode_Conv(ITEM_O_REC.GOUKEI_KIN, "00000000.00")
    End If
                                                                            'íSìñé“∫∞ƒﬁ
    Call UniCode_Conv(ITEM_O_REC.INPUT_TANTO_CODE, Text1(ptxTanto_Code).Text)


    If com = BtOpInsert Then
        Call UniCode_Conv(ITEM_O_REC.INS_TANTO, "SEI16")
        Call UniCode_Conv(ITEM_O_REC.Ins_DateTime, Format(Now, "YYYYMMDDHHMMSS"))
    Else
        Call UniCode_Conv(ITEM_O_REC.UPD_TANTO, "SEI16")
        Call UniCode_Conv(ITEM_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
    End If


    Do
    
        sts = BTRV(com, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            
        Select Case sts
            Case BtNoErr
            
                Exit Do
                            
            
            
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM_O.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            Case Else
                Call File_Error(sts, com, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select

    Loop


    
    'å©êœèëîıçl
    Call UniCode_Conv(ITEMREC.M_BIKOU, RichTextBox1(prchM_BIKOU).Text)


    Do
        sts = BTRV(BtOpUpdate, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
            
                Exit Do
            
            Case BtErrKeyNotFound
    
                Text1(ptxHin_Name).Text = ""
    
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                Text1(ptxHin_Gai).SetFocus
                Exit Do
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            
            
            Case Else
                Call File_Error(sts, BtOpUpdate, "ïiñ⁄É}ÉXÉ^")
                Exit Function
    
        End Select
    Loop



    Tanka_Update_Proc = False


End Function

Private Function Grid_Error_Check_Proc() As Integer
'----------------------------------------------------------------------------
'                   ∏ﬁÿØƒﬁì‡óeÇÃÉGÉâÅ[É`ÉFÉbÉNèàóù
'----------------------------------------------------------------------------
Dim i               As Long

Dim sts             As Integer
    
Dim j               As Long
    
    
Dim NEW_ITEM        As Integer          '2017.09.28
    
    
    
    
    Grid_Error_Check_Proc = True
    
    
    
    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    
    
   TDBGrid1(pGrdKOUSEI).Update
    
    
    For i = 1 To KOUSEI.UpperBound(1)
        ' éwê}ï[ïiî‘ÇÃçÌèú
        If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) = "" And Trim(KOUSEI(i, ColKO_T_HIN_NAME)) = "" Then
            
            KOUSEI(i, ColKO_SYUBETSU) = ""
            KOUSEI(i, ColKO_JGYOBU) = ""
            KOUSEI(i, ColKO_S_HIN_GAI) = ""
            KOUSEI(i, ColKO_HIN_NAME) = ""

            KOUSEI(i, ColKO_T_HIN_NAME) = ""        '2017.09.28

            KOUSEI(i, ColKO_QTY) = ""

            KOUSEI(i, ColKO_TANI) = ""              '2017.09.28
            KOUSEI(i, ColKO_T_TANKA) = ""           '2017.09.28
            KOUSEI(i, ColKO_T_KINGAKU) = ""         '2017.09.28


            KOUSEI(i, ColG_ST_SHITAN) = ""
            KOUSEI(i, ColG_ST_URITAN) = ""

            KOUSEI(i, ColG_KINGAKU) = ""
'
'            KOUSEI(i, ColKO_UMU) = ""  2017.09.28

        Else
            'ïiî‘
            Call UniCode_Conv(K0_ITEM.JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))
            Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)
            Call UniCode_Conv(K0_ITEM.HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))
    
    
            sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            Select Case sts
                Case BtNoErr
                    KOUSEI(i, ColKO_HIN_NAME) = Trim(StrConv(ITEMREC.HIN_NAME, vbUnicode))
                    If KOUSEI(i, ColG_ST_SHITAN) = "" Then
                    
                        If IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then
                            KOUSEI(i, ColG_ST_SHITAN) = Format(CDbl(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)), "#0.00")
                        Else
                            KOUSEI(i, ColG_ST_SHITAN) = Format(CDbl(0), "#0.00")
                        End If
                    End If
                
                    If KOUSEI(i, ColG_ST_URITAN) = "" Then
                    
                        If IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
                            KOUSEI(i, ColG_ST_URITAN) = Format(CDbl(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)), "#0.00")
                        Else
                            KOUSEI(i, ColG_ST_URITAN) = Format(CDbl(0), "#0.00")
                        End If
                    End If
                
                
                    '>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^    2017.09.28
                    'Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
                    'Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
                    'Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
                    '
                    'Call UniCode_Conv(K0_ITEM_O.SEQ_NO, KOUSEI(i, ColNO))
                    '
                    '
                    'sts = BTRV(BtOpGetEqual, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    'Select Case sts
                    '    Case BtNoErr
                    '        NEW_ITEM = 0
                    '    Case BtErrKeyNotFound
                    '        NEW_ITEM = 1
                    '    Case Else
                    '        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄œΩ¿")
                    '        Exit Function
                    'End Select
                    '>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^    2017.09.28
                
                
                Case BtErrKeyNotFound
                    
                        If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) = "" Then           '2017.11.14
                        Else
                        
                            If HIN_INV Then
                                'ñ¢ìoò^ïiî‘Å@â¬Å@éëçﬁÇ∆ÇµÇƒÇ®Ç≠
                                KOUSEI(i, ColKO_HIN_NAME) = "ñ¢ìoò^ïiî‘"
                            Else
                                MsgBox "[" & Format(i, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                                Exit Function
                            End If
                        End If
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄œΩ¿")
                    Exit Function
            End Select
                
                
                
            '>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^    2017.09.28
            Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
            Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
            Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
                
            Call UniCode_Conv(K0_ITEM_O.SEQ_NO, KOUSEI(i, ColNO))
                
                
            sts = BTRV(BtOpGetEqual, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            Select Case sts
                Case BtNoErr
                    NEW_ITEM = 0
                Case BtErrKeyNotFound
                    NEW_ITEM = 1
                Case Else
                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄œΩ¿")
                    Exit Function
            End Select
            '>>>>>>>>>>>>>>>    ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^    2017.09.28
                
                            
                            
                
                
                
                
                'àıêî
            If IsNumeric(KOUSEI(i, ColKO_QTY)) Then
                KOUSEI(i, ColKO_QTY) = Format(CDbl(KOUSEI(i, ColKO_QTY)), "#0.00")
            Else
                MsgBox "[" & Format(i, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(àıêî)"
                Exit Function
            End If
                
                
                
                'íÒèoíPâø   Åf2017.09.28
            If KOUSEI(i, ColKO_T_TANKA) = "" Then
                KOUSEI(i, ColKO_T_TANKA) = "0"
            End If
            If IsNumeric(KOUSEI(i, ColKO_T_TANKA)) Then
                
                KOUSEI(i, ColKO_T_TANKA) = Format(CDbl(KOUSEI(i, ColKO_T_TANKA)), "#0.00")
            
                KOUSEI(i, ColKO_T_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(i, ColKO_QTY)) * CCur(KOUSEI(i, ColKO_T_TANKA))), 2)
            
                                
            
            Else
                MsgBox "[" & Format(i, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(íÒèoíPâø)"
                Exit Function
            End If
                
                
                'édì¸Åó
            If Trim(KOUSEI(i, ColG_ST_SHITAN)) = "" Then
                KOUSEI(i, ColG_ST_SHITAN) = "0.00"
            End If
            If IsNumeric(KOUSEI(i, ColG_ST_SHITAN)) Then
                KOUSEI(i, ColG_ST_SHITAN) = Format(CDbl(KOUSEI(i, ColG_ST_SHITAN)), "#0.00")
            Else
                MsgBox "[" & Format(i, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(édì¸íPâø)"
                Exit Function
            End If
                'îÃîÑÅó
            If Trim(KOUSEI(i, ColG_ST_URITAN)) = "" Then
                KOUSEI(i, ColG_ST_URITAN) = "0.00"
            End If
            
            If IsNumeric(KOUSEI(i, ColG_ST_URITAN)) Then
                KOUSEI(i, ColG_ST_URITAN) = Format(CDbl(KOUSEI(i, ColG_ST_URITAN)), "#0.00")
            Else
                MsgBox "[" & Format(i, "0") & "]çsñ⁄ ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(îÃîÑíPâø)"
                Exit Function
            End If
    
            'çáåvã‡äz
            KOUSEI(i, ColG_KINGAKU) = ToHalfAdjust(CCur(CCur(KOUSEI(i, ColKO_QTY)) * CCur(KOUSEI(i, ColG_ST_URITAN))), 2)
    
    
        End If
    
    
    
    
    
    Next i
    
    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    

'    TDBGrid1(pGrdKOUSEI).Refresh
    TDBGrid1(pGrdKOUSEI).Update

    TDBGrid1(pGrdKOUSEI).SetFocus
    
    
    

    Grid_Error_Check_Proc = False



End Function
Private Function Update_Proc() As Integer
'----------------------------------------------------------------------------
'                   ç\ê¨É}ÉXÉ^èoóÕ
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer
Dim ans         As Integer


Dim i           As Integer
Dim j           As Integer

Dim MESG        As String

Dim D_SEQNO     As Integer


Dim NEW_ITEM    As Integer          '2017.09.28
Dim upd_com     As Integer          '2017.09.28


    Update_Proc = True
                                        
    Call Input_Lock
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
        Exit Function
    End If
    
    
    
    
    
    
    
    
    'ïiñ⁄É}ÉXÉ^Å@ÅiêeÅj
                                                                                'éñã∆ïî
    Call UniCode_Conv(K0_ITEM.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                                                                                'çëì‡äO
    Call UniCode_Conv(K0_ITEM.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
    Call UniCode_Conv(K0_ITEM.HIN_GAI, Text1(ptxHin_Gai).Text)
    
    Do
    
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrKeyNotFound
            
                ans = MsgBox("ÉfÅ[É^ì‡óeÇ™ïœçXÇ≥ÇÍÇƒÇ¢Ç‹Ç∑ÅBämîFÇµÇƒâ∫Ç≥Ç¢ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    GoTo Abort_Tran
                End If
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    GoTo Abort_Tran
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ç\ê¨É}ÉXÉ^")
                GoTo Abort_Tran
        End Select

    Loop
    'ÉJÉeÉSÉä
    Call UniCode_Conv(ITEMREC.CATEGORY_CODE, Text1(ptxCATEGORY_CODE).Text)
    'å©êœèëîıçl
    Call UniCode_Conv(ITEMREC.M_BIKOU, RichTextBox1(prchM_BIKOU).Text)
    'çëì‡ãüãããÊï™           Åf2017.09.28
    Call UniCode_Conv(ITEMREC.NAI_BUHIN, Text1(ptxNAI_BUHIN).Text)

    Call UniCode_Conv(ITEM_O_REC.UPD_TANTO, "SEI16")
    Call UniCode_Conv(ITEM_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))

    Do
        sts = BTRV(BtOpUpdate, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
            
                Exit Do
            
            Case BtErrKeyNotFound
    
                Text1(ptxHin_Name).Text = ""
    
                MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅB(ïiî‘)"
                Text1(ptxHin_Gai).SetFocus
                Exit Do
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            
            
            Case Else
                Call File_Error(sts, BtOpUpdate, "ïiñ⁄É}ÉXÉ^")
                Exit Function
    
        End Select
    Loop


    
    
        
    
    '---------------------------------------------------    'ç\ê¨É}ÉXÉ^çXêV
    'äYìñÉfÅ[É^ëSåèçÌèú
    Call UniCode_Conv(K0_P_COMPO.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2))
    Call UniCode_Conv(K0_P_COMPO.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_P_COMPO.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_P_COMPO.HIN_GAI, Text1(ptxHin_Gai).Text)
       
    Call UniCode_Conv(K0_P_COMPO.DATA_KBN, "")
    Call UniCode_Conv(K0_P_COMPO.SEQNO, "")
       
    com = BtOpGetGreater
       
    Do
        
        DoEvents
        
        Do
        
            sts = BTRV(com + BtSNoWait, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                
            Select Case sts
                Case BtNoErr
                
                    If StrConv(P_COMPO_O_REC.SHIMUKE_CODE, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 1, 2) Or _
                        StrConv(P_COMPO_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                        StrConv(P_COMPO_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                        Trim(StrConv(P_COMPO_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                        sts = BTRV(BtOpUnlock, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ç\ê¨É}ÉXÉ^")
                            GoTo Abort_Tran
                        End If
                        sts = BtErrEOF
                    End If
                    Exit Do
                Case BtErrEOF
                    Exit Do
                
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        GoTo Abort_Tran
                    End If
                Case Else
                    Call File_Error(sts, com + BtSNoWait, "ç\ê¨É}ÉXÉ^")
                    GoTo Abort_Tran
            End Select
    
        Loop
            
        If sts = BtErrEOF Then
            Exit Do
        End If


        Do
            sts = BTRV(BtOpDelete, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
            Select Case sts
                Case BtNoErr
                
                    Exit Do
                Case BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        sts = BTRV(BtOpUnlock, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ç\ê¨É}ÉXÉ^")
                        End If
                        GoTo Abort_Tran
                    End If
                
                
                Case Else
                    Call File_Error(sts, BtOpDelete, "ç\ê¨É}ÉXÉ^")
                    GoTo Abort_Tran
            End Select
        Loop
    
        com = BtOpGetNext
    
    Loop




    'ç\ê¨É}ÉXÉ^(ÕØ¿ﬁ∞)èoóÕ
                                                                                'édå¸ÇØêÊ∫∞ƒﬁ
    Call UniCode_Conv(P_COMPO_O_REC.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 1, 2))
                                                                                'éñã∆ïî
    Call UniCode_Conv(P_COMPO_O_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                                                                                'çëì‡äO
    Call UniCode_Conv(P_COMPO_O_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
    Call UniCode_Conv(P_COMPO_O_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
    Call UniCode_Conv(P_COMPO_O_REC.DATA_KBN, P_HEAD)
    Call UniCode_Conv(P_COMPO_O_REC.SEQNO, "000")

    Call UniCode_Conv(P_COMPO_O_REC.CLASS_CODE, Text1(ptxS_CLASS_CODE).Text)    '∏◊Ω∫∞ƒﬁ
    Call UniCode_Conv(P_COMPO_O_REC.BIKOU, RichTextBox1(prchBIKOU).Text)        'îıçl
    
    Call UniCode_Conv(P_COMPO_O_REC.F_CLASS_CODE, Text1(ptxF_CLASS_CODE).Text)  'ïtâ¡∫∞ƒﬁ
    
    Call UniCode_Conv(P_COMPO_O_REC.N_CLASS_CODE, Text1(ptxN_CLASS_CODE).Text)  'ì‡êE∫∞ƒﬁ
    
    Call UniCode_Conv(P_COMPO_O_REC.FILLER, "")

    Call UniCode_Conv(P_COMPO_O_REC.UPD_TANTO, "SEI16")            'çXêVíSìñé“∫∞ƒﬁ
                                                                                'çXêVì˙éû
    Call UniCode_Conv(P_COMPO_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))


    Do
        
        DoEvents
        
        sts = BTRV(BtOpInsert, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_COMPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    GoTo Abort_Tran
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^")
                GoTo Abort_Tran
        End Select
    
    Loop

    'ç\ê¨É}ÉXÉ^(Œﬁ√ﬁ®)èoóÕ
    
    Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    TDBGrid1(pGrdKOUSEI).ReBind
    TDBGrid1(pGrdKOUSEI).Update


    D_SEQNO = 0


    If TDBGrid1(pGrdKOUSEI).ApproxCount = 0 Then

    Else


        For i = 1 To KOUSEI.UpperBound(1)
    
    
            If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) = "" Then
            Else
                                                                                            'édå¸ÇØêÊ∫∞ƒﬁ
                Call UniCode_Conv(P_COMPO_K_REC.SHIMUKE_CODE, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 1, 2))
                                                                                            'éñã∆ïî
                Call UniCode_Conv(P_COMPO_K_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                                                                                            'çëì‡äO
                Call UniCode_Conv(P_COMPO_K_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
                Call UniCode_Conv(P_COMPO_K_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
            
            
            
                
        
                Call UniCode_Conv(P_COMPO_K_REC.DATA_KBN, P_DOUKON)             'ÉfÅ[É^ãÊï™
                        
                D_SEQNO = D_SEQNO + 10
                        
                Call UniCode_Conv(P_COMPO_K_REC.SEQNO, Format(D_SEQNO, "000"))  'í«î‘
                                                                                'éÌï 
                Call UniCode_Conv(P_COMPO_K_REC.KO_SYUBETSU, Right(KOUSEI(i, ColKO_SYUBETSU), 2))
            
                                                                                            'éqÅ@éñã∆ïî
                Call UniCode_Conv(P_COMPO_K_REC.KO_JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))
                Call UniCode_Conv(P_COMPO_K_REC.KO_NAIGAI, NAIGAI_NAI)                      'éqÅ@çëì‡äO
                Call UniCode_Conv(P_COMPO_K_REC.KO_HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))     'éqÅ@ïiî‘
                                                                                            'àıêî
                Call UniCode_Conv(P_COMPO_K_REC.KO_QTY, Format(CDbl(KOUSEI(i, ColKO_QTY)), "000.00"))
            
                Call UniCode_Conv(P_COMPO_K_REC.FILLER, "")
            
                Call UniCode_Conv(P_COMPO_K_REC.UPD_TANTO, "SEI16")                         'çXêVíSìñé“∫∞ƒﬁ
                                                                                            'çXêVì˙éû
                Call UniCode_Conv(P_COMPO_K_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
            
'>>>>>>>>>  2017.11.29
'                Call UniCode_Conv(K0_ITEM.JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1)) 'éñã∆ïî
'                Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)                        'çëì‡äO
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))       'ïiî‘
'
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'
'                Select Case sts
'                    Case BtNoErr
'                    Case BtErrKeyNotFound
'                        Call UniCode_Conv(ITEMREC.HIN_NAME, "")
'                    Case Else
'                        Call File_Error(sts, com + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
'                        GoTo Abort_Tran
'               End Select
    
                Call UniCode_Conv(P_COMPO_K_REC.KO_BIKOU, KOUSEI(i, ColKO_HIN_NAME))
    
'>>>>>>>>>  2017.11.29
            
            
            
            
                Do
                    
                    DoEvents
                    
                    sts = BTRV(BtOpInsert, P_COMPO_POS, P_COMPO_K_REC, Len(P_COMPO_K_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                            Beep
                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_COMPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                            If ans = vbCancel Then
                                GoTo Abort_Tran
                            End If
                        Case Else
                            Call File_Error(sts, BtOpInsert, "ç\ê¨É}ÉXÉ^")
                            GoTo Abort_Tran
                    End Select
                
                Loop
    
    
                If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) <> "" Then      '2017.11.15
                    '>>>>>>>>>>>>>  ïiñ⁄íPâøÅ@çXêV
                    Call UniCode_Conv(K0_ITEM.JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1)) 'éñã∆ïî
                    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)                        'çëì‡äO
                    Call UniCode_Conv(K0_ITEM.HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))       'ïiî‘
        
                    Do
                        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrKeyNotFound
                                Beep
                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^Ç™ïœçXÇ≥ÇÍÇ‹ÇµÇΩÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                                GoTo Abort_Tran
                    
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                                Beep
                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                                If ans = vbCancel Then
                                    GoTo Abort_Tran
                                End If
                            Case Else
                                Call File_Error(sts, com + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                                GoTo Abort_Tran
                       End Select
        
                    Loop
        
                    If Not IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then
                        Call UniCode_Conv(ITEMREC.G_ST_SHITAN, "00000000.00")
                    End If
                    If Not IsNumeric(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) Then
                        Call UniCode_Conv(ITEMREC.G_ST_URITAN, "00000000.00")
                    End If
        
        
        
                    If CDbl(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) <> CDbl(KOUSEI(i, ColG_ST_SHITAN)) Then
                        Call UniCode_Conv(ITEMREC.G_ST_SHITAN, Format(CDbl(KOUSEI(i, ColG_ST_SHITAN)), "00000000.00"))
                        Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, Format(Now, "YYYY/MM/DD"))
                                        
                        Call UniCode_Conv(ITEMREC.UPD_TANTO, "SEI16")
                        Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, Format(Now, "YYYYMMDDHHMMSS"))
        
                    End If
        
        
                    If CDbl(StrConv(ITEMREC.G_ST_URITAN, vbUnicode)) <> CDbl(KOUSEI(i, ColG_ST_URITAN)) Then
                        Call UniCode_Conv(ITEMREC.G_ST_URITAN, Format(CDbl(KOUSEI(i, ColG_ST_URITAN)), "00000000.00"))
                        Call UniCode_Conv(ITEMREC.G_ST_URITAN_DT, Format(Now, "YYYY/MM/DD"))
                                        
                        Call UniCode_Conv(ITEMREC.UPD_TANTO, "SEI16")
                        Call UniCode_Conv(ITEMREC.G_ST_SHITAN_DT, Format(Now, "YYYYMMDDHHMMSS"))
        
                    End If
        
                    
                    'å©êœèëîıçl
    '                Call UniCode_Conv(ITEMREC.M_BIKOU, RichTextBox1(prchM_BIKOU).Text)
                    
                    
                    
                    Do
                        sts = BTRV(BtOpUpdate, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                    
                            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                                Beep
                                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                                If ans = vbCancel Then
                                    GoTo Abort_Tran
                                End If
                            Case Else
                                Call File_Error(sts, com + BtSNoWait, "ïiñ⁄É}ÉXÉ^")
                                GoTo Abort_Tran
                       End Select
        
                    Loop
                End If
    
    
    
    
    
    
    
    
    
    
            End If
        Next i
    End If





'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2017.09.28  >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>





    '---------------------------------------------------    'ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^  äYìñÉfÅ[É^ëSåèçÌèú
    'äYìñÉfÅ[É^ëSåèçÌèú
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
       
    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "")
       
    com = BtOpGetGreaterEqual
       
    Do
        
        DoEvents
        
        Do
        
            sts = BTRV(com + BtSNoWait, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                
            Select Case sts
                Case BtNoErr
                
                        If StrConv(ITEM_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                           StrConv(ITEM_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                                Trim(StrConv(ITEM_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                        sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                            GoTo Abort_Tran
                        End If
                        sts = BtErrEOF
                    End If
                    Exit Do
                Case BtErrEOF
                    Exit Do
                
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM_O.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        GoTo Abort_Tran
                    End If
                Case Else
                    Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    
                    GoTo Abort_Tran
            End Select
    
        Loop
            
        If sts = BtErrEOF Then
            Exit Do
        End If





        Do
            sts = BTRV(BtOpDelete, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            Select Case sts
                Case BtNoErr
                
                    Exit Do
                Case BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        End If
                        GoTo Abort_Tran
                    End If
                
                
                Case Else
                    Call File_Error(sts, BtOpDelete, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    GoTo Abort_Tran
            End Select
        Loop
    
        com = BtOpGetNext
    
    Loop




    '---------------------------------------------------    'ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^ ÉwÉbÉ_Å[èoóÕ
    
    
    Call Rclr_ITEM_O_REC
    
    Call UniCode_Conv(ITEM_O_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
    Call UniCode_Conv(ITEM_O_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
    Call UniCode_Conv(ITEM_O_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
    Call UniCode_Conv(ITEM_O_REC.SEQ_NO, "000")
    
    
    Call UniCode_Conv(ITEM_O_REC.KO_JGYOBU, "")
    Call UniCode_Conv(ITEM_O_REC.KO_NAIGAI, "")
    Call UniCode_Conv(ITEM_O_REC.KO_HIN_GAI, "")
    
    
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_TANI, Text1(ptxNAKANISHI_TANI).Text)         'íÜêºçHóøÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_KIN, Text1(ptxNAKANISHI_KIN).Text)           'íÜêºçHóøÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.SHOHIN_TANI, Text1(ptxSHOHIN_TANI).Text)               'è§ïiâªçHóøÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_KIN, Text1(ptxSHOHIN_KIN).Text)                 'è§ïiâªçHóøÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_TANI, Text1(ptxPF_KAKOU_TANI).Text)           'PFâ¡çHÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_KIN, Text1(ptxPF_KAKOU_KIN).Text)            'PFâ¡çHÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_TANI, Text1(ptxPF_KAKOU_TANI).Text)           'PEâ¡çHÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_KIN, Text1(ptxPE_KAKOU_KIN).Text)             'PEâ¡çHÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_TANI, Text1(ptxPE_SHIZAI_TANI).Text)         'PFéëçﬁÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_KIN, Text1(ptxPE_SHIZAI_KIN).Text)           'PFéëçﬁÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_TANI, Text1(ptxHINBAN_LABEL_TANI).Text)   'ïiî‘ï\é¶◊ÕﬁŸÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_KIN, Text1(ptxHINBAN_LABEL_KIN).Text)     'ïiî‘ï\é¶◊ÕﬁŸÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_TANI, Text1(ptxKOUJI_SETSU_TANI).Text)     'ê›íuçHéñê‡ñæèëÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_KIN, Text1(ptxKOUJI_SETSU_KIN).Text)       'ê›íuçHéñê‡ñæèëÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.KONPOU_TANI, Text1(ptxKONPOU_TANI).Text)               'ç´ïÔçﬁÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.KONPOU_KIN, Text1(ptxKONPOU_KIN).Text)                 'ç´ïÔçﬁÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_TANI, Text1(ptxFUKU_SHIZAI_TANI).Text)     'ïõéëçﬁÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_KIN, Text1(ptxFUKU_SHIZAI_KIN).Text)       'ïõéëçﬁÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_TANI, Text1(ptxKONPOU_ASSY_TANI).Text)     'ç´ïÔASSYÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_KIN, Text1(ptxKONPOU_ASSY_KIN).Text)       'ç´ïÔASSYÅ@ã‡äz

    Call UniCode_Conv(ITEM_O_REC.KANRI_TANI, Text1(ptxKANRI_TANI).Text)                 'ä«óùîÔÅ@íPà 
    Call UniCode_Conv(ITEM_O_REC.KANRI_KIN, Text1(ptxKANRI_KIN).Text)                   'ä«óùîÔÅ@ã‡äz
    
    Call UniCode_Conv(ITEM_O_REC.GOUKEI_KIN, CLng(lblGOUKEI_KIN.Caption))               'çáåvÅ@ã‡äz
    Call UniCode_Conv(ITEM_O_REC.INPUT_TANTO_CODE, Text1(ptxTanto_Code).Text)           'ì¸óÕíSìñé“∫∞ƒﬁ

    
    Call UniCode_Conv(ITEM_O_REC.BUZAI_TANTO_NAME, Text1(ptxBuzai_Tanto_Name).Text)     'ïîçﬁíSìñé“ñº
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_T_KIN, Text1(ptxNAKANISHI_T_KIN).Text)       'íÜêºçHóøÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_T_KIN, Text1(ptxSHOHIN_T_KIN).Text)             'è§ïiâªçHóøÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_T_KIN, Text1(ptxPF_KAKOU_T_KIN).Text)         'PFâ¡çHÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_T_KIN, Text1(ptxPE_KAKOU_T_KIN).Text)         'PEâ¡çHÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_T_KIN, Text1(ptxPE_SHIZAI_T_KIN).Text)       'PFéëçﬁÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_T_KIN, Text1(ptxHINBAN_LABEL_T_KIN).Text) 'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_T_KIN, Text1(ptxKOUJI_SETSU_T_KIN).Text)   'ê›íuçHéñê‡ñæèëÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.KONPOU_T_KIN, Text1(ptxKONPOU_T_KIN).Text)             'ç´ïÔçﬁÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_T_KIN, Text1(ptxFUKU_SHIZAI_T_KIN).Text)   'ïõéëçﬁÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_T_KIN, Text1(ptxKONPOU_ASSY_T_KIN).Text)   'ç´ïÔASSYÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.KANRI_T_KIN, Text1(ptxKANRI_T_KIN).Text)               'ä«óùîÔÅ@íÒèoã‡äz
    Call UniCode_Conv(ITEM_O_REC.GOUKEI_T_KIN, CLng(lblGOUKEI_T_KIN.Caption))           'íÒèoçáåvã‡äz

    
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_F, Check1(chkNAKANISHI_F).Value)             'íÜêºçHóø å©êœèëï\é¶Ã◊∏
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_F, Check1(chkSHOHIN_F).Value)                   'è§ïiâªçHóø å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_F, Check1(chkPF_KAKOU_F).Value)               'PFâ¡çH å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_F, Check1(chkPE_KAKOU_F).Value)               'PEâ¡çH å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_F, Check1(chkPE_SHIZAI_F).Value)             'PFéëçﬁ å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_F, Check1(chkHINBAN_LABEL_F).Value)       'ïiî‘ï\é¶◊ÕﬁŸ å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_F, Check1(chkKOUJI_SETSU_F).Value)         'ê›íuçHéñê‡ñæèë å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.KONPOU_F, Check1(chkKONPOU_F).Value)                   'ç´ïÔçﬁ å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_F, Check1(chkFUKU_SHIZAI_F).Value)         'ïõéëçﬁ å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_F, Check1(chkKONPOU_ASSY_F).Value)         'ç´ïÔASSY å©êœèëï\é¶Ã◊∏ﬁ
    Call UniCode_Conv(ITEM_O_REC.KANRI_F, Check1(chkKANRI_F).Value)                     'ä«óùîÔ å©êœèëï\é¶Ã◊∏ﬁ

    
    
    
    
'>>>>>>>>>>>>>>>>>> 2017.11.08
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_QTY, Text1(ptxNAKANISHI_QTY).Text)           'íÜêºçHóøÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_QTY, Text1(ptxSHOHIN_QTY).Text)                 'è§ïiâªçHóøÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_QTY, Text1(ptxPF_KAKOU_QTY).Text)             'PFâ¡çHÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_QTY, Text1(ptxPE_KAKOU_QTY).Text)             'PEâ¡çHÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_QTY, Text1(ptxPE_SHIZAI_QTY).Text)           'PEéëçﬁÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_QTY, Text1(ptxHINBAN_LABEL_QTY).Text)     'ïiî‘ï\é¶◊ÕﬁŸÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_QTY, Text1(ptxKOUJI_SETSU_QTY).Text)       'ê›íuçHéñê‡ñæèëÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.KONPOU_QTY, Text1(ptxKONPOU_QTY).Text)                 'ç´ïÔçﬁÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_QTY, Text1(ptxFUKU_SHIZAI_QTY).Text)       'ïõéëçﬁÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_QTY, Text1(ptxKONPOU_ASSY_QTY).Text)       'ç´ïÔASSYÅ@êîó 
    Call UniCode_Conv(ITEM_O_REC.KANRI_QTY, Text1(ptxKANRI_QTY).Text)                   'ä«óùîÔÅ@êîó 
    
    
    Call UniCode_Conv(ITEM_O_REC.NAKANISHI_T_TAN, Text1(ptxNAKANISHI_T_TAN).Text)       'íÜêºçHóøÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.SHOHIN_T_TAN, Text1(ptxSHOHIN_T_TAN).Text)             'è§ïiâªçHóøÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.PF_KAKOU_T_TAN, Text1(ptxPF_KAKOU_T_TAN).Text)         'PFâ¡çHÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.PE_KAKOU_T_TAN, Text1(ptxPE_KAKOU_T_TAN).Text)         'PEâ¡çHÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.PE_SHIZAI_T_TAN, Text1(ptxPE_SHIZAI_T_TAN).Text)       'PEéëçﬁÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.HINBAN_LABEL_T_TAN, Text1(ptxHINBAN_LABEL_T_TAN).Text) 'ïiî‘ï\é¶◊ÕﬁŸÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.KOUJI_SETSU_T_TAN, Text1(ptxKOUJI_SETSU_T_TAN).Text)   'ê›íuçHéñê‡ñæèëÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.KONPOU_T_TAN, Text1(ptxKONPOU_T_TAN).Text)             'ç´ïÔçﬁÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.FUKU_SHIZAI_T_TAN, Text1(ptxFUKU_SHIZAI_T_TAN).Text)   'ïõéëçﬁÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.KONPOU_ASSY_T_TAN, Text1(ptxKONPOU_ASSY_T_TAN).Text)   'ç´ïÔASSYÅ@íÒèoíPâø
    Call UniCode_Conv(ITEM_O_REC.KANRI_T_TAN, Text1(ptxKANRI_T_TAN).Text)               'ä«óùîÔÅ@íÒèoíPâø
'>>>>>>>>>>>>>>>>>> 2017.11.08
    
    
    
    
    
    
    
    
    
    
    
    Call UniCode_Conv(ITEM_O_REC.UPD_TANTO, "SEI16")
    Call UniCode_Conv(ITEM_O_REC.UPD_DATETIME, Format(Now, "yyyyymmddhhmmss"))
    
    
    Do
        
        
        sts = BTRV(BtOpInsert, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                
        
        Select Case sts
            Case BtNoErr
            
                Exit Do
            
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM_O.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Do
                End If
            
            
            Case Else
                Call File_Error(sts, upd_com, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                Exit Function
    
        End Select
    Loop

    '---------------------------------------------------    'ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^ É{ÉfÉBèoóÕ
    
'   Set TDBGrid1(pGrdKOUSEI).Array = KOUSEI
    
    
'   TDBGrid1(pGrdKOUSEI).Update




    If TDBGrid1(pGrdKOUSEI).ApproxCount = 0 Then

    Else


        For i = 1 To KOUSEI.UpperBound(1)
    
    
            If Trim(KOUSEI(i, ColKO_S_HIN_GAI)) = "" And Trim(KOUSEI(i, ColKO_T_HIN_NAME)) = "" Then
            Else
                                                                                                            
                                                                                            
                                                                                            
                
                Call Rclr_ITEM_O_REC
                
                
                Call UniCode_Conv(ITEM_O_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                Call UniCode_Conv(ITEM_O_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
                Call UniCode_Conv(ITEM_O_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
                
                Call UniCode_Conv(ITEM_O_REC.SEQ_NO, Format(i, "000"))          '2017.11.08
                
                
                Call UniCode_Conv(ITEM_O_REC.KO_JGYOBU, Right(KOUSEI(i, ColKO_JGYOBU), 1))
                Call UniCode_Conv(ITEM_O_REC.KO_NAIGAI, NAIGAI_NAI)
                Call UniCode_Conv(ITEM_O_REC.KO_HIN_GAI, KOUSEI(i, ColKO_S_HIN_GAI))
                                                                                            
                Call UniCode_Conv(ITEM_O_REC.KO_QTY, KOUSEI(i, ColKO_QTY))      '2017.11.08
                                                                                
                                                                                
                                                                                
                                                                                
                Call UniCode_Conv(ITEM_O_REC.T_HIN_NAME, KOUSEI(i, ColKO_T_HIN_NAME))
                Call UniCode_Conv(ITEM_O_REC.TANI, KOUSEI(i, ColKO_TANI))
                Call UniCode_Conv(ITEM_O_REC.T_TANKA, KOUSEI(i, ColKO_T_TANKA))
                Call UniCode_Conv(ITEM_O_REC.T_KINGAKU, KOUSEI(i, ColKO_T_KINGAKU))
                                                                                
                                                                                
                                                                                'éÌï 
                Call UniCode_Conv(ITEM_O_REC.KO_SYUBETSU, Right(KOUSEI(i, ColKO_SYUBETSU), 2))       '2017.11.16
                                                                                
                                                                                
                                                                                
                
                
                
            
                Call UniCode_Conv(ITEM_O_REC.UPD_TANTO, "SEI16")                                'çXêVíSìñé“∫∞ƒﬁ
                                                                                                'çXêVì˙éû
                Call UniCode_Conv(ITEM_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
            
            
                Do
                    
                    DoEvents
                    
                    sts = BTRV(BtOpInsert, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                            Beep
                            ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_COMPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                            If ans = vbCancel Then
                                GoTo Abort_Tran
                            End If
                        Case Else
                            Call File_Error(sts, BtOpInsert, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                            GoTo Abort_Tran
                    End Select
                
                Loop
    
    
    
                
                
    
    
    
    
    
    
    
    
    
    
    
            End If
        Next i
    End If


'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2017.09.28  >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>




End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "")
        GoTo Abort_Tran
    End If
    
    
    Call Input_UnLock
    
    Update_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "")
    End If
    
    Call Input_UnLock
                                        




End Function

Private Sub Text1_LostFocus(Index As Integer)
    
Dim i   As Integer
    
    
    Select Case Index
        Case ptxHin_Gai
            
            
            Text1(Index).Text = StrConv(RTrim(Text1(Index).Text), vbUpperCase)
            
            
            If Trim(svHin_Gai) = (Text1(ptxHin_Gai).Text) Then
            Else
                For i = 2 To 5
                    Command1(i).Enabled = False
                Next i
            
            
            End If
    End Select
End Sub
Private Function ITEM_O_RESET_PROC() As Integer
'----------------------------------------------------------------------------
'                   ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^  çƒç\íz
'----------------------------------------------------------------------------
Dim com         As Integer
Dim sts         As Integer
Dim NEW_ITEM    As Integer

Dim ans         As Integer

Dim LAST_SEQ_NO As Integer

    ITEM_O_RESET_PROC = True

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2017.11.14  >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    '---------------------------------------------------    'å©êœópïiñ⁄É}ÉXÉ^(tmp)  äYìñÉfÅ[É^ëSåèçÌèúÇµÅ@å©êœópïiñ⁄É}ÉXÉ^Å®å©êœópïiñ⁄É}ÉXÉ^(tmp)


    com = BtOpGetFirst
       
    Do
        
        DoEvents
        
        Do
        
            sts = BTRV(com + BtSNoWait, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
                
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrEOF
                    Exit Do
                
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM_O.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        Exit Function
                    End If
                Case Else
                    Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    
                    Exit Function
            End Select
    
        Loop
            
        If sts = BtErrEOF Then
            Exit Do
        End If


        Do
            sts = BTRV(BtOpDelete, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
            Select Case sts
                Case BtNoErr
                
                    Exit Do
                Case BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        sts = BTRV(BtOpUnlock, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        End If
                        Exit Function
                    End If
            
                
                Case Else
                    Call File_Error(sts, BtOpDelete, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    Exit Function
            End Select
        Loop
    
        com = BtOpGetNext
    
    Loop
'----------------------------------- ç\ê¨ïiÇÃì‡óeÇç\ê¨É}ÉXÉ^ÇÊÇËçƒç\ízÇ∑ÇÈ  2017.11.15 ------------------------------
    '---------------------------------------------------    'ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^  äYìñÉfÅ[É^ëSåèçÌèú
    'äYìñÉfÅ[É^ëSåèçÌèú
    Call UniCode_Conv(K0_ITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_ITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_ITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
       
    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "")
       
    com = BtOpGetGreaterEqual
       
    Do
        
        DoEvents
        sts = BTRV(com, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            
        Select Case sts
            Case BtNoErr
            
                    If StrConv(ITEM_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                       StrConv(ITEM_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                            Trim(StrConv(ITEM_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                    sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    If sts Then
                        Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        Exit Function
                    End If
                End If
                Exit Do
            Case BtErrEOF
                Exit Do
            
            Case Else
                Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                
                Exit Function
        End Select


        Do
            DoEvents
            sts = BTRV(BtOpInsert, tmpITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
            Select Case sts
                Case BtNoErr
                
                    Exit Do
                Case BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        End If
                        Exit Function
                    End If
                
                
                Case Else
                    Call File_Error(sts, BtOpInsert, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    Exit Function
            End Select
        Loop



        Do
        DoEvents
        sts = BTRV(BtOpDelete, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
            Select Case sts
                Case BtNoErr
                
                    Exit Do
                Case BtErrEOF
                    Exit Do
                Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                    Beep
                    ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                    If ans = vbCancel Then
                        sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                        If sts Then
                            Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        End If
                        Exit Function
                    End If
                
                
                Case Else
                    Call File_Error(sts, BtOpDelete, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    Exit Function
            End Select
        Loop
    
        com = BtOpGetNext
    
    Loop
    
    
    Call UniCode_Conv(K0_tmpITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_tmpITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_tmpITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)

    Call UniCode_Conv(K0_ITEM_O.SEQ_NO, "000")     '2017.11.08

    sts = BTRV(BtOpGetEqual, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
    Select Case sts
        Case BtNoErr
            NEW_ITEM = 0
        
        Case BtErrKeyNotFound

            NEW_ITEM = 1
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ëÂç„éñ å©êœópïiñ⁄É}ÉXÉ^")
            Exit Function

    End Select
    
    If NEW_ITEM = 1 Then
        ITEM_O_RESET_PROC = False
        Exit Function
    End If
    
    Do
        DoEvents
        sts = BTRV(BtOpInsert, ITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
        Select Case sts
            Case BtNoErr
            
                Exit Do
            Case BtErrEOF
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    If sts Then
                        Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    End If
                    Exit Function
                End If
            
            
            Case Else
                Call File_Error(sts, BtOpDelete, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop

    Do
        DoEvents
        sts = BTRV(BtOpDelete, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
        Select Case sts
            Case BtNoErr
            
                Exit Do
            Case BtErrEOF
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<P_CMOPO.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    sts = BTRV(BtOpUnlock, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    If sts Then
                        Call File_Error(sts, BtOpUnlock, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    End If
                    Exit Function
                End If
            
            
            Case Else
                Call File_Error(sts, BtOpDelete, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop


    
    Call UniCode_Conv(K0_P_COMPO.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_P_COMPO.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_P_COMPO.HIN_GAI, Text1(ptxHin_Gai).Text)

    Call UniCode_Conv(K0_P_COMPO.SEQNO, "001")
    
    com = BtOpGetGreater
    
    Do
        sts = BTRV(com, P_COMPO_POS, P_COMPO_O_REC, Len(P_COMPO_O_REC), K0_P_COMPO, Len(K0_ITEM_O), 0)
            
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_COMPO_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                   StrConv(P_COMPO_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                    Trim(StrConv(P_COMPO_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                    
                    Exit Do
                
                End If
            Case BtErrEOF
                
                Exit Do
            
            Case Else
                Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                
                Exit Function
        
        End Select
    
        
        
        Call UniCode_Conv(K1_tmpITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
        Call UniCode_Conv(K1_tmpITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
        Call UniCode_Conv(K1_tmpITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)
        
        
        Call UniCode_Conv(K1_tmpITEM_O.KO_JGYOBU, StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode))
        Call UniCode_Conv(K1_tmpITEM_O.KO_NAIGAI, StrConv(P_COMPO_K_REC.KO_NAIGAI, vbUnicode))
        Call UniCode_Conv(K1_tmpITEM_O.KO_HIN_GAI, StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode))
        
        
        sts = BTRV(BtOpGetEqual, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K1_tmpITEM_O, Len(K1_tmpITEM_O), 1)
            
        Select Case sts
            Case BtNoErr
            
            
             '   Call UniCode_Conv(tmpITEM_O_REC.KO_SYUBETSU, StrConv(P_COMPO_K_REC.KO_SYUBETSU, vbUnicode)) '2017.11.29
            
                Call UniCode_Conv(tmpITEM_O_REC.SEQ_NO, StrConv(P_COMPO_K_REC.SEQNO, vbUnicode))
                
                LAST_SEQ_NO = Val(StrConv(P_COMPO_K_REC.SEQNO, vbUnicode))
                
                Call UniCode_Conv(tmpITEM_O_REC.KO_QTY, StrConv(P_COMPO_K_REC.KO_QTY, vbUnicode))
                
                Call UniCode_Conv(tmpITEM_O_REC.UPD_TANTO, "SEI16")                                'çXêVíSìñé“∫∞ƒﬁ
                                                                                                'çXêVì˙éû
                Call UniCode_Conv(tmpITEM_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                
                
                
                sts = BTRV(BtOpInsert, ITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                    
                Select Case sts
                    Case BtNoErr
                    Case Else
                        Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        
                        Exit Function
                
                End Select
            
                sts = BTRV(BtOpDelete, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 1)
                    
                Select Case sts
                    Case BtNoErr
                    Case Else
                        Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        
                        Exit Function
                
                End Select
            
            
            
            Case BtErrKeyNotFound
                
            
                Call Rclr_ITEM_O_REC
                
                
                Call UniCode_Conv(ITEM_O_REC.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 3, 1))
                Call UniCode_Conv(ITEM_O_REC.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE).Text, 4), 4, 1))
                Call UniCode_Conv(ITEM_O_REC.HIN_GAI, Text1(ptxHin_Gai).Text)
                
                Call UniCode_Conv(ITEM_O_REC.SEQ_NO, StrConv(P_COMPO_K_REC.SEQNO, vbUnicode))
                LAST_SEQ_NO = Val(StrConv(P_COMPO_K_REC.SEQNO, vbUnicode))
                
                
                Call UniCode_Conv(ITEM_O_REC.KO_JGYOBU, StrConv(P_COMPO_K_REC.KO_JGYOBU, vbUnicode))
                Call UniCode_Conv(ITEM_O_REC.KO_NAIGAI, StrConv(P_COMPO_K_REC.KO_NAIGAI, vbUnicode))
                Call UniCode_Conv(ITEM_O_REC.KO_HIN_GAI, StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode))
                                                                                            
                Call UniCode_Conv(ITEM_O_REC.KO_QTY, StrConv(P_COMPO_K_REC.KO_QTY, vbUnicode))
                                                                                
                                                                                
                                                                                
            
                Call UniCode_Conv(ITEM_O_REC.INS_TANTO, "SEI16")                                'çXêVíSìñé“∫∞ƒﬁ
                                                                                                'çXêVì˙éû
                Call UniCode_Conv(ITEM_O_REC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                                                                                
                
                
            
                Call UniCode_Conv(ITEM_O_REC.INS_TANTO, "SEI16")                                'çXêVíSìñé“∫∞ƒﬁ
                                                                                                'çXêVì˙éû
                Call UniCode_Conv(ITEM_O_REC.Ins_DateTime, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
            
            
                
                sts = BTRV(BtOpInsert, ITEM_O_POS, ITEM_O_REC, Len(ITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                Select Case sts
                    Case BtNoErr
                    Case Else
                        Call File_Error(sts, BtOpInsert, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                        Exit Function
                End Select
            
            Case Else
                Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                
                Exit Function
        
        End Select
        
        
        
        
        
        
        
        
        com = BtOpGetNext
    
    
    Loop



    Call UniCode_Conv(K0_tmpITEM_O.JGYOBU, Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1))
    Call UniCode_Conv(K0_tmpITEM_O.NAIGAI, Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1))
    Call UniCode_Conv(K0_tmpITEM_O.HIN_GAI, Text1(ptxHin_Gai).Text)

    Call UniCode_Conv(K0_tmpITEM_O.SEQ_NO, "")
    
    com = BtOpGetGreater
    
    Do
        sts = BTRV(com, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 0)
            
        Select Case sts
            Case BtNoErr
            
                If StrConv(tmpITEM_O_REC.JGYOBU, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 3, 1) Or _
                   StrConv(tmpITEM_O_REC.NAIGAI, vbUnicode) <> Mid(Right(Combo1(pcmbSHIMUKE), 4), 4, 1) Or _
                    Trim(StrConv(tmpITEM_O_REC.HIN_GAI, vbUnicode)) <> Trim(Text1(ptxHin_Gai).Text) Then
                    
                    Exit Do
                
                End If
            Case BtErrEOF
                
                Exit Do
            
            Case Else
                Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                
                Exit Function
        
        End Select
    
        
        
        If Trim(StrConv(tmpITEM_O_REC.KO_HIN_GAI, vbUnicode)) = "" Then
            LAST_SEQ_NO = LAST_SEQ_NO + 10
        
            Call UniCode_Conv(tmpITEM_O_REC.SEQ_NO, Format(LAST_SEQ_NO, "000"))
        
            sts = BTRV(BtOpInsert, ITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_ITEM_O, Len(K0_ITEM_O), 0)
                
            Select Case sts
                Case BtNoErr
                Case Else
                    Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                    
                    Exit Function
            
            End Select
        
        End If
            
        sts = BTRV(BtOpDelete, tmpITEM_O_POS, tmpITEM_O_REC, Len(tmpITEM_O_REC), K0_tmpITEM_O, Len(K0_tmpITEM_O), 1)
            
        Select Case sts
            Case BtNoErr
            Case Else
                Call File_Error(sts, com + BtSNoWait, "ëÂç„éñÅ@å©êœópïiñ⁄É}ÉXÉ^")
                
                Exit Function
        
        End Select
        
        
        com = BtOpGetNext
    
    
    Loop

    ITEM_O_RESET_PROC = False

End Function
