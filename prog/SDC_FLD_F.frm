VERSION 5.00
Begin VB.Form SDC_FLD_F 
   BorderStyle     =   3  'å≈íË¿ﬁ≤±€∏ﬁ
   Caption         =   "ÉfÅ[É^èoóÕêÊéwíËÅ^ämîF"
   ClientHeight    =   3120
   ClientLeft      =   30
   ClientTop       =   3300
   ClientWidth     =   6975
   ControlBox      =   0   'False
   FillColor       =   &H00FFFFFF&
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3120
   ScaleWidth      =   6975
   ShowInTaskbar   =   0   'False
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text1 
      BackColor       =   &H8000000F&
      Height          =   360
      Index           =   0
      Left            =   1920
      Locked          =   -1  'True
      MaxLength       =   40
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   240
      Width           =   4788
   End
   Begin VB.TextBox Text1 
      Height          =   360
      Index           =   1
      Left            =   1920
      MaxLength       =   40
      TabIndex        =   1
      Top             =   840
      Width           =   4788
   End
   Begin VB.TextBox Text1 
      Height          =   360
      IMEMode         =   3  'µÃå≈íË
      Index           =   3
      Left            =   1920
      MaxLength       =   3
      TabIndex        =   3
      Top             =   2040
      Width           =   468
   End
   Begin VB.TextBox Text1 
      Height          =   360
      Index           =   2
      Left            =   1920
      MaxLength       =   40
      TabIndex        =   2
      Top             =   1440
      Width           =   4788
   End
   Begin VB.CommandButton Command1 
      Caption         =   "∑¨›æŸ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   11
      Left            =   6000
      TabIndex        =   15
      TabStop         =   0   'False
      Top             =   2640
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   10
      Left            =   5520
      TabIndex        =   14
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   9
      Left            =   5040
      TabIndex        =   13
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Caption         =   "ÇnÇj"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   8
      Left            =   4200
      TabIndex        =   12
      TabStop         =   0   'False
      Top             =   2640
      Width           =   855
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   7
      Left            =   3600
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   6
      Left            =   3120
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   5
      Left            =   2640
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   4
      Left            =   2160
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   3
      Left            =   1560
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   2
      Left            =   1080
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   1
      Left            =   600
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.CommandButton Command1 
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   10.5
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   372
      Index           =   0
      Left            =   120
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   2640
      Width           =   492
   End
   Begin VB.Label Lab_Fix 
      AutoSize        =   -1  'True
      Caption         =   "ÉtÉHÉãÉ_ñº"
      Height          =   240
      Index           =   1
      Left            =   240
      TabIndex        =   19
      Top             =   840
      Width           =   1200
   End
   Begin VB.Label Lab_Fix 
      AutoSize        =   -1  'True
      Caption         =   "éØï éq"
      Height          =   240
      Index           =   3
      Left            =   240
      TabIndex        =   18
      Top             =   2040
      Width           =   720
   End
   Begin VB.Label Lab_Fix 
      AutoSize        =   -1  'True
      Caption         =   "ÉtÉ@ÉCÉãñº"
      Height          =   240
      Index           =   2
      Left            =   240
      TabIndex        =   17
      Top             =   1440
      Width           =   1200
   End
   Begin VB.Label Lab_Fix 
      AutoSize        =   -1  'True
      Caption         =   "èoóÕêÊÉãÅ[Ég"
      Height          =   240
      Index           =   0
      Left            =   240
      TabIndex        =   16
      Top             =   240
      Width           =   1440
   End
End
Attribute VB_Name = "SDC_FLD_F"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'ÉRÉìÉ{ópìYéö
'Const pcmb = ZERO

'ÉeÉLÉXÉgópìYéö
Const ptxROOT% = 0                      'èoóÕêÊÉãÅ[Ég
Const ptxFOLDER% = 1                     'ÉtÉHÉãÉ_ñº
Const ptxFILE% = 2                       'ÉtÉ@ÉCÉãñº
Const ptxXXX% = 3                        'éØï éq

'ÉâÉxÉãópìYéö
'Const plb = ZERO

'ÉäÉXÉgópìYéö
'Const plst = ZERO

'ÉtÉ@ÉìÉNÉVÉáÉììYéö
Const fncOK% = 8                         'ÇnÇj
Const fncCAN% = 11                       '∑¨›æŸ

Dim Act_Flg As Integer                  'Activate∫›ƒ€∞ŸÃ◊∏ﬁ

Private Function Data_Chk_Set() As Integer
'----------------------------------------------------------------------------
'                   ì¸óÕÉfÅ[É^Ç‹Ç∆ÇﬂÉ`ÉFÉbÉNÅ@ÅïÅ@éÊçûÇ›
'----------------------------------------------------------------------------
Dim sts As Integer
Dim i As Integer
Dim Wk As String
Dim Er_Idx As Integer
Dim yn As Integer

    Data_Chk_Set = True

    For i = ptxFOLDER To ptxXXX
        If Text1(i).MaxLength <> 0 And _
           In_Chr_Chk(Text1(i), Text1(i).MaxLength) Then
            Er_Idx = i
            GoTo Err_Return
        End If
    Next i

    'ÉtÉHÉãÉ_óLñ≥ämîF
    If Len(Trim(Text1(ptxFOLDER))) <> 0 Then
        Er_Idx = ptxFOLDER
        Wk = Trim(Text1(ptxROOT)) & "\" & Trim(Text1(ptxFOLDER))
        If Dir(Wk, vbDirectory) = "" Then
            yn = MsgBox("ÉtÉHÉãÉ_Ç™ë∂ç›ÇµÇ‹ÇπÇÒ" & Chr(13) & Chr(10) & _
                        "çÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If yn = vbNo Then GoTo Err_Return
            MkDir Wk
        End If
    End If

    'ì¸óÕíléÊçûÇ›
    SDC_FLD_Root = Trim(Text1(ptxROOT))      'èoóÕêÊÉãÅ[Ég
    SDC_FLD_Folder = Trim(Text1(ptxFOLDER))  'ÉtÉHÉãÉ_ñº
    SDC_FLD_File = Trim(Text1(ptxFILE))      'ÉtÉ@ÉCÉãñº
    SDC_FLD_xxx = Trim(Text1(ptxXXX))        'éØï éq

    Data_Chk_Set = False
    Exit Function

Err_Return:
    Text1(Er_Idx).SetFocus

End Function

Private Function In_Chr_Chk(DATA As String, C_Len As Integer) As Integer
'----------------------------------------------------------------------------
'                   ì¸óÕï∂éöçÄñ⁄ÉGÉâÅ[É`ÉFÉbÉN
'----------------------------------------------------------------------------

    In_Chr_Chk = True

    If LenB(StrConv(DATA, vbFromUnicode)) > C_Len Then
        Beep
        MsgBox "ì¸óÕÇµÇΩçÄñ⁄ÇÕÉGÉâÅ[Ç≈Ç∑ÅBÅiåÖÇ†Ç”ÇÍÅj", vbExclamation
        Exit Function
    End If

    In_Chr_Chk = False

End Function

Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------
    SDC_FLD_F.MousePointer = vbHourglass
    Call Ctrl_Lock(SDC_FLD_F)
End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------
    Call Ctrl_UnLock(SDC_FLD_F)
    SDC_FLD_F.MousePointer = vbDefault
End Sub

Private Sub Command1_Click(Index As Integer)
'----------------------------------------------------------------------------
'                   èàóùÉtÉ@ÉìÉNÉVÉáÉìÅ@ÉRÉìÉgÉçÅ[ÉãÅiç≈â∫íiÇÃÇPÇQå¬Åj
'----------------------------------------------------------------------------
Dim yn As Integer

    Select Case Index

        Case fncOK              'èoóÕÇnÇj
            If Data_Chk_Set Then Exit Sub
            SDC_FLD_Return = False               'ämîFâÊñ ÇnÇjèIóπ

        Case fncCAN             'èàóù∑¨›æŸ
            SDC_FLD_Return = True                'ämîFâÊñ ∑¨›æŸèIóπ

        Case Else
            Exit Sub
    End Select

    Act_Flg = False                 'Activate∫›ƒ€∞ŸÃ◊∏ﬁ
    SDC_FLD_F.Visible = False
End Sub

Private Sub Form_Activate()
Dim sts As Integer
Dim i As Integer
Dim yn As Integer

    If Act_Flg = True Then Exit Sub

    Act_Flg = True                      'Activate∫›ƒ€∞ŸÃ◊∏ﬁ

    'èoóÕêÊèÓïÒÅ@èâä˙ï\é¶
    Text1(ptxROOT) = SDC_FLD_Root        'èoóÕêÊÉãÅ[Ég
    Text1(ptxFOLDER) = SDC_FLD_Folder    'ÉtÉHÉãÉ_ñº
    Text1(ptxFILE) = SDC_FLD_File        'ÉtÉ@ÉCÉãñº
    Text1(ptxXXX) = SDC_FLD_xxx          'éØï éq

    DoEvents            'âÊñ çÄñ⁄ï\é¶

    'èoóÕêÊÉãÅ[ÉgÉtÉHÉãÉ_óLñ≥ämîF
    If Dir(SDC_FLD_Root, vbDirectory) = "" Then
        yn = MsgBox("èoóÕêÊÉãÅ[ÉgÇ™ë∂ç›ÇµÇ‹ÇπÇÒ" & Chr(13) & Chr(10) & _
                    "çÏê¨ÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
        If yn = vbNo Then
            MsgBox "èoóÕêÊÉãÅ[ÉgÇê≥ÇµÇ≠íËã`ÇµÇƒÇ©ÇÁ" & Chr(13) & Chr(10) & _
                   "çƒãNìÆÇµÇƒâ∫Ç≥Ç¢"
            Command1(fncCAN).Value = True
            Exit Sub
        End If
        MkDir SDC_FLD_Root
    End If



    Text1(ptxFOLDER).SetFocus

End Sub

Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)
    Select Case KeyCode
        Case vbKeyF1 To vbKeyF12
            If Command1(KeyCode - vbKeyF1).Enabled = False Then Exit Sub
            Command1(KeyCode - vbKeyF1).Value = True
    End Select
End Sub

Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub

Private Sub Form_Load()
    Act_Flg = False                             'Activate∫›ƒ€∞ŸÃ◊∏ﬁ
End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
    If UnloadMode = vbFormControlMenu Then Cancel = 1
End Sub

Private Sub Text1_GotFocus(Index As Integer)
    If Text1(Index).Locked <> True Then
        Text1(Index) = Trim(Text1(Index).Text)
        Text1(Index).SelStart = 0
        Text1(Index).SelLength = Len(Text1(Index).Text)
    End If
End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)

    If KeyCode <> vbKeyReturn Then Exit Sub
    'Call Tab_Ctrl(Shift)    'à⁄ìÆ
    If Index < 3 Then
        Text1(Index + 1).SetFocus
        Call Text1_GotFocus(Index + 1)
    Else
        Command1(8).SetFocus
    End If
    

End Sub

