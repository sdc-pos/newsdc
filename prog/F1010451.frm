VERSION 5.00
Begin VB.Form F1010451 
   BackColor       =   &H00FFFFFF&
   Caption         =   "èâä˙ê›íËç›å…ìoò^ÅiTo ïWèÄíIÅjÅiè¨ñÏópÅj"
   ClientHeight    =   6312
   ClientLeft      =   1920
   ClientTop       =   2436
   ClientWidth     =   11220
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   6312
   ScaleWidth      =   11220
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton Command 
      Caption         =   "èI  óπ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Caption         =   "é¿  çs"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.4
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.Label CntLab 
      Alignment       =   1  'âEëµÇ¶
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "Z,ZZZ,ZZ9 åè"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.6
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   1
      Left            =   5520
      TabIndex        =   21
      Top             =   2760
      Visible         =   0   'False
      Width           =   2130
   End
   Begin VB.Label CntLab 
      Alignment       =   1  'âEëµÇ¶
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "Z,ZZZ,ZZ9 åè"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.6
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   0
      Left            =   5520
      TabIndex        =   20
      Top             =   2160
      Visible         =   0   'False
      Width           =   2130
   End
   Begin VB.Label CMsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ñ≥å¯åèêî"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.6
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   2
      Left            =   5880
      TabIndex        =   19
      Top             =   1560
      Visible         =   0   'False
      Width           =   1320
   End
   Begin VB.Label CMsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ìdâªí≤óùã@äÌ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   15.6
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Index           =   1
      Left            =   2640
      TabIndex        =   18
      Top             =   2760
      Visible         =   0   'False
      Width           =   1980
   End
   Begin VB.Label CMsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "êÜî—ã@äÌ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   14.4
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   285
      Index           =   0
      Left            =   2640
      TabIndex        =   17
      Top             =   2160
      Visible         =   0   'False
      Width           =   1200
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ç›å…èâä˙ê›íËÇ™èIóπÇµÇ‹ÇµÇΩÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   480
      Index           =   4
      Left            =   2520
      TabIndex        =   16
      Top             =   3720
      Visible         =   0   'False
      Width           =   6720
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ç›å…èâä˙ê›íËíÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   480
      Index           =   3
      Left            =   3840
      TabIndex        =   15
      Top             =   2640
      Visible         =   0   'False
      Width           =   3840
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "ç›å…ê›íËÉfÅ[É^ì«çûÇ›íÜÅI"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   480
      Index           =   2
      Left            =   2880
      TabIndex        =   14
      Top             =   2640
      Visible         =   0   'False
      Width           =   5760
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "èâä˙ê›íËç›å…ÇÃìoò^ÇçsÇ¢Ç‹Ç∑"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   480
      Index           =   0
      Left            =   2280
      TabIndex        =   13
      Top             =   2400
      Visible         =   0   'False
      Width           =   6720
   End
   Begin VB.Label MsgLab 
      AutoSize        =   -1  'True
      BackColor       =   &H00FFFFFF&
      Caption         =   "Åwé¿çsÅxÇëIëÇµÇƒâ∫Ç≥Ç¢"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   24
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   480
      Index           =   1
      Left            =   2760
      TabIndex        =   12
      Top             =   3120
      Visible         =   0   'False
      Width           =   5760
   End
End
Attribute VB_Name = "F1010451"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False


Option Explicit
'#################################################################################################
'ÅmÉeÉLÉXÉgÉtÉ@ÉCÉãèàóùÇÃíçà”ÅIÅIÅn
'
'Å@Å@Ç±ÇÃÉvÉçÉOÉâÉÄÇ≈ÇÕÅAÉeÉLÉXÉgÉtÉ@ÉCÉãÇÉÜÅ[ÉUÅ[íËã`å^ÇÃç\ë¢ëÃÇ≈ì«èëÇ´ÇµÇƒÇ¢ÇÈÅB
'Å@Å@Ç±ÇÃå`éÆÇ…ÇÊÇÈÇhÅ|ÇnÇÕÅAÅuGETÅvÇ®ÇÊÇ—ÅuPUTÅvΩ√∞ƒ“›ƒÇ…ÇÊÇËçsÇ§éñÇ…Ç»ÇÈÇ™ÅAÇ±ÇÍÇÁÇÃΩ√∞ƒ“›ƒ
'Å@Å@ÇégópÇ∑ÇÈà◊Ç…ÇÕÅAÅuRANDOMÅvÇ‹ÇΩÇÕÅuBINARYÅvÉÇÅ[ÉhÇ≈ÅuOPENÅvÇµÇ»ÇØÇÍÇŒÇ»ÇÁÇ»Ç¢ÅB
'Å@Å@íAÇµÅAà»â∫ÇÃÉçÉWÉbÉNÇ≈ÇÕÅAÉeÉLÉXÉgÉtÉ@ÉCÉãÇÃë∂ç›ÇÉ`ÉFÉbÉNÇ∑ÇÈñ⁄ìIÇ≈ÅuINPUTÅvÉÇÅ[ÉhÇ…ÇÊÇÈ
'Å@Å@ÅuOPENÅvÇ‡çsÇ¡ÇƒÇ®ÇËÅAë∂ç›É`ÉFÉbÉNå„ÅAÇ∑ÇÆÇ…ì«çûÇ›ÇçsÇ§ólÇ»èÍçáÇ…ÇÕÅAàÍíUÅuCLOSEÅvÇµÇƒÇ©ÇÁ
'Å@Å@ÅuBINARYÉÇÅ[ÉhÇ≈OPENÅvÇµÇƒÇ¢ÇÈéñÇ…íçà”Ç™ïKóvÅB
'
'Å@Å@Å¶ÅDÅuINPUTÅvÉÇÅ[ÉhOPENÇ≈ÇÕÅAÅuINPUT#ÅvÅuOUTPUT#ÅvÇÃÇ›égópÇ≈Ç´ÇÈÇ™ÅAÇ±ÇÍÇÁÇÕç\ë¢ëÃÇÃÉÅÉìÉo
'Å@Å@Å@Å@íPà ÇÃÇhÅ|ÇnÇ…Ç»ÇÈÅB
'#################################################################################################
Private Type YUKO_SOKO_TBL4             'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÉeÅ[ÉuÉãÅiêÜî—ã@äÌéñã∆ïîÅj
    HS_SOKO As String * 2
    NAIGAI As String * 1
End Type
Dim SOKO_T4(0 To 9) As YUKO_SOKO_TBL4

Private Type YUKO_SOKO_TBLD             'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÉeÅ[ÉuÉãÅiìdâªí≤óùã@äÌéñã∆ïîÅj
    HS_SOKO As String * 2
    NAIGAI As String * 1
End Type
Dim SOKO_TD(0 To 9) As YUKO_SOKO_TBLD

Dim HS_NaiG As String                   'çëì‡äOÅiåàíËì‡óeÅj••••Å@ŒΩƒ√ﬁ∞¿ì‡óeÇ…ÇÊÇËê›íË
Dim WS_NO As String * 2                 '‹∞∏Ω√∞ºÆ›î‘çÜ

Dim PRT_CAN As Boolean                  'àÛç¸ìríÜÉLÉÉÉìÉZÉãóvãÅ
Dim NormalFont As New StdFont           'àÛç¸ÉtÉHÉìÉg
Dim B_Jgyobu As String

Dim Lcnt As Integer
Const LMAX% = 47

Dim Command_Max As Integer              'âÊñ çÄñ⁄ï ç≈ëÂ≤›√ﬁØ∏Ω

Dim NG_QTY4 As Long                     'ñ≥å¯ÉfÅ[É^åèêîÅiêÜî—ã@äÌÅj
Dim NG_QTYD As Long                     'Å@Å@Å@Å@Å@Å@Å@Åiìdâªí≤óùã@äÌÅj
                                    'âÊñ èâä˙ï\é¶ÅièàóùçœÅuï÷Åvï\é¶Ç»Ç«Åj
Private Sub Scr_Init()
Dim i As Integer
Dim sts As Integer
Dim Work As String

    MsgLab(ZERO).Visible = True
    MsgLab(1).Visible = True
    MsgLab(2).Visible = False
    MsgLab(3).Visible = False
    Command(ZERO).SetFocus

End Sub
                                            'ç›å…èâä˙ê›íË èàóù
Private Sub Zaiko_IniSet_Main()
Dim sts As Integer
Dim ans As Integer
Dim Command As Integer
Dim Work As String
Dim Cp_From As String
Dim Cp_To As String

    Call Input_Lock           'âÊñ çÄñ⁄ÉçÉbÉN

    MsgLab(ZERO).Visible = False
    MsgLab(1).Visible = False
    MsgLab(2).Visible = True        'éÊçûÇ›íÜ“Øæ∞ºﬁï\é¶
    DoEvents

    If Data_Load = False Then       'ï÷ï éÊçûÇ›ÉèÅ[ÉNÇ…√ﬁ∞¿€∞ƒﬁ
        MsgLab(2).Visible = False       'éÊçûÇ›íÜ“Øæ∞ºﬁ ∏ÿ±
        MsgLab(3).Visible = True        'ç›å…ìoò^íÜ“Øæ∞ºﬁï\é¶
        DoEvents

        If WK_ZAI_Open(1, Work) Then    'éÊçûÇ›‹∞∏ OPENÅiçXêV”∞ƒﬁ)
            Unload Me
        End If
    
        If ER_ZAI_Open(ZERO, Work) = False Then    'éÊçûÇ›‹∞∏óLñ≥¡™Ø∏ÅióLÇËÅ®çÌèúÅj
            Close #ER_ZAI_No
            Kill Work
        End If

        If ER_ZAI_Open(1, Work) Then            'éÊçûÇ›‹∞∏ OPENÅiçXêV”∞ƒﬁ)
            Close #ER_ZAI_No
            Unload Me
        End If
                            'àÛç¸ÉtÉHÉìÉgê›íË
        Printer.Font.NAME = F1010451.Font.NAME
        Printer.Font.Size = F1010451.Font.Size

        Lcnt = 99
        B_Jgyobu = Space(1)

        Do
            
            If WK_ZAI_Get Then          'éÊçûÇ›‹∞∏ ì«çûÇ›
                Exit Do
            End If
            If StrConv(WK_ZAIREC.JGYOBU, vbUnicode) < " " Then      ' EOF ?
                Exit Do
            End If

            If Data_Chk = False Then
                Call Zaiko_Set          'èâä˙ê›íËç›å…Å@ìoò^
            End If
        
            DoEvents
        Loop

        Close #WK_ZAI_No                'éÊçûÇ›‹∞∏ CLOSE
        Close #ER_ZAI_No
        MsgLab(3).Visible = False       'ç›å…ìoò^íÜ“Øæ∞ºﬁ ∏ÿ±
    End If

    If Lcnt <> 99 Then
        Printer.EndDoc
    End If

'âÊñ çÄñ⁄ÉçÉbÉNâèúÅ@ÅïÅ@èIóπÉÅÉbÉZÅ[ÉWï\é¶
    MsgLab(ZERO).Visible = False
    MsgLab(1).Visible = False
    MsgLab(2).Visible = False
    MsgLab(3).Visible = False
    MsgLab(4).Visible = True

    CMsgLab(ZERO).Visible = True
    CMsgLab(1).Visible = True
    CMsgLab(2).Visible = True

    CntLab(ZERO).Visible = True
    CntLab(ZERO).Caption = Format(NG_QTY4, "0") & " åè"
    CntLab(1).Visible = True
    CntLab(1).Caption = Format(NG_QTYD, "0") & " åè"
    
    Call Input_UnLock

End Sub
                                            'ÉfÅ[É^ÉçÅ[Éh(äeã∆ïîï ŒΩƒ√ﬁ∞¿Å®éÊçûÇ›‹∞∏Åj
Private Function Data_Load() As Integer
Dim sts As Integer
Dim Work As String
Dim Zai4_F As Integer
Dim ZaiD_F As Integer

    Data_Load = False
    Zai4_F = True
    ZaiD_F = True
    NG_QTY4 = ZERO
    NG_QTYD = ZERO

'éÊçûÇ›ÉèÅ[ÉNÅ@ÇnÇoÇdÇm
    If WK_ZAI_Open(ZERO, Work) = False Then    'éÊçûÇ›‹∞∏óLñ≥¡™Ø∏ÅióLÇËÅ®çÌèúÅj
        Close #WK_ZAI_No
        Kill Work
    End If

    If WK_ZAI_Open(1, Work) Then            'éÊçûÇ›‹∞∏ OPENÅiçXêV”∞ƒﬁ)
        Unload Me
    End If

'êÜî—ã@äÌéñã∆ïî  ç›å…ê›íËÉfÅ[É^éÊçûÇ›
    If HS_ZAI_Open4(ZERO, Work) = False Then   'Ãß≤Ÿñ≥ÇµÇ»ÇÁèàóùÇµÇ»Ç¢
        Close #HS_ZAI_No

        If HS_ZAI_Open4(1, Work) Then       'êÜî—ã@äÌéñã∆ïîŒΩƒ√ﬁ∞¿ OPEN
            Close #WK_ZAI_No
            Unload Me
        End If

        Call Data_Load_Sub                  'êÜî—ã@äÌéñã∆ïî  ç›å…ê›íËÉfÅ[É^Å®éÊçûÇ›‹∞∏

        Close #HS_ZAI_No                    'ŒΩƒ√ﬁ∞¿ CLOSE
        Zai4_F = False
    End If

'ìdâªí≤óùã@äÌéñã∆ïî  ç›å…ê›íËÉfÅ[É^éÊçûÇ›
    If HS_ZAI_OpenD(ZERO, Work) = False Then   'Ãß≤Ÿñ≥ÇµÇ»ÇÁèàóùÇµÇ»Ç¢
        Close #HS_ZAI_No

        If HS_ZAI_OpenD(1, Work) Then       'ìdâªí≤óùã@äÌéñã∆ïîŒΩƒ√ﬁ∞¿ OPEN
            Close #WK_ZAI_No
            Unload Me
        End If

        Call Data_Load_Sub                  'ìdâªí≤óùã@äÌéñã∆ïî  ç›å…ê›íËÉfÅ[É^Å®éÊçûÇ›‹∞∏

        Close #HS_ZAI_No                    'ŒΩƒ√ﬁ∞¿ CLOSE
        Zai4_F = False
    End If

    Close #WK_ZAI_No                    'éÊçûÇ›‹∞∏ CLOSE

    If Zai4_F = True And ZaiD_F = True Then
        Data_Load = True
    End If
End Function
                                            'éñã∆ïîï ÉfÅ[É^ÉçÅ[Éh(éñã∆ïîï ŒΩƒç›å…√ﬁ∞¿Å®éÊçûÇ›‹∞∏Åj
Private Sub Data_Load_Sub()
Dim i As Integer
Dim Put_Sel As Integer
Dim sts As Integer
Dim Work As String

    Do
        If HS_ZAI_Get Then          'ŒΩƒ√ﬁ∞¿ ì«çûÇ›
            Exit Do
        End If
        If StrConv(HS_ZAIREC.JGYOBU, vbUnicode) < " " Then
            Exit Do
        End If
        
                                'éñã∆ïîãÊï™
        Call UniCode_Conv(WK_ZAIREC.JGYOBU, StrConv(HS_ZAIREC.JGYOBU, vbUnicode))
                                'ëqå…ãÊï™ÅiŒΩƒÅj
        Call UniCode_Conv(WK_ZAIREC.HOST_SOKO, StrConv(HS_ZAIREC.HOST_SOKO, vbUnicode))
                                'ïiî‘ÅiäOïîÅj
        Call UniCode_Conv(WK_ZAIREC.HIN_GAI, StrConv(HS_ZAIREC.HIN_GAI, vbUnicode))
                                'ïiî‘Åiì‡ïîÅj
        Call UniCode_Conv(WK_ZAIREC.HIN_NAI, StrConv(HS_ZAIREC.HIN_NAI, vbUnicode))
                                'ïiñº
        Call UniCode_Conv(WK_ZAIREC.HIN_NAME, StrConv(HS_ZAIREC.HIN_NAME, vbUnicode))
                                'íIî‘ÅiŒΩƒÅj
        Call UniCode_Conv(WK_ZAIREC.HOST_TANA, StrConv(HS_ZAIREC.HOST_TANA, vbUnicode))
                                'êîó ÉTÉCÉì
        Call UniCode_Conv(WK_ZAIREC.QTY_SIGN, StrConv(HS_ZAIREC.QTY_SIGN, vbUnicode))
                                'ëOì˙ç›å…êî
        Call UniCode_Conv(WK_ZAIREC.ZEN_Z_QTY, StrConv(HS_ZAIREC.ZEN_Z_QTY, vbUnicode))
                                'FILLER
        Call UniCode_Conv(WK_ZAIREC.FILLER, StrConv(HS_ZAIREC.FILLER, vbUnicode))
                                '⁄∫∞ƒﬁèIí[œ∞∏(@)
        Call UniCode_Conv(WK_ZAIREC.REC_END, StrConv(HS_ZAIREC.REC_END, vbUnicode))
                                'CR.LF
        Call UniCode_Conv(WK_ZAIREC.CR_LF, StrConv(HS_ZAIREC.CR_LF, vbUnicode))

        sts = WK_ZAI_Put                    'éÊçûÇ›‹∞∏èëçûÇ›ÅiëŒè€ëqå…Åj
        If sts Then
            Close #HS_ZAI_No
            Close #WK_ZAI_No
            Unload Me
        End If
    Loop

End Sub
                                            'éÊçûÇ›ÉfÅ[É^ çÄñ⁄ì‡óeÉ`ÉFÉbÉN
Private Function Data_Chk() As Integer
Dim sts As Integer
Dim i As Integer
Dim Command As Integer
Dim Work As String

    Data_Chk = False

'éñã∆ïîãÊï™Å@îÕàÕäOÅH
        For i = ZERO To UBound(JGYOBU_T) - 1
            If JGYOBU_T(i).Code = " " Then
                Data_Chk = True
                Exit For
            End If
            If JGYOBU_T(i).Code = StrConv(WK_ZAIREC.JGYOBU, vbUnicode) Then
                Exit For
            End If
        Next i

'ÉzÉXÉgëqå…Å@îÕàÕäOÅH
        If StrConv(WK_ZAIREC.JGYOBU, vbUnicode) = "4" Then
            For i = ZERO To UBound(SOKO_T4) - 1
                If SOKO_T4(i).HS_SOKO = "  " Then
                    Data_Chk = True
                    Exit For
                End If
                If RTrim(StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_T4(i).HS_SOKO) Then
                    Exit For
                End If
            Next i
        Else
            For i = ZERO To UBound(SOKO_TD) - 1
                If SOKO_TD(i).HS_SOKO = "  " Then
                    Data_Chk = True
                    Exit For
                End If
                If RTrim(StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_TD(i).HS_SOKO) Then
                    Exit For
                End If
            Next i
        End If
        
'ïiî‘ÅiäOïîÅjÅFÅÅãÛîíÅHÅ@ÅïÅ@ïiî‘Åiì‡ïîÅjÅFÅÅãÛîíÅH
'    If StrConv(WK_ZAIREC.HIN_GAI, vbUnicode) = Space(13) Or _
'       StrConv(WK_ZAIREC.HIN_NAI, vbUnicode) = Space(13) Then
'            Data_Chk = True
'    End If

'êîó ÉTÉCÉìÅ@ÅFÅÇãÛîíÅH
    If StrConv(WK_ZAIREC.QTY_SIGN, vbUnicode) <> " " Then
        Data_Chk = True
    End If

    If Data_Chk = True Then
'        Call P_Err_Print             'ÉGÉâÅ[ÉäÉXÉgàÛç¸
        sts = ER_ZAI_Put                    'éÊçûÇ›‹∞∏èëçûÇ›ÅiëŒè€äOëqå…Åj
        If sts Then
            Close #WK_ZAI_No
            Close #ER_ZAI_No
            Unload Me
        End If
        If StrConv(WK_ZAIREC.JGYOBU, vbUnicode) = "4" Then
            NG_QTY4 = NG_QTY4 + 1
        Else
            NG_QTYD = NG_QTYD + 1
        End If
    End If

End Function
                                            'èâä˙ê›íËç›å…Å@ìoò^
Private Sub Zaiko_Set()
Dim sts As Integer
Dim ans As Integer
Dim Command As Integer
Dim Wqty As Long
Dim W_SOKO As String
Dim W_RETU As String
Dim W_REN As String
Dim W_DAN As String
Dim Work As String
Dim i As Integer

'çëì‡äOãÊï™ÇÃê›íË
    If StrConv(WK_ZAIREC.JGYOBU, vbUnicode) = "4" Then
        For i = 0 To UBound(SOKO_T4)
            If SOKO_T4(i).HS_SOKO = "  " Then
                Exit For
            End If
            If RTrim(StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_T4(i).HS_SOKO) Then
                HS_NaiG = SOKO_T4(i).NAIGAI
                Exit For
            End If
        Next i
    Else
        For i = ZERO To UBound(SOKO_TD)
            If SOKO_TD(i).HS_SOKO = "  " Then
                Exit For
            End If
            If RTrim(StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode)) = RTrim(SOKO_TD(i).HS_SOKO) Then
                HS_NaiG = SOKO_TD(i).NAIGAI
                Exit For
            End If
        Next i
    End If

'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
        Unload Me
    End If

'ïiñ⁄É}ÉXÉ^çXêV
    Call Upd_Item(W_SOKO, W_RETU, W_REN, W_DAN)


    If CLng(StrConv(WK_ZAIREC.ZEN_Z_QTY, vbUnicode)) = 0 Then   'ç›å…êîÅÅÇOÅ®ç›å…ìoò^ñ≥Çµ
        GoTo End_Tran
    End If

    If Nyuko_Update_Proc(StrConv(WK_ZAIREC.JGYOBU, vbUnicode), _
                        HS_NaiG, _
                        StrConv(WK_ZAIREC.HIN_GAI, vbUnicode), _
                        Format(Date, "yyyymmdd"), _
                        W_SOKO & W_RETU & W_REN & W_DAN, _
                        YOIN_TU_NYUKA, _
                        CLng(StrConv(WK_ZAIREC.ZEN_Z_QTY, vbUnicode)), _
                        WS_NO) Then
        GoTo Abort_Tran
    End If



End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "")
        GoTo Abort_Tran
    End If
    
    Exit Sub

Abort_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìàŸèÌèIóπ
    sts = BTRV(BtOpAbortTransaction, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), ZERO)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "")
    End If
    Unload Me
End Sub
                                            'ïiñ⁄É}ÉXÉ^çXêV
Private Function Upd_Item(WSOKO As String, _
                            WRETU As String, _
                            WREN As String, _
                            WDAN As String) As Integer
Dim sts As Integer
Dim ans As Integer
Dim Command As Integer
Dim Work As String

    Upd_Item = True
    
    Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(WK_ZAIREC.JGYOBU, vbUnicode))
    Call UniCode_Conv(K0_ITEM.NAIGAI, HS_NaiG)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(WK_ZAIREC.HIN_GAI, vbUnicode))
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
            Case BtNoErr
                Command = BtOpUpdate
                Exit Do
            Case BtErrKeyNotFound
                Command = BtOpInsert
                Call UniCode_Conv(ITEMREC.JGYOBU, StrConv(WK_ZAIREC.JGYOBU, vbUnicode))
                Call UniCode_Conv(ITEMREC.NAIGAI, HS_NaiG)
                Call UniCode_Conv(ITEMREC.HIN_GAI, StrConv(WK_ZAIREC.HIN_GAI, vbUnicode))
                Call UniCode_Conv(ITEMREC.HIN_NAME, Space(25))
                Call UniCode_Conv(ITEMREC.ST_SET_DT, Space(8))
                Call UniCode_Conv(ITEMREC.ST_SOKO, Space(2))
                Call UniCode_Conv(ITEMREC.ST_RETU, Space(2))
                Call UniCode_Conv(ITEMREC.ST_REN, Space(2))
                Call UniCode_Conv(ITEMREC.ST_DAN, Space(2))
                Call UniCode_Conv(ITEMREC.BEF_SOKO, Space(2))
                Call UniCode_Conv(ITEMREC.BEF_RETU, Space(2))
                Call UniCode_Conv(ITEMREC.BEF_REN, Space(2))
                Call UniCode_Conv(ITEMREC.BEF_DAN, Space(2))
                Call UniCode_Conv(ITEMREC.LAST_NYU_DT, Space(8))
                Call UniCode_Conv(ITEMREC.LAST_SYU_DT, Space(8))
                Call UniCode_Conv(ITEMREC.BIKOU_SOKO, Space(2))
                Call UniCode_Conv(ITEMREC.BIKOU_TANA, Space(8))
                Call UniCode_Conv(ITEMREC.SIZAI_CD, Space(5))
                Call UniCode_Conv(ITEMREC.HOJYU_P, "00000000")
                Call UniCode_Conv(ITEMREC.AVE_SYUKA, "00000000")
                Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")
                Call UniCode_Conv(ITEMREC.LAST_INP_DT, Space(8))
                
                Call UniCode_Conv(ITEMREC.LOCK_F, "0")          'îrëºÉtÉâÉO
                Call UniCode_Conv(ITEMREC.WEL_ID, "")           'égópíÜéqã@ÇhÇc
                Call UniCode_Conv(ITEMREC.PRG_ID, "")           'égópíÜÉvÉçÉOÉâÉÄ
                
                Call UniCode_Conv(ITEMREC.LAST_CHK_DT, "")
                Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, "0000000")
                
                Call UniCode_Conv(ITEMREC.FILLER, Space(32))
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop

                                'ì¸â◊êÊëqå…ÇÃåàíË
    If StrConv(ITEMREC.ST_SET_DT, vbUnicode) = Space(8) Then
        WSOKO = KASO_NYUKA_Soko
        WRETU = "01"
        WREN = "01"
        WDAN = "01"
    Else
        WSOKO = StrConv(ITEMREC.ST_SOKO, vbUnicode)
        WRETU = StrConv(ITEMREC.ST_RETU, vbUnicode)
        WREN = StrConv(ITEMREC.ST_REN, vbUnicode)
        WDAN = StrConv(ITEMREC.ST_DAN, vbUnicode)
    End If

                                'ïiñºÅiÅÇãÛîíÇÃéûÇÃÇ›ÉZÉbÉgÅj
    If StrConv(WK_ZAIREC.HIN_NAME, vbUnicode) <> Space(25) Then
        Call UniCode_Conv(ITEMREC.HIN_NAME, StrConv(WK_ZAIREC.HIN_NAME, vbUnicode))
    End If
                                'ïiî‘Åiì‡ïîÅj
    If StrConv(WK_ZAIREC.HIN_NAI, vbUnicode) <> Space(13) Then
        Call UniCode_Conv(ITEMREC.HIN_NAI, StrConv(WK_ZAIREC.HIN_NAI, vbUnicode))
    End If

                                'îıçlÅFŒΩƒëqå…ãÊï™
                                'Å@Å@Åmëqå…ãÊï™ÇÃì«ë÷Ç¶Å@ê›íËèåè]
                                'Å@Å@Å@á@éÛêMÉfÅ[É^ÇÃëqå…ãÊï™ÅÇãÛîí
                                'Å@Å@Å@áAÅ@Å@ÅVÅ@Å@Å@ëqå…ãÊï™ÅÑïiñ⁄œΩ¿ÇÃëqå…ãÊï™
    If StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode) <> Space(2) And _
       StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode) > StrConv(ITEMREC.BIKOU_SOKO, vbUnicode) Then
        Call UniCode_Conv(ITEMREC.BIKOU_SOKO, StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode))
    End If

                                'îıçlÅFŒΩƒíIî‘ÅiÅÇãÛîíÇÃéûÅj
    If StrConv(WK_ZAIREC.HOST_TANA, vbUnicode) <> Space(8) Then
        Call UniCode_Conv(ITEMREC.BIKOU_TANA, StrConv(WK_ZAIREC.HOST_TANA, vbUnicode))
    End If

                                'ç≈èIì¸â◊ì˙ÅFì¸â◊êîÅÇÇOÇÃéûê›íË
    If CLng(StrConv(WK_ZAIREC.ZEN_Z_QTY, vbUnicode)) <> ZERO Then
        Call UniCode_Conv(ITEMREC.LAST_INP_DT, Left(Date, 4) & Mid(Date, 6, 2) & Right(Date, 2))
    End If

                                'ª›ÃﬂŸêîÅ@ã~çœ€ºﬁØ∏Åi√ﬁÃ´ŸƒÅÅÇPÇÃà◊ÅAì‡óeÅÅÇOÇ»ÇÁÅuÇPÅvÇê›íËÅj
    If CLng(StrConv(ITEMREC.SAMPLE_QTY, vbUnicode)) = 0 Then
        Call UniCode_Conv(ITEMREC.SAMPLE_QTY, "1")
    End If

    Do
        sts = BTRV(Command, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
        Select Case sts
            Case BtNoErr, BtErrEOF, BtErrKeyNotFound
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                Beep
                ans = MsgBox("ëºí[ññÇ≈ÉfÅ[É^égópíÜÇ≈Ç∑ÅB<ITEM.DAT>", vbRetryCancel + vbQuestion, "ämîFì¸óÕ")
                If ans = vbCancel Then
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, Command, "ïiñ⁄É}ÉXÉ^")
                Exit Function
        End Select
    Loop

    Upd_Item = False

End Function
                                            'ÉGÉâÅ[ÉäÉXÉgÉwÉbÉ_Å[àÛç¸
Private Sub P_Err_Head()

    If Lcnt <> 99 Then
        Printer.NewPage
    End If
                                        'ÉwÉbÉ_àÛç¸
    Printer.Print
    Printer.Print Tab(31);
    Printer.Print "ÅñÅñÅñÅ@ç›å…ê›íËÉGÉâÅ[ÉäÉXÉgÅ@ÅñÅñÅñ";
    Printer.Print Tab(91);
    Printer.Print Date & "     P." & Format$(Printer.Page, "000")
    Printer.Print
                                        'ñæç◊ÉwÉbÉ_àÛç¸
    Printer.Print Tab(2);
    Printer.Print "éñã∆ïî";
    Printer.Print Tab(25);
    Printer.Print "ëqå…";
    Printer.Print Tab(31);
    Printer.Print "ïiî‘ÅiäOïîÅj";
    Printer.Print Tab(46);
    Printer.Print "ïiî‘Åiì‡ïîÅj";
    Printer.Print Tab(61);
    Printer.Print "ïiÅ@ñº";
    Printer.Print Tab(88);
    Printer.Print "íIî‘";
    Printer.Print Tab(98);
    Printer.Print "Å}";
    Printer.Print Tab(104);
    Printer.Print "ç›å…êî";
    Printer.Print
        
    Printer.Print
    Lcnt = 6

End Sub
                                            'ÉGÉâÅ[ÉäÉXÉgñæç◊àÛç¸
Private Sub P_Err_Print()

Dim Ldata As String
Dim wk_IO As String
Dim Work As String
Dim i As Integer
Dim sts As Integer

                                        'ÉwÉbÉ_Å[ÉRÉìÉgÉçÅ[Éã
    If Lcnt > LMAX Then
        Call P_Err_Head
        B_Jgyobu = Space(1)
    End If
                                'éñã∆ïîãÊï™
    If StrConv(WK_ZAIREC.JGYOBU, vbUnicode) <> B_Jgyobu Then
        B_Jgyobu = StrConv(WK_ZAIREC.JGYOBU, vbUnicode)
        Printer.Print Tab(2);
        Printer.Print StrConv(WK_ZAIREC.JGYOBU, vbUnicode);

        For i = ZERO To UBound(JGYOBU_T) - 1
            If JGYOBU_T(i).Code = " " Then
                Exit For
            End If
            If JGYOBU_T(i).Code = StrConv(WK_ZAIREC.JGYOBU, vbUnicode) Then
                Printer.Print Tab(4);
                Printer.Print RTrim(JGYOBU_T(i).NAME);
                Exit For
            End If
        Next i
    End If
    
    Printer.Print Tab(26);      'ëqå…ãÊï™ÅiŒΩƒÅj
    Printer.Print StrConv(WK_ZAIREC.HOST_SOKO, vbUnicode);
    
    Printer.Print Tab(31);      'ïiî‘ÅiäOïîÅj
    Printer.Print StrConv(WK_ZAIREC.HIN_GAI, vbUnicode);
    
    Printer.Print Tab(46);      'ïiî‘Åiì‡ïîÅj
    Printer.Print StrConv(WK_ZAIREC.HIN_NAI, vbUnicode);
    
    Printer.Print Tab(61);      'ïiñº
    Printer.Print StrConv(WK_ZAIREC.HIN_NAME, vbUnicode);
    
    Printer.Print Tab(88);      'íIî‘ÅiŒΩƒÅj
    Printer.Print StrConv(WK_ZAIREC.HOST_TANA, vbUnicode);
    
    Printer.Print Tab(99);      'êîó ÉTÉCÉì
    Printer.Print StrConv(WK_ZAIREC.QTY_SIGN, vbUnicode);

                                'ëOì˙ç›å…êî
    sts = Numeric_Check(EDIT_ONLY, 8, ZERO, NEGA_DIS, ZSUP_ENA, COMA_ENA, StrConv(WK_ZAIREC.ZEN_Z_QTY, vbUnicode), Work)
    If sts = False Then
        Printer.Print Tab(101);
        Printer.Print Work;
    Else
        Printer.Print Tab(103);
        Printer.Print StrConv(WK_ZAIREC.ZEN_Z_QTY, vbUnicode);
    End If
    Printer.Print

    Printer.Print
    Lcnt = Lcnt + 2

End Sub
Private Sub Command_Click(Index As Integer)
Dim yn As Integer
Dim sts As Integer
Dim Work As String

    Select Case Index
        Case ZERO
            Beep
            yn = MsgBox("ç›å…èâä˙ê›íËÅiÇsÇnïWèÄíIÅjÅ@é¿çsÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If yn = vbYes Then
                Call Zaiko_IniSet_Main            'ç›å…èâä˙ê›íËèàóù
                Command(ZERO).Enabled = False
                Command(11).SetFocus
            End If
        Case 11
            Unload Me
        Case Else
            Beep
    End Select
End Sub
Private Sub Command_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
Dim yn As Integer
Dim sts As Integer

    Select Case KeyCode
        Case vbKeyF1
            Command(ZERO).Value = True
        Case vbKeyF12
            Command(11).Value = True
        Case Else
            Beep
            If Command(ZERO).Enabled = True Then
                Command(ZERO).SetFocus
            Else
                Command(11).SetFocus
            End If
    End Select
End Sub
Private Sub Form_DblClick()
    PrintForm
End Sub
Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = ZERO
    End If
End Sub
Private Sub Form_Load()
Dim i As Integer
Dim j As Integer
Dim c As String * 128
Dim sts As Integer

Dim sBuffer As String * 255
Dim com     As String

    If App.PrevInstance Then
        Beep
        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If
    
    Command_Max = 11            'âÊñ çÄñ⁄ï ç≈ëÂ≤›√ﬁØ∏Ω

    Show
    
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                
                                'ÉVÉXÉeÉÄó\ñÒçœóvàˆéÊÇËçûÇ›
    If SYSTEM_YOIN_Set() Then
        Beep
        MsgBox "ÉVÉXÉeÉÄó\ñÒçœóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

                                'éñã∆ïîéÊÇËçûÇ›
    If JGYOB_TB_Set Then
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

                                'óLå¯ŒΩƒëqå…éÊÇËçûÇ›ÅiêÜî—ã@äÌÅj
    For i = 0 To UBound(SOKO_T4) - 1
        SOKO_T4(i).HS_SOKO = "  "
        SOKO_T4(i).NAIGAI = " "
    Next i
    i = ZERO
    Do
        If GetIni("INIZAI_OK_SOKO", "SOKO4" & RTrim(Format$(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [INIZAI_OK_SOKO] [SOKO] READ ERROR")
            End
        End If
        If RTrim(c) = "**" Then
            Exit Do
        End If
        SOKO_T4(i).HS_SOKO = RTrim(c)
        If GetIni("INIZAI_OK_SOKO", "NAIG4" & RTrim(Format$(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [INIZAI_OK_SOKO] [NAIG] READ ERROR")
            End
        End If
        SOKO_T4(i).NAIGAI = RTrim(c)
        i = i + 1
    Loop

                                'óLå¯ŒΩƒëqå…éÊÇËçûÇ›Åiìdâªí≤óùã@äÌÅj
    For i = ZERO To UBound(SOKO_TD) - 1
        SOKO_TD(i).HS_SOKO = "  "
        SOKO_TD(i).NAIGAI = " "
    Next i
    i = ZERO
    Do
        If GetIni("INIZAI_OK_SOKO", "SOKOD" & RTrim(Format$(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [INIZAI_OK_SOKO] [SOKO] READ ERROR")
            End
        End If
        If RTrim(c) = "**" Then
            Exit Do
        End If
        SOKO_TD(i).HS_SOKO = RTrim(c)
        If GetIni("INIZAI_OK_SOKO", "NAIGD" & RTrim(Format$(i + 1, "#0")), "SYS", c) Then
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
            Call Log_Out(LOG_F, "[SYS.INI] [INIZAI_OK_SOKO] [NAIG] READ ERROR")
            End
        End If
        SOKO_TD(i).NAIGAI = RTrim(c)
        i = i + 1
    Loop

    If Kaso_Soko_No_Set() Then
        Beep
        MsgBox "âºëzëqå…ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

                                '‹∞∏Ω√∞ºÆ›î‘çÜéÊÇËçûÇ›
    sBuffer = Space(255)
    If GetComputerNameA(sBuffer, 255) <> 0 Then
        com = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)
    Else
        com = "??"
    End If
    WS_NO = RTrim(com)

                                'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇnÇoÇdÇm
    If wITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'óvàˆÉ}ÉXÉ^ÇnÇoÇdÇm
    If YOIN_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ëqå…É}ÉXÉ^ÇnÇoÇdÇm
    If SOKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…ÉfÅ[É^ÇnÇoÇdÇm
    If ZAIKO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'ç›å…à⁄ìÆóÇnÇoÇdÇm
    If IDO_Open(BtOpenNomal) Then
        Unload Me
    End If
                                'âÊñ èâä˙ê›íË
    Call Scr_Init

End Sub
Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer
    
                                            'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ïiñ⁄É}ÉXÉ^ÅiçXêVópÉèÅ[ÉNÅjÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, wITEM_POS, wITEMREC, Len(wITEMREC), K0_wITEM, Len(K0_wITEM), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
                                            'ëqå…É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^")
        End If
    End If
                                            'óvàˆÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")
        End If
    End If
                                            'ç›å…ÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")
        End If
    End If
                                            'ç›å…à⁄ìÆóÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, IDO_POS, IDOREC, Len(IDOREC), K0_IDO, Len(K0_IDO), ZERO)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆó")
        End If
    End If
                                            'ÇaÇîÇíÇâÇÖÇñÇÖÉäÉZÉbÉg
    sts = BTRV(BtOpReset, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), ZERO)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If
    
    Set F1010451 = Nothing

    End
End Sub

Private Sub Input_Lock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
'----------------------------------------------------------------------------
Dim i As Integer

    F1010451.MousePointer = vbHourglass

    Call Ctrl_Lock(F1010451)


End Sub

Private Sub Input_UnLock()
'----------------------------------------------------------------------------
'                   âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
'----------------------------------------------------------------------------
Dim i As Integer

    Call Ctrl_UnLock(F1010451)


    F1010451.MousePointer = vbDefault

End Sub

