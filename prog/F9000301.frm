VERSION 5.00
Begin VB.Form F9000301 
   BackColor       =   &H00FFFFFF&
   Caption         =   "ïiñ⁄É}ÉXÉ^Åiéñã∆ïîópÅjèoóÕ[F900030]2015.07.02 08:00"
   ClientHeight    =   6315
   ClientLeft      =   1920
   ClientTop       =   2430
   ClientWidth     =   11220
   ClipControls    =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   ScaleHeight     =   6315
   ScaleWidth      =   11220
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.CommandButton Command 
      Caption         =   "èI  óπ"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   10320
      TabIndex        =   11
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   9480
      TabIndex        =   10
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   8640
      TabIndex        =   9
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   7800
      TabIndex        =   8
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   6480
      TabIndex        =   7
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   5640
      TabIndex        =   6
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   4800
      TabIndex        =   5
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   3960
      TabIndex        =   4
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   2640
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   1800
      TabIndex        =   2
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   960
      TabIndex        =   1
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.CommandButton Command 
      Caption         =   "é¿  çs"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   120
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   5880
      Width           =   855
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Height          =   255
      Index           =   5
      Left            =   4080
      TabIndex        =   19
      Top             =   2280
      Width           =   975
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Caption         =   "åè"
      Height          =   255
      Index           =   4
      Left            =   5160
      TabIndex        =   18
      Top             =   2280
      Width           =   255
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Caption         =   "ïiñ⁄ì«çûåèêî"
      Height          =   255
      Index           =   3
      Left            =   2040
      TabIndex        =   17
      Top             =   2280
      Width           =   1455
   End
   Begin VB.Label Label2 
      BackColor       =   &H80000009&
      Caption         =   "ïiñ⁄É}ÉXÉ^èoóÕèàóùÇ™èIóπÇµÇ‹ÇµÇΩÅB"
      Height          =   255
      Index           =   1
      Left            =   2040
      TabIndex        =   16
      Top             =   1560
      Visible         =   0   'False
      Width           =   4935
   End
   Begin VB.Label Label2 
      BackColor       =   &H80000009&
      Caption         =   "ïiñ⁄É}ÉXÉ^èoóÕèàóùé¿çsíÜÇ≈Ç∑ÅB"
      Height          =   255
      Index           =   0
      Left            =   2040
      TabIndex        =   15
      Top             =   1200
      Visible         =   0   'False
      Width           =   4335
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Caption         =   "åè"
      Height          =   255
      Index           =   2
      Left            =   5160
      TabIndex        =   14
      Top             =   3120
      Width           =   255
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Height          =   255
      Index           =   1
      Left            =   4080
      TabIndex        =   13
      Top             =   3120
      Width           =   975
   End
   Begin VB.Label Label1 
      BackColor       =   &H80000009&
      Caption         =   "ïiñ⁄çÏê¨åèêî"
      Height          =   255
      Index           =   0
      Left            =   2040
      TabIndex        =   12
      Top             =   3120
      Width           =   1455
   End
End
Attribute VB_Name = "F9000301"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'Const Out_File$ = "\\W1\newsdc\work\ITEM.TXT"  '2014.08.20

Dim Out_File    As String                       '2014.08.20

Dim READ_QTY As Long                    'ì«çûÉfÅ[É^åèêîÅië|èúã@Åj   2015.04.10


Dim OK_QTY As Long                      'èàóùÉfÅ[É^åèêîÅië|èúã@Åj

                                    'âÊñ èâä˙ï\é¶ÅièàóùçœÅuï÷Åvï\é¶Ç»Ç«Åj
Private Sub Scr_Init()

    Label2(0).Visible = False
    Label2(1).Visible = False
    
    Command(0).SetFocus

End Sub
                                        'ïiñ⁄É}ÉXÉ^ìoò^ èàóù
Private Sub SYS_HIN_Main()
Dim sts As Integer
Dim Work As String
Dim com As Integer
    
Dim Err_moji    As Boolean      '2015.07.01
Dim i           As Integer      '2015.07.01
Dim wkHIN_GAI   As String * 15  '2015.07.01
    
    On Error GoTo Err_Exit
    Open Trim(Out_File) For Output As #1
    
    Call Scr_Lock                       'âÊñ çÄñ⁄ÉçÉbÉN
    Label2(0).Visible = True            'éÊçûÇ›íÜ“Øæ∞ºﬁï\é¶

    READ_QTY = 0        '2015.04.10
    OK_QTY = 0          '2015.04.10


    com = BtOpGetFirst

    Do
        
        DoEvents        '2015.04.10
        
        
        Do
            sts = BTRV(com, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            Select Case sts
                Case BtNoErr
                    Exit Do
            
                Case BtErrEOF
                    Exit Do
                Case Else
                    Call File_Error(sts, com, "ïiñ⁄É}ÉXÉ^")
                    Unload Me
            End Select
        Loop
        If sts <> BtNoErr Then Exit Do
        
        READ_QTY = READ_QTY + 1                             '2015.04.10
        Label1(5).Caption = Format(READ_QTY, "#####0")      '2015.04.10
        
        '>2015.07.01
        Err_moji = False
        wkHIN_GAI = StrConv(ITEMREC.HIN_GAI, vbUnicode)
        For i = 1 To Len(wkHIN_GAI)
            If Mid(wkHIN_GAI, i, 1) < " " Or Mid(wkHIN_GAI, i, 1) > "z" Then
                Err_moji = True
                Exit For
            End If
        Next i
        '>2015.07.01
        
        
        If StrConv(ITEMREC.JGYOBU, vbUnicode) <> SOJIKI Or Err_moji Then
        Else
        
            OK_QTY = OK_QTY + 1
            Label1(1).Caption = Format(OK_QTY, "#####0")
            DoEvents
            Work = ""
                                            'éñã∆ïî
            Work = Work & StrConv(ITEMREC.JGYOBU, vbUnicode)
                                            'çëì‡äO
            Work = Work & StrConv(ITEMREC.NAIGAI, vbUnicode)
                                            'ïiî‘ÅiäOïîÅj
            Work = Work & Left(StrConv(ITEMREC.HIN_GAI, vbUnicode), 13)
                                            'ïiñº
            Work = Work & StrConv(ITEMREC.HIN_NAME, vbUnicode)              '2015.07.01
'            Work = Work & Space(25)                                        '2015.07.01
                                            'ïWèÄëqå…ê›íËì˙ït
            Work = Work & StrConv(ITEMREC.ST_SET_DT, vbUnicode)
                                            'ïWèÄì¸å…íI ëqå…
            Work = Work & StrConv(ITEMREC.ST_SOKO, vbUnicode)
                                            'ïWèÄì¸å…íI óÒ
            Work = Work & StrConv(ITEMREC.ST_RETU, vbUnicode)
                                            'ïWèÄì¸å…íI òA
            Work = Work & StrConv(ITEMREC.ST_REN, vbUnicode)
                                            'ïWèÄì¸å…íI íi
            Work = Work & StrConv(ITEMREC.ST_DAN, vbUnicode)
                                            'ëOâÒì¸å…íI ëqå…
            Work = Work & StrConv(ITEMREC.BEF_SOKO, vbUnicode)
                                            'ïWèÄì¸å…íI óÒ
            Work = Work & StrConv(ITEMREC.BEF_RETU, vbUnicode)
                                            'ïWèÄì¸å…íI òA
            Work = Work & StrConv(ITEMREC.BEF_REN, vbUnicode)
                                            'ïWèÄì¸å…íI íi
            Work = Work & StrConv(ITEMREC.BEF_DAN, vbUnicode)
                                            'ç≈èIì¸å…ì˙ït
            Work = Work & StrConv(ITEMREC.LAST_NYU_DT, vbUnicode)
                                            'ç≈èIèoå…ì˙ït
            Work = Work & StrConv(ITEMREC.LAST_SYU_DT, vbUnicode)
                                            'ïiî‘Åiì‡ïîÅj
            Work = Work & Left(StrConv(ITEMREC.HIN_NAI, vbUnicode), 13)
                                            'îıçl ÉzÉXÉgëqå…
            Work = Work & StrConv(ITEMREC.BIKOU_SOKO, vbUnicode)
                                            'îıçl ÉzÉXÉgíIî‘
            Work = Work & StrConv(ITEMREC.BIKOU_TANA, vbUnicode)
                                            'éëçﬁÉRÅ[Éh
    '        Work = Work & StrConv(ITEMREC.SIZAI_CD, vbUnicode)
            Work = Work & Space(5)
                                            'ï‚è[ì_
            Work = Work & StrConv(ITEMREC.HOJYU_P, vbUnicode)
                                            'åéïΩãœèoâ◊êî
            Work = Work & StrConv(ITEMREC.AVE_SYUKA, vbUnicode)
                                            'ÉTÉìÉvÉãêî
            Work = Work & StrConv(ITEMREC.SAMPLE_QTY, vbUnicode)
                                            'ç≈èIì¸â◊ì˙ït
            Work = Work & StrConv(ITEMREC.LAST_INP_DT, vbUnicode)
            Work = Work & Space(11)
            
            Work = "144," & Work
            Print #1, Work
        
        End If
        com = BtOpGetNext
        
    Loop
    Print #1, Chr(26)         '1A
    Close #1
    Label2(0).Visible = False           'é¿çsíÜ“Øæ∞ºﬁ ∏ÿ±
    Label2(1).Visible = True            'èIóπï\é¶
    
    Call Scr_UnLock
    Exit Sub
Err_Exit:
    MsgBox "èoóÕÉGÉâÅ[î≠ê∂ÅI", vbExclamation
    Call Scr_UnLock
End Sub
                                    'âÊñ çÄñ⁄ÉçÉbÉNÅiÉCÉxÉìÉgéÊìæïsâ¬Åj
Private Sub Scr_Lock()

Dim i As Integer

    F9000301.MousePointer = vbHourglass

    For i = 0 To 11
        Command(i).Enabled = False
    Next i

End Sub
                                    'âÊñ çÄñ⁄ÉçÉbÉNâèúÅiÉCÉxÉìÉgéÊìæâ¬Åj
Private Sub Scr_UnLock()

Dim i As Integer

    For i = 0 To 11
        Command(i).Enabled = True
    Next i

    F9000301.MousePointer = vbDefault

End Sub
Private Sub Command_Click(Index As Integer)
Dim yn As Integer

    Select Case Index
        Case 0
            yn = MsgBox("ïiñ⁄É}ÉXÉ^èoóÕèàóùÅ@é¿çsÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbQuestion, "ämîFì¸óÕ")
            If yn = vbYes Then
                Call SYS_HIN_Main            'ïiñ⁄É}ÉXÉ^èoóÕèàóù
                Command(0).Enabled = False
                Command(11).SetFocus
            End If
        Case 11
            Unload Me
        Case Else
            Beep
    End Select
End Sub
Private Sub Command_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
Dim yn As Integer
Dim sts As Integer

    Select Case KeyCode
        Case vbKeyF1
            Command(0).Value = True
        Case vbKeyF12
            Command(11).Value = True
        Case Else
            Beep
            If Command(0).Enabled = True Then
                Command(0).SetFocus
            Else
                Command(11).SetFocus
            End If
    End Select
End Sub

Private Sub Form_Activate()
    
    Call SYS_HIN_Main            'ïiñ⁄É}ÉXÉ^èoóÕèàóù
    
    Unload Me

End Sub

Private Sub Form_DblClick()
    PrintForm
End Sub
Private Sub Form_KeyPress(KeyAscii As Integer)
    If KeyAscii = vbKeyReturn Then
        KeyAscii = 0
    End If
End Sub
Private Sub Form_Load()
Dim i As Integer
Dim j As Integer
Dim c As String * 128
Dim sts As Integer


'    Show
                                'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    LOG_F = RTrim(c)
                                'êV ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(0) Then
        Beep
        MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    
    
'----------------   2014.08.20
    If GetIni(App.EXEName, "Out_File", App.EXEName, c) Then
    
        Out_File$ = "ITEM.TXT"
    Else
        Out_File = RTrim(c)
    
    End If
'----------------   2014.08.20

    
    
'    Call SYS_HIN_Main            'ïiñ⁄É}ÉXÉ^èoóÕèàóù
'    Unload Me
    
End Sub
Private Sub Form_Unload(Cancel As Integer)
Dim sts As Integer
    
                                            'êV ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
            Beep
            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇèIóπÇµÇƒâ∫Ç≥Ç¢ÅB", vbOKOnly
        End If
    End If
                                            'ÇaÇîÇíÇâÇÖÇñÇÖÉäÉZÉbÉg
    sts = BTRV(BtOpReset, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "ïiñ⁄É}ÉXÉ^")
        Beep
        MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅBèàóùÇèIóπÇµÇƒâ∫Ç≥Ç¢ÅB", vbOKOnly
    End If

    End
End Sub

