VERSION 5.00
Object = "{D4A17F03-6EDB-11D2-A6E0-0040262B3978}#2.2#0"; "CtrsWsk.ocx"
Begin VB.Form F1100101 
   Caption         =   "ÉXÉLÉÉÉiêßå‰"
   ClientHeight    =   4890
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   6765
   BeginProperty Font 
      Name            =   "ÇlÇr ÉSÉVÉbÉN"
      Size            =   12
      Charset         =   128
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   ScaleHeight     =   4890
   ScaleWidth      =   6765
   StartUpPosition =   2  'âÊñ ÇÃíÜâõ
   Begin VB.TextBox Text2 
      BackColor       =   &H8000000F&
      Height          =   360
      Index           =   3
      Left            =   2280
      Locked          =   -1  'True
      TabIndex        =   17
      Top             =   3600
      Width           =   375
   End
   Begin VB.TextBox Text2 
      BackColor       =   &H8000000F&
      Height          =   360
      Index           =   2
      Left            =   1560
      Locked          =   -1  'True
      TabIndex        =   15
      Top             =   3600
      Width           =   375
   End
   Begin VB.CommandButton Command2 
      Caption         =   "ê›íË"
      Height          =   375
      Left            =   2760
      TabIndex        =   13
      Top             =   4320
      Width           =   855
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Interval        =   30000
      Left            =   120
      Top             =   2760
   End
   Begin VB.TextBox Text2 
      Height          =   360
      Index           =   1
      Left            =   2280
      TabIndex        =   12
      Top             =   4320
      Width           =   375
   End
   Begin VB.TextBox Text2 
      Height          =   360
      Index           =   0
      Left            =   1560
      TabIndex        =   10
      Top             =   4320
      Width           =   375
   End
   Begin VB.TextBox errText 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H000000FF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   20.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   1
      Left            =   210
      TabIndex        =   7
      Text            =   "LOG.TXTÇämîF"
      Top             =   7080
      Visible         =   0   'False
      Width           =   6135
   End
   Begin VB.TextBox errText 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H000000FF&
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   20.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Index           =   0
      Left            =   210
      TabIndex        =   6
      Top             =   6480
      Visible         =   0   'False
      Width           =   6180
   End
   Begin VB.CommandButton Command1 
      Caption         =   "àÍéûí‚é~"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   2
      Left            =   1620
      TabIndex        =   5
      Top             =   2520
      Width           =   3375
   End
   Begin VB.TextBox Text1 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   1
      Left            =   165
      TabIndex        =   4
      Top             =   5340
      Width           =   10695
   End
   Begin VB.TextBox Text1 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   8.25
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Index           =   0
      Left            =   165
      TabIndex        =   3
      Top             =   4920
      Width           =   10695
   End
   Begin VB.TextBox Text1 
      ForeColor       =   &H000000FF&
      Height          =   360
      Index           =   2
      Left            =   165
      TabIndex        =   2
      Top             =   5940
      Width           =   6255
   End
   Begin VB.CommandButton Command1 
      Caption         =   "ã∆ñ±èIóπ"
      Enabled         =   0   'False
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   1
      Left            =   1605
      TabIndex        =   1
      Top             =   1620
      Visible         =   0   'False
      Width           =   3375
   End
   Begin VB.CommandButton Command1 
      Caption         =   "ã∆ñ±äJén"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   12
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   735
      Index           =   0
      Left            =   1605
      TabIndex        =   0
      Top             =   660
      Width           =   3375
   End
   Begin VB.Label Label3 
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   9.75
         Charset         =   128
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   255
      Left            =   3720
      TabIndex        =   18
      Top             =   4440
      Width           =   2775
   End
   Begin VB.Label Label2 
      Caption         =   "ÅF"
      Height          =   255
      Index           =   3
      Left            =   2040
      TabIndex        =   16
      Top             =   3720
      Width           =   255
   End
   Begin VB.Label Label2 
      Caption         =   "äJénéûçè"
      Height          =   255
      Index           =   2
      Left            =   360
      TabIndex        =   14
      Top             =   3720
      Width           =   1095
   End
   Begin VB.Label Label2 
      Caption         =   "ÅF"
      Height          =   255
      Index           =   1
      Left            =   2040
      TabIndex        =   11
      Top             =   4440
      Width           =   255
   End
   Begin VB.Label Label2 
      Caption         =   "èIóπéûçè"
      Height          =   255
      Index           =   0
      Left            =   360
      TabIndex        =   9
      Top             =   4440
      Width           =   1095
   End
   Begin VB.Label Label1 
      Alignment       =   2  'íÜâõëµÇ¶
      BackColor       =   &H00C0FFC0&
      Caption         =   "äîéÆâÔé–ÇrÇcÇbÅ@POSä«óùÉVÉXÉeÉÄ[í‚é~íÜ]"
      BeginProperty Font 
         Name            =   "ÇlÇr ÉSÉVÉbÉN"
         Size            =   11.25
         Charset         =   128
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   0
      TabIndex        =   8
      Top             =   0
      Width           =   6540
   End
   Begin CTRSWSKLib.CtrsWsk CtrsWsk1 
      Left            =   270
      Top             =   1860
      _Version        =   131074
      _ExtentX        =   847
      _ExtentY        =   847
      _StockProps     =   0
   End
End
Attribute VB_Name = "F1100101"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit



'***************************** ÇeÇhÇkÇdÅ@ÇcÇdÇkÇdÇsÇdämîFñYÇÍÇÈÇ»ÅIÅI

    


'''''''''''''''''''''''''''''''' Label_File_Make_ProcÇÃ¡™Ø∏ÇnÇjÅHÅ@***********************************************
'''''''''''''''''''''''''''''''' 20110.11.30ÇÃ¡™Ø∏ÇnÇjÅHÅ@***********************************************

Private Const LAST_UPDATE_DAY$ = "([F110010] 2012.11.19 08:00)"



Private Sub Command1_Click(Index As Integer)
'-------------------------------------------------------
'
'   Åwã∆ñ±äJénéwé¶Åx
'       ÇPÅD É|Å[ÉgÇÃälìæ
'       ÇQÅD É|Å[ÉgÇÃäJï˙
'-------------------------------------------------------
    
Dim ans As Integer
    
    On Error GoTo Error
    
    Select Case Index
        
        Case 0                              'ã∆ñ±äJén
            
            CtrsWsk1.Bind LocalPort, RemotePort
            F1100101.Caption = "ÉXÉLÉÉÉiêßå‰" & " " & LAST_UPDATE_DAY
    
    
            Label1.Caption = "äîéÆâÔé–ÇrÇcÇbÅ@ÇoÇnÇrÉVÉXÉeÉÄ[é¿çsíÜ]"
    
    
            Command1(0).Enabled = False
            
            
            Command1(0).Caption = Format(Now, "YYYY/MM/DD HH:MM:SS")
            
            
            Command1(1).Enabled = True
            Command1(2).Enabled = True
    
        Case 1                              'ã∆ñ±èIóπ
            
            
            ans = MsgBox("ñ{ì˙ÇÃã∆ñ±èIóπÇµÇ‹Ç∑Ç©ÅH", vbYesNo + vbDefaultButton2, "ã∆ñ±èIóπ")
            If ans = vbNo Then
                Exit Sub
            End If
            
            CtrsWsk1.Unbind
            
            Normal_End = False              'ê≥èÌèIóπ
            
            Next_Step = 1                   'éüèàóùãNìÆÇ∑ÇÈ
            Unload Me
    
        Case 2
            CtrsWsk1.Unbind
            
            Normal_End = False              'ê≥èÌèIóπ
            Next_Step = 0                   'éüèàóùãNìÆÇµÇ»Ç¢
            Unload Me
    
    End Select
    
    Exit Sub

Error:
    MsgBox "Winsock Error= " & Err.Description    'ÉXÉeÅ[É^ÉXçsÇ…ÉGÉâÅ[Çï\é¶ÇµÇ‹Ç∑ÅB
    
    Call LOG_OUT(LOG_F, "Winsock Error= " & Err.Description)
    
    Normal_End = True                       'àŸèÌèIóπ
    Unload Me
    


End Sub


Private Sub Command2_Click()


Dim sts     As Integer
Dim yn      As Integer

    If Not IsNumeric(Text2(0).Text) Or Not IsNumeric(Text2(1).Text) Then
        Label3.Caption = "ÅuèIóπéûçèÅvì¸óÕÉGÉâÅ["
        Text2(0).SetFocus
        Exit Sub
    End If

    Text2(0).Text = Format(Val(Text2(0).Text), "00")
    If Val(Text2(0).Text) < 0 Or Val(Text2(0).Text) > 23 Then
        Label3.Caption = "ÅuèIóπéûçèÅvì¸óÕÉGÉâÅ["
        Text2(0).SetFocus
        Exit Sub
    End If
    Text2(1).Text = Format(Val(Text2(1).Text), "00")
    If Val(Text2(1).Text) < 0 Or Val(Text2(1).Text) > 59 Then
        Label3.Caption = "ÅuèIóπéûçèÅvì¸óÕÉGÉâÅ["
        Text2(1).SetFocus
        Exit Sub
    End If
    
    sts = WriteIni(App.EXEName, "ENDTIME", "SYS", Text2(0).Text & Text2(1).Text)
    If sts Then
        Label3.Caption = "ÅuèIóπéûçèÅvèëÇ´çûÇ›ÉGÉâÅ[ SYS.INI"
    End If
End Sub

Private Sub CtrsWsk1_OnReceive(ByVal ID_NO As Integer, ByVal RecvText As String, ByVal Resp_Mode As Boolean)
'-------------------------------------------------------
'
'   ÅwÉåÉRÅ[ÉhéÛêMéûèàóùÅx
'
'-------------------------------------------------------

Dim nErrCode    As Integer
Dim strErrMsg   As String
Dim intLine     As Integer
Dim i           As Integer
Dim j           As Integer
Dim Chk_Time    As String * 8
Dim Sendbuf     As String

Dim Errbuf      As String

Dim sts         As Integer

Dim Start_Flg   As Integer


    Text1(0).Text = Format(ID_NO, "000") & ", Recv=" & RecvText
    
'    Call Log_Out(LOG_F, Format(ID_NO, "000") & ", Recv=" & RecvText)
        
    RecvText = Left(RecvText, Len(RecvText) - 2)
    
                                    'ÇhÇcáÇÇ≈éÛêMçœÇ›ÉeÉLÉXÉgåüçı
    ING_No = -1
    
    Start_Flg = False
    
    For i = 0 To UBound(ID_KANRI_TBL)
        If ID_NO = ID_KANRI_TBL(i).ID Then
            ING_No = i
            Chk_Time = ID_KANRI_TBL(i).Time
            Exit For
        End If
    Next i
    
    
    
    
    
    If i > UBound(ID_KANRI_TBL) Then
                                                'ÇhÇcáÇêVãKìoò^
        For i = 0 To UBound(ID_KANRI_TBL)
            If ID_KANRI_TBL(i).ID = 0 Then
                
                Start_Flg = True
                
                ID_KANRI_TBL(i).ID = ID_NO      'ID_No  ï€ë∂
                
'                ID_KANRI_TBL(i).MENU_GRP = ""
                ID_KANRI_TBL(i).MENU_LV1 = ""
                ID_KANRI_TBL(i).MENU_LV2 = ""
''                ID_KANRI_TBL(i).MENU_LV3 = ""
                
                If UBound(JGYOBU_T) = 0 Then    'ÇPéñã∆ïîå≈íË
                Else
                    ID_KANRI_TBL(i).JGYOBU = ""
                End If
                
                If UBound(NAIGAI) = 0 Then   'çëì‡äOå≈íË
                Else
                    ID_KANRI_TBL(i).NAIGAI = ""
                End If
                
                ING_No = i
                Chk_Time = ""
                Exit For
            End If
        
        Next i
    End If
    
    
'Call Log_Out(LOG_F, Format(ID_NO, "000") & ",Yoin= " & ID_KANRI_TBL(i).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(i).Sagyo_Code.YOIN_CODE)
    
    
    If ING_No = -1 Then
        MsgBox "ÇhÇmÇhÉtÉ@ÉCÉãÇÃéqã@êîÇÃê›íËÇïœçXÇµÇƒâ∫Ç≥Ç¢ÅB", vbCritical
        Normal_End = True
        Unload Me
    End If
    
                                            'ëOâÒéÛêMílÇçƒéÛêMÇµÇΩÅH
    If Left(Right(RecvText, 9), 8) = ID_KANRI_TBL(i).Time And _
         Right(RecvText, 1) = "1" Then
            Call Send_Err_Proc(Sendbuf)
    
            Call LOG_OUT(LOG_F, Format(ID_NO, "000") & ", Send=" & Sendbuf & "[çƒëóêM]")
    
    Else
                                            
        '>>>>>>>>>>>>>>>>>>>>>> 2013.01.04
        
        If Val(Left(Right(RecvText, 9), 8)) <> 0 Then
            If Left(Right(RecvText, 9), 8) < ID_KANRI_TBL(ING_No).Time Then
                                                    
                Call Err_Send_Proc("éÛêMÉGÉâÅ[", "çƒì«çûÇ›ÇµÇƒâ∫Ç≥Ç¢", "", "", "")
                Sendbuf = Text_Create_Proc()
                GoTo SendResp_Proc
            End If
        End If
        '>>>>>>>>>>>>>>>>>>>>>> 2013.01.04
                                            
                                            
                                            
                                            
                                            'éÛêMì‡óeÇï€ë∂
        ID_KANRI_TBL(ING_No).Recv_text(0) = Left(RecvText, 20)       'éÛêMì‡óeÇPçsñ⁄
        ID_KANRI_TBL(ING_No).Recv_text(1) = Mid(RecvText, 21, 20)    'éÛêMì‡óeÇQçsñ⁄
        ID_KANRI_TBL(ING_No).Recv_text(2) = Mid(RecvText, 41, 20)    'éÛêMì‡óeÇRçsñ⁄
        ID_KANRI_TBL(ING_No).Recv_text(3) = Mid(RecvText, 61, 20)    'éÛêMì‡óeÇSçsñ⁄
        ID_KANRI_TBL(ING_No).Recv_text(4) = Mid(RecvText, 81, 20)    'éÛêMì‡óeÇSçsñ⁄
        ID_KANRI_TBL(ING_No).Time = Left(Right(RecvText, 9), 8)      'ëóêMéûçè
        
        
                                            
        If Start_Flg Then
            If Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) <> Start_Para Then
                Call Err_Send_Proc("çƒãNìÆÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB", "", "", "", "")
                Sendbuf = Text_Create_Proc()
            End If
        End If
                                            
        If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SHOUHINKA Then
            
            If Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) = Fin_Para Then
            
                If ID_KANRI_TBL(ING_No).Step >= Step_Sagyo2_REQ Then
                
                    ID_KANRI_TBL(ING_No).Recv_text(0) = "ENT"
                End If
            End If
        End If
                                      
                                      
                                      
        If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = Wel_COMPO_CHECK Then
            
            
            If ID_KANRI_TBL(ING_No).Step >= Step_Sagyo2_REQ Then
                
                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(ID_KANRI_TBL(ING_No).Input_Line + 2)), 2) = LCD_Hinban Then
                            
                
                
                
                    ID_KANRI_TBL(ING_No).Recv_text(0) = "ENT"
                End If
            End If
        End If
                                      
                                      
                                      
                                      
                                      
                                      '[START][CANCEL][FINISHI]éÛêMÇÕèâä˙âªÇ∑ÇÈ
        Select Case Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
            Case Start_Para     'äJén(éqã@ìdåπON)
                
                
                            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                sts = Data_Clear_Proc(0, Sendbuf)
                Select Case sts
                    Case SYS_ERR
                        Normal_End = True
                End Select
                
                
                ID_KANRI_TBL(ING_No).Step = Step_Start
        
                ID_KANRI_TBL(ING_No).CTR_TYPE = Trim(ID_KANRI_TBL(ING_No).Recv_text(1))
                        
        
                Call Start_Proc(Sendbuf)
            
            
            Case Ent_Para       'ENT
                If Not Start_Flg Then
                    
                    If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_MTS Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_DEN Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SPECIAL_PROCESS Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_BINNO Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_GAI Or _
                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SHOUHINKA Then '2009.08.08
                        'åüïiéûÇÃämîF
                        
                        
                        
    '                    Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
    '                    Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
    '                    sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    '                    Select Case sts
    '                        Case BtNoErr
    '                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
    '                        Case Else
    '                       'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
    '                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
    '                        Sendbuf = Text_Create_Proc()
    '                        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
    '                        Normal_End = True
    '                    End Select
    '
                        
                        
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                        
                        If Sagyo_Main_Proc(Sendbuf) Then
                            Normal_End = True
    '                        Unload Me
                        End If
                    Else
                        
                        '--------------------------------------------------- ëÂç„  ïîçﬁëŒâûÅ@2012.03.06
                        If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = Wel_HIN_FURIKA_S Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = Wel_IDO_IN_OSAKA Then
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                            
                            If Sagyo_Main_Proc(Sendbuf) Then
                                Normal_End = True
                            End If
                        
                        Else
                        '--------------------------------------------------- ëÂç„  ïîçﬁëŒâûÅ@2012.03.06
                            'éQè∆âÊñ ÇÃämîFéûÇÃÇ›
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                 '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                               'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Normal_End = True
                            End Select
                            
                             
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Normal_End = True
                            End If
                            Sendbuf = Text_Create_Proc()
                        End If
                    End If
                Else
                    ID_KANRI_TBL(i).ID = 0
                End If
            Case Can_Para       'CANCEL
                If Not Start_Flg Then
                
                    If ID_KANRI_TBL(ING_No).Last_Send = 1 Then
                                
If 0 = 100 Then
    GoTo print_end
End If
                        'åüïiéûÇÕÉfÅ[É^ÇÃäJï˙ÇçsÇ§Å@2004.06.14 Å´
                        If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_MTS Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SPECIAL_PROCESS Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_BINNO Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_GAI Then '2009.08.08


                                 
                            
                            
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    If Sagyo_Send_Proc() Then
                                        Sendbuf = Text_Create_Proc()
                                        Normal_End = True
                                    End If
                                    Sendbuf = Text_Create_Proc()
                                
                                Case SYS_ERR
                                    Normal_End = True
                            End Select
                        
                        Else
                        
'''                             ëÂç„PCå¸ÇØÇÕÅAì¡íËÇÃΩ√ØÃﬂÇÃÇ›âèúÇ∑ÇÈ
                            If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_DEN Then '2006.12.07
                                If (ID_KANRI_TBL(ING_No).Step <> Step_Sagyo2_RES And _
                                    ID_KANRI_TBL(ING_No).Step <> Step_Sagyo3_RES And _
                                    ID_KANRI_TBL(ING_No).Step <> Step_Sagyo5_RES) Then
                                
                                    sts = Data_Clear_Proc(0, Sendbuf)
                                    Select Case sts
                                        Case SYS_CANCEL
                                            If Sagyo_Send_Proc() Then
                                                Sendbuf = Text_Create_Proc()
                                                Normal_End = True
                                            End If
                                            Sendbuf = Text_Create_Proc()
                                        
                                        Case SYS_ERR
                                            Normal_End = True
                                    End Select
                                
                                End If
                            End If
                        End If
                                
                        'åüïiéûÇÕÉfÅ[É^ÇÃäJï˙ÇçsÇ§Å@2004.06.14 Å™
                                
                        
                        
                        '√ﬁ∞¿âï˙èàóùÇí«â¡ 2011.04.07
                        If (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SYUKA_HYO Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_DENPYO_ID Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SYUKA_HYO_OSAKA) Then
                            If (ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ) Then


                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        If Sagyo_Send_Proc() Then
                                            Sendbuf = Text_Create_Proc()
                                            Normal_End = True
                                        End If
                                        Sendbuf = Text_Create_Proc()

                                    Case SYS_ERR
                                        Normal_End = True
                                End Select

                            End If
                        End If
                        '√ﬁ∞¿âï˙èàóùÇí«â¡ 2011.04.07
                                
                                
                                'ëOâÒÇ™ÉGÉâÅ[ëóêM
                        Call Re_Send_Proc(Sendbuf)
                
                    Else
                                
                                
                                                        
                                
                                'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Normal_End = True
                                End If
                                Sendbuf = Text_Create_Proc()
                            
                            Case SYS_ERR
                                Normal_End = True
                        End Select
                
                
                
                        Call Cancel_Proc(Sendbuf)
                
                    End If
            
                Else
                    ID_KANRI_TBL(i).ID = 0
                End If
            
            Case Fin_Para       'FINISH
                    
                If Not Start_Flg Then
                
                
                
                    If ID_KANRI_TBL(ING_No).LABEL_ON Then
                        ID_KANRI_TBL(ING_No).LABEL_ON = False
                
                
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                    
                        If Sagyo_Main_Proc(Sendbuf) Then
                            Normal_End = True
                        End If
                
                    Else
                
                
                        'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                If Sagyo_Send_Proc() Then
                                    Normal_End = True
                                End If
                                Sendbuf = Text_Create_Proc()
                        
                            Case SYS_ERR
                                Normal_End = True
                        End Select
                    
                    
    '                    If Step_MENU1_REQ < ID_KANRI_TBL(ING_No).Step Then
                        If Step_TANTO_REQ <> ID_KANRI_TBL(ING_No).Step Then      '2005.01.07 if Å`Å@else Å`Å@end if
                        
                            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
    '2006.01.30                        ID_KANRI_TBL(ING_No).MENU_LV3 = ""
                    
                            ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
                            ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
    '2006.01.03                        ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
                    
                    
                    
                            ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                    
                            If Menu_Send_Proc(Sendbuf) Then
                                Normal_End = True
        '                Unload Me
                            End If
                    
                        Else                                                    '2005.01.07
    '                        ID_KANRI_TBL(ING_No).Step = Step_Start
                                                                                '2005.01.07
                            Call Start_Proc(Sendbuf)                            '2005.01.07
                                                                                '2005.01.07
                        End If                                                  '2005.01.07
                    End If
                Else
                    ID_KANRI_TBL(i).ID = 0
                End If
            
            
            '2008.08.08 MENU FIN
            Case MENU_FIN
            
                            
                If Not Start_Flg Then
                    If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                ID_KANRI_TBL(ING_No).NAIGAI, _
                                                ID_KANRI_TBL(ING_No).MENU_LV1, _
                                                "EN", , , , , , , , , FILE_RETRY) Then
                                    
                        Normal_End = True
                    
                    End If
                            
                    Text1(1).Text = Format(ID_KANRI_TBL(ING_No).ID, "000") & "=" & "EN"
                            
                            
'                    ST_LOG_OUT_F = True
                
                    If ID_KANRI_TBL(ING_No).Last_Send = 1 Then
                                
                                
                        'åüïiéûÇÕÉfÅ[É^ÇÃäJï˙ÇçsÇ§Å@2004.06.14 Å´
                        If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_MTS Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_SPECIAL_PROCESS Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_BINNO Or _
                            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_GAI Then '2009.08.08


                                 
                            
                            
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    If Sagyo_Send_Proc() Then
                                        Sendbuf = Text_Create_Proc()
                                        Normal_End = True
                                    End If
                                    Sendbuf = Text_Create_Proc()
                                
                                Case SYS_ERR
                                    Normal_End = True
                            End Select
                        
                        Else
                        
'''                             ëÂç„PCå¸ÇØÇÕÅAì¡íËÇÃΩ√ØÃﬂÇÃÇ›âèúÇ∑ÇÈ
                            If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ACT_KENPIN_DEN Then '2006.12.07
                                If (ID_KANRI_TBL(ING_No).Step <> Step_Sagyo2_RES And _
                                    ID_KANRI_TBL(ING_No).Step <> Step_Sagyo3_RES And _
                                    ID_KANRI_TBL(ING_No).Step <> Step_Sagyo5_RES) Then
                                
                                    sts = Data_Clear_Proc(0, Sendbuf)
                                    Select Case sts
                                        Case SYS_CANCEL
                                            If Sagyo_Send_Proc() Then
                                                Sendbuf = Text_Create_Proc()
                                                Normal_End = True
                                            End If
                                            Sendbuf = Text_Create_Proc()
                                        
                                        Case SYS_ERR
                                            Normal_End = True
                                    End Select
                                
                                End If
                            End If
                        End If
                                
                        'åüïiéûÇÕÉfÅ[É^ÇÃäJï˙ÇçsÇ§Å@2004.06.14 Å™
                                
                                'ëOâÒÇ™ÉGÉâÅ[ëóêM
                        Call Re_Send_Proc(Sendbuf)
                
                    Else
                                'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Normal_End = True
                                End If
                                Sendbuf = Text_Create_Proc()
                            
                            Case SYS_ERR
                                Normal_End = True
                        End Select
                
                
                
                        Call Cancel_Proc(Sendbuf, 1, "EN")          '2008.09.01  ﬂ◊“∞¿í«â¡
                
                    End If
            
                Else
                    ID_KANRI_TBL(i).ID = 0
                End If
            
            
            
            '2008.08.08 MENU FIN
            
            
            
            
            
            Case P_END_Para     'àÛç¸äÆóπ   2010.01.21
            
print_end:
            
                ID_KANRI_TBL(ING_No).LABEL_ON = False
        
        
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
            
                If Sagyo_Main_Proc(Sendbuf) Then
                    Normal_End = True
                End If
            
            
            
            Case Else
                If Not Start_Flg Then
                                            'êiíªÉ`ÉFÉbÉN
                    Select Case ID_KANRI_TBL(ING_No).Step
            
            
                        Case Step_TANTO_REQ         'íSìñé“óvãÅÇ…ëŒÇ∑ÇÈÉåÉX
                        
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_TANTO_RES
        
                            If Normal_Proc(Sendbuf) Then
                                Normal_End = True
    '                        Unload Me
                            End If
        
                        Case Step_JGYOBU_REQ        'éñã∆ïîóvãÅÇ…ëŒÇ∑ÇÈÉåÉX
                
                            Select Case Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
    '                        Case BEF_Page       'ëOï≈
    '                        Case NEXT_Page      'éüï≈
                                Case Else            'éñã∆ïîéÛêM
                
                                    ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_RES
              
                                    ID_KANRI_TBL(ING_No).JGYOBU = Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
        
                                    If Normal_Proc(Sendbuf) Then
                                        Normal_End = True
    '                                Unload Me
                                    End If
                
                            End Select
                                    
                        Case Step_NAIGAI_REQ
                    
                            Select Case Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
                                Case Else           'ÉÅÉjÉÖÅ[ÉpÉâÉÅÅ[É^éÛêM
                
                                    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_RES
                                        
                                    ID_KANRI_TBL(ING_No).NAIGAI = Trim(ID_KANRI_TBL(i).Recv_text(0))
                                
        
                                    If Normal_Proc(Sendbuf) Then
                                        Normal_End = True
    '                                Unload Me
                                    End If
                
                            End Select
    
'2006.01.30                        Case Step_MENU1_REQ, Step_MENU2_REQ, Step_MENU3_REQ
                        Case Step_MENU1_REQ, Step_MENU2_REQ
                
                             Select Case Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
                                Case BEF_Page       'ëOï≈
                            
                                    
                                    Select Case ID_KANRI_TBL(ING_No).Step
                                        Case Step_MENU1_REQ
                                            ID_KANRI_TBL(ING_No).PageNo_LV1 = ID_KANRI_TBL(ING_No).PageNo_LV1 - 1
                                        Case Step_MENU2_REQ
                                            ID_KANRI_TBL(ING_No).PageNo_LV2 = ID_KANRI_TBL(ING_No).PageNo_LV2 - 1
'2006.01.30                                        Case Step_MENU3_REQ
'2006.01.30                                            ID_KANRI_TBL(ING_No).PageNo_LV3 = ID_KANRI_TBL(ING_No).PageNo_LV3 - 1
                                    End Select
                                    
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                                    
                                    If Menu_Recv_Proc(Sendbuf) Then
                                        Normal_End = True
    '                                Unload Me
                                    End If
                            
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            
                                Case NEXT_Page      'éüï≈
                                    
                                    
                                    Select Case ID_KANRI_TBL(ING_No).Step
                                        Case Step_MENU1_REQ
                                            ID_KANRI_TBL(ING_No).PageNo_LV1 = ID_KANRI_TBL(ING_No).PageNo_LV1 + 1
                                        Case Step_MENU2_REQ
                                            ID_KANRI_TBL(ING_No).PageNo_LV2 = ID_KANRI_TBL(ING_No).PageNo_LV2 + 1
'2006.01.30                                        Case Step_MENU3_REQ
'2006.01.30                                            ID_KANRI_TBL(ING_No).PageNo_LV3 = ID_KANRI_TBL(ING_No).PageNo_LV3 + 1
                                    End Select
                                    
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                                    If Menu_Recv_Proc(Sendbuf) Then
                                        Normal_End = True
    '                                Unload Me
                                    End If
                            
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                
                                Case Else           'ÉÅÉjÉÖÅ[ÉpÉâÉÅÅ[É^éÛêM
                
                                    Select Case ID_KANRI_TBL(ING_No).Step
                                        Case Step_MENU1_REQ
                                            ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
                                        Case Step_MENU2_REQ
'                                            ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30                                        Case Step_MENU3_REQ
'2006.01.30                                            ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
                                    End Select
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                                
                                    Select Case ID_KANRI_TBL(ING_No).Step
                                        Case Step_MENU1_RES
                                            ID_KANRI_TBL(ING_No).MENU_LV1 = Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
                                        
                                        
                                            '2008.08.08
                                            If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                                        ID_KANRI_TBL(ING_No).JGYOBU, _
                                                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                                                        ID_KANRI_TBL(ING_No).MENU_LV1, _
                                                                        "ST", , , , , , , , , FILE_RETRY) Then
                            
                                                Normal_End = True
                                            End If
                                            
                                                                                
                                            Text1(1).Text = Format(ID_KANRI_TBL(ING_No).ID, "000") & "=" & "ST"
                                            
                                            
                                            '2008.08.08
                                        
                                        
                                        
                                        Case Step_MENU2_RES
                                            ID_KANRI_TBL(ING_No).MENU_LV2 = Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
                                            ID_KANRI_TBL(ING_No).MTS_CODE = Mid(ID_KANRI_TBL(ING_No).Recv_text(0), 3, 8)
                                            ID_KANRI_TBL(ING_No).SS_CODE = Mid(ID_KANRI_TBL(ING_No).Recv_text(0), 11, 8)

'2006.01.30                                        Case Step_MENU3_RES
'2006.01.30                                            ID_KANRI_TBL(ING_No).MENU_LV3 = Trim(ID_KANRI_TBL(ING_No).Recv_text(0))
                                    
                                    
                                    
                                            '2008.08.08
'                                            If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
'                                                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
'                                                                        ID_KANRI_TBL(ING_No).JGYOBU, _
'                                                                        ID_KANRI_TBL(ING_No).NAIGAI, _
'                                                                        ID_KANRI_TBL(ING_No).MENU_LV1, _
'                                                                        "ST", , , , , , , , , FILE_RETRY) Then
'
'                                                Normal_End = True
'                                            End If
                                            '2008.08.08
                                    
                                    
                                    
                                    
                                    
                                    
                                    End Select
                
                                
                                    If Menu_Recv_Proc(Sendbuf) Then
                                        Normal_End = True
    '                                Unload Me
                                    End If
                
                            End Select
                        
                        Case Step_Sagyo1_REQ, Step_Sagyo2_REQ, Step_Sagyo3_REQ, Step_Sagyo4_REQ, Step_Sagyo5_REQ, Step_Sagyo6_REQ
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
                        
                            If Sagyo_Main_Proc(Sendbuf) Then
                                Normal_End = True
    '                        Unload Me
                            End If
                        Case Else
                    End Select
                Else
                    ID_KANRI_TBL(i).ID = 0
                End If
    
        
        End Select
    
    End If
    
    
SendResp_Proc:              '2013.01.04


    If Resp_Mode Then
        On Error GoTo ShowError

        CtrsWsk1.SendResp Sendbuf

'        Text1(1).Text = Format(ID_NO, "000") & ", Send=" & SendBuf
        
'        Call Log_Out(LOG_F, Format(ID_NO, "000") & ", Send=" & Sendbuf)

        On Error GoTo 0
    
        ID_KANRI_TBL(ING_No).Last_Send_Text.sts = Send_Text.sts                     'ÉXÉeÅ[É^ÉX
        ID_KANRI_TBL(ING_No).Last_Send_Text.Display_Flg = Send_Text.Display_Flg     'ï\é¶âÊñ ÉtÉâÉO
        ID_KANRI_TBL(ING_No).Last_Send_Text.End_Menu = Send_Text.End_Menu           'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
        ID_KANRI_TBL(ING_No).Last_Send_Text.Menu_Suu = Send_Text.Menu_Suu           'ÉÅÉjÉÖÅ[å¬êî
        ID_KANRI_TBL(ING_No).Last_Send_Text.fileName = Send_Text.fileName           'ÉtÉ@ÉCÉãñº
        ID_KANRI_TBL(ING_No).Last_Send_Text.Buzzer = Send_Text.Buzzer               'ÉuÉUÅ[éwíË
        
        For j = 0 To M_Gyo - 1
                                                                                    'BOXëÆê´
            ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).Box_Type = Send_Text.Box_Type(j).Box_Type
                                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).LCD, StrConv(Send_Text.Box_Type(j).LCD, vbUnicode))
                                                                                    'èâä˙ì‡óe
            ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).INIT = Send_Text.Box_Type(j).INIT
                                                                                    'äJénÉJÅ[É\Éãà íu
            ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).Start_Pos = Send_Text.Box_Type(j).Start_Pos
                                                                                    'ì¸óÕåÖêîÅiç≈ëÂÅj
            ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).Max_Size = Send_Text.Box_Type(j).Max_Size
                                                                                    'ÉÅÉjÉÖÅ[ì‡óe
            ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(j).MENU = Send_Text.Box_Type(j).MENU
                    
        
        Next j
    
    
        If Normal_End Then
            
'            MsgBox "ÉVÉXÉeÉÄàŸèÌÇ™î≠ê∂ÇµÇ‹ÇµÇΩÅIÅIèàóùÇÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB"
 
            
'            Unload Me
        End If
    End If

    Exit Sub

ShowError:
    nErrCode = Err.Number
    strErrMsg = Err.Description         'ÉGÉâÅ[ÉÅÉbÉZÅ[ÉW
    
    intLine = CtrsWsk1.ErrLineNo        'ê⁄ë±î‘çÜÇéÊìæÇµÇ‹Ç∑ÅB
    If intLine > 0 Then
        strErrMsg = strErrMsg & Chr(&HD) & Chr(&HA) & "ê⁄ë±î‘çÜ = " & intLine
    End If

    Text1(2).Text = strErrMsg           'ÉXÉeÅ[É^ÉXçsÇ…ÉGÉâÅ[Çï\é¶ÇµÇ‹Ç∑ÅB
    
'    Call Log_Out(LOG_F, Format(ID_NO, "000") & ", Send=" & Sendbuf)


End Sub

Private Sub Form_Activate()
    
    Command1(0).Value = True            '2012.11.06
    Timer1.Enabled = True               '2012.11.06

End Sub

Private Sub Form_Load()
    
Dim c           As String * 128
Dim Out_Data    As String

Dim Box_Type    As String * 1
Dim LCD         As String * 10
Dim Keta        As String * 2

Dim i           As Integer
Dim j           As Integer
Dim k           As Integer
    
Dim sts         As Integer
    
Dim wkSHIMUKE   As Variant
    
Dim wkUNSOU_KAISHA  As Variant      'â^ëóâÔé–ì«Ç›ë÷Ç¶Å@2006.12.22
    
Dim SHIMEBI     As String * 2       '2012.03.06
Dim wkYY        As Integer          '2012.03.06
Dim wkMM        As Integer          '2012.03.06
    
Dim wkTH        As String * 4       '2012.11.06
    
    
    
    
    Normal_End = False
    
    If App.PrevInstance Then
        Beep
        MsgBox "ìØàÍÉvÉçÉOÉâÉÄé¿çsíÜÇ≈Ç∑ÅB"
        End
    End If
'---------------------------------------------- 'ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni("FILE", "LOGF", "SYS", c) Then
        Beep
        MsgBox "ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
    LOG_F = RTrim(c)

'---------------------------------------------- 'ÉfÅ[É^éÛêMÉ|Å[Égî‘çÜéÊÇËçûÇ›
    If GetIni(App.EXEName, "LocalPort", "SYS", c) Then
        Beep
        MsgBox "ÉfÅ[É^éÛêMÉ|Å[Égî‘çÜÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
    LocalPort = CLng(RTrim(c))

'---------------------------------------------- 'ÉfÅ[É^ëóêMÉ|Å[Égî‘çÜéÊÇËçûÇ›
    If GetIni(App.EXEName, "RemotePort", "SYS", c) Then
        Beep
        MsgBox "ÉfÅ[É^ëóêMÉ|Å[Égî‘çÜÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
    RemotePort = CLng(RTrim(c))
'---------------------------------------------- 'éñã∆ïîéÊÇËçûÇ›
    If JGYOB_TB_Set(1) Then
        Beep
        MsgBox "éñã∆ïîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
'---------------------------------------------- 'çëì‡äOèÓïÒéÊÇËçûÇ›
    i = 0
    
    Do
        i = i + 1
        If GetIni(App.EXEName, "NAIGAI_CODE" & Format(i, "0"), "SYS", c) Then
            Exit Do
        End If
        ReDim Preserve NAIGAI(i - 1)
        NAIGAI(i - 1).CODE = Trim(c)
        If GetIni(App.EXEName, "NAIGAI_NAME" & Format(i, "0"), "SYS", c) Then
            MsgBox "çëì‡äOÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        End If
        NAIGAI(i - 1).NAME = Trim(c)
    
    Loop
    
    If i = 1 Then
        Beep
        MsgBox "çëì‡äOèÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
'---------------------------------------------- édå¸ÇØêÊälìæ
    Erase SHIMUKE_TBL

    i = 0
    Do
        
        i = i + 1
    
        If GetIni(App.EXEName, "SHIMUKE" & Format(i, "00"), "SYS", c) Then
            Exit Do
        End If
        ReDim Preserve SHIMUKE_TBL(i - 1)
        wkSHIMUKE = Split(c, ",", -1)
        If UBound(wkSHIMUKE) < 2 Then
            MsgBox "édå¸ÇØêÊèÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End If
    
        SHIMUKE_TBL(i - 1).JGYOBU = wkSHIMUKE(0)
        SHIMUKE_TBL(i - 1).NAIGAI = wkSHIMUKE(1)
        SHIMUKE_TBL(i - 1).SHIMUKE_CODE = wkSHIMUKE(2)
    Loop
'---------------------------------------------- ëOéÿÇËì¸â◊èÓïÒälìæ
    If GetIni("YOIN", "YOIN_MAEGARI", "SYS", c) Then
        Call LOG_OUT(LOG_F, "[SYS.INI] [YOIN] [YOIN_MAEGARI] READ ERROR")
        MsgBox "ÉVÉXÉeÉÄó\ñÒçœóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_MAEGARI = Trim(c)
'---------------------------------------------- 'çëì‡äOêUë÷èÓïÒälìæ
    If GetIni("YOIN", "YOIN_FURIKAE", "SYS", c) Then
    Else
        YOIN_FURIKAE = RTrim(c)
        'çëì‡äOêUë÷ê›íËéûÅAà»â∫ÇÃçÄñ⁄ïKê{
        If GetIni("YOIN", "YOIN_FURIKAE_OUT", "SYS", c) Then
            Beep
            MsgBox "çëì‡äOêUë÷èÓïÒ[YOIN_FURIKAE_OUT]ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        End If
    
        YOIN_FURIKAE_OUT = RTrim(c)
    
        If GetIni("YOIN", "YOIN_FURIKAE_IN", "SYS", c) Then
            Beep
            MsgBox "çëì‡äOêUë÷èÓïÒ[YOIN_FURIKAE_IN]ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        End If
    
        YOIN_FURIKAE_IN = RTrim(c)
    
    End If
'---------------------------------------------- íIè∆çáèÓïÒälìæ
    If GetIni("YOIN", "YOIN_WEL_TANASHOGO", "SYS", c) Then
        Call LOG_OUT(LOG_F, "[SYS.INI] [YOIN] [YOIN_WEL_TANASHOGO] READ ERROR")
        MsgBox "ÉVÉXÉeÉÄó\ñÒçœóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If
    YOIN_TANASHOGO = Trim(c)

'---------------------------------------------- íIïiè∆çáèÓïÒälìæ
    If GetIni("YOIN", "YOIN_WEL_TANAHINSHOGO", "SYS", c) Then
        YOIN_TANAHINSHOGO = Wel_TANA_HIN_SHOGO
    Else
        YOIN_TANAHINSHOGO = Trim(c)
    End If



'---------------------------------------------- ïiî‘è∆çáèÓïÒälìæ    2011.02.03
    If GetIni("YOIN", "YOIN_WEL_HIN_SHOGO", "SYS", c) Then
        YOIN_HIN_SHOGO = Wel_HIN_SHOGO
    Else
        YOIN_HIN_SHOGO = Trim(c)
    End If


'---------------------------------------------- ì¸â◊ëqå…    2007.06.07
    If GetIni("SYSTEM", "KASO_NYUKA", "SYS", c) Then
        Beep
        MsgBox "ì¸â◊ópâºëzëqå…î‘çÜÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        NYUKA_SOKO_NO = Trim(c)
    End If
'---------------------------------------------- ëÂìåëqå…áÇ    2007.06.07
    If GetIni(App.EXEName, "SOKO_NO", "SYS", c) Then
        DAITO_SOKO_NO = "S1"
    Else
        DAITO_SOKO_NO = Trim(c)
    End If
'---------------------------------------------- éëçﬁêUë÷óvàˆ    2007.06.28
    If GetIni(App.EXEName, "FURIKAE", "SYS", c) Then
'        Beep
'        MsgBox "ì¸â◊ópâºëzëqå…î‘çÜÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
'        End
    
        Wel_FURIKAE = ""
    
    Else
        Wel_FURIKAE = Trim(c)
    End If


'---------------------------------------------- ïiî‘êUë÷Å{óvàˆ  2011.06.01
    If GetIni(App.EXEName, "HINBAN_FURIKAE_PLUS", "SYS", c) Then
    
        Wel_HIN_FURIKAE_PLUS = ""
    
    Else
        Wel_HIN_FURIKAE_PLUS = Trim(c)
    End If




    If Trim(Wel_HIN_FURIKAE_PLUS) <> "" Then
    
    
    '---------------------------------------------- ïiî‘êUë÷Å|óvàˆ  2011.06.01
        If GetIni(App.EXEName, "HINBAN_FURIKAE_MAINA", "SYS", c) Then
            Beep
            MsgBox "ïiî‘êUë÷Å@êUë÷Å|óvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩ[F110010][HINBAN_FURIKAE_MAINA=]ÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        Else
            Wel_HIN_FURIKAE_MAINA = Trim(c)
        End If
    '---------------------------------------------- ïiî‘êUë÷Å|ÇÃà⁄ìÆóèoóÕéûÇÃóvàˆ
        If GetIni(App.EXEName, "BEF_HINBAN", "SYS", c) Then
            Beep
            MsgBox "ïiî‘êUë÷Å@êUë÷Å|ÇÃà⁄ìÆóèoóÕóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩ[F110010][BEF_HINBAN=]ÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        Else
            YOIN_BEF_HINBAN = Trim(c)
        End If
    '---------------------------------------------- ïiî‘êUë÷Å{ÇÃà⁄ìÆóèoóÕéûÇÃóvàˆ
        If GetIni(App.EXEName, "AFT_HINBAN", "SYS", c) Then
            Beep
            MsgBox "ïiî‘êUë÷Å@êUë÷Å{à⁄ìÆóèoóÕóvàˆÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩ[F110010][AFT_HINBAN=]ÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        Else
            YOIN_AFT_HINBAN = Trim(c)
        End If

    End If
'---------------------------------------------- ïiî‘êUë÷óvàˆ    2011.06.01





'---------------------------------------------- éëçﬁè¡îÔóvàˆ    2007.10.02
    If GetIni(App.EXEName, "S_SHOUHI", "SYS", c) Then
        Wel_S_SHOUHI = ""
    
    Else
        Wel_S_SHOUHI = Trim(c)
    End If


'---------------------------------------------- 'éqã@ë‰êîéÊÇËçûÇ›
    If GetIni(App.EXEName, "KO_SU", "SYS", c) Then
        Beep
        MsgBox "éqã@ë‰êîÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If
    ReDim ID_KANRI_TBL(0 To CInt(RTrim(c)) - 1)

    For i = 0 To UBound(ID_KANRI_TBL)
        ID_KANRI_TBL(i).ID = 0          'IDNoÉNÉäÉAÅ[
        ID_KANRI_TBL(i).Step = 0        'êiíªÉNÉäÉAÅ[
    
    Next i
'---------------------------------------------- 'ëóêMópÉpÉâÉÅÅ[É^éÊÇËçûÇ›
    For i = 0 To UBound(WEL_Para_Tbl, 1)
        For j = 0 To UBound(WEL_Para_Tbl, 2)
            WEL_Para_Tbl(i, j).Action = ""
        Next j
    Next i
    
    i = 0
    Do
        i = i + 1
        
        
        If GetIni("ACTION", "ACTION_CD" & Format(i, "00"), "SYS", c) Then
            Beep
            MsgBox "WELCATëóêMópÉpÉâÅ[ÉÅÅ[É^([ACTION] [ACTION_CD])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
            End
        End If
        If Trim(c) = "NON" Then
            Exit Do
        End If
    
    
        j = 0
    
        Do
            j = j + 1
            If GetIni("ACTION", "ACTION_WEL_PARA" & Format(i, "00") & Format(j, "00"), "SYS", c) Then
                Beep
                MsgBox "WELCATëóêMópÉpÉâÅ[ÉÅÅ[É^([ACTION] [ACTION_WEL_PARA])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
                End
            End If
            If Trim(c) = "NON" Then
                Exit Do
            End If
        
            Call Data_Select(Trim(c), 1, 14, Out_Data)
            
            WEL_Para_Tbl(i - 1, j - 1).Action = Trim(Out_Data)
        
            Call Data_Select(Trim(c), 2, 14, Out_Data)
            
            WEL_Para_Tbl(i - 1, j - 1).Wel_Para(0).Box_Type = Trim(Out_Data)
            WEL_Para_Tbl(i - 1, j - 1).Wel_Para(0).LCD = ""
        
        
            k = 2
            Do
                
                k = k + 1
                
                If k > 14 Then
                    Exit Do
                End If
                
                Call Data_Select(Trim(c), k, 14, Out_Data)
                Box_Type = Trim(Out_Data)
                
                k = k + 1
                Call Data_Select(Trim(c), k, 14, Out_Data)
                LCD = Trim(Out_Data)
            
                k = k + 1
                Call Data_Select(Trim(c), k, 14, Out_Data)
                Keta = Trim(Out_Data)
            
                Select Case k
                    Case 5
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(1).Box_Type = Box_Type
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(1).LCD = LCD
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(1).Keta = CInt(Keta)
                    Case 8
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(2).Box_Type = Box_Type
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(2).LCD = LCD
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(2).Keta = CInt(Keta)
                    Case 11
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(3).Box_Type = Box_Type
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(3).LCD = LCD
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(3).Keta = CInt(Keta)
                    Case 14
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(4).Box_Type = Box_Type
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(4).LCD = LCD
                        WEL_Para_Tbl(i - 1, j - 1).Wel_Para(4).Keta = CInt(Keta)
                
                End Select
            
            Loop
            
        
        Loop
    Loop
'---------------------------------------------- 'ëŒWELCATÅ@ëóéÛêMÉçÉOÉtÉ@ÉCÉãéÊÇËçûÇ›
    
    If GetIni(App.EXEName, "LOG_F", "SYS", c) Then
        CtrsWsk1.LogFile = ""
    Else
        CtrsWsk1.LogFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@ÉfÅ[É^ëóêMópÉtÉHÉãÉ_éÊÇËçûÇ›
    If GetIni(App.EXEName, "SendFolder", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉHÉãÉ_([F110010] [SendFolder])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        CtrsWsk1.SendFolder = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@íIî‘ï\é¶ópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "B1", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [B1])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        B1_SendFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@èoå…óöóópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "B6", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [B6])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        B6_SendFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@èoâ◊êÑà⁄ópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "B7", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [B7])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        B7_SendFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@íIî‘ï\é¶(âºëzóDêÊ)ópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "B9", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [B9])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        B9_SendFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@ç\ê¨ï\é¶ópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "BA", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [BA])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        BA_SendFile = Trim(c)
    End If
'---------------------------------------------- 'ëŒWELCATÅ@åüïióöóÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "BB", "SYS", c) Then
        Beep
        MsgBox "WELCATëóêMópÉtÉ@ÉCÉã([F110010] [BB])ÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    Else
        BB_SendFile = Trim(c)
    End If



'---------------------------------------------- 'ëŒWELCATÅ@ìñì˙èoå…óöóÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2009.01.09
    If GetIni(App.EXEName, "BD", "SYS", c) Then
        BD_SendFile = ""
    Else
        BD_SendFile = Trim(c)
    End If


'---------------------------------------------- 'ëŒWELCATÅ@èWñÒç´ïÔécÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2010.02.15
    If GetIni(App.EXEName, "BF", "SYS", c) Then
        BF_SendFile = ""
    Else
        BF_SendFile = Trim(c)
    End If


'---------------------------------------------- 'ëŒWELCATÅ@ãÛÇ´íIåüçıÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2010.12.13
    If GetIni(App.EXEName, "BG", "SYS", c) Then
        BG_SendFile = ""
    Else
        BG_SendFile = Trim(c)
    End If


'---------------------------------------------- 'ëŒWELCATÅ@ëÂç„åüïiÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2010.01.21
    If GetIni(App.EXEName, "F0", "SYS", c) Then
        F0_SendFile = ""
    Else
        F0_SendFile = Trim(c)
    End If



'---------------------------------------------- 'ëŒWELCATÅ@◊ÕﬁŸî≠çsópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2011.03.05
    If GetIni(App.EXEName, "EF", "SYS", c) Then
        EF_SendFile = ""
    Else
        EF_SendFile = Trim(c)
    End If


'---------------------------------------------- 'èoâ◊ÉçÉOÉtÉ@ÉCÉãñºéÊÇËçûÇ› 2007.11.02
    If SYUKA_LOGF_GET_PROC() Then
        Beep
        MsgBox "èoâ◊ÉçÉOÉtÉ@ÉCÉãñºÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇƒâ∫Ç≥Ç¢ÅB"
        End
    End If

'---------------------------------------------- 'ã§í ÉÅÉjÉÖÅ[èÓïÒéÊÇËçûÇ›
    If GetIni(App.EXEName, "ALL_MENU_GRP", "SYS", c) Then
        Beep
        MsgBox "ã§í ÉÅÉjÉÖÅ[èÓïÒÇÃälìæÇ…é∏îsÇµÇ‹ÇµÇΩÅBèàóùÇíÜé~ÇµÇ‹Ç∑ÅB"
        End
    End If


    ALL_MENU_GRP = Trim(c)

'---------------------------------------------- 'åüïiÉ`ÉFÉbÉN
    If GetIni(App.EXEName, "Inspection", "SYS", c) Then
        Inspection_Flg = 0
    Else
        If Not IsNumeric(Trim(c)) Then
            Inspection_Flg = 1
        Else
            Inspection_Flg = CInt(Trim(c))
        End If
    End If
'---------------------------------------------- 'åüïiêîï\é¶ 2007.05.15
    If GetIni(App.EXEName, "Inspection_QTY", "SYS", c) Then
        Inspection_QTY = 0
    Else
        If Not IsNumeric(Trim(c)) Then
            Inspection_QTY = 0
        Else
            Inspection_QTY = CInt(Trim(c))
        End If
    End If

'---------------------------------------------- 'èoå…êîì¸óÕÅ@ïKê{óLñ≥ 2007.08.02
    If GetIni(App.EXEName, "SYUKO_QTY", "SYS", c) Then
        SYUKO_QTY = 0
    Else
        If Not IsNumeric(Trim(c)) Then
            SYUKO_QTY = 0
        Else
            SYUKO_QTY = CInt(Trim(c))
        End If
    End If


'---------------------------------------------- 'çƒåüïiÉ`ÉFÉbÉN 2007.10.10
    If GetIni(App.EXEName, "Inspection_CHK", "SYS", c) Then
        Inspection_CHK = 0
    Else
        If Not IsNumeric(Trim(c)) Then
            Inspection_CHK = 0
        Else
            Inspection_CHK = CInt(Trim(c))
        End If
    End If

'---------------------------------------------- 'ç›å…è∆çáÉÅÉÇçÄñ⁄
    If GetIni(App.EXEName, "B2_MEMO", "SYS", c) Then
        B2_MEMO = ""
    Else
        B2_MEMO = Trim(c)
    End If
'--
    If GetIni(App.EXEName, "B8_MEMO", "SYS", c) Then
        B8_MEMO = ""
    Else
        B8_MEMO = Trim(c)
    End If
'---------------------------------------------- 'ÉtÉ@ÉCÉãÉäÉgÉâÉCâÒêîéÊÇËçûÇ›
    If GetIni("SYSTEM", "RETRY", "SYS", c) Then
        FILE_RETRY = 1
    Else
        If Not IsNumeric(Trim(c)) Then
            FILE_RETRY = 1
        Else
            FILE_RETRY = CInt(Trim(c))
        End If
    End If


'---------------------------------------------- 'ëÂç„ÇoÇbâ^ëóâÔé–ì«Ç›ë÷Ç¶óp 2006.12.22
'    If GetIni(App.EXEName, "UNSOU_KAISHA", "SYS", c) Then
'        UNSOU_KAISHA_CODE = ""
'        UNSOU_KAISHA_NAME = ""
'    Else
'        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
'
'        If UBound(wkUNSOU_KAISHA) > 0 Then
'
'            UNSOU_KAISHA_CODE = wkUNSOU_KAISHA(0)
'            UNSOU_KAISHA_NAME = wkUNSOU_KAISHA(1)
'
'        Else
'            UNSOU_KAISHA_CODE = ""
'            UNSOU_KAISHA_NAME = ""
'        End If
'    End If
'
'
'---------------------------------------------- 'ëÂç„ÇoÇbÅiêVÅjâ^ëóâÔé–ì«Ç›ë÷Ç¶óp 2007.01.09
'
''ãvóØïƒ
'    KURUME_F = False
'    If GetIni(App.EXEName, "KURUME", "SYS", c) Then
'    Else
'        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
'        For i = 0 To UBound(wkUNSOU_KAISHA)
'            ReDim Preserve KURUME(0 To i)
'            KURUME(i) = Trim(wkUNSOU_KAISHA(i))
'            KURUME_F = True
'
'        Next i
'    End If
'
''    If UBound(KURUME) > 0 Then
''        KURUME_F = True
''    End If
''ïüéR
'    FUKUYAMA_F = False
'    If GetIni(App.EXEName, "FUKUYAMA", "SYS", c) Then
'    Else
'        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
'        For i = 0 To UBound(wkUNSOU_KAISHA)
'            ReDim Preserve FUKUYAMA(0 To i)
'            FUKUYAMA(i) = Trim(wkUNSOU_KAISHA(i))
'            FUKUYAMA_F = True
'        Next i
'    End If
''    If UBound(FUKUYAMA) > 0 Then
''        FUKUYAMA_F = True
''    End If
''ç≤êÏ
'    SAGAWA_F = False
'    If GetIni(App.EXEName, "SAGAWA", "SYS", c) Then
'    Else
'        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
'        For i = 0 To UBound(wkUNSOU_KAISHA)
'            ReDim Preserve SAGAWA(0 To i)
'            SAGAWA(i) = Trim(wkUNSOU_KAISHA(i))
'            SAGAWA_F = True
'        Next i
'    End If
'
''    If UBound(SAGAWA) > 0 Then
''        SAGAWA_F = True
''    End If





'ïüéR
    If GetIni("FUKUYAMA", "length", "UNSOU", c) Then
        FUKUYAMA_Name = ""
        FUKUYAMA_Length = 0
        ReDim Preserve FUKUYAMA_CODE(0 To 0)
        FUKUYAMA_CODE(0) = "*"
    Else
        FUKUYAMA_Length = Val(Trim(c))
        
        If GetIni("FUKUYAMA", "Name", "UNSOU", c) Then
            FUKUYAMA_Name = ""
        Else
            FUKUYAMA_Name = Trim(c)
        End If
        
        If GetIni("FUKUYAMA", "Code", "UNSOU", c) Then
            ReDim Preserve FUKUYAMA_CODE(0 To 0)
            FUKUYAMA_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve FUKUYAMA_CODE(0 To i)
                FUKUYAMA_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If



'êºïê
    If GetIni("SEIBU", "length", "UNSOU", c) Then
        SEIBU_Name = ""
        SEIBU_Length = 0
        ReDim Preserve SEIBU_CODE(0 To 0)
        SEIBU_CODE(0) = "*"
    Else
        SEIBU_Length = Val(Trim(c))
        
        If GetIni("SEIBU", "Name", "UNSOU", c) Then
            SEIBU_Name = ""
        Else
            SEIBU_Name = Trim(c)
        End If
        
        If GetIni("SEIBU", "Code", "UNSOU", c) Then
            ReDim Preserve SEIBU_CODE(0 To 0)
            SEIBU_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve SEIBU_CODE(0 To i)
                SEIBU_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If


'ãvóØïƒ
    If GetIni("KURUME", "length", "UNSOU", c) Then
        KURUME_Name = ""
        KURUME_Length = 0
        ReDim Preserve KURUME_CODE(0 To 0)
        KURUME_CODE(0) = "*"
    Else
        KURUME_Length = Val(Trim(c))
        
        If GetIni("KURUME", "Name", "UNSOU", c) Then
            KURUME_Name = ""
        Else
            KURUME_Name = Trim(c)
        End If
        
        If GetIni("KURUME", "Code", "UNSOU", c) Then
            ReDim Preserve KURUME_CODE(0 To 0)
            KURUME_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve KURUME_CODE(0 To i)
                KURUME_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If


'ç≤êÏ
    If GetIni("SAGAWA", "length", "UNSOU", c) Then
        SAGAWA_Name = ""
        SAGAWA_Length = 0
        ReDim Preserve SAGAWA_CODE(0 To 0)
        SAGAWA_CODE(0) = "*"
    Else
        SAGAWA_Length = Val(Trim(c))
        
        If GetIni("SAGAWA", "Name", "UNSOU", c) Then
            SAGAWA_Name = ""
        Else
            SAGAWA_Name = Trim(c)
        End If
        
        If GetIni("SAGAWA", "Code", "UNSOU", c) Then
            ReDim Preserve SEIBU_CODE(0 To 0)
            SAGAWA_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve SAGAWA_CODE(0 To i)
                SAGAWA_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If

'ÉÑÉ}Ég
    If GetIni("YAMATO", "length", "UNSOU", c) Then
        YAMATO_Name = ""
        YAMATO_Length = 0
        ReDim Preserve YAMATO_CODE(0 To 0)
        YAMATO_CODE(0) = "*"
    Else
        YAMATO_Length = Val(Trim(c))
        
        If GetIni("YAMATO", "Name", "UNSOU", c) Then
            YAMATO_Name = ""
        Else
            YAMATO_Name = Trim(c)
        End If
        
        If GetIni("YAMATO", "Code", "UNSOU", c) Then
            ReDim Preserve YAMATO_CODE(0 To 0)
            YAMATO_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve YAMATO_CODE(0 To i)
                YAMATO_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If
' ﬂ≈Œ∞— 2011.06.06
    If GetIni("PANAHOME", "length", "UNSOU", c) Then
        PANA_Name = ""
        PANA_Length = 0
        ReDim Preserve PANA_CODE(0 To 0)
        PANA_CODE(0) = "*"
    Else
        PANA_Length = Val(Trim(c))
        
        If GetIni("PANAHOME", "Name", "UNSOU", c) Then
            PANA_Name = ""
        Else
            PANA_Name = Trim(c)
        End If
        
        If GetIni("PANAHOME", "Code", "UNSOU", c) Then
            ReDim Preserve PANA_CODE(0 To 0)
            PANA_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve PANA_CODE(0 To i)
                PANA_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If
'êœêÖ 2011.06.06
    If GetIni("SEKISUI", "length", "UNSOU", c) Then
        SEKISUI_Name = ""
        SEKISUI_Length = 0
        ReDim Preserve SEKISUI_CODE(0 To 0)
        SEKISUI_CODE(0) = "*"
    Else
        SEKISUI_Length = Val(Trim(c))
        
        If GetIni("SEKISUI", "Name", "UNSOU", c) Then
            SEKISUI_Name = ""
        Else
            SEKISUI_Name = Trim(c)
        End If
        
        If GetIni("SEKISUI", "Code", "UNSOU", c) Then
            ReDim Preserve SEKISUI_CODE(0 To 0)
            SEKISUI_CODE(0) = "*"
        Else
            wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
        
            For i = 0 To UBound(wkUNSOU_KAISHA)
                ReDim Preserve SEKISUI_CODE(0 To i)
                SEKISUI_CODE(i) = wkUNSOU_KAISHA(i)
            Next i
        
        End If
    End If





'---------------------------------------------- 'É`ÉÉÅ[É^Å[ï÷∫∞ƒﬁ   2010.01.21
    If GetIni("CHARTER", "Code", "UNSOU", c) Then
        KEN_CHARTER_CD = "*"
    Else
        
        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
    
        KEN_CHARTER_CD = wkUNSOU_KAISHA(0)
        
        If GetIni("CHARTER", "Name", "UNSOU", c) Then
            KEN_CHARTER_NM = ""
        Else
            KEN_CHARTER_NM = Trim(c)
        End If
    End If
'---------------------------------------------- 'ê‘ñXï÷∫∞ƒﬁ   2010.01.21
    If GetIni("AKABOU", "Code", "UNSOU", c) Then
        KEN_AKABOU_CD = "*"
    Else
        wkUNSOU_KAISHA = Split(Trim(c), ",", -1)
    
        KEN_AKABOU_CD = wkUNSOU_KAISHA(0)
    
    
        If GetIni("AKABOU", "Name", "UNSOU", c) Then
            KEN_AKABOU_NM = ""
        Else
            KEN_AKABOU_NM = Trim(c)
        End If
    
    
    End If

'---------------------------------------------- 'ÉçÉWÉXÉeÉbÉN∫∞ƒﬁ   2010.01.21
    If GetIni(App.EXEName, "KEN_LOGISTIC", "SYS", c) Then
        KEN_LOGISTIC_CD = "*"
    Else
        KEN_LOGISTIC_CD = Trim(c)
    End If






'---------------------------------------------- 'éñã∆ïîì«Ç›ë÷Ç¶óLñ≥ 2008.07.24
    If GetIni(App.EXEName, "JGYOBU_YOMIKAE", "SYS", c) Then
        JGYOBU_YOMIKAE_F = False
    Else
        JGYOBU_YOMIKAE_F = True
    
        JGYOBU_YOMIKAE_T = Split(Trim(c), ",", -1)
    
    End If

'---------------------------------------------- 'íSìñé“è∆çá 2008.08.08
    If GetIni(App.EXEName, "TANTO_REF", "SYS", c) Then
        TANTO_REF = ""
    Else
        TANTO_REF = Trim(c)
    End If
'---------------------------------------------- 'ÉÅÉjÉÖÅ[èIóπ 2008.08.08
    If GetIni(App.EXEName, "MENU_FIN", "SYS", c) Then
        MENU_FIN = ""
    Else
        MENU_FIN = Trim(c)
    End If


'---------------------------------------------- '∑¨›æŸéûÇÃìÆçÏ 2008.09.01
    
    
    CANCEL_OPE = True
    If GetIni(App.EXEName, "CANCEL_OPE", "SYS", c) Then
    Else
        
        If Trim(c) = "1" Then
            CANCEL_OPE = False
        End If
    End If

'---------------------------------------------- 'ç›å…ê∏ç∏ÇÃóvàˆ 2008.11.20
    ZAIKO_SEISA_PURA = "11"
    
    If GetIni(App.EXEName, "ZAIKO_SEISA_PURA", "SYS", c) Then
    Else
        ZAIKO_SEISA_PURA = Trim(c)
    End If


    ZAIKO_SEISA_MAINA = "21"
    
    If GetIni(App.EXEName, "ZAIKO_SEISA_MAINA", "SYS", c) Then
    Else
        ZAIKO_SEISA_MAINA = Trim(c)
    End If



'---------------------------------------------- 'èoâ◊åüïiéûÇÃBUZZERâπ 2009.07.27
    If GetIni(App.EXEName, "Inspe_BUZZER", "SYS", c) Then
    
        Wel_Inspe_BUZZER = Buzzer_DEF
    Else
        Wel_Inspe_BUZZER = Trim(c)
        
    End If


'---------------------------------------------- 'èoâ◊åüïiéûÇÃBUZZERâπ 2009.07.27
    If GetIni(App.EXEName, "SYUKA_BUZZER", "SYS", c) Then
    
        Wel_SYUKA_BUZZER = Buzzer_DEF
    Else
        Wel_SYUKA_BUZZER = Trim(c)
        
    End If


'---------------------------------------------- 'å˚êîì¸óÕâ¬Å^ïsâ¬ 2010.02.17
    If GetIni(App.EXEName, "Inspection_Input", "SYS", c) Then
    
        Inspection_Input = False
    Else
        
        
        If Trim(c) = "1" Then
            Inspection_Input = True
        Else
            Inspection_Input = False
        End If
        
    End If


'---------------------------------------------- 'îpä¸ópå¸ÇØêÊ 2010.02.22
    HAIKI_MTS_F = False
    If GetIni(App.EXEName, "HAIKI_MTS", "SYS", c) Then
    
    Else
        
        HAIKI_MTS = Split(Trim(c), ",", -1)
        HAIKI_MTS_F = True
        
    End If







'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
    If GetIni(App.EXEName, "RECOVER_F", "SYS", c) Then
        RECOVER_F = False
    Else
        If Trim(c) = "1" Then
            RECOVER_F = True
        Else
            RECOVER_F = False
        End If
    End If


'---------------------------------------------- 'ç\ê¨É`ÉFÉbÉNópéÌï  2011.04.18
    If GetIni(App.EXEName, "kousei_check", "SYS", c) Then
        Kousei_check_F = False
    Else
    
        Kousei_check_Tb = Split(Trim(c), ",", -1)
        Kousei_check_F = True
    
    
    End If


'---------------------------------------------- 'ëÂç„Å@êœêÖå¸ÇØèàóù 2011.05.27
    
    'èWçáç´ïÔçœÇ›
    If GetIni(App.EXEName, "SEK_KONPO_F", "SYS", c) Then
        SEK_KONPO_F = False
    Else
        If Trim(c) = "1" Then
            SEK_KONPO_F = True
        Else
            SEK_KONPO_F = False
        End If
    End If

    'è∆çáçœÇ›
    If GetIni(App.EXEName, "SEK_KEN_SHOGO_F", "SYS", c) Then
        SEK_KEN_SHOGO_F = False
    Else
        If Trim(c) = "1" Then
            SEK_KEN_SHOGO_F = True
        Else
            SEK_KEN_SHOGO_F = False
        End If
    End If

    'ç´ïÔçœÇ›
    If GetIni(App.EXEName, "SEK_KEN_KONPO_F", "SYS", c) Then
        SEK_KEN_KONPO_F = False
    Else
        If Trim(c) = "1" Then
            SEK_KEN_KONPO_F = True
        Else
            SEK_KEN_KONPO_F = False
        End If
    End If


    'åüïiçœÇ›
    If GetIni(App.EXEName, "SEK_KEN_KENPIN_F", "SYS", c) Then
        SEK_KEN_KENPIN_F = True
    Else
        If Trim(c) = "1" Then
            SEK_KEN_KENPIN_F = False
        Else
            SEK_KEN_KENPIN_F = True
        End If
    End If


    'åüïiéû◊ÕﬁŸäJénÕﬂ∞ºﬁ
    If GetIni(App.EXEName, "SEK_LABEL_PAGE", "SYS", c) Then
        SEK_LABEL_PAGE = 0
    Else
        If IsNumeric(Trim(c)) Then
            SEK_LABEL_PAGE = Val(Trim(c))
        Else
            SEK_LABEL_PAGE = 0
        End If
    End If


'---------------------------------------------- 'ëÂç„Å@êœêÖå¸ÇØèàóù 2011.05.27

'---------------------------------------------- 'ëÂç„Å@êœêÖå¸ÇØà⁄ìÆèoå…óvàˆ 2011.06.15
    If GetIni(App.EXEName, "SEK_IDO_SYUKO", "SYS", c) Then
        WEL_SEK_IDO_SYUKO = "**"
    Else
        WEL_SEK_IDO_SYUKO = Trim(c)
    End If
'---------------------------------------------- 'ëÂç„Å@êœêÖå¸ÇØà⁄ìÆèoå…óvàˆ 2011.06.15





'---------------------------------------------- 'åéïΩãœÅ^ê∂éYåvâÊóp 2011.07.05
    If GetIni("F120050", "TUKI1", "F120050", c) Then
        TUKI1 = 3
    Else
        If IsNumeric(Trim(c)) Then
            TUKI1 = Val(Trim(c))
        Else
            TUKI1 = 3
        End If
    End If

    If GetIni("F120050", "TUKI2", "F120050", c) Then
        TUKI2 = 3
    Else
        If IsNumeric(Trim(c)) Then
            TUKI2 = Val(Trim(c))
        Else
            TUKI2 = 3
        End If
    End If
'---------------------------------------------- 'ëÂç„PC ïîçﬁä÷åW 2012.03.06
    If GetIni("F110010", "SHIMEBI", "SYS", c) Then
        SHIMEBI = "25"
    Else
        If IsNumeric(Trim(c)) Then
            SHIMEBI = Trim(c)
        Else
            SHIMEBI = "25"
        End If
    End If

    'äJénì˙
    If Mid(Format(Date, "YYYYMMDD"), 7, 2) > SHIMEBI Then
        BUZAI_DATE_S = Mid(Format(Date, "YYYYMMDD"), 1, 6) & Format(Val(SHIMEBI) + 1, "00")
    Else
        wkYY = Val(Mid(Format(Date, "YYYYMMDD"), 1, 4))
        wkMM = Val(Mid(Format(Date, "YYYYMMDD"), 5, 2)) - 1
        If wkMM < 1 Then
            wkYY = Val(Mid(Format(Date, "YYYYMMDD"), 1, 4)) - 1
            wkMM = 12
        End If
        BUZAI_DATE_S = Format(wkYY, "0000") & Format(wkMM, "00") & Format(Val(SHIMEBI) + 1, "00")
    End If
    'èIóπì˙
    If Mid(Format(Date, "YYYYMMDD"), 7, 2) <= SHIMEBI Then
        BUZAI_DATE_E = Mid(Format(Date, "YYYYMMDD"), 1, 6) & SHIMEBI
    Else
        wkYY = Val(Mid(Format(Date, "YYYYMMDD"), 1, 4))
        wkMM = Val(Mid(Format(Date, "YYYYMMDD"), 5, 2)) + 1
        If wkMM > 12 Then
            wkYY = Val(Mid(Format(Date, "YYYYMMDD"), 1, 4)) + 1
            wkMM = 1
        End If
        BUZAI_DATE_E = Format(wkYY, "0000") & Format(wkMM, "00") & Format(Val(SHIMEBI) + 1, "00")
    End If
    'égópåé
    USE_YM = Mid(BUZAI_DATE_E, 1, 6)


    'åüé˚Å`íIì¸ÇÍÇÃóvàˆ
    If GetIni("F110010", "IN_TANA_S_OSAKA", "SYS", c) Then
        c = "25"
        IN_TANA_S_OSAKA = Split(Trim(c), ",", -1)
    Else
        IN_TANA_S_OSAKA = Split(Trim(c), ",", -1)
    End If



    'èoå…èàóù
    If GetIni("F110010", "IDO_OUT_OSAKA", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁèoå…èàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] IDO_OUT_OSAKA="
        Unload Me
    Else
        Wel_IDO_OUT_OSAKA = Trim(c)
    End If


    'êUë÷èoå…Å^ì¸å…
    If GetIni("F110010", "HIN_FURIKA_S", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁêUë÷èoå…èàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] HIN_FURIKA_S="
        Unload Me
    Else
        Wel_HIN_FURIKA_S = Trim(c)
    End If

    'êUë÷èoå…
    If GetIni("F110010", "BEF_HINBAN_S", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁêUë÷èoå…èàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] BEF_HINBAN_S="
        Unload Me
    Else
        YOIN_BEF_HINBAN_S = Trim(c)
    End If
    
    'êUë÷ì¸å…
    If GetIni("F110010", "AFT_HINBAN_S", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁêUë÷ì¸å…èàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] AFT_HINBAN_S="
        Unload Me
    Else
        YOIN_AFT_HINBAN_S = Trim(c)
    End If

    'êUë÷èoå…Å^ì¸å…
    If GetIni("F110010", "IDO_IN_OSAKA", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁêUë÷ì¸å…èàóùÇÃóvàˆèàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] IDO_IN_OSAKA="
        Unload Me
    Else
        Wel_IDO_IN_OSAKA = Trim(c)
    End If


    'ç\ê¨É`ÉFÉbÉN       2012.03.16
    If GetIni("F110010", "COMPO_OSAKA_CHECK", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@ïîçﬁç\ê¨É`ÉFÉbÉNèàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] COMPO_OSAKA_CHECK="
        Unload Me
    Else
        Wel_COMPO_OSAKA_CHECK = Trim(c)
    End If


    'åüïi               2012.03.18
    If GetIni("F110010", "KENPIN_OSAKA", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@åüïièàóùÇÃóvàˆÇìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] KENPIN_OSAKA="
        Unload Me
    Else
        Wel_KENPIN_OSAKA = Trim(c)
    End If
    'åüïiéûà¯óéëqå…     2012.03.18
    If GetIni("F110010", "KENPIN_SOKO", "SYS", c) Then
        MsgBox "ëÂç„ÇoÇbÅ@åüïièàóùéûà¯óéëqå…Çìoò^ÇµÇƒÇ≠ÇæÇ≥Ç¢ SYS.INI [F110010] KENPIN_SOKO="
        Unload Me
    Else
        KENPIN_OSAKA_SOKO_No = Trim(c)
    End If
    
    'ëŒWELCATÅ@◊ÕﬁŸî≠çsópÉfÅ[É^ÉtÉ@ÉCÉãñºéÊÇËçûÇ›
    If GetIni(App.EXEName, "88", "SYS", c) Then
        LABEL_88_SendFile = ""
    Else
        LABEL_88_SendFile = Trim(c)
    End If

'---------------------------------------------- 'ëÂç„PC ïîçﬁä÷åW 2012.03.06


'---------------------------------------------- 'äJénÅ^èIóπ 2012.11.06
    If GetIni("F110010", "STARTTIME", "SYS", c) Then
        wkTH = ""
    Else
        wkTH = Trim(c)
        If Not IsNumeric(wkTH) Then
            wkTH = ""
        End If
    End If
    Text2(2) = Mid(wkTH, 1, 2)
    Text2(3) = Mid(wkTH, 3, 2)


    If GetIni("F110010", "ENDTIME", "SYS", c) Then
        wkTH = ""
    Else
        wkTH = Trim(c)
        If Not IsNumeric(wkTH) Then
            wkTH = ""
        End If
    End If
    Text2(0) = Mid(wkTH, 1, 2)
    Text2(1) = Mid(wkTH, 3, 2)




'---------------------------------------------- 'äJénÅ^èIóπ 2012.11.06


'---------------------------------------------- 'éÛêMÉ^ÉCÉÄÉAÉEÉg   2014.01.04
    If GetIni("F110010", "WAIT_TIME", "SYS", c) Then
        WAIT_TIME = 300
    Else
        If Not IsNumeric(Trim(c)) Then
            WAIT_TIME = 300
        Else
            WAIT_TIME = Val(c)
        End If
    End If
'---------------------------------------------- 'ëqå…É}ÉXÉ^ÇnÇoÇdÇm
    If SOKO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If


'---------------------------------------------- 'íIÉ}ÉXÉ^ÇnÇoÇdÇm
    If TANA_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ïiñ⁄É}ÉXÉ^ÇnÇoÇdÇm
    If ITEM_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ïiñ⁄É}ÉXÉ^(ÉèÅ[ÉN)ÇnÇoÇdÇm
    If wITEM_Open(BtOpenNomal) Then
        Unload Me
    End If
'---------------------------------------------- 'ïiñ⁄êUë÷É}ÉXÉ^ÇnÇoÇdÇm 2011.06.01
    If FURIKAE_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'íSìñé“É}ÉXÉ^ÇnÇoÇdÇm
    If TANTO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'óvàˆÉ}ÉXÉ^ÇnÇoÇdÇm
    If YOIN_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If MTS_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^ÇnÇoÇdÇm
    If P_MENU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç\ê¨É}ÉXÉ^ÇnÇoÇdÇm
    If P_COMPO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ÉRÅ[ÉhÉ}ÉXÉ^ÇnÇoÇdÇm
    If P_CODE_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'î≠î‘É}ÉXÉ^ÇnÇoÇdÇm
    If HATUBAN_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'íSìñé“ï ÉÅÉjÉÖÅ[ÇnÇoÇdÇm
    If P_TMENU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç›å…ÉfÅ[É^ÇnÇoÇdÇm
    If ZAIKO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç›å…ÉfÅ[É^Åià⁄ìÆèàóùópÅjÇnÇoÇdÇm
    If wZAIKO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç›å…ÉfÅ[É^Åiè§ïiÅ^ñ¢è§ïiêÿÇËë÷Ç¶ópÅjÇnÇoÇdÇm
    If tmpZAIKO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ëOéÿÉfÅ[É^ÇnÇoÇdÇm
    If J_NYU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'èoâ◊ó\íËÉfÅ[É^ÇnÇoÇdÇm
    If Y_SYU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If


''    sts = BTRV(BtOpGetFirst, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K8_Y_SYU, Len(K8_Y_SYU), 8)
''    Select Case sts
''        Case BtNoErr
''        Case BtErrIvldKey
''
''            If Y_SYU_Create_Index() Then
''                Normal_End = True
''                Unload Me
''            End If
''
''        Case Else
''            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
''            Normal_End = True
''            Unload Me
''    End Select



'---------------------------------------------- 'èoâ◊ó\íËÉfÅ[É^ÇnÇoÇdÇm
    If DEL_SYU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç›å…à⁄ìÆóÉfÅ[É^ÇnÇoÇdÇm
    If IDO_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ç›å…èWåvÉfÅ[É^ÇnÇoÇdÇm
    If SUMZ_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'åéïΩãœèoâ◊êîÇnÇoÇdÇm
    If AVE_SYUKA_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'éëçﬁëOéÿ√ﬁ∞¿ÇnÇoÇdÇm
    If P_NYU_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'çÏã∆é¿ê—€∏ﬁÇnÇoÇdÇm
    If P_SAGYO_LOG_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇnÇoÇdÇm 2006.12.07
    If Y_SYU_H_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'ì¸â◊ó\íË(ëÂç„PCå¸ÇØ)ÇnÇoÇdÇm 2007.06.07
    If Y_NYU_O_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If

'---------------------------------------------- 'ä«óùÉ}ÉXÉ^ÇnÇoÇdÇm 2007.06.28
    If P_KANRI_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'éëçﬁíçï∂√ﬁ∞¿ÇnÇoÇdÇm 2007.06.28
    If P_SHORDER_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'éÛï•êÊœΩ¿ÇnÇoÇdÇm 2007.06.28
    If P_UKEHARAI_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If
'---------------------------------------------- 'éëçﬁéÛì¸óöóÇnÇoÇdÇm 2007.06.28
    If P_SHUKEIRE_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If

'---------------------------------------------- 'éwê}ï[ÉfÅ[É^ÅiêeÅjÇnÇoÇdÇm 2010.09.03
    If P_SSHIJI_O_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If


'---------------------------------------------- 'éwê}ï[ÉfÅ[É^ÅiéqÅjÇnÇoÇdÇm 2011.03.02
    If P_SSHIJI_K_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If


'---------------------------------------------- 'ì@ï íçï∂ÉfÅ[É^ÇnÇoÇdÇm 2011.04.25
    If Y_SYU_TEI_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If

'---------------------------------------------- 'î≠íçåüì¢ÅFêeïiî‘íçï∂ÉfÅ[É^ÇnÇoÇdÇm 2012.03.18
    If ODR_ORDER_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If

'---------------------------------------------- 'è§ïiâªéwê}éÛì¸óöóÉfÅ[É^ÇnÇoÇdÇm 2012.03.18
    If P_SUKEIRE_Open(BtOpenNomal) Then
        Normal_End = True
        Unload Me
    End If


'---------------------------------------------- 'ÉÅÉjÉÖÅ[ã@î\É`ÉFÉbÉNÅiå¬ï  or ã§í Åj
'    Call UniCode_Conv(K0_TMENU.TANTO_CODE, ALL_TANTO_CODE)
'    sts = BTRV(BtOpGetEqual, TMENU_POS, TMENUREC, Len(TMENUREC), K0_TMENU, Len(K0_TMENU), 0)
'    Select Case sts
'        Case BtNoErr
'            Menu_Type = 1           'ã§í ÉÅÉjÉÖÅ[Ç≈â^óp
'        Case BtErrKeyNotFound
            Menu_Type = 2           'íSìñé“ï ÉÅÉjÉÖÅ[Ç≈â^óp
'        Case Else
'            Call File_Error(sts, BtOpGetEqual, "íSìñé“ï ÉÅÉjÉÖÅ[")
'            Unload Me
'    End Select
    
    
'    ST_LOG_OUT_F = True '2008.08.08

    
    F1100101.Caption = F1100101.Caption & " " & LAST_UPDATE_DAY
    
    F1100101.Height = 4050              '2012.10.02
    F1100101.Width = 6720               '2012.10.02
    
        
    
    
    Show

    If Data_Clear_Proc(1, "") Then
        MsgBox "ÉfÅ[É^èâä˙ê›íËÇ™èoóàÇ‹ÇπÇÒÇ≈ÇµÇΩÅB"
        Unload Me
    End If


    If tmpZaiko_Clear_Proc() Then
        MsgBox "ÉfÅ[É^èâä˙ê›íËÇ™èoóàÇ‹ÇπÇÒÇ≈ÇµÇΩÅB"
        Unload Me
    End If


    
'    Command1(0).Value = True                '2012.05.18

'    Timer1.Enabled = True                   '2012.05.18

End Sub

Private Sub Start_Proc(Sendbuf As String)
'-------------------------------------------------------
'
'   Åwéqã@äJénèàóùÅx
'
'-------------------------------------------------------
Dim i   As Integer
                                                'ëóêMÉeÉLÉXÉgçÏê¨Åïä«óùÉeÅ[ÉuÉãÇ…ì]ëó
    ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ                      'íSìñé“óvãÅ
    '---------------------------------------------------------------
    Send_Text.sts = Sts_OK                                          'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_DEF                             'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕ
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
    Send_Text.End_Menu = ""                                         'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = ""
    
    Send_Text.Menu_Suu = "05"                                       'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
    Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
    Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
    
    
    
    '---------------------------------------------------------------
    Send_Text.Box_Type(0).Box_Type = TYPE_REF                       'É{ÉbÉNÉXëÆê´Å@ï\é¶ÇaÇnÇw
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
    
    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, "íSìñé“ì¸óÕ")      'ï\é¶ÉÅÉbÉZÅ[ÉW
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, "íSìñé“ì¸óÕ")
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
    Send_Text.Box_Type(0).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
    
    
    Send_Text.Box_Type(0).Start_Pos = ""                            'ÉJÅ[É\Éãà íu
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
    
    Send_Text.Box_Type(0).Max_Size = "00"                           'ç≈ëÂåÖêî
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
    
    Send_Text.Box_Type(0).MENU = ""                                 'ÉÅÉjÉÖÅ[î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
    '---------------------------------------------------------------
    Send_Text.Box_Type(1).Box_Type = TYPE_BCANK                     'É{ÉbÉNÉXëÆê´Å@ï\é¶ÇaÇnÇw
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_BCANK
    
    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "")                'ï\é¶ÉÅÉbÉZÅ[ÉW
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "")
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
    Send_Text.Box_Type(1).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
    
    Send_Text.Box_Type(1).Start_Pos = "01"                          'ÉJÅ[É\Éãà íu
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
    
    Send_Text.Box_Type(1).Max_Size = "05"                           'ç≈ëÂåÖêî
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "05"
    
    Send_Text.Box_Type(1).MENU = ""                                 'ÉÅÉjÉÖÅ[î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
    '---------------------------------------------------------------
    Send_Text.Box_Type(2).Box_Type = TYPE_REF                       'É{ÉbÉNÉXëÆê´Å@ï\é¶ÇaÇnÇw
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
    
    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "")                'ï\é¶ÉÅÉbÉZÅ[ÉW
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "")
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
    Send_Text.Box_Type(2).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
    
    Send_Text.Box_Type(2).Start_Pos = ""                            'ÉJÅ[É\Éãà íu
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
    
    Send_Text.Box_Type(2).Max_Size = "00"                           'ç≈ëÂåÖêî
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
    
    Send_Text.Box_Type(2).MENU = ""                                 'ÉÅÉjÉÖÅ[î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
    '---------------------------------------------------------------
    Send_Text.Box_Type(3).Box_Type = TYPE_REF                       'É{ÉbÉNÉXëÆê´Å@ï\é¶ÇaÇnÇw
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
    
    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")                'ï\é¶ÉÅÉbÉZÅ[ÉW
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
    Send_Text.Box_Type(3).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
    
    Send_Text.Box_Type(3).Start_Pos = ""                            'ÉJÅ[É\Éãà íu
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
    
    Send_Text.Box_Type(3).Max_Size = "00"                           'ç≈ëÂåÖêî
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
    
    Send_Text.Box_Type(3).MENU = ""                                 'ÉÅÉjÉÖÅ[î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
    '---------------------------------------------------------------
    Send_Text.Box_Type(4).Box_Type = TYPE_REF                       'É{ÉbÉNÉXëÆê´Å@ï\é¶ÇaÇnÇw
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
    
    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")                'ï\é¶ÉÅÉbÉZÅ[ÉW
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
    Send_Text.Box_Type(4).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
    
    Send_Text.Box_Type(4).Start_Pos = ""                            'ÉJÅ[É\Éãà íu
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
    
    Send_Text.Box_Type(4).Max_Size = "00"                           'ç≈ëÂåÖêî
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
    
    Send_Text.Box_Type(4).MENU = ""                                 'ÉÅÉjÉÖÅ[î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    '---------------------------------------------------------------
    Send_Text.CRLF = vbCrLf
    '------------------------------------------ ëóêMÉoÉbÉtÉ@Å[Ç÷ì]ëó
    Sendbuf = Text_Create_Proc()

    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM

End Sub


Private Function Normal_Proc(Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   Åwí èÌÉeÉLÉXÉgéÛêMÅx
'
'-------------------------------------------------------
    Normal_Proc = True
    
    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Start                 'éqã@ìdåπONÅiÇ±Ç±Ç…ÇÕóàÇ»Ç¢Åj
        
        Case Step_TANTO_REQ             'íSìñé“óvãÅÅiÇ±Ç±Ç…ÇÕóàÇ»Ç¢Åj
        
        Case Step_TANTO_RES             'íSìñé“âÒìö
    
            MENU_UP_F = False   '2008.08.08
    
    
            If Tanto_Check_Proc(Sendbuf) Then
                Exit Function
            End If
    
        Case Step_JGYOBU_REQ            'éñã∆ïîóvãÅÅiÇ±Ç±Ç…ÇÕóàÇ»Ç¢Åj
                
        Case Step_JGYOBU_RES            'éñã∆ïîâÒìö
            
            MENU_UP_F = False   '2008.08.08
            
            If Menu_Send_Proc(Sendbuf) Then
                Exit Function
            End If
                
        Case Step_NAIGAI_REQ            'çëì‡äOóvãÅÅiÇ±Ç±Ç…ÇÕóàÇ»Ç¢Åj
                
        Case Step_NAIGAI_RES            'çëì‡äOâÒìö
            
            MENU_UP_F = False   '2008.08.08
            
            If Menu_Send_Proc(Sendbuf) Then
                Exit Function
            End If
                                        
            ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ      '2006.07.14
                                        'ÉÅÉjÉÖÅ[óvãÅÅiÇ±Ç±Ç…ÇÕóàÇ»Ç¢Åj
'2006.01.30        Case Step_MENU1_REQ, Step_MENU2_REQ, Step_MENU3_REQ
        Case Step_MENU1_REQ, Step_MENU2_REQ
                                        'ÉÅÉjÉÖÅ[âÒìö
'2006.01.30        Case Step_MENU1_RES, Step_MENU2_RES, Step_MENU3_RES
        Case Step_MENU1_RES, Step_MENU2_RES
    
            If Menu_Send_Proc(Sendbuf) Then
                Exit Function
            End If
    
    End Select
    
    Normal_Proc = False

End Function

Private Sub Form_Unload(Cancel As Integer)

Dim sts As Integer

'---------------------------------------------- 'ëqå…É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ëqå…É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'íIÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "íIÉ}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'ïiñ⁄É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'ïiñ⁄É}ÉXÉ^ÅiÉèÅ[ÉNÅjÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, wITEM_POS, wITEMREC, Len(wITEMREC), K0_wITEM, Len(K0_wITEM), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ïiñ⁄É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'íSìñé“É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "íSìñé“É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'óvàˆÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "óvàˆÉ}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'å¸ÇØêÊä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "å¸ÇØêÊä«óùÉ}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'ç\ê¨É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_COMPO_POS, P_COMPO_K_REC, Len(P_COMPO_K_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç\ê¨É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'ÉRÅ[ÉhÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ÉRÅ[ÉhÉ}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_MENU_POS, P_MENUREC, Len(P_MENUREC), K0_P_MENU, Len(K0_P_MENU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'î≠î‘É}ÉXÉ^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, HATUBAN_POS, HATUBANREC, Len(HATUBANREC), K0_HATUBAN, Len(K0_HATUBAN), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "î≠î‘É}ÉXÉ^")
        End If
    End If
'---------------------------------------------- 'íSìñé“ï ÉÅÉjÉÖÅ[ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_TMENU_POS, P_TMENUREC, Len(P_TMENUREC), K0_P_TMENU, Len(K0_P_TMENU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "íSìñé“ï ÉÅÉjÉÖÅ[")
        End If
    End If
'---------------------------------------------- 'ç›å…ÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K0_ZAIKO, Len(K0_ZAIKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ç›å…ÉfÅ[É^Åià⁄ìÆèàóùópÅjÇbÇkÇnÇrÇd

    sts = BTRV(BtOpClose, wZAIKO_POS, wZAIKOREC, Len(wZAIKOREC), K0_wZAIKO, Len(K0_wZAIKO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…ÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ëOéÿÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, J_NYU_POS, J_NYUREC, Len(J_NYUREC), K0_J_NYU, Len(K0_J_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ëOéÿÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'èoâ◊ó\íËÉfÅ[É^ÇbÇkÇnÇrÇd
    
''    sts = BTRV(BtOpDropSupIndex, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K8_Y_SYU, Len(K8_Y_SYU), 8)
''    If sts Then
''        Call File_Error(sts, BtOpDropSupIndex, "èoâ◊ó\íËÉfÅ[É^")
''    End If
    
    
    
    
    sts = BTRV(BtOpClose, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íËÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'èoâ◊ó\íËÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, DEL_SYU_POS, DEL_SYUREC, Len(DEL_SYUREC), K0_DEL_SYU, Len(K0_DEL_SYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íËÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ç›å…à⁄ìÆóÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, IDO_POS, IDOREC, Len(IDOREC), K0_IDO, Len(K0_IDO), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…à⁄ìÆóÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ç›å…èWåvÉfÅ[É^ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, SUMZ_POS, SUMZREC, Len(SUMZREC), K0_SUMZ, Len(K0_SUMZ), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ç›å…èWåvÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'åéïΩãœèoâ◊êîÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, AVE_SYUKA_POS, AVE_SYUKAREC, Len(AVE_SYUKAREC), K0_AVE_SYUKA, Len(K0_AVE_SYUKA), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "åéïΩãœèoâ◊êî")
        End If
    End If
'---------------------------------------------- 'éëçﬁëOéÿ√ﬁ∞¿ÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_NYU_POS, P_NYUREC, Len(P_NYUREC), K0_P_NYU, Len(K0_P_NYU), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "éëçﬁëOéÿ√ﬁ∞¿")
        End If
    End If
'---------------------------------------------- 'çÏã∆é¿ê—€∏ﬁÇbÇkÇnÇrÇd
    sts = BTRV(BtOpClose, P_SAGYO_LOG_POS, P_SAGYO_LOG_REC, Len(P_SAGYO_LOG_REC), K0_P_SAGYO_LOG, Len(K0_P_SAGYO_LOG), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "éëçﬁëOéÿ√ﬁ∞¿")
        End If
    End If
'---------------------------------------------- 'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇbÇkÇnÇrÇd   2006.12.07
    sts = BTRV(BtOpClose, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K0_Y_SYU_H, Len(K0_Y_SYU_H), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ì¸â◊ó\íË(ëÂç„PCå¸ÇØ)ÇbÇkÇnÇrÇd   2007.06.07
    sts = BTRV(BtOpClose, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
    If sts Then
        If sts <> BtErrNoOpen Then
            Call File_Error(sts, BtOpClose, "ì¸â◊ó\íË(ëÂç„PCå¸ÇØ)ÉfÅ[É^")
        End If
    End If
'---------------------------------------------- 'ÉtÉ@ÉCÉãä¬ã´ÉäÉZÉbÉg
    sts = BTRV(BtOpReset, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
    If sts Then
        Call File_Error(sts, BtOpReset, "")
    End If

'Call LOG_OUT(LOG_F, "END 1")

    If Next_Step = 1 Then
        sts = Shell("d:\newsdc\exe\F1100501.bat", vbNormalFocus)
        If sts = 0 Then
            MsgBox "[F110050]èIóπèàóùÇÃãNìÆÇ…é∏îsÇµÇ‹ÇµÇΩÅB "
            Call LOG_OUT(LOG_F, "[F110050]èIóπèàóùÇÃãNìÆÇ…é∏îsÇµÇ‹ÇµÇΩÅB")
        End If
    End If


    Set F1100101 = Nothing

'Call LOG_OUT(LOG_F, "END 2")

    


    End
End Sub
Private Function Tanto_Check_Proc(Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   ÅwíSìñé“ÉRÅ[ÉhÇÃÉ`ÉFÉbÉNÅx
'
'-------------------------------------------------------
Dim sts As Integer
Dim i   As Integer

    Tanto_Check_Proc = True

    For i = 0 To M_Gyo
        
        If ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = TYPE_REF Then
        Else
                                'íSìñé“É}ÉXÉ^ì«Ç›çûÇ›
            Call UniCode_Conv(K0_TANTO.TANTO_CODE, ID_KANRI_TBL(ING_No).Recv_text(i))
            sts = BTRV(BtOpGetEqual, TANTO_POS, TANTOREC, Len(TANTOREC), K0_TANTO, Len(K0_TANTO), 0)
            Select Case sts
                Case BtNoErr
                    ID_KANRI_TBL(ING_No).TANTO_CODE = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                    Exit For
                Case BtErrKeyNotFound
                    
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                    Call Err_Send_Proc("íSìñé“ñ¢ìoò^", "", "", "", "")
                    
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
                    
                    Tanto_Check_Proc = False
                    Exit Function
                Case Else
                    Sendbuf = Text_Create_Proc()
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Call File_Error(sts, BtOpGetEqual, "íSìñé“É}ÉXÉ^", 0)
                    Exit Function
            End Select
        
        End If
    
    Next i

    If i > M_Gyo Then                       'é¿ç€ÇÕÇ†ÇËÇ¶Ç»Ç¢ÅiíSìñé“Ç™ñ¢ì¸óÕÅj
        ID_KANRI_TBL(ING_No).Step = Step_Start
        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
        Call Err_Send_Proc("íSìñé“ñ¢ìoò^", "", "", "", "")
                    
        Sendbuf = Text_Create_Proc()
        ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
                    
        Tanto_Check_Proc = False
        Exit Function
    End If

'----------------------------------------------- 'êÍópÉÅÉjÉÖÅ[älìæ
    If Menu_Type = 1 Then
                        'ã§í ÉÅÉjÉÖÅ[
    Else
        Call UniCode_Conv(K0_P_TMENU.TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
        sts = BTRV(BtOpGetEqual, P_TMENU_POS, P_TMENUREC, Len(P_TMENUREC), K0_P_TMENU, Len(K0_P_TMENU), 0)
        Select Case sts
            Case BtNoErr
'                ID_KANRI_TBL(ING_No).MENU_GRP = StrConv(P_TMENUREC.TANTO_CODE, vbUnicode)
            Case BtErrKeyNotFound
                    
'                ID_KANRI_TBL(ING_No).MENU_GRP = ""
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Call Err_Send_Proc("íSìñé“ÉÅÉjÉÖÅ[", "ñ¢ìoò^", "", "", "")
                    
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
            
                Tanto_Check_Proc = False
                Exit Function
            Case Else
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "íSìñé“ÉÅÉjÉÖÅ[", 0)
                Exit Function
        End Select
            
    
    
    End If
'----------------------------------------------- 'ÉÅÉjÉÖÅ[èÓïÒÅïçÏã∆èÓïÒÇÃèâä˙âª
    
    If UBound(JGYOBU_T) = 0 Then
                                                'ÇPéñã∆ïîå≈íË
        ID_KANRI_TBL(ING_No).JGYOBU = JGYOBU_T(0).CODE
    Else
        ID_KANRI_TBL(ING_No).JGYOBU = ""
    End If
    
    If UBound(NAIGAI) = 0 Then
                                                'çëì‡äOå≈íË
        ID_KANRI_TBL(ING_No).NAIGAI = NAIGAI(0).CODE
    Else
        ID_KANRI_TBL(ING_No).NAIGAI = ""
    End If
    
    ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
    ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'    ID_KANRI_TBL(ING_No).MENU_LV3 = ""

    ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
    ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'    ID_KANRI_TBL(ING_No).PageNo_LV3 = 0

    ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ""
    ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = ""
    ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM = ""

'---------------------------------------------- 'ÉÅÉjÉÖÅ[ëóêM
    If Menu_Send_Proc(Sendbuf) Then
        Exit Function
    End If

    Tanto_Check_Proc = False

End Function
'2006.01.30Private Function Menu_Send_Proc(Optional Sendbuf As String) As Integer
'2006.01.30'-------------------------------------------------------
'2006.01.30'
'2006.01.30'   ÅwÉÅÉjÉÖÅ[ÉeÉLÉXÉgçÏê¨Åx
'2006.01.30'
'2006.01.30'-------------------------------------------------------
'2006.01.30Dim sts         As Integer
'2006.01.30Dim com         As Integer
'2006.01.30
'2006.01.30Dim i           As Integer
'2006.01.30Dim j           As Integer
'2006.01.30
'2006.01.30Dim Menu_Tbl()  As Menu_Tbl_tag
'2006.01.30Dim Menu_Cnt    As Integer
'2006.01.30Dim Max_Page    As Integer
'2006.01.30
'2006.01.30
'2006.01.30Dim PageNo      As Integer
'2006.01.30
'2006.01.30Dim Gyo_Suu     As Integer
'2006.01.30Dim Start_Gyo   As Integer
'2006.01.30Dim End_Gyo     As Integer
'2006.01.30
'2006.01.30
'2006.01.30Dim WK_LV1      As String * 3
'2006.01.30Dim WK_LV2      As String * 3
'2006.01.30Dim WK_LV3      As String * 3
'2006.01.30
'2006.01.30
'2006.01.30    Menu_Send_Proc = True
'2006.01.30'----------------------------------------------- 'éñã∆ïîëIëÇ†ÇË
'2006.01.30    If ID_KANRI_TBL(ING_No).JGYOBU = " " Then
'2006.01.30        Call JGYOBU_MENU_SET
'2006.01.30
'2006.01.30        Sendbuf = Text_Create_Proc()
'2006.01.30
'2006.01.30
'2006.01.30        Menu_Send_Proc = False
'2006.01.30        Exit Function
'2006.01.30    End If
'2006.01.30'----------------------------------------------- 'çëì‡äOëIëÇ†ÇË
'2006.01.30    If ID_KANRI_TBL(ING_No).NAIGAI = " " Then
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_GRP = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV3 = ""
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30
'2006.01.30        Call NAIGAI_MENU_SET
'2006.01.30        Sendbuf = Text_Create_Proc
'2006.01.30        Menu_Send_Proc = False
'2006.01.30        Exit Function
'2006.01.30    End If
'2006.01.30'----------------------------------------------- 'ÉÅÉjÉÖÅ[ä«óùÇÃì«Ç›çûÇ›
'2006.01.30    If Len(Trim(ID_KANRI_TBL(ING_No).MENU_GRP)) = 0 Then
'2006.01.30                                    'Ç±Ç±Ç≈ñ¢ämíËÇ»ÇÃÇÕã§í ÉÅÉjÉÖÅ[éûÇæÇØ
'2006.01.30        Call UniCode_Conv(K1_MENU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'2006.01.30        Call UniCode_Conv(K1_MENU.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_GRP_NO, ALL_MENU_GRP)
'2006.01.30
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_LV1, "")
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_LV2, "")
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_LV3, "")
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30
'2006.01.30        sts = BTRV(BtOpGetGreaterEqual, MENU_POS, MENUREC, Len(MENUREC), K1_MENU, Len(K1_MENU), 1)
'2006.01.30        Select Case sts
'2006.01.30            Case BtNoErr
'2006.01.30            Case BtErrEOF
'2006.01.30
'2006.01.30            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'2006.01.30                Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
'2006.01.30                Sendbuf = Text_Create_Proc()
'2006.01.30                If UBound(NAIGAI) = 0 Then
'2006.01.30                    ID_KANRI_TBL(ING_No).Step = Step_Start
'2006.01.30                Else
'2006.01.30                    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
'2006.01.30                End If
'2006.01.30                Menu_Send_Proc = False
'2006.01.30                Exit Function
'2006.01.30            Case Else
'2006.01.30                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2006.01.30                Sendbuf = Text_Create_Proc()
'2006.01.30                Call File_Error(sts, BtOpGetEqual, "ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^", 0)
'2006.01.30                Exit Function
'2006.01.30        End Select
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_GRP = StrConv(MENUREC.MENU_GRP_NO, vbUnicode)
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV3 = ""
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'2006.01.30        ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
'2006.01.30
'2006.01.30
'2006.01.30    End If
'2006.01.30    '   -------------------------------- ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^ì«çûÇ›
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30    Call UniCode_Conv(K0_MENU.MENU_GRP_NO, ID_KANRI_TBL(ING_No).MENU_GRP)
'2006.01.30    Call UniCode_Conv(K0_MENU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'2006.01.30    Call UniCode_Conv(K0_MENU.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'2006.01.30    Call UniCode_Conv(K0_MENU.MENU_LV1, ID_KANRI_TBL(ING_No).MENU_LV1)
'2006.01.30    Call UniCode_Conv(K0_MENU.MENU_LV2, ID_KANRI_TBL(ING_No).MENU_LV2)
'2006.01.30    Call UniCode_Conv(K0_MENU.MENU_LV3, ID_KANRI_TBL(ING_No).MENU_LV3)
'2006.01.30
'2006.01.30    Erase Menu_Tbl
'2006.01.30
'2006.01.30    com = BtOpGetGreater
'2006.01.30
'2006.01.30    Menu_Cnt = -1
'2006.01.30    Do
'2006.01.30        sts = BTRV(com, MENU_POS, MENUREC, Len(MENUREC), K0_MENU, Len(K0_MENU), 0)
'2006.01.30        Select Case sts
'2006.01.30            Case BtNoErr
'2006.01.30                If ID_KANRI_TBL(ING_No).MENU_GRP <> StrConv(MENUREC.MENU_GRP_NO, vbUnicode) Or _
'2006.01.30                    ID_KANRI_TBL(ING_No).JGYOBU <> StrConv(MENUREC.JGYOBU, vbUnicode) Or _
'2006.01.30                    ID_KANRI_TBL(ING_No).NAIGAI <> StrConv(MENUREC.NAIGAI, vbUnicode) Then
'2006.01.30                    Exit Do
'2006.01.30                End If
'2006.01.30
'2006.01.30                WK_LV1 = ID_KANRI_TBL(ING_No).MENU_LV1
'2006.01.30                WK_LV2 = ID_KANRI_TBL(ING_No).MENU_LV2
'2006.01.30                WK_LV3 = ID_KANRI_TBL(ING_No).MENU_LV3
'2006.01.30
'2006.01.30
'2006.01.30                If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV1)) = 0 Then
'2006.01.30                    WK_LV1 = StrConv(MENUREC.MENU_LV1, vbUnicode)
'2006.01.30                    WK_LV2 = ""
'2006.01.30                    WK_LV3 = ""
'2006.01.30
'2006.01.30
'2006.01.30'                    ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
'2006.01.30                    ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'2006.01.30                    ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30
'2006.01.30                Else
'2006.01.30                    If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV2)) = 0 Then
'2006.01.30                        WK_LV2 = StrConv(MENUREC.MENU_LV2, vbUnicode)
'2006.01.30                        WK_LV3 = ""
'2006.01.30
'2006.01.30'                        ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
'2006.01.30                        ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30
'2006.01.30                    Else
'2006.01.30                        If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV3)) = 0 Then
'2006.01.30                            WK_LV3 = StrConv(MENUREC.MENU_LV3, vbUnicode)
'2006.01.30
'2006.01.30'                            ID_KANRI_TBL(ING_No).PageNo_LV3 = 0
'2006.01.30
'2006.01.30                        End If
'2006.01.30                    End If
'2006.01.30                End If
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30            Case BtErrEOF
'2006.01.30                Exit Do
'2006.01.30            Case Else
'2006.01.30
'2006.01.30                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2006.01.30                Sendbuf = Text_Create_Proc()
'2006.01.30                Call File_Error(sts, com, "ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^", 0)
'2006.01.30                Exit Function
'2006.01.30        End Select
'2006.01.30
'2006.01.30
'2006.01.30    '   -------------------------------- ÉÅÉjÉÖÅ[èÓïÒÇï€ë∂
'2006.01.30        If WK_LV1 <> StrConv(MENUREC.MENU_LV1, vbUnicode) Or _
'2006.01.30            WK_LV2 <> StrConv(MENUREC.MENU_LV2, vbUnicode) Or _
'2006.01.30            WK_LV3 <> StrConv(MENUREC.MENU_LV3, vbUnicode) Then
'2006.01.30        Else
'2006.01.30
'2006.01.30
'2006.01.30            Menu_Cnt = Menu_Cnt + 1
'2006.01.30
'2006.01.30            ReDim Preserve Menu_Tbl(Menu_Cnt)
'2006.01.30
'2006.01.30            If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV1)) = 0 Then
'2006.01.30                Menu_Tbl(Menu_Cnt).CODE = StrConv(MENUREC.MENU_LV1, vbUnicode)
'2006.01.30            Else
'2006.01.30                If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV2)) = 0 Then
'2006.01.30                    Menu_Tbl(Menu_Cnt).CODE = StrConv(MENUREC.MENU_LV2, vbUnicode)
'2006.01.30                Else
'2006.01.30                    If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV3)) = 0 Then
'2006.01.30                        Menu_Tbl(Menu_Cnt).CODE = StrConv(MENUREC.MENU_LV3, vbUnicode)
'2006.01.30                    End If
'2006.01.30                End If
'2006.01.30            End If
'2006.01.30
'2006.01.30
'2006.01.30            Menu_Tbl(Menu_Cnt).Disp = StrConv(MENUREC.DISPLAY_ITEM, vbUnicode)
'2006.01.30        End If
'2006.01.30
'2006.01.30        com = BtOpGetNext
'2006.01.30
'2006.01.30    Loop
'2006.01.30
'2006.01.30    If Menu_Cnt = -1 Then
'2006.01.30            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'2006.01.30        Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
'2006.01.30        Sendbuf = Text_Create_Proc()
'2006.01.30        If UBound(NAIGAI) = 0 Then
'2006.01.30            ID_KANRI_TBL(ING_No).Step = Step_Start
'2006.01.30        Else
'2006.01.30            ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
'2006.01.30        End If
'2006.01.30        Menu_Send_Proc = False
'2006.01.30        Exit Function
'2006.01.30    End If
'2006.01.30
'2006.01.30'----------------------------------------------- 'ÉÅÉjÉÖÅ[ëóêMÉeÉLÉXÉgçÏê¨
'2006.01.30'''    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1   'ÉÅÉjÉÖÅ[ëóêM
'2006.01.30    '---------------------------------------------------------------
'2006.01.30    Max_Page = Int(CDbl((Menu_Cnt + 1) / M_Gyo + 0.9))
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30'    Start_Gyo = ID_KANRI_TBL(ING_No).PageNo * M_Gyo
'2006.01.30'    End_Gyo = (ID_KANRI_TBL(ING_No).PageNo * M_Gyo) + (M_Gyo - 1)
'2006.01.30
'2006.01.30
'2006.01.30    Select Case ID_KANRI_TBL(ING_No).Step
'2006.01.30        Case Step_MENU1_REQ, Step_MENU1_RES
'2006.01.30            PageNo = ID_KANRI_TBL(ING_No).PageNo_LV1
'2006.01.30        Case Step_MENU2_REQ, Step_MENU2_RES
'2006.01.30            PageNo = ID_KANRI_TBL(ING_No).PageNo_LV2
'2006.01.30        Case Step_MENU3_REQ, Step_MENU3_RES
'2006.01.30            PageNo = ID_KANRI_TBL(ING_No).PageNo_LV3
'2006.01.30    End Select
'2006.01.30
'2006.01.30
'2006.01.30    Start_Gyo = PageNo * M_Gyo
'2006.01.30    End_Gyo = (PageNo * M_Gyo) + (M_Gyo - 1)
'2006.01.30
'2006.01.30
'2006.01.30    Send_Text.sts = Sts_OK                                      'ÉXÉeÅ[É^ÉXÅ@OK
'2006.01.30    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
'2006.01.30
'2006.01.30    Send_Text.Display_Flg = Display_MENU                        'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
'2006.01.30    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_MENU
'2006.01.30                                                                'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
'2006.01.30    If Max_Page = 1 Then
'2006.01.30        Send_Text.End_Menu = Menu_Only          'ÇPâÊñ ÇÃÇ›
'2006.01.30        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
'2006.01.30    Else
'2006.01.30        If (Max_Page - 1) = PageNo Then
'2006.01.30            Send_Text.End_Menu = Menu_End       'ç≈èIÉyÅ[ÉW
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_End
'2006.01.30        Else
'2006.01.30            If PageNo = 0 Then
'2006.01.30                Send_Text.End_Menu = Menu_Head  'êÊì™ÉyÅ[ÉW
'2006.01.30                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Head
'2006.01.30            Else
'2006.01.30                Send_Text.End_Menu = Menu_Mid   'ìríÜÉyÅ[ÉW
'2006.01.30                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Mid
'2006.01.30            End If
'2006.01.30        End If
'2006.01.30    End If
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30    Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
'2006.01.30    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
'2006.01.30
'2006.01.30    Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
'2006.01.30    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
'2006.01.30    '---------------------------------------------------------------
'2006.01.30    Gyo_Suu = 0
'2006.01.30    j = -1
'2006.01.30    For i = Start_Gyo To End_Gyo
'2006.01.30        j = j + 1
'2006.01.30        If i > UBound(Menu_Tbl) Then
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Box_Type = ""                 'BOXëÆê´
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = ""
'2006.01.30
'2006.01.30            Call UniCode_Conv(Send_Text.Box_Type(j).LCD, "")    'ï\é¶ì‡óe
'2006.01.30            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, "")
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = ""
'2006.01.30
'2006.01.30
'2006.01.30        Else
'2006.01.30            Gyo_Suu = Gyo_Suu + 1
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Box_Type = TYPE_MENU          'BOXëÆê´
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = TYPE_MENU
'2006.01.30                                                                'ï\é¶ì‡óe
'2006.01.30            Call UniCode_Conv(Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
'2006.01.30            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
'2006.01.30
'2006.01.30            Send_Text.Box_Type(j).MENU = Menu_Tbl(i).CODE       'ÉÅÉjÉÖÅ\î‘çÜ
'2006.01.30            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = Menu_Tbl(i).CODE
'2006.01.30
'2006.01.30        End If
'2006.01.30
'2006.01.30    Next i
'2006.01.30
'2006.01.30    Send_Text.Menu_Suu = Format(Gyo_Suu, "00")      'ÉÅÉjÉÖÅ[çÄñ⁄êî
'2006.01.30    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = Format(Gyo_Suu, "00")
'2006.01.30
'2006.01.30
'2006.01.30    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM
'2006.01.30
'2006.01.30    Sendbuf = Text_Create_Proc()
'2006.01.30
'2006.01.30
'2006.01.30
'2006.01.30    Menu_Send_Proc = False
'2006.01.30
'2006.01.30End Function

Private Function Menu_Send_Proc(Optional Sendbuf As String) As Integer

'-------------------------------------------------------
'
'   ÅwÉÅÉjÉÖÅ[ÉeÉLÉXÉgçÏê¨Åx
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

Dim Menu_Tbl()  As Menu_Tbl_tag
Dim Menu_Cnt    As Integer
Dim Max_Page    As Integer


Dim PageNo      As Integer

Dim Gyo_Suu     As Integer
Dim Start_Gyo   As Integer
Dim End_Gyo     As Integer


Dim WK_LV1      As String * 3
Dim WK_LV2      As String * 3




    Menu_Send_Proc = True
'----------------------------------------------- 'éñã∆ïîëIëÇ†ÇË
    If Trim(ID_KANRI_TBL(ING_No).JGYOBU) = "" Then
        Call JGYOBU_MENU_SET

        Sendbuf = Text_Create_Proc()


        Menu_Send_Proc = False
        Exit Function
    End If
'----------------------------------------------- 'çëì‡äOëIëÇ†ÇË
    If ID_KANRI_TBL(ING_No).NAIGAI = " " Then

        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
        ID_KANRI_TBL(ING_No).MENU_LV2 = ""

        ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
        ID_KANRI_TBL(ING_No).PageNo_LV2 = 0


        Call NAIGAI_MENU_SET
        Sendbuf = Text_Create_Proc
        Menu_Send_Proc = False
        Exit Function
    Else
        '2010.03.30
        If Trim(ID_KANRI_TBL(ING_No).MENU_LV1) = "" Then
            If ID_KANRI_TBL(ING_No).Step < Step_MENU1_REQ Then
                ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
            End If
'            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
'            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
        
'            ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
'            ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
        
'            ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = ""
'            ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = ""
'            ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM = ""
        End If
        '2010.03.30
    
    
    End If
    '   -------------------------------- ÉåÉxÉãÇPÅ@ÉgÉbÉvÉÅÉjÉÖÅ[ÇÃä«óù
    If Trim(ID_KANRI_TBL(ING_No).MENU_LV1) = "" Then
'        ST_LOG_OUT_F = True '2008.08.08
        
        
        MENU_UP_F = False   '2008.08.08
        
        '“∆≠∞∏ﬁŸ∞Ãﬂ
        Call UniCode_Conv(K0_P_TMENU.TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
        Erase Menu_Tbl

        sts = BTRV(BtOpGetEqual, P_TMENU_POS, P_TMENUREC, Len(P_TMENUREC), K0_P_TMENU, Len(K0_P_TMENU), 0)
        Select Case sts
            
            Case BtNoErr
            Case BtErrKeyNotFound
            
                        
                Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
                Sendbuf = Text_Create_Proc()
'                If UBound(NAIGAI) = 0 Then
'                    ID_KANRI_TBL(ING_No).Step = Step_Start
'                Else
'                    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
'                End If
                
                
                
                
                
                
                
                If UBound(NAIGAI) = 0 Then
                    
                    
                    
                    If UBound(JGYOBU_T) = 0 Then
                    
                    
                        ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                
    '                    Call Menu_Send_Proc(Sendbuf)
                
                
                    Else
                
                        'éñã∆ïîóvãÅÇ≈ÉãÅ[ÉvÇ∑ÇÈ
                        ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
                        ID_KANRI_TBL(ING_No).JGYOBU = ""
                        
                        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
            
    '                    Call Menu_Send_Proc(Sendbuf)
                    End If
                
                Else
                    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                    ID_KANRI_TBL(ING_No).NAIGAI = ""
    '                Call Menu_Send_Proc(Sendbuf)
                End If
                
                Menu_Send_Proc = False
                
                Exit Function
            
            
            Case Else

                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, com, "íSìñé“ï “∆≠∞", 0)
                Exit Function
        End Select


        Menu_Cnt = -1
        For i = 0 To 179     '29--->179 2006.10.11
            If Trim(StrConv(P_TMENUREC.MENU_T(i).MENU_NO, vbUnicode)) = "" Then
                Exit For
            End If
        
            If StrConv(P_TMENUREC.MENU_T(i).JGYOBU, vbUnicode) = ID_KANRI_TBL(ING_No).JGYOBU And _
                StrConv(P_TMENUREC.MENU_T(i).NAIGAI, vbUnicode) = ID_KANRI_TBL(ING_No).NAIGAI Then
        
                Menu_Cnt = Menu_Cnt + 1
                ReDim Preserve Menu_Tbl(Menu_Cnt)
            
                Menu_Tbl(Menu_Cnt).MENU_NO = StrConv(P_TMENUREC.MENU_T(i).MENU_NO, vbUnicode)
                
                Call UniCode_Conv(K0_P_MENU.JGYOBU, StrConv(P_TMENUREC.MENU_T(i).JGYOBU, vbUnicode))
                Call UniCode_Conv(K0_P_MENU.NAIGAI, StrConv(P_TMENUREC.MENU_T(i).NAIGAI, vbUnicode))
                Call UniCode_Conv(K0_P_MENU.MENU_NO, StrConv(P_TMENUREC.MENU_T(i).MENU_NO, vbUnicode))
                
                sts = BTRV(BtOpGetEqual, P_MENU_POS, P_MENUREC, Len(P_MENUREC), K0_P_MENU, Len(K0_P_MENU), 0)
                Select Case sts
                    
                    Case BtNoErr
                    Case BtErrKeyNotFound
                    
                                
                        Call Err_Send_Proc("ÉÅÉjÉÖÅ[àŸèÌ", "", "", "", "")
'                        Sendbuf = Text_Create_Proc()
'                        If UBound(NAIGAI) = 0 Then
'                            ID_KANRI_TBL(ING_No).Step = Step_Start
'                        Else
'                            ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
'                        End If
'                        Menu_Send_Proc = False
'                        Exit Function
                    
                    
                        If UBound(NAIGAI) = 0 Then
                            
                            
                            
                            If UBound(JGYOBU_T) = 0 Then
                            
                            
                                ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                                ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                        
            '                    Call Menu_Send_Proc(Sendbuf)
                        
                        
                            Else
                        
                                'éñã∆ïîóvãÅÇ≈ÉãÅ[ÉvÇ∑ÇÈ
                                ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
                                ID_KANRI_TBL(ING_No).JGYOBU = ""
                                
                                ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                                ID_KANRI_TBL(ING_No).MENU_LV2 = ""
                    
            '                    Call Menu_Send_Proc(Sendbuf)
                            End If
                        
                        Else
                            ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                            ID_KANRI_TBL(ING_No).NAIGAI = ""
            '                Call Menu_Send_Proc(Sendbuf)
                        End If
                        
                        Menu_Send_Proc = False
                        
                        Exit Function
                    
                    
                    
                    
                    Case Else
        
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, com, "ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                
                
                Menu_Tbl(Menu_Cnt).MENU_NO = StrConv(P_TMENUREC.MENU_T(i).MENU_NO, vbUnicode)
                Menu_Tbl(Menu_Cnt).Disp = StrConv(P_MENUREC.MENU_DSP, vbUnicode)
        
        
            End If
        
        Next i


        If Menu_Cnt = -1 Then
        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
            Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
            Sendbuf = Text_Create_Proc()
'            If UBound(NAIGAI) = 0 Then
'                ID_KANRI_TBL(ING_No).Step = Step_Start
'            Else
'                ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
'            End If
            
            
            
            
            
            If UBound(NAIGAI) = 0 Then
                
                
                
                If UBound(JGYOBU_T) = 0 Then
                
                
                    ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
            
'                    Call Menu_Send_Proc(Sendbuf)
            
            
                Else
            
                    'éñã∆ïîóvãÅÇ≈ÉãÅ[ÉvÇ∑ÇÈ
                    ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
                    ID_KANRI_TBL(ING_No).JGYOBU = ""
                    
                    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                    ID_KANRI_TBL(ING_No).MENU_LV2 = ""
        
'                    Call Menu_Send_Proc(Sendbuf)
                End If
            
            Else
                ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                ID_KANRI_TBL(ING_No).NAIGAI = ""
'                Call Menu_Send_Proc(Sendbuf)
            End If
            
'''''            Menu_Send_Proc = False
            
            Exit Function
            
            
            
            
            
            
            
            
            
            
            
            
            
            
        End If


        Max_Page = Int(CDbl((Menu_Cnt + 1) / M_Gyo + 0.9))
        PageNo = ID_KANRI_TBL(ING_No).PageNo_LV1

        Start_Gyo = PageNo * M_Gyo
        End_Gyo = (PageNo * M_Gyo) + (M_Gyo - 1)


        Send_Text.sts = Sts_OK                                      'ÉXÉeÅ[É^ÉXÅ@OK
        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK

        Send_Text.Display_Flg = Display_MENU                        'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_MENU
        If Max_Page = 1 Then
            Send_Text.End_Menu = Menu_Only          'ÇPâÊñ ÇÃÇ›
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        Else
            If (Max_Page - 1) = PageNo Then
                Send_Text.End_Menu = MENU_END       'ç≈èIÉyÅ[ÉW
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = MENU_END
            Else
                If PageNo = 0 Then
                    Send_Text.End_Menu = Menu_Head  'êÊì™ÉyÅ[ÉW
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Head
                Else
                    Send_Text.End_Menu = Menu_Mid   'ìríÜÉyÅ[ÉW
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Mid
                End If
            End If
        End If
        Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
'---------------------------------------------------------------
        Gyo_Suu = 0
        j = -1
        For i = Start_Gyo To End_Gyo
            j = j + 1
            If i > UBound(Menu_Tbl) Then
                Send_Text.Box_Type(j).Box_Type = ""                 'BOXëÆê´
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = ""
                Call UniCode_Conv(Send_Text.Box_Type(j).LCD, "")    'ï\é¶ì‡óe
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, "")
                Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
                Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
                Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
                Send_Text.Box_Type(j).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = ""
            Else
                Gyo_Suu = Gyo_Suu + 1
                Send_Text.Box_Type(j).Box_Type = TYPE_MENU          'BOXëÆê´
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = TYPE_MENU
                Call UniCode_Conv(Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
                Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
                Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
                Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
                Send_Text.Box_Type(j).MENU = Menu_Tbl(i).MENU_NO
                
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = Menu_Tbl(i).MENU_NO
            End If
        Next i
        
        Send_Text.Menu_Suu = Format(Gyo_Suu, "00")      'ÉÅÉjÉÖÅ[çÄñ⁄êî
        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = Format(Gyo_Suu, "00")
        ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM
        Sendbuf = Text_Create_Proc()
        
    Else
        '   -------------------------------- ÉåÉxÉãÇQÅ@çÏã∆ÉÅÉjÉÖÅ[ÇÃä«óù
        If Trim(ID_KANRI_TBL(ING_No).MENU_LV2) = "" Then
            
            
'2008.08.12            If ST_LOG_OUT_F Then            '2008.08.08

'                ST_LOG_OUT_F = False        '2008.08.08

                
'                If Not MENU_UP_F Then       '2008.08.08
'
'                    If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
'                                                Format(ID_KANRI_TBL(ING_No).ID, "000"), _
'                                                ID_KANRI_TBL(ING_No).JGYOBU, _
'                                                ID_KANRI_TBL(ING_No).NAIGAI, _
'                                                ID_KANRI_TBL(ING_No).MENU_LV1, _
'                                                "ST", , , , , , , , , FILE_RETRY) Then
'
'                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                        Sendbuf = Text_Create_Proc()
'                        Exit Function
'
'                    End If
'
'                End If


 '2008.08.12           End If
            
            
            
            
            
            
            
            
            
            '“∆≠∞∏ﬁŸ∞Ãﬂ
            Call UniCode_Conv(K0_P_MENU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
            Call UniCode_Conv(K0_P_MENU.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
            Call UniCode_Conv(K0_P_MENU.MENU_NO, ID_KANRI_TBL(ING_No).MENU_LV1)
            
            
            Erase Menu_Tbl
    
            sts = BTRV(BtOpGetEqual, P_MENU_POS, P_MENUREC, Len(P_MENUREC), K0_P_MENU, Len(K0_P_MENU), 0)
            Select Case sts
                
                Case BtNoErr
                Case BtErrKeyNotFound
                
                            
                    Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    If UBound(NAIGAI) = 0 Then
                        ID_KANRI_TBL(ING_No).Step = Step_Start
                    Else
                        ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                    End If
                    Menu_Send_Proc = False
                    Exit Function
                
                
                Case Else
    
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, com, "íSìñé“ï “∆≠∞", 0)
                    Exit Function
            End Select
    
    
            Menu_Cnt = -1
            For i = 0 To 19
                If Trim(StrConv(P_MENUREC.SAGYO(i).YOIN, vbUnicode)) = "" Then
                    Exit For
                End If
            
            
                Menu_Cnt = Menu_Cnt + 1
                ReDim Preserve Menu_Tbl(Menu_Cnt)
                
                    
                    
                Menu_Tbl(Menu_Cnt).MENU_NO = StrConv(P_MENUREC.SAGYO(i).YOIN, vbUnicode)
                Menu_Tbl(Menu_Cnt).PARAM = StrConv(P_MENUREC.SAGYO(i).PARAM, vbUnicode)
                Menu_Tbl(Menu_Cnt).Disp = StrConv(P_MENUREC.SAGYO(i).Disp, vbUnicode)
            
                Menu_Tbl(Menu_Cnt).LOG_OUT = StrConv(P_MENUREC.SAGYO(i).LOG_OUT, vbUnicode)
            
            Next i
    
    
            If Menu_Cnt = -1 Then
            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Call Err_Send_Proc("ÉÅÉjÉÖÅ[ñ¢ìoò^", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                If UBound(NAIGAI) = 0 Then
                    ID_KANRI_TBL(ING_No).Step = Step_Start
                Else
                    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                End If
                Menu_Send_Proc = False
                Exit Function
            End If
    
    
            Max_Page = Int(CDbl((Menu_Cnt + 1) / M_Gyo + 0.9))
            PageNo = ID_KANRI_TBL(ING_No).PageNo_LV2
    
            Start_Gyo = PageNo * M_Gyo
            End_Gyo = (PageNo * M_Gyo) + (M_Gyo - 1)
    
    
            Send_Text.sts = Sts_OK                                      'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_MENU                        'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_MENU
            If Max_Page = 1 Then
                Send_Text.End_Menu = Menu_Only          'ÇPâÊñ ÇÃÇ›
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            Else
                If (Max_Page - 1) = PageNo Then
                    Send_Text.End_Menu = MENU_END       'ç≈èIÉyÅ[ÉW
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = MENU_END
                Else
                    If PageNo = 0 Then
                        Send_Text.End_Menu = Menu_Head  'êÊì™ÉyÅ[ÉW
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Head
                    Else
                        Send_Text.End_Menu = Menu_Mid   'ìríÜÉyÅ[ÉW
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Mid
                    End If
                End If
            End If
            Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
    '---------------------------------------------------------------
            Gyo_Suu = 0
            j = -1
            For i = Start_Gyo To End_Gyo
                j = j + 1
                If i > UBound(Menu_Tbl) Then
                    Send_Text.Box_Type(j).Box_Type = ""                 'BOXëÆê´
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = ""
                    Call UniCode_Conv(Send_Text.Box_Type(j).LCD, "")    'ï\é¶ì‡óe
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, "")
                    Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
                    Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
                    Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
                    Send_Text.Box_Type(j).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = ""
                Else
                    Gyo_Suu = Gyo_Suu + 1
                    Send_Text.Box_Type(j).Box_Type = TYPE_MENU          'BOXëÆê´
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Box_Type = TYPE_MENU
                    Call UniCode_Conv(Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).LCD, Menu_Tbl(i).Disp)
                    Send_Text.Box_Type(j).INIT = ""                     'êîílèâä˙íl
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).INIT = ""
                    Send_Text.Box_Type(j).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Start_Pos = ""
                    Send_Text.Box_Type(j).Max_Size = "00"               'ì¸óÕåÖêî
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).Max_Size = "00"
                                                                        
                                                                        'ÉÅÉjÉÖÅ\î‘çÜ &  ﬂ◊“∞¿
                     Send_Text.Box_Type(j).MENU = Menu_Tbl(i).MENU_NO & Menu_Tbl(i).PARAM
                     ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j).MENU = Menu_Tbl(i).MENU_NO & Menu_Tbl(i).PARAM
                
                
                End If
            Next i
            
            Send_Text.Menu_Suu = Format(Gyo_Suu, "00")      'ÉÅÉjÉÖÅ[çÄñ⁄êî
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = Format(Gyo_Suu, "00")
            ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM
            Sendbuf = Text_Create_Proc()
            
        
        End If
    End If
    
    Menu_Send_Proc = False




End Function


Private Sub JGYOBU_MENU_SET()
'-------------------------------------------------------
'
'   Åwéñã∆ïîëIëópÉÅÉjÉÖÅ[çÏê¨Åx
'
'-------------------------------------------------------
Dim i   As Integer

    ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ                     'éñã∆ïîóvãÅ
    '---------------------------------------------------------------
    Send_Text.sts = Sts_OK                                          'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_MENU                            'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_MENU
    
    Send_Text.End_Menu = Menu_Only                                  'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = Format(UBound(JGYOBU_T) + 1, "00")         'ÉÅÉjÉÖÅ[çÄñ⁄êî
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = Format(UBound(JGYOBU_T) + 1, "00")
    
    Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
    Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
    
    '---------------------------------------------------------------
    For i = 0 To M_Gyo - 1
        
        If i > UBound(JGYOBU_T) Then
        
            Send_Text.Box_Type(i).Box_Type = ""                 'BOXëÆê´
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
        
            Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")    'ï\é¶ì‡óe
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
            
            Send_Text.Box_Type(i).INIT = ""                     'êîílèâä˙íl
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                                                
            Send_Text.Box_Type(i).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                                                
            Send_Text.Box_Type(i).Max_Size = "00"               'ì¸óÕåÖêî
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(i).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
        
        Else
            
            Send_Text.Box_Type(i).Box_Type = TYPE_MENU          'BOXëÆê´
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = TYPE_MENU
                                                                'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(i).LCD, JGYOBU_T(i).NAME)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, JGYOBU_T(i).NAME)
                                                                                
            Send_Text.Box_Type(i).INIT = ""                     'êîílèâä˙íl
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
            
            Send_Text.Box_Type(i).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                                                
            Send_Text.Box_Type(i).Max_Size = "00"               'ì¸óÕåÖêî
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(i).MENU = JGYOBU_T(i).CODE       'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = JGYOBU_T(i).CODE
                                                                                
        
        End If
    
    Next i
    
    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM

End Sub

Private Sub NAIGAI_MENU_SET()
'-------------------------------------------------------
'
'   Åwì‡äOëIëópÉÅÉjÉÖÅ[çÏê¨Åx
'
'-------------------------------------------------------
Dim i   As Integer

    ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ                     'ì‡äOóvãÅ
    '---------------------------------------------------------------
    Send_Text.sts = Sts_OK                                          'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_MENU                             'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_MENU
    
    Send_Text.End_Menu = Menu_Only                                  'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = Format(UBound(NAIGAI) + 1, "00")         'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = Format(UBound(NAIGAI) + 1, "00")
    
    Send_Text.fileName = ""                                         'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
    Send_Text.Buzzer = Buzzer_DEF                                   'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
    
    '---------------------------------------------------------------
    For i = 0 To M_Gyo - 1
        
        If i > UBound(NAIGAI) Then
        
            Send_Text.Box_Type(i).Box_Type = ""                 'BOXëÆê´
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
        
            Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")    'ï\é¶ì‡óe
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
            
            Send_Text.Box_Type(i).INIT = ""                     'êîílèâä˙íl
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                                                
            Send_Text.Box_Type(i).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                                                
            Send_Text.Box_Type(i).Max_Size = "00"               'ì¸óÕåÖêî
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(i).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
        
        Else
            
            Send_Text.Box_Type(i).Box_Type = TYPE_MENU          'BOXëÆê´
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = TYPE_MENU
                                                                'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(i).LCD, NAIGAI(i).NAME)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, NAIGAI(i).NAME)
                                                                                
            Send_Text.Box_Type(i).INIT = ""                     'êîílèâä˙íl
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                                                
            Send_Text.Box_Type(i).Start_Pos = ""                'èâä˙ÉJÅ[É\Éãà íu
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                                                
            Send_Text.Box_Type(i).Max_Size = "00"               'ì¸óÕåÖêî
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(i).MENU = NAIGAI(i).CODE       'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = NAIGAI(i).CODE
                                                                                
        
        End If
    
    Next i
    
    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM

End Sub

Private Sub Re_Send_Proc(Sendbuf As String)
'-------------------------------------------------------
'
'   ÅwÉGÉâÅ[éûÇÃçƒëóÅx
'
'-------------------------------------------------------
Dim i   As Integer
    
    
    
'    Select Case ID_KANRI_TBL(ING_No).Step
'        Case 2, 4, 6
'            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'    End Select
'-------------------------------------------------------
    Send_Text.sts = ID_KANRI_TBL(ING_No).Send_Text.sts                  'ÉXÉeÅ[É^ÉXÅ@OK
    
    Send_Text.Display_Flg = ID_KANRI_TBL(ING_No).Send_Text.Display_Flg  'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
    
    Send_Text.End_Menu = ID_KANRI_TBL(ING_No).Send_Text.End_Menu        'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    
    Send_Text.Menu_Suu = ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu        'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    
    Send_Text.fileName = ID_KANRI_TBL(ING_No).Send_Text.fileName        'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    
    Send_Text.Buzzer = ID_KANRI_TBL(ING_No).Send_Text.Buzzer            'ÉuÉUÅ[âπÅ@ïWèÄ

    For i = 0 To M_Gyo - 1
                                                                        'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type
                                                                        'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                                                                        
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
        Send_Text.Box_Type(i).INIT = ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT
                                                                        'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos
                                                                        'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size
                                                                        'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU

    Next
    
    Send_Text.CRLF = vbCrLf
    
    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM
    
    Sendbuf = Text_Create_Proc()


End Sub
Private Sub Send_Err_Proc(Sendbuf As String)
'-------------------------------------------------------
'
'   ÅwëóêMÉGÉâÅ[éûÇÃçƒëóÅx
'
'-------------------------------------------------------
Dim i   As Integer
    
    
    
'    Select Case ID_KANRI_TBL(ING_No).Step
'        Case 2, 4, 6
'            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'    End Select
'-------------------------------------------------------
    Send_Text.sts = ID_KANRI_TBL(ING_No).Last_Send_Text.sts                  'ÉXÉeÅ[É^ÉXÅ@OK
    
    Send_Text.Display_Flg = ID_KANRI_TBL(ING_No).Last_Send_Text.Display_Flg  'ï\é¶âÊñ ÉtÉâÉO ÉÅÉjÉÖÅ[âÊñ 
    
    Send_Text.End_Menu = ID_KANRI_TBL(ING_No).Last_Send_Text.End_Menu        'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    
    Send_Text.Menu_Suu = ID_KANRI_TBL(ING_No).Last_Send_Text.Menu_Suu        'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    
    Send_Text.fileName = ID_KANRI_TBL(ING_No).Last_Send_Text.fileName        'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    
    Send_Text.Buzzer = ID_KANRI_TBL(ING_No).Last_Send_Text.Buzzer            'ÉuÉUÅ[âπÅ@ïWèÄ

    For i = 0 To M_Gyo - 1
                                                                        'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).Box_Type
                                                                        'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, StrConv(ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).LCD, vbUnicode))
                                                                        
                                                                    'èâä˙ï\é¶ì‡óeÅiêîílÅj
        Send_Text.Box_Type(i).INIT = ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).INIT
                                                                        'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).Start_Pos
                                                                        'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).Max_Size
                                                                        'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ID_KANRI_TBL(ING_No).Last_Send_Text.Box_Type(i).MENU

    Next
    
    Send_Text.CRLF = vbCrLf
    
    ID_KANRI_TBL(ING_No).Last_Send = 0  'ÉmÅ[É}ÉãÉfÅ[É^ëóêM
    
    Sendbuf = Text_Create_Proc()


End Sub

Private Function Menu_Recv_Proc(Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   ÅwÇQäKëwà»è„ÇÃÉÅÉjÉÖÅ[ëóêMÅx
'
'-------------------------------------------------------
Dim sts     As Integer
Dim i       As Integer

    
Dim MTS     As String * 8
Dim SS      As String * 8
    
    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_MENU1_RES
    '   -------------------------------- éü⁄ÕﬁŸÇ÷
            If Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) <> BEF_Page And Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) <> NEXT_Page Then

                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
            End If
            
            If Menu_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        Case Else
    
            If Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) = BEF_Page Or Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) = NEXT_Page Then
                If Menu_Send_Proc() Then
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                End If
            Else
    
    '   -------------------------------- ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^ì«çûÇ›
                Call UniCode_Conv(K0_P_MENU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                Call UniCode_Conv(K0_P_MENU.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                Call UniCode_Conv(K0_P_MENU.MENU_NO, ID_KANRI_TBL(ING_No).MENU_LV1)
        
                sts = BTRV(BtOpGetEqual, P_MENU_POS, P_MENUREC, Len(P_MENUREC), K0_P_MENU, Len(K0_P_MENU), 0)
                Select Case sts
                    Case BtNoErr
    
                        For i = 0 To 19
                        
                            If Trim(StrConv(P_MENUREC.SAGYO(i).YOIN, vbUnicode)) = Trim(ID_KANRI_TBL(ING_No).MENU_LV2) And _
                                StrConv(P_MENUREC.SAGYO(i).PARAM, vbUnicode) = (ID_KANRI_TBL(ING_No).MTS_CODE & _
                                                                                        ID_KANRI_TBL(ING_No).SS_CODE) Then
                                
                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, Left(StrConv(P_MENUREC.SAGYO(i).YOIN, vbUnicode), 1))
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, Right(StrConv(P_MENUREC.SAGYO(i).YOIN, vbUnicode), 1))
                                
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                
                                    Case BtNoErr
                                        'Ω∑¨≈ï\é¶ñºèÃ
                                        ID_KANRI_TBL(ING_No).YOIN_DNAME = StrConv(P_MENUREC.SAGYO(i).Disp, vbUnicode)
                                
                                
                                        '2010.09.15
                                        ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME = StrConv(P_MENUREC.SAGYO(i).Disp, vbUnicode)
                                
                                        
                                        ID_KANRI_TBL(ING_No).SAGYO_LOG = StrConv(P_MENUREC.SAGYO(i).LOG_OUT, vbUnicode)
                                                                    
                                        If StrConv(YOINREC.PARAM_F, vbUnicode) = "1" Then   'å¸ÇØêÊÇ»ÇÁÅièoâ◊Åj
                                            ID_KANRI_TBL(ING_No).CYU_KBN = StrConv(YOINREC.YOIN_CODE, vbUnicode)
'2006.01.30                                            ID_KANRI_TBL(ING_No).MTS_CODE = Left(StrConv(P_MENUREC.SAGYO(i).PARAM, vbUnicode), 8)
'2006.01.30                                            ID_KANRI_TBL(ING_No).SS_CODE = Right(StrConv(P_MENUREC.SAGYO(i).PARAM, vbUnicode), 8)
                                        End If
                                                                                            'åüïiÅiå¸ÇØêÊéwíËÅjÇ»ÇÁ
                                        If StrConv(YOINREC.CODE_TYPE, vbUnicode) = ACT_KENPIN_MTS Then
                                            ID_KANRI_TBL(ING_No).CYU_KBN = StrConv(YOINREC.YOIN_CODE, vbUnicode)
                                        End If
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = StrConv(YOINREC.CODE_TYPE, vbUnicode)
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = StrConv(YOINREC.YOIN_CODE, vbUnicode)
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM = StrConv(YOINREC.SOKO_NO, vbUnicode)
                                
                                    Case BtErrKeyNotFound
    
                                        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                                        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                        Call Err_Send_Proc("óvàˆÉ}ÉXÉ^", "ñ¢ìoò^", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
                                        Menu_Recv_Proc = False
                                        Exit Function
                                    Case Else
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpGetEqual, "ÉÅÉjÉÖÅ[ä«óù", 0)
                                        Exit Function
                                End Select
                                
                                Exit For
                            End If
                        
                        Next i
    
                        If i > 19 Then
                
    
                            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc("ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^", "ê›íËÉ~ÉX", Trim(ID_KANRI_TBL(ING_No).MENU_LV1), "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
                            Menu_Recv_Proc = False
                            Exit Function
                        
                        End If
                
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
        
        
                    Case BtErrKeyNotFound
        
                        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc("ÉÅÉjÉÖÅ[ä«óùÉ}ÉXÉ^", "ñ¢ìoò^", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
                        Menu_Recv_Proc = False
                        Exit Function
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "ÉÅÉjÉÖÅ[ä«óù", 0)
                        Exit Function
        
                End Select
            End If
        End Select
        Sendbuf = Text_Create_Proc()
    
    Menu_Recv_Proc = False

End Function
'2006.01.30Private Function Menu_Recv_Proc(Sendbuf As String) As Integer
'2006.01.30'-------------------------------------------------------
'2006.01.30'
'2006.01.30'   ÅwÇQäKëwà»è„ÇÃÉÅÉjÉÖÅ[ëóêMÅx
'2006.01.30'
'2006.01.30'-------------------------------------------------------
'2006.01.30Dim sts As Integer
'2006.01.30
'2006.01.30    Menu_Recv_Proc = True
'2006.01.30                                        'ÉÅÉjÉÖä«óùÉ}ÉXÉ^ÇÃì«Ç›çûÇ›
'2006.01.30    Call UniCode_Conv(K1_MENU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'2006.01.30    Call UniCode_Conv(K1_MENU.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'2006.01.30    Call UniCode_Conv(K1_MENU.MENU_GRP_NO, ID_KANRI_TBL(ING_No).MENU_GRP)
'2006.01.30
'2006.01.30    If ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ Then
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_LV1, "000")
'2006.01.30    Else
'2006.01.30        Call UniCode_Conv(K1_MENU.MENU_LV1, ID_KANRI_TBL(ING_No).MENU_LV1)
'2006.01.30    End If
'2006.01.30
'2006.01.30    Call UniCode_Conv(K1_MENU.MENU_LV2, ID_KANRI_TBL(ING_No).MENU_LV2)
'2006.01.30    Call UniCode_Conv(K1_MENU.MENU_LV3, ID_KANRI_TBL(ING_No).MENU_LV3)
'2006.01.30    sts = BTRV(BtOpGetEqual, MENU_POS, MENUREC, Len(MENUREC), K1_MENU, Len(K1_MENU), 1)
'2006.01.30    Select Case sts
'2006.01.30        Case BtNoErr
'2006.01.30        Case BtErrKeyNotFound
'2006.01.30
'2006.01.30            ID_KANRI_TBL(ING_No).MENU_GRP = ""
'2006.01.30
'2006.01.30            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
'2006.01.30            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30            ID_KANRI_TBL(ING_No).MENU_LV3 = ""
'2006.01.30
'2006.01.30            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'2006.01.30            Call Err_Send_Proc("ÉÅÉjÉÖÅ[ä«óù", "ñ¢ìoò^", "", "", "")
'2006.01.30
'2006.01.30            Sendbuf = Text_Create_Proc()
'2006.01.30            ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
'2006.01.30
'2006.01.30            Menu_Recv_Proc = False
'2006.01.30            Exit Function
'2006.01.30        Case Else
'2006.01.30            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2006.01.30            Sendbuf = Text_Create_Proc()
'2006.01.30            Call File_Error(sts, BtOpGetEqual, "ÉÅÉjÉÖÅ[ä«óù", 0)
'2006.01.30            Exit Function
'2006.01.30    End Select
'2006.01.30
'2006.01.30    If Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) <> BEF_Page And Trim(ID_KANRI_TBL(ING_No).Recv_text(0)) <> NEXT_Page And _
'2006.01.30     StrConv(MENUREC.MENU_KBN, vbUnicode) = "1" Then
'2006.01.30
'2006.01.30
'2006.01.30                                            'óvàˆÇÃì«çûÇ›
'2006.01.30        Call UniCode_Conv(K0_YOIN.CODE_TYPE, StrConv(MENUREC.CODE_TYPE, vbUnicode))
'2006.01.30        Call UniCode_Conv(K0_YOIN.YOIN_CODE, StrConv(MENUREC.YOIN_CODE, vbUnicode))
'2006.01.30        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
'2006.01.30        Select Case sts
'2006.01.30            Case BtNoErr
'2006.01.30                ID_KANRI_TBL(ING_No).YOIN_DNAME = StrConv(YOINREC.YOIN_DNAME, vbUnicode)
'2006.01.30
'2006.01.30                If StrConv(YOINREC.PARAM_F, vbUnicode) = "1" Then   'å¸ÇØêÊÇ»ÇÁÅièoâ◊Åj
'2006.01.30                    ID_KANRI_TBL(ING_No).CYU_KBN = StrConv(MENUREC.YOIN_CODE, vbUnicode)
'2006.01.30                    ID_KANRI_TBL(ING_No).MTS_CODE = Left(StrConv(MENUREC.PARAM, vbUnicode), 8)
'2006.01.30                    ID_KANRI_TBL(ING_No).SS_CODE = Right(StrConv(MENUREC.PARAM, vbUnicode), 8)
'2006.01.30                End If
'2006.01.30                                                                    'åüïiÅiå¸ÇØêÊéwíËÅjÇ»ÇÁ
'2006.01.30                If StrConv(YOINREC.CODE_TYPE, vbUnicode) = ACT_KENPIN_MTS Then
'2006.01.30                    ID_KANRI_TBL(ING_No).CYU_KBN = StrConv(MENUREC.YOIN_CODE, vbUnicode)
'2006.01.30                End If
'2006.01.30
'2006.01.30                ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = StrConv(YOINREC.CODE_TYPE, vbUnicode)
'2006.01.30                ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = StrConv(YOINREC.YOIN_CODE, vbUnicode)
'2006.01.30                ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM = StrConv(MENUREC.PARAM, vbUnicode)
'2006.01.30
'2006.01.30            Case BtErrKeyNotFound
'2006.01.30
'2006.01.30                ID_KANRI_TBL(ING_No).MENU_GRP = ""
'2006.01.30
'2006.01.30                ID_KANRI_TBL(ING_No).MENU_LV1 = ""
'2006.01.30                ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30                ID_KANRI_TBL(ING_No).MENU_LV3 = ""
'2006.01.30
'2006.01.30                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'2006.01.30                Call Err_Send_Proc("óvàˆÉ}ÉXÉ^", "ñ¢ìoò^", "", "", "")
'2006.01.30
'2006.01.30                Sendbuf = Text_Create_Proc()
'2006.01.30                ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
'2006.01.30
'2006.01.30                Menu_Recv_Proc = False
'2006.01.30                Exit Function
'2006.01.30            Case Else
'2006.01.30                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2006.01.30                Sendbuf = Text_Create_Proc()
'2006.01.30                Call File_Error(sts, BtOpGetEqual, "ÉÅÉjÉÖÅ[ä«óù", 0)
'2006.01.30                Exit Function
'2006.01.30        End Select
'2006.01.30
'2006.01.30        If Sagyo_Send_Proc() Then
'2006.01.30            Sendbuf = Text_Create_Proc()
'2006.01.30            Exit Function
'2006.01.30        End If
'2006.01.30    Else
'2006.01.30
'2006.01.30        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step + 1
'2006.01.30
'2006.01.30        If Menu_Send_Proc() Then
'2006.01.30            Sendbuf = Text_Create_Proc()
'2006.01.30            Exit Function
'2006.01.30        End If
'2006.01.30    End If
'2006.01.30
'2006.01.30    Sendbuf = Text_Create_Proc()
'2006.01.30
'2006.01.30
'2006.01.30    Menu_Recv_Proc = False
'2006.01.30
'2006.01.30End Function





Private Function Sagyo_Main_Proc(Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   ÅwçÏã∆éÛêMéûÇÃÉÅÉCÉìèàóùÅx
'
'-------------------------------------------------------
Dim i           As Integer
Dim j           As Integer
Dim Found_Flg   As Boolean
    
    
    Sagyo_Main_Proc = True
    
    
    Found_Flg = False
    For i = 0 To UBound(WEL_Para_Tbl, 1)
        For j = 0 To UBound(WEL_Para_Tbl, 2)
                                        'ç≈èâÇÕÇQåÖÇ≈åüçı
            If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = _
                WEL_Para_Tbl(i, j).Action Then
                Found_Flg = True
                Exit For
            End If
        
        Next j
            
        If Found_Flg Then
            Exit For
        End If
    
    Next i
    
    If Not Found_Flg Then
        
        For i = 0 To UBound(WEL_Para_Tbl, 1)
            For j = 0 To UBound(WEL_Para_Tbl, 2)
                                        'ç≈å„ÇÕÇPåÖÇ≈åüçı
               If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE = Left(WEL_Para_Tbl(i, j).Action, 1) Then
                    Found_Flg = True
                    Exit For
                End If
        
            Next j
            
            If Found_Flg Then
                Exit For
            End If
        
        
        Next i
            
    End If


    If Not Found_Flg Then
                        
                        'Ç†ÇËÇ¶Ç»Ç¢àŸèÌÅiäYìñçÏã∆ÉpÉâÉÅÅ[É^Ç»ÇµÅj
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_GRP = ""
                
        ID_KANRI_TBL(ING_No).MENU_LV1 = ""
        ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30        ID_KANRI_TBL(ING_No).MENU_LV3 = ""
                
        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
        Call Err_Send_Proc("çÏã∆ÉpÉâÉÅÅ[É^ÅiINIÅj", "ñ¢ìoò^", "", "", "")
                    
        Sendbuf = Text_Create_Proc()
        ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
            
        Sagyo_Main_Proc = False
        Exit Function
    
    End If

    Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE
        Case ACT_ZAITEI_IN          'ç›í˘Å{
        
        
            If Zaitei_In_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        
        
        Case ACT_ZAITEI_OUT         'ç›í˘Å|
            
            '2007.10.02
            If (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE) = _
                Wel_S_SHOUHI Then
                        
                '2007.10.02 éëçﬁè¡îÔêÍóp
                If S_SHOUHI_Out_Proc(Sendbuf, i, j) Then
                    Exit Function
                End If
                        
                        
            Else
                If Zaitei_Out_Proc(Sendbuf, i, j) Then
                    Exit Function
                End If
            End If
        
        
        Case ACT_NYUKA              'ì¸â◊
    
        Case ACT_SYUKA_KEI          'èoâ◊(èoâ◊ó\íËóLÇË)Å®å¸ÇØêÊêÈåæ
        
            
            If MTS_Dec_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        
        
        Case ACT_SYUKA_HYO          'èoâ◊(èoå…ï\)
        
            If SYUKO_HYO_Dec_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        Case ACT_SYUKA_GAI          'èoâ◊(èoâ◊ó\íËñ≥Çµ)
        
            If Out_Plan_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        
        
        Case ACT_IDO_IN             'à⁄ìÆì¸å…
        
'-----------------------------------------  2012.03.06
'            If Ido_In_Proc(Sendbuf, i, j) Then
'                Exit Function
'            End If
        
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
        
                Case Wel_IDO_IN_OSAKA          '2012.03.15
            
                    If Ido_In_OSAKA_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Else
            
                    If Ido_In_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            End Select
        
        
        
        Case ACT_IDO_OUT            'à⁄ìÆèoå…
        
            
            
'-----------------------------------------  2012.03.06
'            '2011.06.01
'            If (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE) = _
'                Wel_HIN_FURIKAE_MAINA Then
'                '2011.06.01
'                If Ido_Out_Hin_Furikae_Proc(Sendbuf, i, j) Then
'                    Exit Function
'                End If
'
'            Else
'                If Ido_Out_Proc(Sendbuf, i, j) Then
'                    Exit Function
'                End If
'
'            End If
        
        Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
            Case Wel_HIN_FURIKAE_MAINA
        
                If Ido_Out_Hin_Furikae_Proc(Sendbuf, i, j) Then
                    Exit Function
                End If
        
        
            Case Wel_IDO_OUT_OSAKA          '2012.03.10
            
                If Ido_Out_OSAKA_Proc(Sendbuf, i, j) Then
                    Exit Function
                End If
            
            
            Case Else
                If Ido_Out_Proc(Sendbuf, i, j) Then
                    Exit Function
                End If
        
        End Select
'-----------------------------------------  2012.03.06
        
        Case ACT_DENPYO_ID          'ì`ï[ÇhÇc
        
            If DEN_ID_Dec_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        Case ACT_KENPIN             'åüïi
        
            If Inspe_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
        
        
        Case ACT_WEL_ETC            'WELêÍópÅiè∆âÔÅj
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
            
                Case Wel_TANAOROSI      'ÅuWEL íIâµÇµÅvÇÃóvàˆ
                
                    If Tanaorosi_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_TANAHYOJI      'ÅuWEL íIî‘ï\é¶ÅvÇÃóvàˆ
                
                    If Tanahyoji_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                
                Case Wel_HIN_SHOGO      'ÅuWEL ïiî‘ï è∆çáÅvÇÃóvàˆ
                    
                    If Hin_Shogo_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_AVE_SYUKA      'ÅuWEL åéïΩãœèoâ◊êîÅvÇÃóvàˆ
                
                    If Ave_Syuka_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_HOST_ZAIKO     'ÅuWEL ÉzÉXÉgç›å…è∆âÔÅvÇÃóvàˆ
                    
                    If Host_Zaiko_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                            
                Case Wel_ST_TANABAN     'ÅuWEL ïWèÄíIî‘ê›íËÅvÇÃóvàˆ
                    
                    If St_Tanaban_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                            
            
                Case Wel_RIREKI         'ÅuWEL ìñì˙èoå…óöóÅvÇÃóvàˆ
                
                    If Rireki_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_SUII           'ÅuWEL èoâ◊êÑà⁄ÅvÇÃóvàˆ

                    If Suii_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If

                Case Wel_TANA_HIN_SHOGO 'ÅuWEL íIî‘ÅEïiî‘ï è∆çáÅvÇÃóvàˆ

                    If Tana_Hin_Shogo_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_TANAHYOJI_KASO 'ÅuWEL íIî‘ï\é¶(âºëzóDêÊ)ÅvÇÃóvàˆ
                
                    If Tanahyoji_Kaso_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_COMPO          'ÅuWEL ç\ê¨ï\é¶ÅvÇÃóvàˆ 2006.10.15
                
                    If COMPO_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_KEN_RIREKI     'ÅuWEL åüïié¿ê—ÅvÇÃóvàˆ 2006.10.15
                
                    If KEN_Rireki_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                Case Wel_RIREKI2        'ÅuWEL ìñì˙èoå…óöóÅvÇÃóvàˆ 2009.01.09
                
                    If Rireki2_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                Case Wel_AVE_SYUKA_ID   'ÅuWEL åéïΩãœÅ@ÇhÇcì«Ç›çûÇ›ÅvÇÃóvàˆ 2009.03.19
                
                    If Ave_Syuka_ID_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_KEN_ZAN_ID   'ÅuWEL èWñÒç´ïÔécÅvÇÃóvàˆ 2010.02.15
            
            
                    If KEN_ZAN_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                '2010.12.13
                Case Wel_AKI_LOC                'ÅuWEL ãÛÇ´ÉçÉPÅ[ÉVÉáÉìÇÃåüçıÅvÇÃóvàˆ
            
            
                        
                    If AKI_LOC_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                '2011.07.05
                Case Wel_S_AVE_SYUKA
            
                    If S_Ave_Syuka_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            End Select
    
        Case ACT_KENPIN_MTS             'åüïiÅiÇlÇsÇrì«Ç›çûÇ›Ç†ÇËÅj
        
            If Inspe_Proc_MTS(Sendbuf, i, j) Then
                Exit Function
            End If
    
    
        Case ACT_GOODS_ONFF             'è§ïiÅ^ñ¢è§ïiêÿÇËë÷Ç¶
    
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
    
                Case Wel_GOODS_ONOFF_ONO        'ÅuWEL è§ïi/ñ¢è§ïiêÿÇËë÷Ç¶Å@è¨ñÏÅvÇÃóvàˆ
                
                    If GOODS_ONOFF_Ono_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_GOODS_ONOFF_SIGA       'ÅuWEL è§ïi/ñ¢è§ïiêÿÇËë÷Ç¶Å@é†âÍÅvÇÃóvàˆ
            
                    If GOODS_ONOFF_Siga_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            End Select
    
    
        Case ACT_SPECIAL_PROCESS    'ì¡éÍèàóù
        
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
    
                Case Wel_RETURNED_GOODS         'Åuó«ïiï‘ïiÅvÇÃóvàˆ
                
                    If RETURNED_GOODS_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                
                Case Wel_LOCATION_MOVE         'ÅuíIà⁄ìÆÅvÇÃóvàˆ
                
                    If Location_Move_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
            
                Case Wel_RETURNED_GOODS_OSAKA   'ÅuëÂç„ÇoÇbÅ@ó«ïiï‘ïiÅvÇÃóvàˆ   2007.09.12
                
                    If RETURNED_GOODS_OSAKA_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_SYUKA_CENCEL           'Åuèoâ◊∑¨›æŸÅvÇÃóvàˆ    2007.11.02
            
                    If SYUKA_CANCEL_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_ZAIKO_SEISA            'Åuç›å…ê∏ç∏ÅvÇÃóvàˆ    2008.11.20
            
                    If Zaiko_Seisa_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_SYUKO_CANCEL           'Åuèoå…CANCELÅvÇÃóvàˆ    2008.12.05
            
                    If SYUKO_CANCEL_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                                                'Åuà⁄ä«èàóùÅvÇÃóvàˆ    2009.02.26
                Case Wel_IKAN_1, Wel_IKAN_2, Wel_IKAN_3
            
                    
                    Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                        
                        Case Wel_IKAN_1
                    
                            If LSBU_IKAN_Proc(Sendbuf, i, j, 1) Then
                                Exit Function
                            End If
            
                        Case Wel_IKAN_2
                    
                            If LSBU_IKAN_Proc(Sendbuf, i, j, 2) Then
                                Exit Function
                            End If
            
                        Case Wel_IKAN_3
                    
                            If LSBU_IKAN_Proc(Sendbuf, i, j, 3) Then
                                Exit Function
                            End If
            
            
                    End Select
            
            
            
            
                                                'Åuà⁄ä«çÌèúèàóùÅvÇÃóvàˆ    2009.03.09
                Case Wel_IKAN_DEL
            
                    
                
                    If LSBU_IKAN_DEL_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                'Åuà⁄ä«ï\é¶èàóùÅvÇÃóvàˆ    2009.03.09
                Case Wel_IKAN_DSP
            
                    
                
                    If LSBU_IKAN_DSP_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                'ÅuíIî‘í«â¡èàóùÅvÇÃóvàˆ    2009.03.17
                Case Wel_TANA_INS
            
                    
                
                    If TANA_INS_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                'Åuèoâ◊çÌèúèàóùÅvÇÃóvàˆ    2009.03.17
                Case Wel_SYUKA_DEL
            
                    
                
                    If SYUKA_DEL_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            
                                                'ÅuçÀêîÅ^å˚êîèàóùÅvÇÃóvàˆ    2010.03.09
                Case Wel_SAI_SU
            
                    
                
                    If SAI_SU_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            
            
                                                '2010.12.13
                Case Wel_TANA_USE               'ÅuWEL íIégópèÛãµÅvÇÃóvàˆ
                                                
                                                
                                                
                    If TANA_USE_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                                                
                                                
                                                    
                                                
                                                '2011.03.05
                Case Wel_LABEL_PRINT            'ÅuWEL ◊ÕﬁŸî≠çsÅvÇÃóvàˆ
            
            
                    
                    
            
            
            
                    If LABEL_Print_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                                                '2011.08.05
                Case Wel_JAN_SET                'ÅuWEL ïiî‘(JAN)ìoò^ÅvÇÃóvàˆ
            
                    If JAN_SET_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            
            End Select
        
        Case ACT_KENPIN_DEN             'åüïiÅiëÂç„ÇoÇbå¸ÇØÅj   2006.12.07
        
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
'                Case Wel_Inspe_DEN, Wel_Inspe_DEN2              '2009.06.03
                Case Wel_Inspe_DEN                              '2009.06.03
        
        
        
                    If Inspe_Proc_DEN(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
        
                Case Wel_Inspe_E_BAG     '2010.01.21
                    
                    If Inspe_Proc_E_BAG(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
                Case Wel_KYOSEI_END
    
                    If KYOSEI_END_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
    
    
                Case Wel_LABEL_REPRINT  '2010.01.21
    
                    If LABEL_RePrint_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
                
                Case Wel_Inspe_LOGISTIC '2010.01.25
                    
                    If Inspe_Proc_LOGISTIC(Sendbuf, i, j) Then
                        Exit Function
                    End If
    
    
                Case Wel_SEK_PACKING    '2011.04.25
                    
                    If SEK_PACKING_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
    
    
    
                Case Wel_SEK_Inspe      '2011.05.09
            
                    If Inspe_Proc_SEK(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                Case Wel_SEK_SYUGO_PACKING  '2011.05.12
                    
                    If SEK_SYUGO_PACKING_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_SEK_KYOSEI_END     '2011.06.28
            
                    If SEK_KYOSEI_END_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            
            
'------------------------------------------------------------------ ëSêîåüïiëŒâû    2012.03.21
                Case Wel_Inspe_DEN_ALL                  'ÅuWEL ëÂç„åüïiÅvÇÃóvàˆ
                    If Inspe_Proc_DEN_ALL(Sendbuf, i, j) Then
                        Exit Function
                    End If
                Case Wel_Inspe_LOGISTIC_ALL             'ÅuWEL €ºﬁΩ√Ø∏ΩÅvÇÃóvàˆ
                    If Inspe_Proc_LOGISTIC_ALL(Sendbuf, i, j) Then
                        Exit Function
                    End If
                Case Wel_SEK_PACKING_ALL                'ÅuWEL êœêÖì@ï ç´ïÔèàóùÅvÇÃóvàˆ
                    If SEK_PACKING_ALL_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
'------------------------------------------------------------------ ëSêîåüïiëŒâû    2012.03.21
            
            
                Case Wel_Inspe_E_BAG_ALL                                            '2012.06.20
                    If Inspe_Proc_E_BAG_ALL(Sendbuf, i, j) Then                     '2012.06.20
                        Exit Function                                               '2012.06.20
                    End If                                                          '2012.06.20
            
            
            End Select
    
        Case ACT_SYUKA_HYO_OSAKA        'èoå…ï\èoå…ÅiëÂç„ÇoÇbå¸ÇØÅj   2007.03.16
    
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                Case Wel_SYUKO_HYO_OSAKA
        
                    If SYUKO_HYO_Dec_OSAKA_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
    
            End Select
    
    
    
    
        Case ACT_IN_KENPIN_OSAKA        'ì¸å…åüïiÅiëÂç„ÇoÇbå¸ÇØÅj   2007.06.07
    
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                Case Wel_IN_KENPIN_OSAKA
        
                    If NYUKO_KENPIN_OSAKA_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
    
                Case WEL_IN_TANA_S_OSAKA            'éëçﬁåüé˚ì¸å… 2012.03.01
    
                    If NYUKO_KENPIN_OSAKA_S_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
    
    
    
    
            End Select
    
        Case ACT_IN_TANA_OSAKA        'ì¸å…åüïiÅiëÂç„ÇoÇbå¸ÇØÅj   2007.06.07
    
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                Case Wel_IN_TANA_OSAKA
        
                    If NYUKO_TANA_OSAKA_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
    
            End Select
    
    
        Case ACT_FURIKAE                'éëçﬁêUë÷èàóù   2007.06.28
    
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                Case Wel_FURIKAE
        
                    If Furikae_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
        
        
                Case Wel_HIN_FURIKAE_PLUS   'ïiî‘êUë÷èàóù   2011.06.01
        
                    If Hin_Furikae_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
        
        
                Case Wel_HIN_FURIKA_S    'ïîçﬁÉZÉìÉ^Å[êUë÷èoå…
                    
                    If Hin_Furikae_S_Proc(Sendbuf, i, j) Then
                        Exit Function
                    End If
    
    
            End Select
    
    
        Case ACT_BINNO                  'ï÷áÇèàóù(à⁄ä«óp) 2009.03.11
    
            If LSBU_IKAN_BinNo_Proc(Sendbuf, i, j) Then
                Exit Function
            End If
    
    
        Case ACT_KENPIN_GAI             'äCäOå¸ÇØåüïi   2009.08.07
        
            If Inspe_Proc_GAI(Sendbuf, i, j) Then
                Exit Function
            End If
    
    
'        Case ACT_SAI_SU                 'çÀêîÅ^å˚êî   2010.01.21
'
'            If SAI_SU_Proc(Sendbuf, i, j) Then
'                Exit Function
'            End If
    
    
        
        Case ACT_SHOUHINKA              'è§ïiâª¡™Ø∏     2010.09.03
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
                
                Case Wel_SHOUHINKA_CHECK
                
                    If SHOUHINKA_CHECK_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            
                Case Wel_HINBAN_CHECK    'ïiî‘¡™Ø∏   2010.09.10
                
                    If HINBAN_CHECK_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                Case Wel_COMPO_CHECK    'ç\ê¨¡™Ø∏   2011.03.02
                
                    If COMPO_CHECK_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
                Case Wel_COMPO_OSAKA_CHECK  'ëÂç„ÇoÇbÅ@ïîçﬁæ›¿∞ç\ê¨¡™Ø∏   2012.03.16
                
                    If COMPO_OSAKA_CHECK_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
                Case Wel_KENPIN_OSAKA       'ëÂç„ÇoÇbÅ@åüïi   2012.03.16
                
                    If KENPIN_OSAKA_PROC(Sendbuf, i, j) Then
                        Exit Function
                    End If
            
            
            

            
            End Select


    End Select

    Sagyo_Main_Proc = False

End Function


Private Function Tanahyoji_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwíIî‘ï\é¶èàóùÅx
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

'2010.12.07
'Dim Hinban      As String * 13
Dim Hinban      As String * 20
'2010.12.07

Dim Tanaban     As String * 8
Dim ST_TANABAN  As String * 8


Dim FileNo      As Integer

Dim FullPath    As String

Dim SendFileRec As SendFileRec_Tag

Dim SUMI_QTY    As Long
Dim MI_QTY      As Long

Dim Tanahyoji() As Tanahyoji_tag
Dim Tana_Cnt    As Integer


Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1

Dim MENU_NO     As String * 2   '2008.08.08


    Tanahyoji_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & B1_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & B1_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            Case LCD_Hinban         'ïiî‘
                Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    'ïiñ⁄É}ÉXÉ^ì«Ç›çûÇ›ÅiïWèÄíIî‘ÇfÇdÇsÅj
'                Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                Select Case sts
                    Case BtNoErr
                        ST_TANABAN = (StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                    Case BtErrKeyNotFound
'                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
'
'                        Sendbuf = Text_Create_Proc()
'                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                        Tanahyoji_Proc = False
'                        Exit Function
                        'ñ¢ìoò^ÇÕèoâ◊ó\íËì«Ç›çûÇ›   2006.06.01
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                        Select Case sts
                            Case BtNoErr
                                Hinban = StrConv(Y_SYUREC.HIN_NO, vbUnicode)
                                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                                Select Case sts
                                    Case BtNoErr
                                        ST_TANABAN = (StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                            
                                    
                                    Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                                    
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Tanahyoji_Proc = False
                                        Exit Function
                                    
                                    Case Else
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, com, "ç›å…ÉfÅ[É^", 0)
                                        Exit Function
                            
                                End Select
                            
                            
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Tanahyoji_Proc = False
                                Exit Function
                            
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, com, "ç›å…ÉfÅ[É^", 0)
                                Exit Function
                        End Select
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                Erase Tanahyoji
                Tana_Cnt = -1
        
                If Len(Trim(ST_TANABAN)) = 0 Then
                                            'ïWèÄíIî‘ê›íËÇ»Çµ
                
                    Tana_Cnt = Tana_Cnt + 1
                    ReDim Tanahyoji(Tana_Cnt)
                    Tanahyoji(Tana_Cnt).Tanaban = ST_TANABAN
                
                    Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                    Tanahyoji(Tana_Cnt).MI_QTY = 0
                Else
                    If Zaiko_Syukei_Proc(SUMI_QTY, _
                                            MI_QTY, _
                                            RET_JGYOBU, _
                                            RET_NAIGAI, _
                                            Hinban, _
                                            ST_TANABAN) Then

            
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                    End If
                    Tana_Cnt = Tana_Cnt + 1
                    ReDim Tanahyoji(Tana_Cnt)
                    Tanahyoji(Tana_Cnt).Tanaban = ST_TANABAN
                    Tanahyoji(Tana_Cnt).SUMI_QTY = SUMI_QTY
                    Tanahyoji(Tana_Cnt).MI_QTY = MI_QTY
                    
                    
                    
                End If
                
                Call UniCode_Conv(K6_ZAIKO.JGYOBU, RET_JGYOBU)
                Call UniCode_Conv(K6_ZAIKO.NAIGAI, RET_NAIGAI)
                Call UniCode_Conv(K6_ZAIKO.HIN_GAI, Hinban)
                Call UniCode_Conv(K6_ZAIKO.NYUKA_DT, "")
                Call UniCode_Conv(K6_ZAIKO.SOKO_NO, "")
                Call UniCode_Conv(K6_ZAIKO.Retu, "")
                Call UniCode_Conv(K6_ZAIKO.Ren, "")
                Call UniCode_Conv(K6_ZAIKO.Dan, "")
                    
                com = BtOpGetGreater
        
                SUMI_QTY = 0
                MI_QTY = 0
    
    
                Do
                    sts = BTRV(com, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K6_ZAIKO, Len(K6_ZAIKO), 6)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrEOF
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, com, "ç›å…ÉfÅ[É^", 0)
                            Exit Function
                    End Select
                
                    If StrConv(ZAIKOREC.JGYOBU, vbUnicode) <> RET_JGYOBU Or _
                        StrConv(ZAIKOREC.NAIGAI, vbUnicode) <> RET_NAIGAI Or _
                        Trim(StrConv(ZAIKOREC.HIN_GAI, vbUnicode)) <> Trim(Hinban) Then
                        'éñã∆ïîÅ^çëì‡äOÅ^ïiî‘ÉuÉåÅ[ÉN
                        Exit Do
                    End If
                    
                    If (StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)) _
                        = ST_TANABAN Then
                        'ïWèÄíIî‘ÇÕëŒè€äO
                    Else
                        If Tana_Cnt = (-1) Then
                            Tana_Cnt = Tana_Cnt + 1
                            ReDim Tanahyoji(Tana_Cnt)
                            Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                            If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                Tanahyoji(Tana_Cnt).MI_QTY = 0
                            Else
                                Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                            End If
                        
                        Else
                            For j = 0 To UBound(Tanahyoji)
                                If Tanahyoji(j).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode) Then
                                    Exit For
                                End If
                            Next j
                        
                            If j <= UBound(Tanahyoji) Then
                            
                                If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                    Tanahyoji(j).SUMI_QTY = Tanahyoji(j).SUMI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                Else
                                    Tanahyoji(j).MI_QTY = Tanahyoji(j).MI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                End If
                            
                            
                            Else
                            
                                Tana_Cnt = Tana_Cnt + 1
                            
                                ReDim Preserve Tanahyoji(Tana_Cnt)
                                Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                                If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    Tanahyoji(Tana_Cnt).MI_QTY = 0
                                Else
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                    Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                End If
                            
                            End If
                        
                        End If
                    
                    End If
                    
                    com = BtOpGetNext
                    
                Loop
        
        
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME & Format(Tana_Cnt + 1, "#0") & "åè")
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
        
        
                If Tana_Cnt > -1 Then
                                'èWåvÉeÅ[ÉuÉãÇÊÇËÉfÅ[É^èoóÕ
                    For j = 0 To UBound(Tanahyoji)
                                
                        SendFileRec.Title = "1"
'                        Call UniCode_Conv(SendFileRec.LCD, Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
'                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
'                        SendFileRec.CRLF = vbCrLf
                        
                        If j = 0 Then
                            Call UniCode_Conv(SendFileRec.LCD, "*" & Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
                        Else
                            Call UniCode_Conv(SendFileRec.LCD, " " & Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
                        End If
                        SendFileRec.CRLF = vbCrLf
                                            
                        Put #FileNo, , SendFileRec
                                            
                                            
                        Call UniCode_Conv(SendFileRec.LCD, "  è§ÅF" & Format(Tanahyoji(j).SUMI_QTY, "#0") & "  ñ¢ÅF" & Format(Tanahyoji(j).MI_QTY, "#0"))
                        SendFileRec.CRLF = vbCrLf
                                            
                                            
                        
                        Put #FileNo, , SendFileRec
                            
                    Next j
                End If
        
        
                Close #FileNo
        
        
        End Select
    Next i
    
    
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                
    Else
                
        MENU_NO = ""
    End If
    If Trim(MENU_NO) = "" Then
    Else
    'çÏã∆€∏ﬁèoóÕ
        
        If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                            (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                            RET_JGYOBU, _
                                            RET_NAIGAI, _
                                            MENU_NO, _
                                            (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                            Hinban) Then
            Tanahyoji_Proc = SYS_ERR
            Exit Function
        End If
    End If
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    
    
    
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = B1_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = B1_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    Tanahyoji_Proc = False
    

End Function
Private Function Tanahyoji_Kaso_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwíIî‘ï\é¶(âºëzóDêÊ)èàóùÅx
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

'2010.12.07
'Dim Hinban      As String * 13
Dim Hinban      As String * 20
'2010.12.07


Dim Tanaban     As String * 8
Dim ST_TANABAN  As String * 8


Dim FileNo      As Integer

Dim FullPath    As String

Dim SendFileRec As SendFileRec_Tag

Dim SUMI_QTY    As Long
Dim MI_QTY      As Long

Dim Tanahyoji() As Tanahyoji_tag
Dim Tana_Cnt    As Integer


Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1


Dim MENU_NO     As String * 2   '2008.08.08


    Tanahyoji_Kaso_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & B9_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & B9_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            Case LCD_Hinban         'ïiî‘
                Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    'ïiñ⁄É}ÉXÉ^ì«Ç›çûÇ›ÅiïWèÄíIî‘ÇfÇdÇsÅj
'                Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                Select Case sts
                    Case BtNoErr
                        ST_TANABAN = (StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode))
                    Case BtErrKeyNotFound
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Tanahyoji_Kaso_Proc = False
                        Exit Function
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                Erase Tanahyoji
                Tana_Cnt = -1
        
                If Len(Trim(ST_TANABAN)) = 0 Then
                                            'ïWèÄíIî‘ê›íËÇ»Çµ
                
                    Tana_Cnt = Tana_Cnt + 1
                    ReDim Tanahyoji(Tana_Cnt)
                    Tanahyoji(Tana_Cnt).Tanaban = ST_TANABAN
                
                    Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                    Tanahyoji(Tana_Cnt).MI_QTY = 0
                Else
                    If Zaiko_Syukei_Proc(SUMI_QTY, _
                                            MI_QTY, _
                                            RET_JGYOBU, _
                                            RET_NAIGAI, _
                                            Hinban, _
                                            ST_TANABAN) Then

            
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                    End If
                    Tana_Cnt = Tana_Cnt + 1
                    ReDim Tanahyoji(Tana_Cnt)
                    Tanahyoji(Tana_Cnt).Tanaban = ST_TANABAN
                    Tanahyoji(Tana_Cnt).SUMI_QTY = SUMI_QTY
                    Tanahyoji(Tana_Cnt).MI_QTY = MI_QTY
                    
                    
                    
                End If
                
                Call UniCode_Conv(K6_ZAIKO.JGYOBU, RET_JGYOBU)
                Call UniCode_Conv(K6_ZAIKO.NAIGAI, RET_NAIGAI)
                Call UniCode_Conv(K6_ZAIKO.HIN_GAI, Hinban)
                Call UniCode_Conv(K6_ZAIKO.NYUKA_DT, "")
                Call UniCode_Conv(K6_ZAIKO.SOKO_NO, "")
                Call UniCode_Conv(K6_ZAIKO.Retu, "")
                Call UniCode_Conv(K6_ZAIKO.Ren, "")
                Call UniCode_Conv(K6_ZAIKO.Dan, "")
                    
                com = BtOpGetGreater
        
                SUMI_QTY = 0
                MI_QTY = 0
    
    
                Do
                    sts = BTRV(com, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K6_ZAIKO, Len(K6_ZAIKO), 6)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrEOF
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, com, "ç›å…ÉfÅ[É^", 0)
                            Exit Function
                    End Select
                
                    If StrConv(ZAIKOREC.JGYOBU, vbUnicode) <> RET_JGYOBU Or _
                        StrConv(ZAIKOREC.NAIGAI, vbUnicode) <> RET_NAIGAI Or _
                        Trim(StrConv(ZAIKOREC.HIN_GAI, vbUnicode)) <> Trim(Hinban) Then
                        'éñã∆ïîÅ^çëì‡äOÅ^ïiî‘ÉuÉåÅ[ÉN
                        Exit Do
                    End If
                    
                    If (StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)) _
                        = ST_TANABAN Then
                        'ïWèÄíIî‘ÇÕëŒè€äO
                    Else
                        
                        'âºëzëqå…ÇóDêÊÇ∑ÇÈ
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, StrConv(ZAIKOREC.SOKO_NO, vbUnicode))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(SOKOREC.SOKO_BUN, BUN_JITU)
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…œΩ¿", 0)
                                Exit Function
                        End Select
                        
                        
                        
                        If StrConv(SOKOREC.SOKO_BUN, vbUnicode) = BUN_KASO Then
                        
                            If Tana_Cnt = (-1) Then
                                Tana_Cnt = Tana_Cnt + 1
                                ReDim Tanahyoji(Tana_Cnt)
                                Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                                If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    Tanahyoji(Tana_Cnt).MI_QTY = 0
                                Else
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                    Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                End If
                            
                            Else
                                For j = 0 To UBound(Tanahyoji)
                                    If Tanahyoji(j).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode) Then
                                        Exit For
                                    End If
                                Next j
                            
                                If j <= UBound(Tanahyoji) Then
                                
                                    If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                        Tanahyoji(j).SUMI_QTY = Tanahyoji(j).SUMI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    Else
                                        Tanahyoji(j).MI_QTY = Tanahyoji(j).MI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    End If
                                
                                
                                Else
                                
                                    Tana_Cnt = Tana_Cnt + 1
                                
                                    ReDim Preserve Tanahyoji(Tana_Cnt)
                                    Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                                    If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                        Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                        Tanahyoji(Tana_Cnt).MI_QTY = 0
                                    Else
                                        Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                        Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    End If
                                
                                End If
                            
                            End If
                        
                        End If
                    End If
                    
                    com = BtOpGetNext
                    
                Loop
        
        
                Call UniCode_Conv(K6_ZAIKO.JGYOBU, RET_JGYOBU)
                Call UniCode_Conv(K6_ZAIKO.NAIGAI, RET_NAIGAI)
                Call UniCode_Conv(K6_ZAIKO.HIN_GAI, Hinban)
                Call UniCode_Conv(K6_ZAIKO.NYUKA_DT, "")
                Call UniCode_Conv(K6_ZAIKO.SOKO_NO, "")
                Call UniCode_Conv(K6_ZAIKO.Retu, "")
                Call UniCode_Conv(K6_ZAIKO.Ren, "")
                Call UniCode_Conv(K6_ZAIKO.Dan, "")
                    
                com = BtOpGetGreater
        
                SUMI_QTY = 0
                MI_QTY = 0
    
    
                Do
                    sts = BTRV(com, ZAIKO_POS, ZAIKOREC, Len(ZAIKOREC), K6_ZAIKO, Len(K6_ZAIKO), 6)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrEOF
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, com, "ç›å…ÉfÅ[É^", 0)
                            Exit Function
                    End Select
                
                    If StrConv(ZAIKOREC.JGYOBU, vbUnicode) <> RET_JGYOBU Or _
                        StrConv(ZAIKOREC.NAIGAI, vbUnicode) <> RET_NAIGAI Or _
                        Trim(StrConv(ZAIKOREC.HIN_GAI, vbUnicode)) <> Trim(Hinban) Then
                        'éñã∆ïîÅ^çëì‡äOÅ^ïiî‘ÉuÉåÅ[ÉN
                        Exit Do
                    End If
                    
                    If (StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)) _
                        = ST_TANABAN Then
                        'ïWèÄíIî‘ÇÕëŒè€äO
                    Else
                        
                        'âºëzëqå…ÇóDêÊÇ∑ÇÈ
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, StrConv(ZAIKOREC.SOKO_NO, vbUnicode))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(SOKOREC.SOKO_BUN, BUN_KASO)
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…œΩ¿", 0)
                                Exit Function
                        End Select
                        
                        
                        
                        If StrConv(SOKOREC.SOKO_BUN, vbUnicode) = BUN_JITU Then
                        
                            If Tana_Cnt = (-1) Then
                                Tana_Cnt = Tana_Cnt + 1
                                ReDim Tanahyoji(Tana_Cnt)
                                Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                                If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    Tanahyoji(Tana_Cnt).MI_QTY = 0
                                Else
                                    Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                    Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                End If
                            
                            Else
                                For j = 0 To UBound(Tanahyoji)
                                    If Tanahyoji(j).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode) Then
                                        Exit For
                                    End If
                                Next j
                            
                                If j <= UBound(Tanahyoji) Then
                                
                                    If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                        Tanahyoji(j).SUMI_QTY = Tanahyoji(j).SUMI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    Else
                                        Tanahyoji(j).MI_QTY = Tanahyoji(j).MI_QTY + CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    End If
                                
                                
                                Else
                                
                                    Tana_Cnt = Tana_Cnt + 1
                                
                                    ReDim Preserve Tanahyoji(Tana_Cnt)
                                    Tanahyoji(Tana_Cnt).Tanaban = StrConv(ZAIKOREC.SOKO_NO, vbUnicode) & StrConv(ZAIKOREC.Retu, vbUnicode) & StrConv(ZAIKOREC.Ren, vbUnicode) & StrConv(ZAIKOREC.Dan, vbUnicode)
                                    If StrConv(ZAIKOREC.GOODS_ON, vbUnicode) = "0" Then
                                        Tanahyoji(Tana_Cnt).SUMI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                        Tanahyoji(Tana_Cnt).MI_QTY = 0
                                    Else
                                        Tanahyoji(Tana_Cnt).SUMI_QTY = 0
                                        Tanahyoji(Tana_Cnt).MI_QTY = CLng(StrConv(ZAIKOREC.YUKO_Z_QTY, vbUnicode))
                                    End If
                                
                                End If
                            
                            End If
                        
                        End If
                    End If
                    
                    com = BtOpGetNext
                    
                Loop
        
        
        
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME & Format(Tana_Cnt + 1, "#0") & "åè")
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
        
        
                If Tana_Cnt > -1 Then
                                'èWåvÉeÅ[ÉuÉãÇÊÇËÉfÅ[É^èoóÕ
                    For j = 0 To UBound(Tanahyoji)
                                
                        SendFileRec.Title = "1"
'                        Call UniCode_Conv(SendFileRec.LCD, Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
'                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
'                        SendFileRec.CRLF = vbCrLf
                        
                        If j = 0 Then
                            Call UniCode_Conv(SendFileRec.LCD, "*" & Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
                        Else
                            Call UniCode_Conv(SendFileRec.LCD, " " & Left(Tanahyoji(j).Tanaban, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 3, 2) & "-" & Mid(Tanahyoji(j).Tanaban, 5, 2) & "-" & Right(Tanahyoji(j).Tanaban, 2) & ":" _
                                            & Format(Tanahyoji(j).SUMI_QTY + Tanahyoji(j).MI_QTY, "#0"))
                        End If
                        SendFileRec.CRLF = vbCrLf
                                            
                        Put #FileNo, , SendFileRec
                                            
                                            
                        Call UniCode_Conv(SendFileRec.LCD, "  è§ÅF" & Format(Tanahyoji(j).SUMI_QTY, "#0") & "  ñ¢ÅF" & Format(Tanahyoji(j).MI_QTY, "#0"))
                        SendFileRec.CRLF = vbCrLf
                                            
                                            
                        
                        Put #FileNo, , SendFileRec
                            
                    Next j
                End If
        
        
                Close #FileNo
        
        
        End Select
    Next i
    
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                
    Else
                
        MENU_NO = ""
    End If
    If Trim(MENU_NO) = "" Then
    Else
    'çÏã∆€∏ﬁèoóÕ
        
        If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                            (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                            RET_JGYOBU, _
                                            RET_NAIGAI, _
                                            MENU_NO, _
                                            (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                            Hinban) Then
            Tanahyoji_Kaso_Proc = SYS_ERR
            Exit Function
        End If
    End If
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = B9_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = B9_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    Tanahyoji_Kaso_Proc = False
    

End Function
Private Function AKI_LOC_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwãÛÇ´ÉçÉPÅ[ÉVÉáÉìåüçıÅx
'       2010.12.13
'
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer
Dim k           As Integer


Dim Tanaban     As String * 8


Dim FileNo      As Integer

Dim FullPath    As String

Dim SendFileRec As SendFileRec_Tag

Dim AKI_Tanahyoji() _
                As AKI_Tanahyoji_tag

Dim Tana_Cnt    As Integer
Dim Tana_Use    As String * 3

Dim wkTanaban   As String
Dim wkTana_Use  As String * 3


Dim MENU_NO     As String * 2   '2008.08.08


    AKI_LOC_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & BG_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & BG_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            Case LCD_Tanaban        'íIî‘
                Tanaban = Mid(ID_KANRI_TBL(ING_No).Recv_text(i), 2, 8)
                
                
                Call UniCode_Conv(K0_TANA.SOKO_NO, Mid(Tanaban, 1, 2))
                Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                Call UniCode_Conv(K0_TANA.Ren, "")
                Call UniCode_Conv(K0_TANA.Dan, "")
                
                
                sts = BTRV(BtOpGetGreater, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                Select Case sts
                    Case BtNoErr
                                            
                        If Mid(Tanaban, 1, 2) <> StrConv(TANAREC.SOKO_NO, vbUnicode) Or _
                            Mid(Tanaban, 3, 2) <> StrConv(TANAREC.Retu, vbUnicode) Then
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 4), "íIî‘ÉGÉâÅ[", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            AKI_LOC_Proc = False
                            Exit Function
                        End If
                    
                    
                    Case BtErrEOF
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 4), "íIî‘ÉGÉâÅ[", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        AKI_LOC_Proc = False
                        Exit Function
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                Erase AKI_Tanahyoji
                Tana_Cnt = -1
                
                
                
                Call UniCode_Conv(K0_TANA.SOKO_NO, Mid(Tanaban, 1, 2))
                Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                Call UniCode_Conv(K0_TANA.Ren, "")
                Call UniCode_Conv(K0_TANA.Dan, "")
                
                
                
                Do
                    
                    DoEvents
                    
                    sts = BTRV(BtOpGetGreater, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                    Select Case sts
                        Case BtNoErr
                                                
                            If Mid(Tanaban, 1, 2) <> StrConv(TANAREC.SOKO_NO, vbUnicode) Or _
                                Mid(Tanaban, 3, 2) <> StrConv(TANAREC.Retu, vbUnicode) Then
                            
                                Exit Do
                            End If
                        Case BtErrEOF
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                            Exit Function
                    End Select
                
                
                    If Not IsNumeric(StrConv(TANAREC.Tana_Use, vbUnicode)) Then
                        If Trim(StrConv(TANAREC.Tana_Use, vbUnicode)) = "." Then
                            Tana_Use = Trim(StrConv(TANAREC.Tana_Use, vbUnicode))
                        Else
                            Tana_Use = "100"
                        End If
                    Else
                        Tana_Use = StrConv(TANAREC.Tana_Use, vbUnicode)
                    End If
                
                    If Val(Tana_Use) < 100 Then
                    
                        Tana_Cnt = Tana_Cnt + 1
                        ReDim Preserve AKI_Tanahyoji(Tana_Cnt)
                        
                        AKI_Tanahyoji(Tana_Cnt).Tanaban = StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                        AKI_Tanahyoji(Tana_Cnt).Tana_Use = Tana_Use
                    
                    End If
                
                Loop
        
                If Tana_Cnt < 1 Then
                Else
                    For j = 0 To UBound(AKI_Tanahyoji) - 1
                        
                        For k = j To UBound(AKI_Tanahyoji)
                                                
                            If AKI_Tanahyoji(j).Tana_Use > AKI_Tanahyoji(k).Tana_Use Then
                                wkTanaban = AKI_Tanahyoji(k).Tanaban
                                wkTana_Use = AKI_Tanahyoji(k).Tana_Use
                                    
                                AKI_Tanahyoji(k).Tanaban = AKI_Tanahyoji(j).Tanaban
                                AKI_Tanahyoji(k).Tana_Use = AKI_Tanahyoji(j).Tana_Use
                                    
                                AKI_Tanahyoji(j).Tanaban = wkTanaban
                                AKI_Tanahyoji(j).Tana_Use = wkTana_Use
                                    
                            
                            
                            End If
                        Next k
                    
                    Next j
                End If
        
        
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
                
                Call UniCode_Conv(SendFileRec.LCD, "íIî‘:" & Left(Tanaban, 4))
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
        
                        
        
        
        
                If Tana_Cnt > -1 Then
                                'èWåvÉeÅ[ÉuÉãÇÊÇËÉfÅ[É^èoóÕ
                    For j = 0 To UBound(AKI_Tanahyoji)
                                
                        SendFileRec.Title = "1"
                        
                        
                        If Trim(AKI_Tanahyoji(j).Tana_Use) = "." Then
                            Call UniCode_Conv(SendFileRec.LCD, Left(Tanaban, 4) & AKI_Tanahyoji(j).Tanaban & " " & StrConv(" .%", vbWide))
                        Else
                            Call UniCode_Conv(SendFileRec.LCD, Left(Tanaban, 4) & AKI_Tanahyoji(j).Tanaban & " " & StrConv(Space(2 - Len(Format(AKI_Tanahyoji(j).Tana_Use, "0"))), vbWide) & StrConv(Format(AKI_Tanahyoji(j).Tana_Use, "0") & "%", vbWide))
                        End If
                                            
                        SendFileRec.CRLF = vbCrLf
                                            
                        Put #FileNo, , SendFileRec
                                            
                            
                    Next j
                End If
        
        
                Close #FileNo
        
        
        End Select
    Next i
    
    
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                
    Else
                
        MENU_NO = ""
    End If
    If Trim(MENU_NO) = "" Then
    Else
    'çÏã∆€∏ﬁèoóÕ
        
        If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                            (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                            ID_KANRI_TBL(ING_No).JGYOBU, _
                                            ID_KANRI_TBL(ING_No).NAIGAI, _
                                            MENU_NO, _
                                            (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                            , , , Tanaban) Then
            AKI_LOC_Proc = SYS_ERR
            Exit Function
        End If
    End If
    'çÏã∆€∏ﬁèoóÕ    2008.08.08
    
    
    
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = BG_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = BG_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    AKI_LOC_Proc = False
    

End Function





Private Function SAI_SU_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwì¸ÇËêîÅ^å˚êîèàóùÅx
'
'-------------------------------------------------------
Dim sts         As Integer
Dim i           As Integer
Dim Hinban      As String
Dim SAI_SU      As String
Dim KUCHI_SU    As String

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2   '2008.08.08

Dim wkNum1      As Double
Dim wkNum2      As Double

Dim wkKUTI_SU   As String


    SAI_SU_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                SAI_SU_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                End Select
            Next i
            '   -------------------------------- ëóêMÉeÉLÉXÉgçÏê¨
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
            
            ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
            ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
            
            ID_KANRI_TBL(ING_No).Hinban = Hinban            'ïiî‘ÇÉZÅ[Éu
            
            
            
            If IsNumeric(StrConv(ITEMREC.SAI_SU, vbUnicode)) Then
                ID_KANRI_TBL(ING_No).SAI_SU = StrConv(ITEMREC.SAI_SU, vbUnicode)    'ëóêMÇ∑ÇÈçÀêî
            Else
                ID_KANRI_TBL(ING_No).SAI_SU = "00.0"
            End If
            
            If IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                ID_KANRI_TBL(ING_No).KUTI_SU = ToRoundDown(CCur(StrConv(ITEMREC.KUTI_SU, vbUnicode)), 0) 'ëóêMÇ∑ÇÈå˚
            Else
                ID_KANRI_TBL(ING_No).KUTI_SU = "0"
            End If
            
            
            If Trim(StrConv(ITEMREC.KONPOU_F, vbUnicode)) <> "1" Then
                ID_KANRI_TBL(ING_No).KUTI_SU = "0"
            End If
                        
            
            
            
            
            
            
            If IsNumeric(StrConv(ITEMREC.D_SIZE_W, vbUnicode)) Then
                ID_KANRI_TBL(ING_No).SIZE_W = StrConv(ITEMREC.D_SIZE_W, vbUnicode)    'ëóêMÇ∑ÇÈ(W)
            Else
                ID_KANRI_TBL(ING_No).SIZE_W = "00000000"
            End If
            
            If IsNumeric(StrConv(ITEMREC.D_SIZE_D, vbUnicode)) Then
                ID_KANRI_TBL(ING_No).SIZE_D = StrConv(ITEMREC.D_SIZE_D, vbUnicode)    'ëóêMÇ∑ÇÈ(D)
            Else
                ID_KANRI_TBL(ING_No).SIZE_D = "00000000"
            End If
            
            If IsNumeric(StrConv(ITEMREC.D_SIZE_H, vbUnicode)) Then
                ID_KANRI_TBL(ING_No).SIZE_H = StrConv(ITEMREC.D_SIZE_H, vbUnicode)    'ëóêMÇ∑ÇÈ(H)
            Else
                ID_KANRI_TBL(ING_No).SIZE_H = "00000000"
            End If
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
            'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
            '-----------------------------------------------ÇPçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(0).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            
            
'            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, LCD_SIZE_W_S & Space(M_Keta - (Len(LCD_SIZE_W_S) * 2) - 8 + (8 - Len(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")))) & Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, LCD_SIZE_W_S & Space(M_Keta - (Len(LCD_SIZE_W_S) * 2) - 8 + (8 - Len(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")))) & Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))
            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, LCD_SIZE_W_S)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, LCD_SIZE_W_S)
                                                            
                                                            'êîílèâä˙ï\é¶
'            Send_Text.Box_Type(0).INIT = Space(10 - Len(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))) & Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = Space(10 - Len(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))) & Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")
            Send_Text.Box_Type(0).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))
                                                            
                                                            
                                                            
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(0).Start_Pos = Format(10 - Len(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0")), "00")
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = Format(10 - Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"), "00")
'            Send_Text.Box_Type(0).Start_Pos = 10 + Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "#0"))) - 2
            Send_Text.Box_Type(0).Start_Pos = "07"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = "07"
                                                            
                                                            
                                                            
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(0).Max_Size = "03"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "03"
                                                                                
                                                                                
                                                                                
                                                                                
            Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            '-----------------------------------------------ÇQçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(1).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            
            
            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_SIZE_D_S)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_SIZE_D_S)
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
                                                            
                                                            
            Send_Text.Box_Type(1).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0"))
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0"))
                                                            
                                                            
                                                            
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(1).Start_Pos = 10 + Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0"))) - 2
            Send_Text.Box_Type(1).Start_Pos = "07"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "07"
                                                            
                                                            
                                                            
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(1).Max_Size = "03"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "03"
                                                                                
                                                                                
                                                                                
                                                                                
            Send_Text.Box_Type(1).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
            '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            
            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_SIZE_H_S)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_SIZE_H_S)
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(2).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_H), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_H), "#0"))
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_H), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_H), "#0"))
                                                            
                                                            
                                                            
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(2).Start_Pos = 10 + Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "#0"))) - 2
            Send_Text.Box_Type(2).Start_Pos = "07"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "07"
                                                            
                                                            
                                                            
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(2).Max_Size = "03"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "03"
                                                                                
                                                                                
                                                                                
                                                                                
            Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            
            
            
            '-----------------------------------------------ÇSçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(3).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            
            
            
            wkNum1 = Val(ID_KANRI_TBL(ING_No).SIZE_W) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_D) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_H) / 1000
            wkNum1 = ToHalfAdjust(CCur(Val(ID_KANRI_TBL(ING_No).SIZE_W) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_D) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_H) / 1000), 4)
            
            
            
            
            If IsNumeric(StrConv(ITEMREC.SAI_SU, vbUnicode)) Then
                wkNum2 = CCur(StrConv(ITEMREC.SAI_SU, vbUnicode))
            Else
                wkNum2 = ToHalfAdjust(wkNum1 / 0.028, 1)
            End If
            
            ID_KANRI_TBL(ING_No).SAI_SU = Format(wkNum2, "00.0")
            
            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SAI_SU_S1 & Format(wkNum2, "0.0") & "(" & Format(wkNum1, "0.000") & ")")
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SAI_SU_S1 & Format(wkNum2, "0.0") & "(" & Format(wkNum1, "0.00") & ")")
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(3).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                            
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(3).Start_Pos = ""            'êîílÇÕÇTåÖå≈íË
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(3).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            
            
            
            
            
            
            
            '-----------------------------------------------ÇTçsñ⁄
                                                                     
'å˚êîÇS

                                                                     
                                                                     'BOXëÆê´
            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            
            
'            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_KUTI_SU_S1 & Space(M_Keta - (Len(LCD_KUTI_SU_S) * 2) - 4 + (4 - Len(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0")))) & Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0"))
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_KUTI_SU_S1 & Space(M_Keta - (Len(LCD_KUTI_SU_S) * 2) - 4 + (4 - Len(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0")))) & Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0"))
                                                            
            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_KUTI_SU_S1)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_KUTI_SU_S1)
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
                                                            
                                                            
            Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0"))
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0")))) & Trim(Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "#0"))
                                                            
                                                            
                                                            
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(4).Start_Pos = "14"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "14"
                                                            
                                                            
                                                            
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(4).Max_Size = "02"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "02"
                                                                                
                                                                                
                                                                                
                                                                                
            Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
        
            Sendbuf = Text_Create_Proc()
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiè§ïiÅ^ñ¢è§ïiêîó Åj
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
            
            
                    Case LCD_SIZE_W_S          'W
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "ÉTÉCÉY(W)ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SAI_SU_Proc = False
                            Exit Function
                        End If
                
                        ID_KANRI_TBL(ING_No).SIZE_W = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
            
                    Case LCD_SIZE_D_S          'D
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "ÉTÉCÉY(D)ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SAI_SU_Proc = False
                            Exit Function
                        End If
                
                        ID_KANRI_TBL(ING_No).SIZE_D = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
            
            
                    Case LCD_SIZE_H_S          'H
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "ÉTÉCÉY(H)ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SAI_SU_Proc = False
                            Exit Function
                        End If
                
                        ID_KANRI_TBL(ING_No).SIZE_H = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
            
            
                    Case LCD_KUTI_SU_S1         'å˚êî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êî", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SAI_SU_Proc = False
                            Exit Function
                        End If
                
                        If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) < 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êî", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SAI_SU_Proc = False
                            Exit Function
                        End If
                
                
                        ID_KANRI_TBL(ING_No).KUTI_SU = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
            
            
        
                End Select
            Next i
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                        'ïiñ⁄É}ÉXÉ^ì«çûÇ›
            Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
            Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
            Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).Hinban)
            Do
                sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ëºÇ≈égópíÜ", "", "")

                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                        SAI_SU_Proc = False
                        GoTo Abort_Tran
                    Case BtErrKeyNotFound
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ïiî‘ñ¢ìoò^", "", "")

                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                        SAI_SU_Proc = False
                        GoTo Abort_Tran
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^", 0)
                        SAI_SU_Proc = SYS_ERR
                        GoTo Abort_Tran
                End Select

            Loop
                                        'W
            Call UniCode_Conv(ITEMREC.D_SIZE_W, Format(Val(ID_KANRI_TBL(ING_No).SIZE_W), "00000000"))
                                        'D
            Call UniCode_Conv(ITEMREC.D_SIZE_D, Format(Val(ID_KANRI_TBL(ING_No).SIZE_D), "00000000"))
                                        'D
            Call UniCode_Conv(ITEMREC.D_SIZE_H, Format(Val(ID_KANRI_TBL(ING_No).SIZE_H), "00000000"))
                                        'çÀêî
            
            wkNum1 = Val(ID_KANRI_TBL(ING_No).SIZE_W) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_D) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_H) / 1000
            wkNum1 = ToHalfAdjust(CCur(Val(ID_KANRI_TBL(ING_No).SIZE_W) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_D) / 1000 * Val(ID_KANRI_TBL(ING_No).SIZE_H) / 1000), 4)
            wkNum2 = ToHalfAdjust(wkNum1 / 0.028, 1)
            
            
            
            Call UniCode_Conv(ITEMREC.SAI_SU, Format(wkNum2, "000.00"))
                                        'å˚êî
            
            
            
            If Val(ID_KANRI_TBL(ING_No).KUTI_SU) = 0 Then
                Call UniCode_Conv(ITEMREC.KONPOU_F, "0")
            Else
                Call UniCode_Conv(ITEMREC.KONPOU_F, "1")
                Call UniCode_Conv(ITEMREC.KUTI_SU, Format(Val(ID_KANRI_TBL(ING_No).KUTI_SU), "00.0"))
            End If


        
            Call UniCode_Conv(ITEMREC.UPD_TANTO, App.EXEName)                                   'çXêVíSìñé“∫∞ƒﬁ
                                                                                                'çXêVì˙éû
            Call UniCode_Conv(ITEMREC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))



'                                        'ïiñ⁄É}ÉXÉ^èëÇ´çûÇ›
            Do
                sts = BTRV(BtOpUpdate, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE

                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ëºÇ≈égópíÜ", "", "")

                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                        SAI_SU_Proc = False
                        GoTo Abort_Tran

                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpUpdate, "ïiñ⁄É}ÉXÉ^", 0)
                        SAI_SU_Proc = SYS_ERR
                        GoTo Abort_Tran
                End Select
            Loop
        
        
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        'éüÇÃçÏã∆óvãÅ
            
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    SAI_SU_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If
    

End Function






Private Function Hin_Shogo_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwïiî‘ï ç›å…è∆çáèàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long


Dim i               As Integer

Dim Tanaban         As String * 8

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MEMO            As String

Dim MENU_NO         As String

    Hin_Shogo_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Tanaban        'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(Tanaban) = Loc_OK_Para Then     'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Hin_Shogo_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ ç¨ç⁄É`ÉFÉbÉN
'                            If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
'                                If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
'                                    StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
'                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
'                                    SendBuf = Text_Create_Proc()
'                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                    Hin_Shogo_Proc = False
'                                    Exit Function
'                                End If
'                            End If
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    Hin_Shogo_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
'                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
'
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(To_Tanaban, 2) & "-" & Mid(To_Tanaban, 3, 2) & "-" & Mid(To_Tanaban, 5, 2) & "-" & Right(To_Tanaban, 2), "íIégópïsâ¬", "", "")
'
'                                SendBuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                                Ido_In_Proc = False
'                                Exit Function
'                            End If
            
                        End If
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                                If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            Hin_Shogo_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Shogo_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                End Select
            Next i
            '   -------------------------------- ç›å…êîèWåv
            If Zaiko_Syukei_Proc(SUMI_QTY, _
                                    MI_QTY, _
                                    RET_JGYOBU, _
                                    RET_NAIGAI, Hinban) Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            '   -------------------------------- ëóêMÉeÉLÉXÉgçÏê¨
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
            ID_KANRI_TBL(ING_No).Tanaban = Tanaban          'íIî‘ÇÉZÅ[Éu
            
            
            ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
            ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
            
            
            ID_KANRI_TBL(ING_No).Hinban = Hinban            'ïiî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
            ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
                                                        
            'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
            '-----------------------------------------------ÇPçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(0).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(0).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(0).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(0).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            '-----------------------------------------------ÇQçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(1).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                            Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))

            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                            Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(1).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(1).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(1).Max_Size = "08"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "08"
                                                                                
            Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
            '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(2).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(2).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(2).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(2).Max_Size = "13"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
            Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            '-----------------------------------------------ÇSçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SUMI_Suryo & Space(M_Keta - (Len(LCD_SUMI_Suryo) * 2) - 5 + (5 - Len(Format(SUMI_QTY, "#0")))) & Format(SUMI_QTY, "#0"))
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SUMI_Suryo & Space(M_Keta - (Len(LCD_SUMI_Suryo) * 2) - 5 + (5 - Len(Format(SUMI_QTY, "#0")))) & Format(SUMI_QTY, "#0"))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SUMI_QTY, "#0"))) & Format(SUMI_QTY, "#0")
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SUMI_QTY, "#0"))) & Format(SUMI_QTY, "#0")
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(3).Max_Size = "05"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                
            Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            '-----------------------------------------------ÇTçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(MI_QTY, "#0")))) & Format(MI_QTY, "#0"))
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(MI_QTY, "#0")))) & Format(MI_QTY, "#0"))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(MI_QTY, "#0"))) & Format(MI_QTY, "#0")
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(MI_QTY, "#0"))) & Format(MI_QTY, "#0")
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(4).Max_Size = "05"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                                                
            Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
        
            Sendbuf = Text_Create_Proc()
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiè§ïiÅ^ñ¢è§ïiêîó Åj
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
            
            
                    Case LCD_Suryo          'êîó ÅiÇ±Ç±ÇÕñ≥Ç¢Åj
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Shogo_Proc = False
                            Exit Function
                        End If
                
                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
            
            
                    Case LCD_SUMI_Suryo, LCD_MI_Suryo    'êîó Åiè§ïiâªçœÇ›êîó Å^ñ¢è§ïiêîó Åj
                
                       If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Shogo_Proc = False
                            Exit Function
                        End If
                
                
                        If Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size))) = LCD_SUMI_Suryo Then
                            SUMI_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            
                        Else
                            MI_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        
                        End If
        
                End Select
            Next i
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                        'ïiñ⁄É}ÉXÉ^ì«çûÇ›
            Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).S_JGYOBU)
            Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).S_NAIGAI)
            Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).Hinban)
            Do
                sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ëºÇ≈égópíÜ", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                        Hin_Shogo_Proc = False
                        GoTo Abort_Tran
                    Case BtErrKeyNotFound
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ïiî‘ñ¢ìoò^", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                        Hin_Shogo_Proc = False
                        GoTo Abort_Tran
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄É}ÉXÉ^", 0)
                        Hin_Shogo_Proc = SYS_ERR
                        GoTo Abort_Tran
                End Select
        
            Loop
                                        'ç≈èIè∆çáì˙ït
            Call UniCode_Conv(ITEMREC.LAST_CHK_DT, Format(Date, "yyyymmdd"))
                                        'ç≈èIè∆çáç›å…êî
            Call UniCode_Conv(ITEMREC.LAST_CHK_QTY, Format(SUMI_QTY + MI_QTY, "00000000"))
                                        'ïiñ⁄É}ÉXÉ^èëÇ´çûÇ›
            Do
                sts = BTRV(BtOpUpdate, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
            
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "ëºÇ≈égópíÜ", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                        Hin_Shogo_Proc = False
                        GoTo Abort_Tran
            
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpUpdate, "ïiñ⁄É}ÉXÉ^", 0)
                        Hin_Shogo_Proc = SYS_ERR
                        GoTo Abort_Tran
                End Select
            Loop
        
            If (SUMI_QTY + MI_QTY) = (ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY) Then
                MEMO = B2_MEMO & StrConv(Format((SUMI_QTY + MI_QTY), "#0"), vbWide) & "[OK]"
            Else
                MEMO = B2_MEMO & StrConv(Format((ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY), "#0"), vbWide) & "[" & StrConv(Format(SUMI_QTY + MI_QTY, "#0"), vbWide) & "]"
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
            Else
                MENU_NO = ""
            End If
                                
                                
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                        ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                        ID_KANRI_TBL(ING_No).Hinban, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        MEMO, , , , , MENU_NO)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Hin_Shogo_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        
    
    
                
    
    
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        'éüÇÃçÏã∆óvãÅ
            
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    Hin_Shogo_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function
Private Function MTS_Dec_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwå¸ÇØêÊêÈåæÇ≈ÇÃèoâ◊èàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8

'2010.12.07
Dim Hinban          As String * 13
'Dim Hinban          As String * 20
'2010.12.07

Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long

Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

    MTS_Dec_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Åj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Tanaban        'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    MTS_Dec_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    MTS_Dec_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                MTS_Dec_Proc = False
                                Exit Function
                            End If
                        End If
                            
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                                If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            MTS_Dec_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                MTS_Dec_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                End Select
            Next i
            '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
            ID_NO = ""
            sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                    Hinban, _
                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                    ID_KANRI_TBL(ING_No).SS_CODE, _
                                    ID_KANRI_TBL(ING_No).CYU_KBN, _
                                    Y_SYU_CNT, _
                                    ID_NO, _
                                    SYUKA_QTY, _
                                    DEN_NO, _
                                    KAN_KBN)
            Select Case sts
                Case False          'ê≥èÌ
                    If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "èoâ◊ó\íËñ≥Çµ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        MTS_Dec_Proc = False
                        Exit Function
                    End If
                
                Case True
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "èoâ◊ó\íËégópíÜ", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    MTS_Dec_Proc = False
                    Exit Function
            End Select
            '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
            sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, Tanaban, ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, SUMI_QTY, MI_QTY)
            Select Case sts
                Case False
                Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                    Exit Function
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                Case SYS_CANCEL
                    Call Err_Send_Proc("ç›å…égópíÜ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    MTS_Dec_Proc = False
                    Exit Function
            End Select
                    
            If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                MTS_Dec_Proc = False
                Exit Function
            End If
        
                
        
        
            ID_KANRI_TBL(ING_No).Tanaban = Tanaban          'íIî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Hinban = Hinban            'ïiî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Y_SYU_CNT = Y_SYU_CNT      'äYìñì`ï[ñáêî
            ID_KANRI_TBL(ING_No).ID_NO = ID_NO              'ì`ï[áÇ
            ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO            'ì`ï[áÇ
            ID_KANRI_TBL(ING_No).YUKO_SUMI_QTY = SUMI_QTY   'égópâ¬î\Ç»è§ïiâªçœÇ›ç›å…
            ID_KANRI_TBL(ING_No).YUKO_MI_QTY = MI_QTY       'égópâ¬î\Ç»ñ¢è§ïiç›å…
        
        
            Select Case Y_SYU_CNT
                Case 1              'ëŒè€ì`ï[Ç™ÇPñá
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                    ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                    'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                    Send_Text.sts = Sts_OK                                      'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                    Send_Text.Display_Flg = Display_DEF                         'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                    Send_Text.End_Menu = Menu_Only                              'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                    Send_Text.Menu_Suu = "05"                                   'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                    Send_Text.fileName = ""                                     'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
                    Send_Text.Buzzer = Buzzer_DEF                               'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                
                    '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                    Send_Text.Box_Type(0).MENU = ""                             'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                                                Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                                                Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "08"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "08"
                                                                                
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "13"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                            
                    If SYUKA_QTY > (SUMI_QTY + MI_QTY) Then
                        SYUKA_QTY = SUMI_QTY + MI_QTY           'ç›å…êîÇ™è≠Ç»Ç¢éûÇÕç›å…êîÇëóêM
                    End If
                                                                            
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                                                                            
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "05"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                
                    Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
        
                    Sendbuf = Text_Create_Proc()
                
                
                Case Else           'ëŒè€ì`ï[Ç™ï°êîñá
            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                    
                    'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                    Send_Text.sts = Sts_OK                                      'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                    Send_Text.Display_Flg = Display_DEF                         'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                    Send_Text.End_Menu = Menu_Only                              'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                    Send_Text.Menu_Suu = "05"                                   'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                    Send_Text.fileName = ""                                     'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
                    Send_Text.Buzzer = Buzzer_DEF                               'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                
                    '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                    Send_Text.Box_Type(0).MENU = ""                             'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                                                Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                                                Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "08"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "08"
                                                                                
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    '2010.12.07
'                    Send_Text.Box_Type(2).Max_Size = "13"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                    Send_Text.Box_Type(2).Max_Size = "20"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                    '2010.12.07
                                                                                
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_ID_No)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_ID_No)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "08"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "08"
                                                                                
                    Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
        
                    Sendbuf = Text_Create_Proc()
            
            End Select
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅièoâ◊êîÅ^ì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    Case LCD_Syuka      'èoâ◊écêî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
                
                        SYUKA_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If SYUKA_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
            
                        If SYUKA_QTY > ID_KANRI_TBL(ING_No).Send_Syuka_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                    
                                    
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                                    
                                    'èoå…èàóù
                        sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                    0, _
                                    0, _
                                    SYUKA_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).CYU_KBN, _
                                    ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).DEN_NO, _
                                    ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        Select Case sts
                            Case False
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ëºí[ññÇ≈égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                MTS_Dec_Proc = False
                                GoTo Abort_Tran
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                        End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                                        'éüÇÃçÏã∆óvãÅ
                        
                        
                        'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                        
                        
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
            
                        Sendbuf = Text_Create_Proc()
            
            
            
                    Case LCD_ID_No      'ì`ï[ÇhÇc
                
'''                        If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'''                            ID_NO = Format(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "00000000")
'''                        Else
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
'''                        End If
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                "", _
                                                "", _
                                                "", _
                                                "", _
                                                "", _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    MTS_Dec_Proc = False
                                    Exit Function
                                End If
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Hinban, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                MTS_Dec_Proc = False
                                Exit Function
                        End Select
                
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                
                        '------------------ ämíËÇµÇΩèoâ◊ó\íËÇÃó\íËêîÇëóêMÇ∑ÇÈ
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                        'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                                                    Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                                                    Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2))
                                                                            'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "08"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "08"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                            'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "13"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                            'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                            
                        If SYUKA_QTY > (ID_KANRI_TBL(ING_No).YUKO_SUMI_QTY + ID_KANRI_TBL(ING_No).YUKO_MI_QTY) Then
                            SYUKA_QTY = ID_KANRI_TBL(ING_No).YUKO_SUMI_QTY + ID_KANRI_TBL(ING_No).YUKO_MI_QTY
                        End If
                                                                            
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                                                                            'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                                            'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅièoâ◊êîÅj
            For i = 0 To M_Gyo - 1
            
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    Case LCD_Syuka      'èoâ◊écêî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
                
                        SYUKA_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If SYUKA_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
            
                        If SYUKA_QTY > ID_KANRI_TBL(ING_No).Send_Syuka_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            MTS_Dec_Proc = False
                            Exit Function
                        End If
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                                    'èoå…èàóù
                        sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                    0, _
                                    0, _
                                    SYUKA_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).CYU_KBN, _
                                    ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).DEN_NO, _
                                    ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        Select Case sts
                            Case False
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ëºí[ññÇ≈égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                MTS_Dec_Proc = False
                                GoTo Abort_Tran
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                        End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                                        'éüÇÃçÏã∆óvãÅ
                        
                        
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
            
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
    End Select

    MTS_Dec_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
Private Function DEN_ID_Dec_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwì`ï[ÇhÇcÇ≈ÇÃèoâ◊èàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8


Dim Hinban          As String * 20      '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long

Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim KAN_KBN         As String * 1

Dim MENU_NO         As String * 2

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim wkTEXT          As String       '2007.07.21


Dim HAIKI_F         As Boolean      '2010.02.22
Dim j               As Integer      '2010.02.22


    DEN_ID_Dec_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            RET_JGYOBU = Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 1)
                            ID_NO = Right(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 12)
                        Else
                            RET_JGYOBU = ID_KANRI_TBL(ING_No).JGYOBU
'''                            If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'''                                ID_NO = Format(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "00000000")
'''                            Else
                                ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
'''                            End If
                        End If
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                RET_JGYOBU, _
                                                RET_NAIGAI, _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    DEN_ID_Dec_Proc = False
                                    Exit Function
                                End If
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                DEN_ID_Dec_Proc = False
                                Exit Function
                        End Select
                
                
                        If KAN_KBN <> KAN_KBN_UN Then
                            
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…èàóùçœÇ›", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
                                                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
                           
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        '2009.07.29
                        If SYUKA_QTY > 1 Then
                        
                            Send_Text.Buzzer = Wel_SYUKA_BUZZER                 'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        Else
                            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        End If
                        
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "09"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.07.21                        Send_Text.Box_Type(3).Max_Size = "13"
'2007.07.21                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"                       '2007.07.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"  '2007.07.21
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Å^êîó Åj
            For i = 0 To M_Gyo - 1
                
                
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case wkTEXT
                '2007.07.21 Å™
                                    
                    
                    
                    Case LCD_Tanaban    'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    DEN_ID_Dec_Proc = False
                                    Exit Function
                    
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
            
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    DEN_ID_Dec_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                DEN_ID_Dec_Proc = False
                                Exit Function
                            End If
                        End If
                            
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        
                        If ID_KANRI_TBL(ING_No).JGYOBU = ID_KANRI_TBL(ING_No).S_JGYOBU And _
                            ID_KANRI_TBL(ING_No).NAIGAI = ID_KANRI_TBL(ING_No).S_NAIGAI Then
                        
                            sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        
                        Else
                        
                            sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, ID_KANRI_TBL(ING_No).S_NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        
                        End If
                        
                        
                        
                        
                        Select Case sts
                            Case BtNoErr
                                If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            DEN_ID_Dec_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                DEN_ID_Dec_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                    
                    
'2007.07.21                        If Hinban <> ID_KANRI_TBL(ING_No).Hinban Then
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                        
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
    
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            DEN_ID_Dec_Proc = False
                            Exit Function
                        
                        End If
                    
                    
                    Case LCD_Syuka      'èoâ◊écêî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
                
                        SYUKA_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If SYUKA_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
            
                        If SYUKA_QTY > ID_KANRI_TBL(ING_No).Send_Syuka_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
                        
                        
                        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                DEN_ID_Dec_Proc = False
                                Exit Function
                        End Select
                    
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
                        
                        
                        
                        If SYUKA_QTY > (SUMI_QTY + MI_QTY) Then
                            Call Err_Send_Proc("èoâ◊êîïsë´", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            DEN_ID_Dec_Proc = False
                            Exit Function
                        End If
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                    
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                                    'èoå…èàóù
                        '2010.02.22Å@Å´
                        HAIKI_F = False
                                    
                        If HAIKI_MTS_F Then
                                    
                            For j = 0 To UBound(HAIKI_MTS)
                            
                            
                                If Trim(ID_KANRI_TBL(ING_No).MTS_CODE) = HAIKI_MTS(j) Then
                                
                            
                                    HAIKI_F = True
                                    Exit For
                                
                                End If
                            
                            Next j
                                    
                        End If
                                    
                                    
                                    'èoå…èàóù
                        
                        
                        If HAIKI_F Then
                        
                        
                            sts = Syuko_Update_HAIKI_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        Hinban, _
                                        "", _
                                        Tanaban, _
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                        0, _
                                        0, _
                                        SYUKA_QTY, _
                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).CYU_KBN, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_NO, _
                                        ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        
                        Else
                        '2010.02.22 Å™
                        
                            sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        Hinban, _
                                        "", _
                                        Tanaban, _
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                        0, _
                                        0, _
                                        SYUKA_QTY, _
                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).CYU_KBN, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_NO, _
                                        ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        
                        
                        
                        End If
                        Select Case sts
                            Case False
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ëºí[ññÇ≈égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                DEN_ID_Dec_Proc = False
                                GoTo Abort_Tran
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                        End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                                        
                                        
                        'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                        
                                        
                                        'éüÇÃçÏã∆óvãÅ
                                        
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
            
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
    End Select
    DEN_ID_Dec_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function
Private Function SYUKO_HYO_Dec_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwèoå…ï\Ç≈ÇÃèoâ◊èàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8
Dim Hinban          As String * 20      '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long

Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim wkTEXT          As String



Dim HAIKI_F         As Boolean      '2010.02.22
Dim j               As Integer      '2010.02.22



    SYUKO_HYO_Dec_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅièoå…ï\áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SYUKO_HYO_No   'èoå…ï\áÇ
    
                        
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…ï\égópïsâ¬", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                        
'''                        If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'''                            ID_NO = Format(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "000000000000")
'''                        Else
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
'''                        End If
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                "", _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_Proc = False
                                    Exit Function
                                End If
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_Proc = False
                                Exit Function
                        End Select
                
                        If KAN_KBN <> KAN_KBN_UN Then
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…èàóùçœÇ›", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        '2009.07.29
                        If SYUKA_QTY > 1 Then
                        
                            Send_Text.Buzzer = Wel_SYUKA_BUZZER                 'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        Else
                            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        End If
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "09"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.07.21                        Send_Text.Box_Type(3).Max_Size = "13"
'2007.07.21                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"                       '2007.07.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"  '2007.07.21
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka & Space(M_Keta - (Len(LCD_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Å^êîó Åj
            For i = 0 To M_Gyo - 1
                
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT
                '2007.07.21 Å™
                
                
                    Case LCD_Tanaban    'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_Proc = False
                                    Exit Function
                    
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
            
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    SYUKO_HYO_Dec_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                SYUKO_HYO_Dec_Proc = False
                                Exit Function
                            End If
                        End If
                            
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                                If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            SYUKO_HYO_Dec_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                SYUKO_HYO_Dec_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                    
                    
'2007.07.21                        If Hinban <> ID_KANRI_TBL(ING_No).Hinban Then
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                        
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
    
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        
                        End If
                    
                    
                    Case LCD_Syuka      'èoâ◊écêî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                
                        SYUKA_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If SYUKA_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
            
                        If SYUKA_QTY > ID_KANRI_TBL(ING_No).Send_Syuka_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, Tanaban, ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_Proc = False
                                Exit Function
                        End Select
                    
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                        
                        
                        If SYUKA_QTY > (SUMI_QTY + MI_QTY) Then
                            Call Err_Send_Proc("èoâ◊êîïsë´", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_Proc = False
                            Exit Function
                        End If
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                    
                                    
                                    
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                                    
                        '2010.02.22Å@Å´
                        HAIKI_F = False
                                    
                        If HAIKI_MTS_F Then
                                    
                            For j = 0 To UBound(HAIKI_MTS)
                            
                            
                                If Trim(ID_KANRI_TBL(ING_No).MTS_CODE) = HAIKI_MTS(j) Then
                                
                            
                                    HAIKI_F = True
                                    Exit For
                                
                                End If
                            
                            Next j
                                    
                        End If
                                    
                                    
                                    'èoå…èàóù
                        
                        
                        If HAIKI_F Then
                        
                        
                            sts = Syuko_Update_HAIKI_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        Hinban, _
                                        "", _
                                        Tanaban, _
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                        0, _
                                        0, _
                                        SYUKA_QTY, _
                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).CYU_KBN, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_NO, _
                                        ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        
                        Else
                        '2010.02.22 Å™
                        
                            sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        Hinban, _
                                        "", _
                                        Tanaban, _
                                        ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                        0, _
                                        0, _
                                        SYUKA_QTY, _
                                        Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).CYU_KBN, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_NO, _
                                        ID_KANRI_TBL(ING_No).ID_NO, MENU_NO)
                        
                        
                        
                        End If
                        
                        
                        Select Case sts
                            Case False
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ëºí[ññÇ≈égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_Proc = False
                                GoTo Abort_Tran
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                        End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                                        
                                        
                        'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                        
                                        'éüÇÃçÏã∆óvãÅ
                                        
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                           'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
            
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
    End Select
    SYUKO_HYO_Dec_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function

Private Function SYUKO_HYO_Dec_OSAKA_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ëÂç„PCå¸ÇØÅwèoå…ï\Ç≈ÇÃèoâ◊èàóùÅx    2007.03.16
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long

Dim MI_QTY          As Long

Dim i               As Integer

Dim Y_SYU_CNT       As Integer

Dim Y_SURYO         As Long
Dim J_SURYO         As Long

Dim ID_NO           As String * 12
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim BIN_NO          As String * 2   '2007.05.16

Dim DEN_NO          As String * 6   '2007.06.12
Dim Found_F         As Integer      '2007.06.12
Dim SEQ_NO          As String * 3   '2007.06.12
Dim QTY             As Long         '2007.06.12

Dim wkTEXT          As String

Dim Mod_Return      As Integer      '2010.12.09
Dim iNum            As Integer      '2010.12.09
'Dim wkIri_Su        As String * 8
'Dim j               As Integer


    SYUKO_HYO_Dec_OSAKA_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅièoå…ï\áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SYUKO_HYO_No   'èoå…ï\áÇ
    
                        
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) <> 12 Then
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…ï\áÇÅHÅH", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
                        
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_OSAKA_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                ID_KANRI_TBL(ING_No).NAIGAI, _
                                                Hinban, _
                                                Y_SYU_CNT, _
                                                Y_SURYO, _
                                                J_SURYO, _
                                                ID_NO, _
                                                BIN_NO)         '2007.05.16
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_OSAKA_Proc = False
                                    Exit Function
                                End If
                
                                If Y_SURYO <= J_SURYO Then
                
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…èàóùçœÇ›", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_OSAKA_Proc = False
                                    Exit Function
                                            
                                End If
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_OSAKA_Proc = False
                                Exit Function
                        End Select
                
                
                        '2010.12.09
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(ITEMREC.GAISO_IRI_QTY, "")
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        
                        End Select
                        '2010.12.09
                                                    
                        
                        
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        
                        SYUKA_QTY = Y_SURYO - J_SURYO
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                        
                        
                        ID_KANRI_TBL(ING_No).BIN_NO = BIN_NO        '2007.05.16
                        
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN_SPO  '2007.05.16
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
'                                                                                'BOXëÆê´
'                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(0).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(0).Start_Pos = ""
'
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(0).Max_Size = "00"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
'                        '-----------------------------------------------ÇQçsñ⁄
'                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, "èoå…áÇ:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, "èoå…áÇ:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_Tanaban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_Tanaban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "09"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "09"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.07
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(2).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                        '2010.12.07
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OSAKA_Syuka & Space(M_Keta - (Len(LCD_OSAKA_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OSAKA_Syuka & Space(M_Keta - (Len(LCD_OSAKA_Syuka) * 2) - 5 + (5 - Len(Format(SYUKA_QTY, "#0")))) & Format(SYUKA_QTY, "#0"))
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        
                        If SYUKO_QTY = 1 Then   '2007.08.02
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                        Else
                            Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(SYUKA_QTY, "#0"))) & Format(SYUKA_QTY, "#0")
                        End If
                                                                                                            
                                                                                
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(3).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""





                        '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
'                        Call UniCode_Conv(ITEMREC.GAISO_IRI_QTY, " 3 ")
'                        wkIri_Su = StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)
'                        For j = 1 To Len(wkIri_Su)
'                            If Mid(wkIri_Su, j, 1) < " " Then
'                                Mid(wkIri_Su, j, 1) = " "
'                            End If
'                        Next j
                        
                        '2010.12.09
                        If IsNumeric(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) Then
                            If Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) <> 0 Then
                                Mod_Return = SYUKA_QTY Mod Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                                iNum = CInt(ToRoundDown(CCur(SYUKA_QTY) / CCur(Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))), 0))
                        
                                
                                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        
                        
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                
                                If Mod_Return <> 0 Then
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                Else
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                End If
                                
                                
''Call LOG_OUT(LOG_F, Hinban & " " & StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode) & " " & StrConv(Send_Text.Box_Type(4).LCD, vbUnicode))
                                
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            End If
                        
                                                    
                        End If







                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Å^êîó Åj
            For i = 0 To M_Gyo - 1
                

                '2010.12.07 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT


'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    
                '2010.12.07 Å™
                    
                    Case LCD_Tanaban    'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_OSAKA_Proc = False
                                    Exit Function
                    
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
            
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    SYUKO_HYO_Dec_OSAKA_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                SYUKO_HYO_Dec_OSAKA_Proc = False
                                Exit Function
                            End If
                        End If
                            
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                                If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            SYUKO_HYO_Dec_OSAKA_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                SYUKO_HYO_Dec_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                    
                    
                        If Hinban <> ID_KANRI_TBL(ING_No).Hinban Then
                        
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
    
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        
                        End If
                    
                    
                    
                        'ì`ï[áÇñ¢ìoò^ÇÕèoâ◊ïsâ¬ 2007.06.12
                        If Left(Tanaban, 2) = NYUKA_SOKO_NO Then
                            
                    
                    
                    
                    
                    
                            '------------------ ì¸â◊ÉfÅ[É^ÇÃämîF
                            sts = Y_Nyuka_O_Chek_Proc(3, RET_JGYOBU, _
                                                        RET_NAIGAI, _
                                                        Hinban, _
                                                        DEN_NO, _
                                                        Found_F, _
                                                        SEQ_NO, _
                                                        QTY)
                    
                    
                    
                            Select Case sts
                                Case False          'ê≥èÌ
                                    If Found_F = 9 Then
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SYUKO_HYO_Dec_OSAKA_Proc = False
                                        Exit Function
                                    End If
                    
                    
                                    If Found_F = 1 Then
                                        If Trim(DEN_NO) = "" Or DEN_NO = "000000" Then
                    
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ì`ï[î‘çÜñ¢ì¸óÕÇ≈Ç∑ÅB", "ì¸å…çÏã∆ÇÅA", "äÆóπÇ≥ÇπÇƒâ∫Ç≥Ç¢ÅB")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SYUKO_HYO_Dec_OSAKA_Proc = False
                                            Exit Function
                                        End If
                                    End If
                    
                                Case True, SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                Case SYS_CANCEL
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_HYO_Dec_OSAKA_Proc = False
                                    Exit Function
                            End Select
                    
                    
                    
                    
                        End If
                    Case LCD_OSAKA_Syuka      'èoâ◊écêî
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
                
                        SYUKA_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If SYUKA_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
            
                        If SYUKA_QTY > ID_KANRI_TBL(ING_No).Send_Syuka_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
                        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, Tanaban, ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_OSAKA_Proc = False
                                Exit Function
                        End Select
                    
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
                        
                        
                        If SYUKA_QTY > (SUMI_QTY + MI_QTY) Then
                            Call Err_Send_Proc("èoâ◊êîïsë´", Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKO_HYO_Dec_OSAKA_Proc = False
                            Exit Function
                        End If
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                    
                                    
                                    
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                                    
                                    
                                    
                                    'èoå…èàóù
                        sts = Syuko_OSAKA_Update_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                    Hinban, _
                                    "", _
                                    Tanaban, _
                                    ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                    0, _
                                    0, _
                                    SYUKA_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).CYU_KBN, _
                                    ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).DEN_NO, _
                                    ID_KANRI_TBL(ING_No).ID_NO, _
                                    MENU_NO, _
                                    ID_KANRI_TBL(ING_No).BIN_NO)
                        Select Case sts
                            Case False
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ëºí[ññÇ≈égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_HYO_Dec_OSAKA_Proc = False
                                GoTo Abort_Tran
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                        End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                                        
                                        
                        'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                        sts = Data_Clear_Proc(0, Sendbuf)
                        Select Case sts
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                        
                                        'éüÇÃçÏã∆óvãÅ
                                        
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                           'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
            
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
    End Select
    SYUKO_HYO_Dec_OSAKA_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function


Private Function SHOUHINKA_CHECK_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwè§ïiâª¡™Ø∏èàóùÅx
'       2010.09.03
'
'-------------------------------------------------------
Dim sts             As Integer



Dim SHIJI_No        As String * 8


Dim SHIJI_QTY       As String * 11

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim i               As Integer


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim MENU_NO         As String * 2



    SHOUHINKA_CHECK_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ï[áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SHIJI_NO      'éwê}ï[áÇ
    
    
                        SHIJI_No = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        
                        Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, SHIJI_No)
                        sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
                        Select Case sts
                            Case False          'ê≥èÌ
                                
                            
                            
                            Case BtErrKeyNotFound
                                    
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SHOUHINKA_CHECK_PROC = False
                                Exit Function
                            
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        
                        End Select
                
                        
                        
                        'ÉLÉÉÉìÉZÉãçœ
                        If StrConv(P_SSHIJI_O_REC.CANCEL_F, vbUnicode) = "1" Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SHOUHINKA_CHECK_PROC = False
                            Exit Function
                        End If
                                                
                        'äÆóπçœ
                        If StrConv(P_SSHIJI_O_REC.KAN_F, vbUnicode) = "1" Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SHOUHINKA_CHECK_PROC = False
                            Exit Function
                        End If
                        
                        
                        
                        
                        SHIJI_QTY = Format(Val(StrConv(P_SSHIJI_O_REC.SHIJI_QTY, vbUnicode)) - Val(StrConv(P_SSHIJI_O_REC.UKEIRE_QTY, vbUnicode)), "00000000.00")
                        If Val(SHIJI_QTY) < 0 Then
                            SHIJI_QTY = "00000000.00"
                        End If
                        
                        ID_KANRI_TBL(ING_No).SHIJI_No = SHIJI_No
                        ID_KANRI_TBL(ING_No).Hinban = StrConv(P_SSHIJI_O_REC.HIN_GAI, vbUnicode)
                        ID_KANRI_TBL(ING_No).SHIJI_QTY = SHIJI_QTY
                        ID_KANRI_TBL(ING_No).LABEL_CNT = 0
                        ID_KANRI_TBL(ING_No).GENPIN_CNT = 0
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        '2010.12.07
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_L_HIN_CNT)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_L_HIN_CNT)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.07
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                        '2010.12.07
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÉâÉxÉãïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
'                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Select Case i
                
                    Case 0
                
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        If Trim(Hinban) = Ent_Para Then
                        
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    
                            '2010.12.07
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                    Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & _
'                                                                                    Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                    Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & _
                                                                                    Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            
                            '2010.12.07
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"                  'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
'2011.04.11                            Send_Text.Box_Type(4).Max_Size = "13"
'2011.04.11                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "13"
                                                                                    
                                                                                    
                            Send_Text.Box_Type(4).Max_Size = "20"                           '2011.04.11 13-->20
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"      '2011.04.11 13-->20
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                            Sendbuf = Text_Create_Proc()
                        
                            SHOUHINKA_CHECK_PROC = False
    
                            Exit Function
            
                        End If
                
                
                
                
                
                
                    'ïiî‘
                    Case 3
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                                    
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                        
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                        'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            '2010.12.07
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban & "    ¥◊∞")
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban & "    ¥◊∞")
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & " ¥◊∞")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & " ¥◊∞")
                            '2010.12.07
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
                            SHOUHINKA_CHECK_PROC = False
    
                            Exit Function
                        
                        
                        End If
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        '2010.12.07
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                        
                        ID_KANRI_TBL(ING_No).LABEL_CNT = ID_KANRI_TBL(ING_No).LABEL_CNT + 1
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban & _
'                                                                                Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & _
                                                                                Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        '2010.12.07
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.07
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                        '2010.12.07
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiåªïiï[ïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
'                Select Case Trim(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD)
                Select Case i
                
                                    
                    Case 0
                                    
                                    
                                    
                                    
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    
                        If Trim(Hinban) = Ent_Para Then
                        
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                            
                        
                        
                        
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                    
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                
                            Sendbuf = Text_Create_Proc()
                        
                            SHOUHINKA_CHECK_PROC = False
        
                            Exit Function

                        End If
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                    Case 4          'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        
                        
                        
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        
                        
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                        
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                        'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                        
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))                            '2010.12.08
                            '2010.12.07
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))

                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            '2010.12.07


                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Hinban & "    ¥◊∞")
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Hinban & "    ¥◊∞")
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Left(Hinban, 16) & " ¥◊∞")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Left(Hinban, 16) & " ¥◊∞")
                            '2010.12.07
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"                  'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
''                            Send_Text.Box_Type(4).Max_Size = "13"
''                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "13"
                                                                                    
                            Send_Text.Box_Type(4).Max_Size = "20"                               '2011.04.11 13-->20
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"          '2011.04.11 13-->20
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
                            SHOUHINKA_CHECK_PROC = False
        
                            Exit Function
                                                    
                        
                        
                        
                        End If
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                        '2010.12.07
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                            Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                            Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))


                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                            Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                            Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        '2010.12.07


                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        ID_KANRI_TBL(ING_No).GENPIN_CNT = ID_KANRI_TBL(ING_No).GENPIN_CNT + 1
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Left(Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Left(Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                        '2010.12.07
                                                                                
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.07
'                        Send_Text.Box_Type(4).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(4).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"
                        '2010.12.07
                                                                                
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        
        
        
        
        
        Case Step_Sagyo4_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            
            
            Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
            sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
            Select Case sts
                Case False          'ê≥èÌ
                    
                
                
                Case BtErrKeyNotFound
                        
'                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                    
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                    
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    GoTo Abort_Tran
                
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    GoTo Abort_Tran
            
            End Select
            
            Call UniCode_Conv(P_SSHIJI_O_REC.HIN_CHECK_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
            Call UniCode_Conv(P_SSHIJI_O_REC.HIN_CHECK_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
            Call UniCode_Conv(P_SSHIJI_O_REC.HIN_CHECK_LABEL_CNT, Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "000"))
            Call UniCode_Conv(P_SSHIJI_O_REC.HIN_CHECK_GENPIN_CNT, Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "000"))
            sts = BTRV(BtOpUpdate, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
            Select Case sts
                Case False          'ê≥èÌ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    GoTo Abort_Tran
            End Select
            
            
            
            
            
            
            
            
            
            
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).Hinban, , CLng(ID_KANRI_TBL(ING_No).SHIJI_QTY), , , , , , , _
                                                     ID_KANRI_TBL(ING_No).SHIJI_No, Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "000"), Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "000")) Then
                    SHOUHINKA_CHECK_PROC = SYS_ERR
                    GoTo Abort_Tran
                End If
            End If
            '2004.07.16 Å™
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
    
    
    End Select

    SHOUHINKA_CHECK_PROC = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function

Private Function HINBAN_CHECK_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwïiî‘¡™Ø∏èàóùÅx
'       2010.09.10
'
'-------------------------------------------------------
Dim sts             As Integer



'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim i               As Integer


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim MENU_NO         As String * 2

Dim Out_Moji        As String           '2012.03.29


    HINBAN_CHECK_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
    
    
    
    
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                HINBAN_CHECK_PROC = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
    
    
                        
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        '2012.03.19
                        Call Moji_Cut_Proc(StrConv(ITEMREC.HIN_NAME, vbUnicode), Out_Moji, 20)
                        'ID_KANRI_TBL(ING_No).HIN_NAME = StrConv(ITEMREC.HIN_NAME, vbUnicode)
                        ID_KANRI_TBL(ING_No).HIN_NAME = Out_Moji
                        '2012.03.19
                        ID_KANRI_TBL(ING_No).LABEL_CNT = 1
                        ID_KANRI_TBL(ING_No).GENPIN_CNT = 0
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        '2010.09.15
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        '2010.09.15
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & _
'                                                                                Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 16) & _
                                                                                Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        '2010.12.07
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.07
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                        '2010.12.07
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÉâÉxÉãïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
'                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Select Case i
                
                    Case 0
                
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        If Trim(Hinban) = Ent_Para Then
                        
                        
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                            
                            
                            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                        
                            Else
                                        
                                MENU_NO = ""
                            End If
                            
                            If Trim(MENU_NO) = "" Then
                            Else
                            'çÏã∆€∏ﬁèoóÕ
                                
                                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                                    MENU_NO, _
                                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                                     ID_KANRI_TBL(ING_No).Hinban, , , , , , , , , _
                                                                     , Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "000")) Then
                                    HINBAN_CHECK_PROC = SYS_ERR
                                    GoTo Abort_Tran
                                End If
                            End If
                                        
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                            End If
                            'éüÇÃçÏã∆óvãÅ
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                        
                            Sendbuf = Text_Create_Proc()
                        
                        
                            HINBAN_CHECK_PROC = False
    
                            Exit Function
                        
                        End If

                
                
                    'ïiî‘
                    Case 3
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                                    
                        
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                        
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                        'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    
                                                                                    
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            '2010.12.07
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban & "    ¥◊∞")
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban & "    ¥◊∞")
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & " ¥◊∞")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & " ¥◊∞")
                            '2010.12.07
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
                            
                            HINBAN_CHECK_PROC = False
    
                            Exit Function
                        
                        
                        End If
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).HIN_NAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                        
                        ID_KANRI_TBL(ING_No).LABEL_CNT = ID_KANRI_TBL(ING_No).LABEL_CNT + 1
                        '2010.12.07
'                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
'                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban & _
'                                                                                Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(Hinban, 16) & _
                                                                                Space(4 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                        '2010.12.07
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        '2010.12.08
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                        '2010.12.08
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        
    End Select
            
    HINBAN_CHECK_PROC = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function

Private Function COMPO_CHECK_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwè§ïiâªç\ê¨¡™Ø∏èàóùÅx
'       2011.03.02
'
'-------------------------------------------------------
Dim sts             As Integer



Dim SHIJI_No        As String * 8

Dim Hinban          As String * 20

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim MENU_NO         As String * 2

Dim KO_CNT          As Integer
Dim RD_CNT          As Integer



    COMPO_CHECK_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ï[áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SHIJI_NO      'éwê}ï[áÇ
    
    
                        SHIJI_No = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        
                        
                        sts = COMPO_Check_Read_Proc(SHIJI_No, KO_CNT)
                        
                        
                        Select Case sts
                            Case False          'ê≥èÌ
                                
                            
                            
                            Case BtErrKeyNotFound
                                    
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                COMPO_CHECK_PROC = False
                                Exit Function
                            
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        
                        End Select
                
                        
                        'éqïîïiÇ»Çµ
                        If KO_CNT < 0 Then
                        
                        
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "éqïîïiÇ»Çµ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_CHECK_PROC = False
                            Exit Function
                        
                        
                        
                        
                        End If
                        
                        
                        'ÉLÉÉÉìÉZÉãçœ
                        If StrConv(P_SSHIJI_O_REC.CANCEL_F, vbUnicode) = "1" Then
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_CHECK_PROC = False
                            Exit Function
                        End If
                                                
                        'äÆóπçœ
                        If StrConv(P_SSHIJI_O_REC.KAN_F, vbUnicode) = "1" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_CHECK_PROC = False
                            Exit Function
                        End If
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).SHIJI_No = SHIJI_No
                        ID_KANRI_TBL(ING_No).Hinban = StrConv(P_SSHIJI_O_REC.HIN_GAI, vbUnicode)
                        ID_KANRI_TBL(ING_No).Input_Line = 0
                                                
                        
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                        Call COMPO_Check_Cnt_Proc(KO_CNT, RD_CNT)
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Hinban)
                                                                                
                                                                                
                                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÉâÉxÉãïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                Select Case i
                
                                    
                    Case 0
                                    
                                    
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    
                        If Trim(Hinban) = Ent_Para Then
                        
                            '2011.06.14
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                                If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG <> 1 Then
                                    Exit For
                                End If
                            Next k
                            
                            If k > UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) Then
                            Else
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, "¡™Ø∏ñ¢äÆóπ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                COMPO_CHECK_PROC = False
                                Exit Function
                            
                            End If
                            
                            
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                        
                        
                        
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                    
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                
                            Sendbuf = Text_Create_Proc()
                        
                            COMPO_CHECK_PROC = False
        
                            Exit Function
                            
                            
                            
                            '2011.06.14
                                                    
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                                    
                            Exit For
                        End If
                    Case 2, 3, 4        'ïiî‘
                        
                        
                        
                        For j = 2 To 4
                        
                            If j - 2 = ID_KANRI_TBL(ING_No).Input_Line Then
                        
                                                    
                        
                                Hinban = ID_KANRI_TBL(ING_No).Recv_text(j)
                    
                    
                                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                                Select Case sts
                                    Case BtNoErr
                            
                                    Case BtErrKeyNotFound
                                
                                    Case Else
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                        Exit Function
                        
                                End Select
                    
                    
                    
                    
                                For k = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).KO_HIN_GAI) = Trim(Hinban) Then
                                        Exit For
                                    End If
                                
                                Next k
                    
                    
                                If k > UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) Then
                                
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, Hinban, "ïiî‘¥◊∞", "")
                                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    COMPO_CHECK_PROC = False
                                    Exit Function
                                
                                
                                End If
                                                            
                                                            
                        
                                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 1
                            
                            
                                '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.20
                                If COMPO_Check_Update_Proc(KO_CNT, RD_CNT, Sendbuf) Then
                                    Exit Function
                                End If
                                '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.20
                            
                            
                            
                            
                            
                                Exit For
                           End If
                        
                        
                        
                        Next j
                        
                        ID_KANRI_TBL(ING_No).RD_HINBAN(ID_KANRI_TBL(ING_No).Input_Line) = Hinban
                        ID_KANRI_TBL(ING_No).Input_Line = ID_KANRI_TBL(ING_No).Input_Line + 1
                        
                        If ID_KANRI_TBL(ING_No).Input_Line > 2 Then
                            ID_KANRI_TBL(ING_No).Input_Line = 0
                        
                            ID_KANRI_TBL(ING_No).RD_HINBAN(0) = ""
                            ID_KANRI_TBL(ING_No).RD_HINBAN(1) = ""
                            ID_KANRI_TBL(ING_No).RD_HINBAN(2) = ""
                        
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            
                            
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                        Call COMPO_Check_Cnt_Proc(KO_CNT, RD_CNT)
                                                                                
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                        For j = 0 To 2
                        
                            If j = ID_KANRI_TBL(ING_No).Input_Line Then
                                                                                    'BOXëÆê´
                                Send_Text.Box_Type(j + 2).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(j + 2).LCD, LCD_Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).LCD, LCD_Hinban)
                        
                        
                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(j + 2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(j + 2).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                Send_Text.Box_Type(j + 2).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Max_Size = "20"
                                                                                        
                                                                                        
                                Send_Text.Box_Type(j + 2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).MENU = ""
                        
                        
                        
                        
                            Else
                                                                                    'BOXëÆê´
                                Send_Text.Box_Type(j + 2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Box_Type = TYPE_REF
                                Call UniCode_Conv(Send_Text.Box_Type(j + 2).LCD, ID_KANRI_TBL(ING_No).RD_HINBAN(j))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).LCD, ID_KANRI_TBL(ING_No).RD_HINBAN(j))
                        
                        
                            
                            
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(j + 2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(j + 2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                Send_Text.Box_Type(j + 2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Max_Size = "00"
                                                                                        
                                                                                        
                                Send_Text.Box_Type(j + 2).MENU = ""                       'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).MENU = ""
                            
                            
                            End If
                        
                        Next j
                                                                                    
                                                                                    
                                                                                    
                                                                                    
                                                                                    
                                                                                    
    
                        Sendbuf = Text_Create_Proc()
                                    
                        Exit For
                           
                End Select
            
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiÇdÇmÇsÅj
        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).Hinban, , , , , , , , , _
                                                     ID_KANRI_TBL(ING_No).SHIJI_No) Then
                    COMPO_CHECK_PROC = SYS_ERR
                    Exit Function
                End If
            End If
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select

            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
        
        
    End Select
        

    COMPO_CHECK_PROC = False
    


End Function

Private Function Inspe_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8
Dim Hinban          As String * 20      '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim JITU_QTY        As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim NAIGAI          As String * 1
Dim HIN_NO          As String * 13


Dim KAN_FLG         As String * 1

Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1


Dim wkTEXT          As String           '2007.07.21

Dim MENU_NO         As String * 2

Dim wkNull_Check    As String       '2009.04.27

Dim Mod_Return      As Integer      '2010.12.09
Dim iNum            As Integer      '2010.12.09



    Inspe_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "åüïiçÏã∆ïsâ¬", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc = False
                            Exit Function
                        End If
    
    
'''                        If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'''                            ID_NO = Format(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "00000000")
'''                        Else
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
'''                        End If
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_FIN, _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                NAIGAI, _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN, _
                                                JITU_QTY)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc = False
                                    Exit Function
                                End If
                
                            Case True
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc = False
                                Exit Function
                        End Select
                
                        '------------------ å¸ÇØêÊÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).MTS_CODE <> MTS_CODE Or _
                            ID_KANRI_TBL(ING_No).SS_CODE <> SS_CODE Then
                            
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "å¸ÇØêÊÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc = False
                            Exit Function
                        End If
                        '------------------ íçï∂ãÊï™ÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).CYU_KBN <> CYU_KBN Then
                            
                            
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "íçï∂ãÊï™É~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc = False
                            Exit Function
                        End If
                        '------------------ èoå…äÆóπÇÃÉ`ÉFÉbÉN
                        If Inspection_Flg = 0 Then
                            If KAN_KBN <> KAN_KBN_FIN Then
                                
                                
                                
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    
                                    Case SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                
                                
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "çÏã∆ñ¢äÆóπ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc = False
                                Exit Function
                            End If
                        End If
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Y_SYU_CNT = Y_SYU_CNT
                        ID_KANRI_TBL(ING_No).SYUKA_QTY = JITU_QTY
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.07.21                        Send_Text.Box_Type(2).Max_Size = "13"
'2007.07.21                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "20"                       '2007.07.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"  '2007.07.21
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT
                '2007.07.21 Å™
                
                                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc = False
                                Exit Function
                    
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ïiî‘ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc = False
                            Exit Function
                        End If
                
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        
                        '2009.07.29
                        If ID_KANRI_TBL(ING_No).SYUKA_QTY > 1 Then
                        
                            Send_Text.Buzzer = Wel_Inspe_BUZZER                 'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Wel_Inspe_BUZZER
                        
                        Else
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        End If
                        
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                
                        '2009.04.16
                        wkNull_Check = Replace(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode), Chr(0), " ")
                        If Trim(wkNull_Check) = "" Then
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""






                            '2010.12.09
                            If IsNumeric(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) Then
                                If Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) <> 0 Then
                                    Mod_Return = ID_KANRI_TBL(ING_No).SYUKA_QTY Mod Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                                    iNum = CInt(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).SYUKA_QTY) / CCur(Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))), 0))
                            
                                    
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            
                                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                            'ï\é¶ì‡óe
                                    
                                    If Mod_Return <> 0 Then
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                    Else
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                    End If
                                    
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(4).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                            'ì¸óÕåÖêî
                                     Send_Text.Box_Type(4).Max_Size = "00"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                                End If
                            
                                                        
                            End If



                        Else
                                                                                    
                                                                                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                    
                                                                                    
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        End If


                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            'èoâ◊ó\íËÇÃì«Ç›çûÇ›
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDáÇ
    
            Do
            
                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrKeyNotFound
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc = False
                        GoTo Abort_Tran
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc = False
                        GoTo Abort_Tran
                    Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
        
            Loop
    
    
            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
            Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                            
            '2006.07.20 åüïiíSìñé“èoóÕí«â¡
            Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
            Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                            
                                            'èoâ◊ó\íËèëçûÇ›
            Do
                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        Inspe_Proc = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            Loop
                                        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
                                        
            '2004.07.16 Å´
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).Hinban, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        "", , , , , MENU_NO, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE, _
                                        ID_KANRI_TBL(ING_No).SS_CODE, _
                                        ID_KANRI_TBL(ING_No).ID_NO)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Inspe_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
            '2004.07.16 Å™
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
    
    
    End Select

    Inspe_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function









Private Function Inspe_Proc_MTS(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiÇlÇsÇrì«Ç›çûÇ›Ç†ÇËÅjÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8
Dim Hinban          As String * 20          '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim JITU_QTY        As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim NAIGAI          As String * 1

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07


Dim KAN_FLG         As String * 1

Dim i               As Integer

Dim DEN_ID_LOOP     As Integer      '2006.06.01
Dim DEN_ID_JGYOBU   As String * 1   '2006.06.01


Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim wkTEXT          As String


Dim wkKENPIN_YMD    As String * 8   'åüïiì˙ït   2007.10.10


Dim wkNull_Check    As String       '2009.04.27

Dim Mod_Return      As Integer      '2010.12.09
Dim iNum            As Integer      '2010.12.09


    Inspe_Proc_MTS = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiå¸ÇØêÊÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_MTS    'å¸ÇØêÊ
                                
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) < 16 Then
                                    'å¸ÇØêÊÅiìæà”êÊÅjÇÃÇ›Ç≈å¸ÇØêÊÉ}ÉXÉ^ì«Ç›çûÇ›
                            Call UniCode_Conv(K2_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).Recv_text(i))
                            sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K2_MTS, Len(K2_MTS), 2)
                            Select Case sts
                                Case BtNoErr
                                    If Len(Trim(StrConv(MTSREC.SS_CODE, vbUnicode))) <> 0 Then
                                    
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "èoâ◊êÊÉGÉâÅ[", "", "")
                    
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                                        Inspe_Proc_MTS = False
                                        Exit Function
                                    
                                    End If
                                
                                Case BtErrKeyNotFound
                                
                                    Call UniCode_Conv(K3_MTS.SS_CODE, ID_KANRI_TBL(ING_No).Recv_text(i))
                                                        
                                    sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K3_MTS, Len(K3_MTS), 3)
                                    Select Case sts
                                        Case BtNoErr
                                        
                                        Case BtErrKeyNotFound
                                        
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "èoâ◊êÊÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                                            Inspe_Proc_MTS = False
                                            Exit Function
                                        
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                        
                            End Select
                        
                            MTS_CODE = StrConv(MTSREC.MUKE_CODE, vbUnicode)
                            SS_CODE = StrConv(MTSREC.SS_CODE, vbUnicode)
                        
                        
                        Else
                            MTS_CODE = Left(ID_KANRI_TBL(ING_No).Recv_text(i), 8)
                            SS_CODE = Right(ID_KANRI_TBL(ING_No).Recv_text(i), 8)
                        
                                                'å¸ÇØêÊÉ}ÉXÉ^ì«Ç›çûÇ›
                            Call UniCode_Conv(K0_MTS.MUKE_CODE, MTS_CODE)
                            Call UniCode_Conv(K0_MTS.SS_CODE, SS_CODE)
                         
                            sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, MTS_CODE & SS_CODE, "èoâ◊êÊÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    Inspe_Proc_MTS = False
                                    Exit Function
                            
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                        
                        
                        End If
                         
                         
                         
                         
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, MTS_CODE & SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, MTS_CODE & SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "13"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT
                '2007.07.21 Å™
                
                
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "åüïiçÏã∆ïsâ¬", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_MTS = False
                            Exit Function
                        End If
    
    
    
'''                        If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'''                            ID_NO = Format(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "00000000")
'''                        Else
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
'''                        End If
'''                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
'''                        sts = Y_Syuka_Chek_Proc(KAN_KBN_FIN, _
'''                                                ID_KANRI_TBL(ING_No).JGYOBU, _
'''                                                NAIGAI, _
'''                                                Hinban, _
'''                                                MTS_CODE, _
'''                                                SS_CODE, _
'''                                                CYU_KBN, _
'''                                                Y_SYU_CNT, _
'''                                                ID_NO, _
'''                                                SYUKA_QTY, _
'''                                                DEN_NO, _
'''                                                KAN_KBN, _
'''                                                JITU_QTY)
'''
'''
                        
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        For DEN_ID_LOOP = 0 To UBound(JGYOBU_T) '2006.06.01
                        
                            '2007.10.10 à¯êîÅ@åüïiì˙ïtí«â¡
                            sts = Y_Syuka_Chek_Proc(KAN_KBN_FIN, _
                                                    JGYOBU_T(DEN_ID_LOOP).CODE, _
                                                    NAIGAI, _
                                                    Hinban, _
                                                    MTS_CODE, _
                                                    SS_CODE, _
                                                    CYU_KBN, _
                                                    Y_SYU_CNT, _
                                                    ID_NO, _
                                                    SYUKA_QTY, _
                                                    DEN_NO, _
                                                    KAN_KBN, _
                                                    JITU_QTY, _
                                                    DEN_ID_JGYOBU, _
                                                    wkKENPIN_YMD)
                            If sts <> False Or Y_SYU_CNT <> 0 Then
                                Exit For
                            End If
                        
                        Next DEN_ID_LOOP
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_MTS = False
                                    Exit Function
                                End If
                
                            Case True
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_MTS = False
                                Exit Function
                        End Select
                        
                        
                        '------------------ å¸ÇØêÊÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).MTS_CODE <> MTS_CODE Or _
                            ID_KANRI_TBL(ING_No).SS_CODE <> SS_CODE Then
                            
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "å¸ÇØêÊÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_MTS = False
                            Exit Function
                        End If
                        '------------------ íçï∂ãÊï™ÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).CYU_KBN <> CYU_KBN Then
                            
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "íçï∂ãÊï™É~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_MTS = False
                            Exit Function
                        End If
                        '------------------ èoå…äÆóπÇÃÉ`ÉFÉbÉN
                        If Inspection_Flg = 0 Then
                            If KAN_KBN <> KAN_KBN_FIN Then
                                
                                
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    
                                    Case SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                
                                
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "çÏã∆ñ¢äÆóπ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_MTS = False
                                Exit Function
                            End If
                        End If
                        
                        '------------------ çƒåüïiÇÃÉ`ÉFÉbÉN    2007.10.10
                        If Inspection_CHK = 1 Then
                            If Trim(wkKENPIN_YMD) <> "" Then
                                
                                
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    
                                    Case SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
'---------------------------    ÉfÅ[É^âï˙Çí«â¡    2011.07.29
                                
                                
                                
                                
                                
                                
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïiçœÇ≈Ç∑", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_MTS = False
                                Exit Function
                            End If
                        End If
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Y_SYU_CNT = Y_SYU_CNT
                        ID_KANRI_TBL(ING_No).SYUKA_QTY = JITU_QTY
                        ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU = DEN_ID_JGYOBU      '2006.06.01
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.07.21                        Send_Text.Box_Type(3).Max_Size = "13"
'2007.07.21                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"                       '2007.07.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"  '2007.07.21
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT
                '2007.07.21 Å™
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_MTS = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                            '------------------------- 2011.07.29   ì«Ç›ë÷Ç¶∫∞ƒﬁÇ≈çƒì«Ç›çûÇ›
                            
                            
''                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ïiî‘ÉGÉâÅ[", "", "")
''                            Sendbuf = Text_Create_Proc()
''                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
''                            Inspe_Proc_MTS = False
''                            Exit Function
                            
                            Call UniCode_Conv(K5_ITEM.JGYOBU, RET_JGYOBU)
                            Call UniCode_Conv(K5_ITEM.NAIGAI, RET_NAIGAI)
                            Call UniCode_Conv(K5_ITEM.HIN_CHANGE, Hinban)
                            sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K5_ITEM, Len(K5_ITEM), 5)
                            Select Case sts
                                Case BtNoErr
                                
                                    If Trim(StrConv(ITEMREC.HIN_GAI, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                                
                                
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ïiî‘ÉGÉâÅ[", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_MTS = False
                                        Exit Function
                                        
                                    End If
                                    Hinban = Trim(StrConv(ITEMREC.HIN_GAI, vbUnicode))
                                Case BtErrKeyNotFound
                                
                                
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ïiî‘ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_MTS = False
                                    Exit Function
                                
                                
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄œΩ¿", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                            '------------------------- 2011.07.29
                        End If
                
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        '2009.07.29
                        If ID_KANRI_TBL(ING_No).SYUKA_QTY > 1 Then
                        
                            Send_Text.Buzzer = Wel_Inspe_BUZZER                 'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Wel_Inspe_BUZZER
                        
                        Else
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        End If
                        
                        '-----------------------------------------------ÇPçsñ⁄
'                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(0).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(0).Start_Pos = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(0).Max_Size = "00"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄


                        
                        
                        '2009.04.16
                        wkNull_Check = Replace(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode), Chr(0), " ")
                        If Trim(wkNull_Check) = "" Then
                                                                                    'BOXëÆê´
                            
                            
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                                                        
                            '2010.12.09
                            If IsNumeric(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) Then
                                If Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode)) <> 0 Then
                                    Mod_Return = ID_KANRI_TBL(ING_No).SYUKA_QTY Mod Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                                    iNum = CInt(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).SYUKA_QTY) / CCur(Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))), 0))
                            
                                    
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            
                                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                            'ï\é¶ì‡óe
                                    
                                    If Mod_Return <> 0 Then
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†Å{" & StrConv(Format(Mod_Return, "#0"), vbWide) & "ó]")
                                    Else
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å@äOëïÅF" & StrConv(Format(iNum, "#0"), vbWide) & "î†")
                                    End If
                                    
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(4).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                            'ì¸óÕåÖêî
                                     Send_Text.Box_Type(4).Max_Size = "00"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                                End If
                            
                                                        
                            End If
                        Else
                                                                                    
                                                                                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                    
                                                                                    
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""



                            



                        End If



                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            'èoâ◊ó\íËÇÃì«Ç›çûÇ›
            '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU)     'éñã∆ïî
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDáÇ
    
            Do
            
                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrKeyNotFound
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_MTS = False
                        GoTo Abort_Tran
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_MTS = False
                        GoTo Abort_Tran
                    Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
        
            Loop
    
    
            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
            Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                            
            '2006.07.20 åüïiíSìñé“èoóÕí«â¡
            Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
            Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                            
                                            
                                            'èoâ◊ó\íËèëçûÇ›
            Do
                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_MTS = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        Inspe_Proc_MTS = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            Loop
                                        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
                                        
                                        
                                        
            '2004.07.16 Å´
            
            '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
            
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).Hinban, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        "", , , , , MENU_NO, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE, _
                                        ID_KANRI_TBL(ING_No).SS_CODE, _
                                        ID_KANRI_TBL(ING_No).ID_NO)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Inspe_Proc_MTS = SYS_ERR
                    GoTo Abort_Tran
            End Select
            '2004.07.16 Å™
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                'åüïiämîFèIóπéûÇÕÅAì`ï[ÇhÇcóvãÅÇ…ñﬂÇ∑à◊ÇÃì¡éÍèàóù
                
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                
                
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                
                
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "12"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()


'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
            
                Sendbuf = Text_Create_Proc()
    
    
    End Select

    Inspe_Proc_MTS = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
Private Function Inspe_Proc_DEN_ALL(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'
'       2006.12.07
'
'ëSêîåüïiëŒâû    2012.03.21
'
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07


Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Long

Dim SAI_SU          As Double

Dim UNSOU_KAISHA    As String
 
Dim SYUKA_YMD       As String
Dim JYUSHO          As String
Dim BIKOU           As String

Dim SURYO           As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag

Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean

'2010.01.21
Dim KONPOU_ON           As Integer




Dim KONPOU_ON_SUMI      As Integer
Dim KONPOU_OFF          As Integer
Dim KONPOU_OFF_SUMI     As Integer



Dim PRINT_OFF           As Boolean
Dim Start_Page_No       As Long
Dim PRINT_TOTAL_SU      As Long
Dim PRINT_MAISU         As Long
Dim fileName            As String
Dim ID_SEQ              As Integer
Dim DISP_SAI_SU         As Double

Dim wkKUTI_SU           As String
Dim wkKONPO_F           As String * 1

Dim TOTAL_KUTI_SU       As Integer
Dim TOTAL_SAI_SU        As Double
Dim MUKE_NAME           As String
Dim OKURI_NO_MAX        As Integer
Dim KUTI_SU_INPUT_F     As Boolean

Dim KEN_TEL_NO          As String * 20


Dim OKURI_NO_F          As Boolean
'2010.01.21


Dim FUKUYAMA_CHK_F      As Boolean

Dim Cnt_F               As Boolean
Dim Print_bara_F        As Boolean
Dim Hin_Total           As Long             '2012.04.07

Dim KEN_HINBAN          As String * 20      '2012.10.02

    Inspe_Proc_DEN_ALL = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                        '2012.10.02Å@KEN_HINBANí«â¡
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, _
                                                SYUKA_YMD, _
                                                JYUSHO, _
                                                BIKOU, _
                                                Start_Page_No, _
                                                KUTI_SU, _
                                                MUKE_NAME, _
                                                OKURI_NO_MAX, , , _
                                                KEN_TEL_NO, _
                                                KEN_HINBAN)
                        
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                                
                        
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                                                    
                            Next j
                                                     
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        End If
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                                                 
                        If Sumi_CNT = Y_SYU_CNT And Start_Page_No <> 0 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        
                        End If
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_CND = Y_SYU_TBL(j).KONPOU_CND    '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).TOTAL_SU = Y_SYU_TBL(j).TOTAL_SU        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = Y_SYU_TBL(j).SAI_SU            '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = Y_SYU_TBL(j).KUTI_SU          '2010.01.21
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = Y_SYU_TBL(j).PRINT_SUMI    '2010.01.21
                        
                                                                                                        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = Y_SYU_TBL(j).OKURI_NO_SEQ
                        
                        
                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = Y_SYU_TBL(j).CNT_BARA_SU      'åüïié¿ê—Å@ÉoÉâ
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = Y_SYU_TBL(j).CNT_HAKO_SU      'åüïié¿ê—Å@î†
                            
                
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = Y_SYU_TBL(j).Y_HIN_CHK_CNT  'ïiî‘ì«çûÇ›âÒêî
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = Y_SYU_TBL(j).J_HIN_CHK_CNT  'ïiî‘ì«çûÇ›çœÇ›âÒêî

                        
                        
                        
'2012.11.15                            ID_KANRI_TBL(ING_No).KEN_HINBAN = KEN_HINBAN
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                        
                        
                        
                        
                        
                        
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        'èoâ◊ì˙
                        ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = SYUKA_YMD
                        'èZèä
                        ID_KANRI_TBL(ING_No).KEN_JYUSHO = JYUSHO
                        
                        'îıçl
                        ID_KANRI_TBL(ING_No).KEN_BIKOU = BIKOU
                        'å¸ÇØêÊ
                        ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = MUKE_NAME
                        
                        'é}î‘
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO_MAX = OKURI_NO_MAX
                        'ìdòbî‘çÜ
                        ID_KANRI_TBL(ING_No).KEN_TEL_NO = KEN_TEL_NO
                        
                        
                        'åüïi ﬂ¿∞›  2012.03.31
                        ID_KANRI_TBL(ING_No).KEN_TYPE = ""
                        
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                '2012.11.15
                        ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = KEN_HINBAN    '2012.11.15
                        
                        '◊ÕﬁŸäJénÉyÅ[ÉWáÇ
                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                        
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                        
                    
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        
                        
                        
                        End If
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                        
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                        If KONPOU_ON <> 0 Then
                            If KONPOU_ON = KONPOU_ON_SUMI Then
                                                    
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                                    
                            End If
                        End If
                        
                        
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                
                
                
                        Else
                
                
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                                                                                    'BOXëÆê´
                                                                                    
                                                                                    
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI          '2011.03.17
                            
                            
Select Case KONPOU_ON                           '2011.03.17
                    
''''''''''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)     '2011.03.17
                            
                                Case 0
                                'èWçáç´ïÔÇ»Çµ
                                
                                    
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                        If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        
                                        
                                        
                                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                            
                                            '-----------------------------------------------ÉwÉbÉ_Å[
                                            Call Wel_Head_Text_Proc
                                            '-----------------------------------------------ÇPçsñ⁄
                                            Call Wel_DETAIL_0_Text_Proc
                                            '-----------------------------------------------ÇQçsñ⁄
                                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                            '-----------------------------------------------ÇRçsñ⁄
                                                                                                    'BOXëÆê´
'2012.11.15                                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                                    'ì¸óÕåÖêî
'2012.11.15                                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                        
                                        
                                            '2012.11.15
                                            Call Wel_OKURI_SAKI_PROC
                                        
                                            TOTAL_KUTI_SU = 1
                                            KUTI_SU_INPUT_F = True
                                            TOTAL_SAI_SU = 0#
                                                
                                                
                                                
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                            End If
                                                
                                                
                                    
                                            Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                            ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                                    
                                    
                                            Sendbuf = Text_Create_Proc()
                                        
                                            Inspe_Proc_DEN_ALL = False
                                            Exit Function
                                        
                                        
                                        End If
                                    End If
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    
                                    
                                    
                                    '-----------------------------------------------É{ÉfÉB
                                    Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
            
                                    Sendbuf = Text_Create_Proc()
                                Case Else
                                'èWçáç´ïÔÇ†ÇË
                                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                            
                                    '-----------------------------------------------ÇQçsñ⁄
                                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                    '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
'2012.11.15                                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                            'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                            'êîílèâä˙ï\é¶
'2012.11.15                                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                            'ì¸óÕåÖêî
'2012.11.15                                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    
                                    '2012.11.15
                                    Call Wel_OKURI_SAKI_PROC
                                    '-----------------------------------------------ÇSçsñ⁄
                                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                            'ï\é¶ì‡óe
                                                                                        'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = "01"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(3).Max_Size = "13"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇTçsñ⁄
                                    Call Wel_Clear_Text_Proc
            
                                    Sendbuf = Text_Create_Proc()
                            
                            End Select
                        End If
                
                
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
'2009.10.14                         If Len(OKURI_NO) < 11 Or Len(OKURI_NO) > 13 Then
'                            If Len(OKURI_NO) < 10 Or Len(OKURI_NO) > 13 Then
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                Inspe_Proc_DEN = False
'                                Exit Function
'                            End If
                        
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        
                        
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                                                
                            End If
                        
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        
                        
                        
                        
                        
                        
                        End If
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                                    
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
                                                                                'BOXëÆê´
                                                                                
                                                                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI              '2011.03.17
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
Select Case KONPOU_ON                               '2011.03.17
'''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)     '2011.03.17



                        
                            Case 0
                            'èWçáç´ïÔÇ»Çµ
                            
                                
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    
                                    
                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                        
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Call Wel_Head_Text_Proc
                                        '-----------------------------------------------ÇPçsñ⁄
                                        Call Wel_DETAIL_0_Text_Proc
                                        '-----------------------------------------------ÇQçsñ⁄
                                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                'BOXëÆê´
'2012.11.15                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                                'êîílèâä˙ï\é¶
'2012.11.15                                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                                'ì¸óÕåÖêî
'2012.11.15                                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    
                                        '2012.11.15
                                        Call Wel_OKURI_SAKI_PROC
                                    
                                    
                                    
                                        TOTAL_KUTI_SU = 1
                                        KUTI_SU_INPUT_F = True
                                        TOTAL_SAI_SU = 0#
                                            
                                            
                                            
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                        End If
                                            
                                            
                                
                                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                                
                                
                                        Sendbuf = Text_Create_Proc()
                                    
                                        Inspe_Proc_DEN_ALL = False
                                        Exit Function
                                    
                                    
                                    End If
                                End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                
                                
                                
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
        
                                Sendbuf = Text_Create_Proc()
                            Case Else
                            'èWçáç´ïÔÇ†ÇË
                        
                        
                                'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg 2011.03.04
                                Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
'2012.11.15                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                        'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                                Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                                Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '2012.11.15
                                Call Wel_OKURI_SAKI_PROC
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                        'ï\é¶ì‡óe
                                                                                    'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                '2010.12.07
'                                Send_Text.Box_Type(3).Max_Size = "13"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                Send_Text.Box_Type(3).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                '2010.12.07
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                    End Select
                Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            Cnt_F = False
            For i = 0 To M_Gyo - 1
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban, "èoâ◊"    'ïiî‘/èoâ◊êîÅiïiî‘Åj
                        If Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2) = "èoâ◊" Then
                            Cnt_F = True
                        Else
                            ID_KANRI_TBL(ING_No).LAST_START_PAGE = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1 '2012.04.01
                        End If
                        
                        
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                'èWçáç´ïÔóLÇËéûÇÃïiî‘É`ÉFÉbÉN
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                        
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND <> "1" Then
                        
                            If KONPOU_ON <> KONPOU_ON_SUMI Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                            
                            
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    Exit Function
                            
                                End If
                            End If
                        
                        End If
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next k
                                            
                            If k <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        
                        
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02-->2012.11.15 KEN_HINBAN-->KEN_ING_HINBAN
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) Then
                            If Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) <> "" Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ëºïiî‘åüïiíÜÅI", ID_KANRI_TBL(ING_No).KEN_ING_HINBAN)
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        End If
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02
                        
                        If Cnt_F Then
                        
                            If RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) <> RTrim(Hinban) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, ID_KANRI_TBL(ING_No).KEN_HINBAN, "ïiî‘ÉGÉâÅ[")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                        
                        
                        
                        
                        Print_bara_F = False
                
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1
                            End If
                        
                                        
                            '2012.04.07
                            Hin_Total = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If ID_KANRI_TBL(ING_No).KEN_HINBAN = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then                '2012.09.05
                                        Hin_Total = Hin_Total + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If                                                                  '2012.09.05
                                End If
                            Next k
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)) + _
                            '                                                            (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO - _
                            '                                                            ((CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY)
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)) + _
                                                                                        (Hin_Total - _
                                                                                        ((CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY)
                            '2012.04.07
                            
                            
                            
                            Print_bara_F = False
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1 Then
                                'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO   2012.04.09
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = Hin_Total                                    '2012.04.09
                                Print_bara_F = True
                            Else
                                'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = CLng(ToRoundUp(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO Mod ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0))
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = CLng(ToRoundUp(CCur(Hin_Total Mod ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0))    '2012.04.09
                            End If
                            
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            '
                            'If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 1
                            'Else
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            'End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                        
                        
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                        
                        
                        End If
                        
                        
                        If Cnt_F Then
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                                Print_bara_F = True
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                        
                        
                        End If
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02
                        '----------------------------------- ÉgÉâÉìÉUÉNÉVÉáÉìäJén -----------
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If


                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
'2012.10.02                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
'2012.10.02
'2012.10.02                                '------------------------------------   èoâ◊ó\íËÇÃèàóù
'2012.10.02                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
'2012.10.02
'2012.10.02
'2012.10.02                                Do
'2012.10.02
'2012.10.02                                    sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.01.02                                    Select Case sts
'2012.01.02                                        Case BtNoErr
'2012.01.02                                            Exit Do
'2012.01.02                                        Case BtErrKeyNotFound
'2012.01.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
'2012.01.02                                            Sendbuf = Text_Create_Proc()
'2012.01.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.01.02                                            Inspe_Proc_DEN_ALL = False
'2012.01.02                                            GoTo Abort_Tran
'2012.01.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.01.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.01.02                                            Sendbuf = Text_Create_Proc()
'2012.01.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.01.02                                            Inspe_Proc_DEN_ALL = False
'2012.01.02                                            GoTo Abort_Tran
'2012.01.02                                        Case Else
'2012.01.02                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
'2012.01.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.01.02                                            Sendbuf = Text_Create_Proc()
'2012.01.02                                            GoTo Abort_Tran
'2012.01.02                                    End Select
'2012.01.02
'2012.01.02                                Loop
'2012.01.02
'2012.01.02
'2012.01.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
'2012.01.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
'2012.01.02
'2012.01.02                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))
'2012.01.02
'2012.01.02                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
'2012.01.02                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
'2012.01.02
'2012.01.02
'2012.01.02
'2012.01.02                                Do
'2012.01.02
'2012.01.02                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.01.02                                    Select Case sts
'2012.01.02                                        Case BtNoErr
'2012.01.02                                            Exit Do
'2012.01.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.01.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.01.02                                            Sendbuf = Text_Create_Proc()
'2012.01.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.01.02                                            Inspe_Proc_DEN_ALL = False
'2012.01.02                                            GoTo Abort_Tran
'2012.01.02                                        Case Else
'2012.01.02                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
'2012.01.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.01.02                                            Sendbuf = Text_Create_Proc()
'2012.01.02                                            GoTo Abort_Tran
'2012.01.02                                    End Select
'2012.01.02
'2012.01.02                                Loop
'2012.01.02
'2012.01.02
'2012.01.02
'2012.01.02                            End If
                            '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
                
                
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
    

                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
    
                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))

                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
                            End If
                        
                            Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, ID_KANRI_TBL(ING_No).KEN_HINBAN)

                        
                            Do
                            
                                sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                        
                        Next k
                        
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            Exit Function
                        End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> â◊éDî≠çsèàóù    2012.03.30
                        PRINT_OFF = False
    
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                            PRINT_OFF = True
                        Else
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                            
''                                If KONPOU_ON = KONPOU_ON_SUMI Then
        
                                    PRINT_OFF = True

''                                End If
        
                            End If
                        End If
                        
                        If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                            ID_KANRI_TBL(ING_No).LABEL_ON = False
                        Else
                                    
                            PRINT_OFF = False
                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                    
                                    For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                        If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                            
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                                'é}î‘çXêV   2010.02.15
                                                Start_Page_No = 1
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01                                                End If
                                                
                                                PRINT_OFF = True
                                            End If
                                        
                                        
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KONPOU_F <> "1" Then
                                                
                            
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                    End If
                                                
                                                
                                                
                                                End If
                                                                    
                                            End If
                                        
                                        
                                        
                                        
                                        
                                        End If
                                    Next k
                                End If
                            End If
                            
                            If Not PRINT_OFF Then
                            
                                Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
                                '2010.06.16
                                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                '2010.06.16
                                Select Case sts
                                    Case BtNoErr
                                    
                                        If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                        
                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                        
                                        End If
                                    
                                    Case BtErrKeyNotFound
                                    
                                        Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                    
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                                
                                If Print_bara_F Then
                                    PRINT_MAISU = Val(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                Else
                                    PRINT_MAISU = Val(StrConv(ITEMREC.KUTI_SU, vbUnicode)) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                                End If
                                                        
                                Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                        
                                PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                
                                If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                    PRINT_MAISU = PRINT_MAISU - 1
                                    If PRINT_MAISU < 1 Then
                                        
                                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                
                                                'é}î‘çXêV   2010.02.15
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                    End If
                                                
                                                
                                                'é}î‘çXêV   2010.02.15
                                
                                
                                
                                                End If
                                            
                                            
                                            
                                            
                                            
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KONPOU_F <> "1" Then
                                                    
                                
'2012.04.01                                                        If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01                                                        End If
                                                        
                                                
                                                    
                                                    End If
                                                                        
                                                End If
                                            
                                            
                                            
                                            
                                            
                                            
                                            End If
                                        Next k
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                        PRINT_OFF = True
                                    Else
    '                                    PRINT_MAISU = PRINT_MAISU - 1
                                        Start_Page_No = Start_Page_No + 1
                                    End If
                                End If
                            End If
                            
                            If Not PRINT_OFF Then
                            
                                ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                
                                Y_SYU_CNT = 0
                                SYUKA_QTY = 0
                                For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                        
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                        
                                            Y_SYU_CNT = Y_SYU_CNT + 1
                                            SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                        
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).PRINT_SUMI Then
                                                PRINT_OFF = True
                                            Else
                                        
'                                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).PRINT_SUMI = True
                                            
                                            End If
                                        
                                        End If
                                    End If
                                Next k
                            End If
                            
                            If Not PRINT_OFF Then
                                
                                ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01
                                
                                If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                End If
                                'é}î‘çXêV   2010.02.15
                                For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                    If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                    
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
'2012.04.01                                            If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                GoTo Abort_Tran
'2012.04.01                                           End If
                                        End If
                                    
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KONPOU_F <> "1" Then
                                            
                        
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU, "000")) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01                                                End If
                                            
                                            
                                            End If
                                                                
                                        End If
                                    
                                    
                                    
                                    
                                    
                                    
                                    
                                    End If
                                Next k
                                'é}î‘çXêV   2010.02.15
                                
                                
                                
                                
                                
                                If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                Else
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                End If
                                
                                'ÉfÅ[É^ëóêM
                                                            
                                ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                            
                                ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                            
                                ID_KANRI_TBL(ING_No).LABEL_ON = True
                            
                                '-----------------------------------------------ÉwÉbÉ_Å[
                        
                                Call Wel_Head_Print_Text_Proc(fileName)
                            
                                
                                
                                Sendbuf = Text_Create_Proc()
                                
                            
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            
                            End If
                        End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> â◊éDî≠çsèàóù    2012.03.30
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT Then
                
                
                
                
                
                
                
                
                
                
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            If Inspection_QTY = 1 Then
    
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            Else
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                            End If
                            
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                    
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If
                                End If
                            Next k
                                                                                    'ï\é¶ì‡óe
                            
                            If Y_SYU_CNT < 2 Then
    
'                                If Inspection_QTY = 1 Then
    
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
'                                End If
                                                                                    
                            Else
                            
'                                If Inspection_QTY = 1 Then
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                            End If
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            If Inspection_QTY = 1 Then
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                            Else
                                Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                            End If
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            If Inspection_QTY = 1 Then
    
                                Send_Text.Box_Type(4).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                            Else
                                Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
                            If Inspection_QTY = 1 Then
                                Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                            Else
                                Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                            End If
                                                                                    
                                                                                    
                            '2009.04.15
                            If SYUKA_QTY > 1 Then
                                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            End If
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            Sendbuf = Text_Create_Proc()
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                
                
                        Else
                
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                            Else
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCANK                             '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK        '2007.04.21
'                            End If
                            
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then            '2012.09.05 j-->k
                                    
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If
                                End If
                            Next k
                                                                                    'ï\é¶ì‡óe
                            
                            If Y_SYU_CNT < 2 Then
    
 '                               If Inspection_QTY = 1 Then
    
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
 '                               Else
 '                                   Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
 '                                   Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
 '                               End If
                                                                                    
                            Else

'                                If Inspection_QTY = 1 Then
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                            End If
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
'                            Else
                                Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
'                            End If
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
'                            Else
                                Send_Text.Box_Type(4).Start_Pos = "01"                                              '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"                         '2007.04.21
'                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
'                            Else
                                Send_Text.Box_Type(4).Max_Size = "20"                                               '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"                          '2007.04.21
'                            End If
                                                                                    
                                                                                    
                            '2009.04.15
                            If SYUKA_QTY > 1 Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then       '2012.04.09
                                Else
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                End If                  '2012.04.09
                            
                            Else                                            '2012.11.15
                                ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""    '2012.11.15
                            End If
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            Sendbuf = Text_Create_Proc()
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                
                
                End Select
            
            Next i
'''''''''''''''''''''''''''''''
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            For i = 0 To M_Gyo - 1
                
                    
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 10))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2, "èoâ◊êîÅF"  'èoâ◊êî(åüïiêî)
                        
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN_ALL = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""        '2012.11.15
                        
            
            Y_SYU_CNT = 0
            SYUKA_QTY = 0
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                    End If
                End If
            Next j
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
        
                    '''ëºçsÇÃégópÇåpë±Ç∑ÇÈÇΩÇﬂ
                    '''Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    '''Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_DEN_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                                    
                                                    
                        Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
'2012.10.31                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_DEN_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_DEN_ALL = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                
                
                '--------------------   2012.10.02  Å§
                Else
                
                    Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
    
                    Do
                    
                        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                GoTo Abort_Tran
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                GoTo Abort_Tran
                            Case Else
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                
                    Loop
                
                
                    Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
'''''''''''''''                    ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                                'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                    Do
                        sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                GoTo Abort_Tran
                        
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Inspe_Proc_DEN_ALL = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                
                '--------------------   2012.10.02  Å¢
                
                
                End If
            
            Next j
            
            
'2012.11.15            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.31
            
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_DEN_ALL = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
                    
                    
                    
                    
                    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                    
            Select Case ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND
            
            
                Case "1"
                    'èWçáç´ïÔÇ»Çµ
                
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
'''' â◊éDèàíu
'                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
'                                ID_KANRI_TBL(ING_No).LABEL_ON = False
'                            Else
'
'                                PRINT_OFF = False
'
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
'                                    If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
'                                        PRINT_OFF = True
'                                    End If
'                                End If
'
'                                If Not PRINT_OFF Then
'
'                                    '2010.06.16
'                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'
'                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                    Select Case sts
'                                        Case BtNoErr
'
'                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            End If
'
'                                        Case BtErrKeyNotFound
'
'
'                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                        Case Else
'                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                            Sendbuf = Text_Create_Proc()
'                                            GoTo Abort_Tran
'                                    End Select
'
'
'                                    '2010.06.16
'
'                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
'                                    Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
'
'                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'                                    'Y_SYU_CNT = 0
'                                    SYUKA_QTY = 0
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                'Y_SYU_CNT = Y_SYU_CNT + 1
'                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'                                                    PRINT_OFF = True
'                                                Else
'
'                                                   ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
'
'                                                End If
'
'                                            End If
'                                        End If
'                                    Next j
'                                End If
'
'                                If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
'                                    PRINT_MAISU = PRINT_MAISU - 1
'                                    If PRINT_MAISU < 1 Then
'
'                                    'é}î‘çXêV   2010.02.15
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                        GoTo Abort_Tran
'
'                                                    End If
'
'
'                                                End If
'                                            Else
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                            GoTo Abort_Tran
'
'                                                        End If
'
'
'
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
'                                    'é}î‘çXêV   2010.02.15
'
'                                        PRINT_OFF = True
'
'                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
'
'
'                                    Else
''                                            PRINT_MAISU = PRINT_MAISU - 1
'                                        Start_Page_No = Start_Page_No + 1
'                                    End If
'                                End If
'
'                                If Not PRINT_OFF Then
'
'                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'                                    '2010.06.16
'                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                    '2010.06.16
'                                    Select Case sts
'                                        Case BtNoErr
'
'                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            End If
'
'                                        Case BtErrKeyNotFound
'
'
'                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                        Case Else
'                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                            Sendbuf = Text_Create_Proc()
'                                            GoTo Abort_Tran
'                                    End Select
'
'
''2010.02.21                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
''2010.02.21                                    Start_Page_No = Start_Page_No + 1
'
''2010.02.21                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'
'                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
'                                    End If
'
'
'
'                                    'é}î‘çXêV   2010.02.15
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And _
'                                                    (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'
'                                                        GoTo Abort_Tran
'                                                    End If
'
'
'                                                Else
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                        GoTo Abort_Tran
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Else
'                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                        GoTo Abort_Tran
'
'                                                    End If
'
'
'
'                                                End If
'
'
'
'                                            End If
'                                        End If
'                                    Next j
'                                    'ÉfÅ[É^ëóêM
'
'                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'
'                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
'
'                                    ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU - 1
'                                    '-----------------------------------------------ÉwÉbÉ_Å[
'
'                                    Call Wel_Head_Print_Text_Proc(fileName)
'
'                                    Sendbuf = Text_Create_Proc()
'
'
'                                    Inspe_Proc_DEN_ALL = False
'                                    Exit Function
'                                End If
'
'                            End If
'''' â◊éDèàíu
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
'                            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 1
                    
                            ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""        '2012.11.15
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
'''' â◊éDèàíu
'                                PRINT_OFF = False
'
'                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
'                                    PRINT_OFF = True
'                                Else
'                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
'
'                                        If KONPOU_ON = KONPOU_ON_SUMI Then
'
'                                            PRINT_OFF = True
'
'                                        End If
'
'                                    End If
'                                End If
'
'                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
'                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
'                                Else
'
'            '                        Y_SYU_CNT = 0
'            '                        SYUKA_QTY = 0
'
'                                    PRINT_OFF = False
'
'                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
'                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
'
'                                                        'é}î‘çXêV   2010.02.15
'                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'                                                    Start_Page_No = 1
'                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'
'
'
'                                                        'é}î‘çXêV   2010.02.15
'
'                                                        PRINT_OFF = True
'
'                                                    End If
'
'                                                Else
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                GoTo Abort_Tran
'
'                                                            End If
'
'
'                                                        End If
'
'                                                    End If
'                                                End If
'                                            Next j
'                                        End If
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'                                        '2010.06.16
'                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                        Select Case sts
'                                            Case BtNoErr
'
'                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                                End If
'
'                                            Case BtErrKeyNotFound
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            Case Else
'                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                                Sendbuf = Text_Create_Proc()
'                                                GoTo Abort_Tran
'                                        End Select
'
'                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
'                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
'
'                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
'                                            PRINT_MAISU = PRINT_MAISU - 1
'
'
'
'                                            If PRINT_MAISU < 1 Then
'
'                                                        'é}î‘çXêV   2010.02.15
'                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                GoTo Abort_Tran
'                                                            End If
'
'                                                        End If
'
'
'
'                                                    Else
'                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                    GoTo Abort_Tran
'                                                                End If
'
'
'
'                                                            End If
'
'                                                        End If
'
'
'
'                                                    End If
'                                                Next j
'                                                        'é}î‘çXêV   2010.02.15
'
'                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
'
'                                                PRINT_OFF = True
'                                            Else
'            '                                    PRINT_MAISU = PRINT_MAISU - 1
'                                                Start_Page_No = Start_Page_No + 1
'                                            End If
'                                        End If
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'                                        Y_SYU_CNT = 0
'                                        SYUKA_QTY = 0
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                    Y_SYU_CNT = Y_SYU_CNT + 1
'                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'                                                        PRINT_OFF = True
'                                                    Else
'
'                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
'
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
'                                        End If
'
'
'
'
'
'                                                        'é}î‘çXêV   2010.02.15
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'                                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And Start_Page_No = 2 Then
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'                                                    Else
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'                                                    End If
'
'                                                End If
'
'
'
'                                            Else
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'
'                                                    End If
'
'                                                End If
'
'
'
'
'
'                                            End If
'                                        Next j
'                                                        'é}î‘çXêV   2010.02.15
'
'
'
'
'                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
'                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
'                                        Else
'                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
'                                        End If
'
'
'                                        'ÉfÅ[É^ëóêM
'
'                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
'
'                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
'
'                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                        '-----------------------------------------------ÉwÉbÉ_Å[
'
'                                        Call Wel_Head_Print_Text_Proc(fileName)
'
'                                        Sendbuf = Text_Create_Proc()
'
'
'                                        Inspe_Proc_DEN_ALL = False
'                                        Exit Function
'
'                                    End If
'                                End If
'            ''' â◊éDèàíu
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
'2012.11.15                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                        'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                                Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                                Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '2012.11.15
                                Call Wel_OKURI_SAKI_PROC
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇP
                                
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                    
                                    
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.10
                                    '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    If sts <> BtNoErr Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    End If
                                            
                                                                
                                    For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                            'íPëÃç´ïÔÇPå˚éû
                                            If OKURI_NO_SEQ_Update_Proc(k, Format(1, "000"), Sendbuf, Format(TOTAL_KUTI_SU, "000")) Then
                                                GoTo Abort_Tran
                                            End If
                                            
                                        End If
                                    Next k
                                            
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                                    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    If sts <> BtNoErr Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpEndTransaction, "", 0)
                                        GoTo Abort_Tran
                                    End If
                                            
        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.10
                                
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                                
'                                ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 2
                        
                        End Select
                        
                
                
                Case "2"
                    'èWçáç´ïÔÇÃÇ›
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                    
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
'                            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 3
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''' â◊éDèàíu
                                PRINT_OFF = False
Debug.Print ID_KANRI_TBL(ING_No).KEN_TYPE
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                                    PRINT_OFF = True
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                                    
                                        If KONPOU_ON = KONPOU_ON_SUMI Then
                
                                            PRINT_OFF = True
                
                                        End If
                
                                    End If
                                End If
                                
                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
                                Else
                                    
            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
                                    
                                    PRINT_OFF = False
                                    
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                            
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                    
                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        Start_Page_No = 1
'2012.04.01                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01                                                        End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        PRINT_OFF = True
                                                    End If
                                                
                                                
                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                        
                                    
'2012.04.01                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                                GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                            End If
                                                        
                                                        
                                                        
                                                        End If
                                                                            
                                                    End If
                                                
                                                
                                                
                                                
                                                
                                                End If
                                            Next j
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                        '2010.06.16
                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                        '2010.06.16
                                        Select Case sts
                                            Case BtNoErr
                                            
                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                                
                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                                
                                                End If
                                            
                                            Case BtErrKeyNotFound
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            Case Else
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                GoTo Abort_Tran
                                        End Select
                                        
                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                                
                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                                
                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                        
                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                            PRINT_MAISU = PRINT_MAISU - 1
                                            If PRINT_MAISU < 1 Then
                                                
                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                        
                                                        'é}î‘çXêV   2010.02.15
'2012.04.01                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                                GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                            End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    Else
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                            
                                        
'2012.04.01                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                                    GoTo Abort_Tran
'2012.04.01                                                                End If
                                                                
                                                        
                                                            
                                                            End If
                                                                                
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    End If
                                                Next j
                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                                PRINT_OFF = True
                                            Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                                Start_Page_No = Start_Page_No + 1
                                            End If
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                        
                                        Y_SYU_CNT = 0
                                        SYUKA_QTY = 0
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                
                                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                                
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                        PRINT_OFF = True
                                                    Else
                                                
                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                    
                                                    End If
                                                
                                                End If
                                            End If
                                        Next j
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                        
                                        ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01

                                        
                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                        End If
                                        
                                        
                                        
                                        
                                        
                                        'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01                                                    End If
                                                End If
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
'2012.04.01                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01                                                        End If
                                                    
                                                    
                                                    End If
                                                                        
                                                End If
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            End If
                                        Next j
                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                        
                                        
                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                        Else
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                        End If
                                        
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                        GoTo Abort_Tran
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
                                        
                                        'ÉfÅ[É^ëóêM
                                                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
                                                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                        Call Wel_Head_Print_Text_Proc(fileName)
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
'                                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 4
                                    
                                        Inspe_Proc_DEN_ALL = False
                                        Exit Function
                                    
                                    End If
                                End If
            ''' â◊éDèàíu
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
'2012.11.15                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                        'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                                Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                                Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '2012.11.15
                                Call Wel_OKURI_SAKI_PROC
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇQ
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 5
            
                        End Select
                    
                Case "3"
                    'ç¨ç›
            
                    
                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
            
            
                    Select Case (KONPOU_ON - KONPOU_ON_SUMI)
            
                        Case 0
                            'å˚êîÇ÷
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------aaa------------------------------------ÇSçsñ⁄
'å˚êîinput ÇR
                            wkKONPO_F = ""
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                
                                    wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                    Exit For
                                End If
                            Next j
                            
                            If wkKONPO_F = "1" Then
                                                    
                                If Inspection_Input Then
                                    KUTI_SU_INPUT_F = False
                                Else
                                    KUTI_SU_INPUT_F = True
                                End If
                            
                            
                                TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                        
                            Else
                                TOTAL_KUTI_SU = 1
                                KUTI_SU_INPUT_F = True
                                TOTAL_SAI_SU = 0#
                            End If
                                        
                                        
                                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                            End If
                                        
                                        
                            If KUTI_SU_INPUT_F Then
                            
                                Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                                
                                                        
                            Else
                                Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                            
                                
                                
                                
                                
                                If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                            
                            
                            
                            End If
                        
                        
                            Sendbuf = Text_Create_Proc()
                        
                        
'                            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 6
                        
                        
                        
                        Case Else
                            'ïiî‘Ç÷
            
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                                        
                                                                                        'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                            
'                            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 7
                    
                    End Select
            
            End Select
                    
                    
                    
                    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Left(Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)), 6)
                    'å˚êî
                    Case LCD_KUTI_SU_S
                
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU < 0 Then
                        
                
                
                
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            
                            End If
                    
                            KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If KUTI_SU < 1 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        Else
                            KUTI_SU = ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU
                        End If
                    
                    
                    
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU < 0 Then
                        
                        
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            
                            End If
                    
                            SAI_SU = CDbl(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If SAI_SU <= 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN_ALL = False
                                Exit Function
                            End If
                        Else
                            SAI_SU = ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU
                        
                        
                            If SAI_SU < 1 Then
                                SAI_SU = 1
                            Else
                                If SAI_SU > 1 Then
                                    SAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                                End If
                            End If
                        
                        End If
                    
                        'ëóÇËèÛç≈ëÂàÛç¸ñáêîälìæ 2010.01.21
                            
                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                
                                    If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                Else
                                
                                    If Label_Print_Total_Su_Proc(0, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                End If
                            End If
                        Next j
                                        
                            
                            
                            
                        
                    
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                            Else
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU <= 1 Then
                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                    End If
                                
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                                
                                End If
                            End If
                        Next j
                        
                        
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN_ALL = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_DEN_ALL = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                
                                
                                
                                
                                
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                    'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                    If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                        If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                        End If
                                    Else
'''''''                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                        
                                        
                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                                                            
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                    
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN_SAV, Format(SAI_SU, "00.00"))
                                                    
                                                    
                                Else
                                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                        
                                        'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                        If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                            If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                            Else
                                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                            End If
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                                                                
                                        End If
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                
                                
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN_SAV, Format(SAI_SU, "00.00"))
                                
                                
                                
                                End If
                                                    
                                
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j

        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                   
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                    'IDáÇ
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
                
                                Do
                                
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                            
                                Loop
                                
                                
                                
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                                
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù

                        If ID_KANRI_TBL(ING_No).KEN_TYPE = "1" Then
                            
                            
                            
                            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            End If
                                    
                                                        
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                    'èWçáç´ïÔéû
                                    If OKURI_NO_SEQ_Update_Proc(k, Format(1, "000"), Sendbuf, Format(KUTI_SU, "000")) Then
                                        GoTo Abort_Tran
                                    End If
                                    
                                End If
                            Next k
                                    
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                            End If
                                    
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                            
                            ID_KANRI_TBL(ING_No).KEN_TYPE = ""

'2012.03.29

                            If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 0 Then
                                ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                            End If

    
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                    PRINT_OFF = True
                                End If
                            End If



                            PRINT_MAISU = KUTI_SU


                            Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
    
                            PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU


                            If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                PRINT_MAISU = PRINT_MAISU - 1
                                If PRINT_MAISU < 1 Then

                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then


                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then


                                                        'é}î‘çXêV   2010.02.15
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01                                                End If


                                                        'é}î‘çXêV   2010.02.15

                                            End If
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                    End If


                                                End If

                                            End If
                                        End If
                                    Next j



                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No




                                    PRINT_OFF = True
                                Else
'                                    PRINT_MAISU = PRINT_MAISU - 1
                                    Start_Page_No = Start_Page_No + 1

                                End If
                            End If

''' â◊éDèàíu
                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                ID_KANRI_TBL(ING_No).LABEL_ON = False
                            Else

'2012.03.30
'                                Y_SYU_CNT = 0
'                                SYUKA_QTY = 0
'
'                                PRINT_OFF = False
'
'                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                            Y_SYU_CNT = Y_SYU_CNT + 1
'                                            SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'
'                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'
'                                                PRINT_OFF = True
'                                            Else
'
'                                            End If
'                                        End If
'                                    End If
'                                Next j
'
'                                If Not PRINT_OFF Then
                                ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01

                                If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                End If




                                'é}î‘çXêV   2010.02.15
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then

                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then


                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01
'2012.04.01
'2012.04.01                                                End If

                                            Else


                                                    'é}î‘çXêV   2010.02.15
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01
'2012.04.01
'2012.04.01                                                End If

                                            End If

                                                    'é}î‘çXêV   2010.02.15





                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then


                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01                                                    End If
                                                Else

'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01                                                    End If



                                                End If
                                            End If
                                        End If
                                    End If
                                Next j
                                'é}î‘çXêV   2010.02.15
                                If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                Else
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                End If


                                ID_KANRI_TBL(ING_No).LABEL_STEP = 9

                                'ÉfÅ[É^ëóêM

                                ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ

                                ID_KANRI_TBL(ING_No).LABEL_ON = True

                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Print_Text_Proc(fileName)
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)

                                Sendbuf = Text_Create_Proc()

                                Inspe_Proc_DEN_ALL = False
                                Exit Function

                            End If
                        End If
'                        End If
''' â◊éDèàíu

                        KENPIN_END = True
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                            
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                    KENPIN_END = False
                                    Exit For
                                End If
                            End If
                        Next j

'                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15


                        Select Case KENPIN_END
                    
                            Case True
    
                            'éüÇÃçÏã∆óvãÅ

                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                                            
                                            
                                            
                                            
                                            
                    
                    
                            Case Else
                    
    ''''''''''''''''''''''''''''''''''''''''''''''
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                
                                '-----------------------------------------------ÇRçsñ⁄
                                Call Wel_HIN_NO_Req_Text_3_Proc
                                '-----------------------------------------------ÇSçsñ⁄
                                Call Wel_HIN_NO_Req_Text_4_Proc
                                
                                '-----------------------------------------------ÇRçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                    
                        End Select
                    
                    End Select
                
            Next i
        

        Case Step_PRINT_RES        'àÛç¸èIóπ
    
    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    
    
            Select Case ID_KANRI_TBL(ING_No).LABEL_STEP
                Case 1      'ïiî‘Ç÷
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------  2012.03.30
'
'                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
'
'                    '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
'                    Call Wel_Head_Text_Proc
'
'                    '-----------------------------------------------ÇPçsñ⁄
'                    Call Wel_DETAIL_0_Text_Proc
'                    '-----------------------------------------------ÇQçsñ⁄
'                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
'
'
'
'
'                    '-----------------------------------------------ÇRçsñ⁄
'                    Call Wel_HIN_NO_Req_Text_3_Proc
'                    '-----------------------------------------------ÇSçsñ⁄
'                    Call Wel_HIN_NO_Req_Text_4_Proc
'                    '-----------------------------------------------ÇTçsñ⁄
'                    Call Wel_Clear_Text_Proc
'
'                    Sendbuf = Text_Create_Proc()



                        
                        
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                        If RTrim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                            Exit For
                        End If
                    
                    Next j
                        
'                    Print_bara_F = False
'
'                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
'
'                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Cnt_Bara_Su < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
'                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Cnt_Bara_Su = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Cnt_Bara_Su + 1
'                        Print_bara_F = True
'                    Else
'                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Cnt_Hako_Su = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Cnt_Hako_Su + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
'                    End If
                    
                    
 



                   If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT Then
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                                                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                        End If
                                
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If ID_KANRI_TBL(ING_No).KEN_HINBAN = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO And _
                                Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                'íPëÃç´ïÔéû
                                If OKURI_NO_SEQ_Update_Proc(k, Format(ID_KANRI_TBL(ING_No).LAST_START_PAGE, "000"), Sendbuf, Format(ID_KANRI_TBL(ING_No).LAST_END_PAGE, "000")) Then
                                    GoTo Abort_Tran
                                End If
                                
                            End If
                        Next k
                                
                                
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        Else
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                        End If
                        
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                End If
                            End If
                        Next k
                                                                                    'ï\é¶ì‡óe
                            
                        If Y_SYU_CNT < 2 Then
    
'                                If Inspection_QTY = 1 Then
    
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
'                                End If
                                                                                    
                        Else
                            
'                                If Inspection_QTY = 1 Then
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                        End If
                                                                                    
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        End If
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
'                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.11.15 8
                        
                        Sendbuf = Text_Create_Proc()
                        Inspe_Proc_DEN_ALL = False
                        Exit Function
                
                
                    Else
                
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                            
                            
                            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                            Else
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCANK                             '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK        '2007.04.21
'                            End If
                            
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                End If
                            End If
                        Next k
                                                                                    'ï\é¶ì‡óe
                            
                        If Y_SYU_CNT < 2 Then
    
 '                               If Inspection_QTY = 1 Then
    
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
 '                               Else
 '                                   Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
 '                                   Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
 '                               End If
                                                                                    
                        Else

'                                If Inspection_QTY = 1 Then
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                        End If
                                                                                
                                                                                    'êîílèâä˙ï\é¶
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
'                            Else
                        Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
'                            End If
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
'                            Else
                        Send_Text.Box_Type(4).Start_Pos = "01"                                              '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"                         '2007.04.21
'                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
'                            Else
                        Send_Text.Box_Type(4).Max_Size = "20"                                               '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"                          '2007.04.21
'                            End If
                                                                                    
                                                                                    
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then     '2012.04.13
                            Else
                                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            End If                  '2012.04.13
                        End If
                                                                            
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                        Inspe_Proc_DEN_ALL = False
                        Exit Function
                    End If
                    
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------  2012.03.30
                
                Case 2      'å˚êîÇ÷
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Call Wel_Head_Text_Proc
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    
                    '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                            'BOXëÆê´
'2012.11.15                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                            'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                            'êîílèâä˙ï\é¶
'2012.11.15                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                            'ì¸óÕåÖêî
'2012.11.15                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '2012.11.15
                    Call Wel_OKURI_SAKI_PROC
                    
                    '-----------------------------------------------ÇSçsñ⁄
'å˚êîÅ@ÇS
                    wkKONPO_F = ""
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                    
                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                        
                            wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                            Exit For
                        End If
                    Next j
                    
                    If wkKONPO_F = "1" Then
                                            
                        If Inspection_Input Then
                            KUTI_SU_INPUT_F = False
                        Else
                            KUTI_SU_INPUT_F = True
                        End If
                    
                    
                        TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                        TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                
                    Else
                        TOTAL_KUTI_SU = 1
                        KUTI_SU_INPUT_F = True
                        TOTAL_SAI_SU = 0#
                    End If
                                
                                
                                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                    End If
                                
                                
                    If KUTI_SU_INPUT_F Then
                    
                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                    
                    Else
                        Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                    
                    
                    
                        If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                    
                    
                    
                    
                    
                    
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                    
                    
                    
                    End If
                    
                    Sendbuf = Text_Create_Proc()
                
                Case 9
        
                    Select Case (Y_SYU_CNT - Sumi_CNT)
                
                        Case 0
                
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                            End Select
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                            
                            Sendbuf = Text_Create_Proc()
            
            
                        Case Else
                        
        ''''''''''''''''''''''''''''''''''''''''''''''
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            '-----------------------------------------------ÇTçsñ⁄
                            Call Wel_Clear_Text_Proc
        
                            Sendbuf = Text_Create_Proc()
        
            
                End Select
            End Select
    
    End Select
                    
                    

    Inspe_Proc_DEN_ALL = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
Private Function Inspe_Proc_DEN(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'
'       2006.12.07
'
'
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07


Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Long

Dim SAI_SU          As Double

Dim UNSOU_KAISHA    As String
 
Dim SYUKA_YMD       As String
Dim JYUSHO          As String
Dim BIKOU           As String

Dim SURYO           As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag

Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean

'2010.01.21
Dim KONPOU_ON           As Integer




Dim KONPOU_ON_SUMI      As Integer
Dim KONPOU_OFF          As Integer
Dim KONPOU_OFF_SUMI     As Integer



Dim PRINT_OFF           As Boolean
Dim Start_Page_No       As Long
Dim PRINT_TOTAL_SU      As Long
Dim PRINT_MAISU         As Long
Dim fileName            As String
Dim ID_SEQ              As Integer
Dim DISP_SAI_SU         As Double

Dim wkKUTI_SU           As String
Dim wkKONPO_F           As String * 1

Dim TOTAL_KUTI_SU       As Integer
Dim TOTAL_SAI_SU        As Double
Dim MUKE_NAME           As String
Dim OKURI_NO_MAX        As Integer
Dim KUTI_SU_INPUT_F     As Boolean

Dim KEN_TEL_NO          As String * 20


Dim OKURI_NO_F          As Boolean
'2010.01.21


Dim FUKUYAMA_CHK_F      As Boolean

    Inspe_Proc_DEN = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, _
                                                SYUKA_YMD, _
                                                JYUSHO, _
                                                BIKOU, _
                                                Start_Page_No, _
                                                KUTI_SU, _
                                                MUKE_NAME, _
                                                OKURI_NO_MAX, , , _
                                                KEN_TEL_NO)
                        
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                                
                        
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                                                    
                            Next j
                                                     
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            End If
                        End If
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        End If
                                                 
                        If Sumi_CNT = Y_SYU_CNT And Start_Page_No <> 0 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        
                        End If
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_CND = Y_SYU_TBL(j).KONPOU_CND    '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).TOTAL_SU = Y_SYU_TBL(j).TOTAL_SU        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = Y_SYU_TBL(j).SAI_SU            '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = Y_SYU_TBL(j).KUTI_SU          '2010.01.21
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = Y_SYU_TBL(j).PRINT_SUMI    '2010.01.21
                        
                                                                                                        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = Y_SYU_TBL(j).OKURI_NO_SEQ
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        'èoâ◊ì˙
                        ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = SYUKA_YMD
                        'èZèä
                        ID_KANRI_TBL(ING_No).KEN_JYUSHO = JYUSHO
                        
                        'îıçl
                        ID_KANRI_TBL(ING_No).KEN_BIKOU = BIKOU
                        'å¸ÇØêÊ
                        ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = MUKE_NAME
                        
                        'é}î‘
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO_MAX = OKURI_NO_MAX
                        'ìdòbî‘çÜ
                        ID_KANRI_TBL(ING_No).KEN_TEL_NO = KEN_TEL_NO
                        
                        
                        
                        '◊ÕﬁŸäJénÉyÅ[ÉWáÇ
                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                        
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                        
                    
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        
                        
                        
                        End If
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                        
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                        If KONPOU_ON <> 0 Then
                            If KONPOU_ON = KONPOU_ON_SUMI Then
                                                    
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                                    
                            End If
                        End If
                        
                        
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                
                
                
                        Else
                
                
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                                                                                    'BOXëÆê´
                                                                                    
                                                                                    
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI          '2011.03.17
                            
                            
Select Case KONPOU_ON                           '2011.03.17
                    
''''''''''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)     '2011.03.17
                            
                                Case 0
                                'èWçáç´ïÔÇ»Çµ
                                
                                    
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                        If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        
                                        
                                        
                                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                            
                                            '-----------------------------------------------ÉwÉbÉ_Å[
                                            Call Wel_Head_Text_Proc
                                            '-----------------------------------------------ÇPçsñ⁄
                                            Call Wel_DETAIL_0_Text_Proc
                                            '-----------------------------------------------ÇQçsñ⁄
                                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                            '-----------------------------------------------ÇRçsñ⁄
                                                                                                    'BOXëÆê´
                                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                    'ï\é¶ì‡óe
                                                                                                    
                                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                                    
                                                                                                    'êîílèâä˙ï\é¶
                                            Send_Text.Box_Type(2).INIT = ""
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                                            Send_Text.Box_Type(2).Start_Pos = ""
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                    'ì¸óÕåÖêî
                                            Send_Text.Box_Type(2).Max_Size = "00"
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                    
                                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                        
                                        
                                        
                                        
                                        
                                            TOTAL_KUTI_SU = 1
                                            KUTI_SU_INPUT_F = True
                                            TOTAL_SAI_SU = 0#
                                                
                                                
                                                
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                            End If
                                                
                                                
                                    
                                            Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                            ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                    
                                    
                                    
                                            Sendbuf = Text_Create_Proc()
                                        
                                            Inspe_Proc_DEN = False
                                            Exit Function
                                        
                                        
                                        End If
                                    End If
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    
                                    
                                    
                                    '-----------------------------------------------É{ÉfÉB
                                    Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
            
                                    Sendbuf = Text_Create_Proc()
                                Case Else
                                'èWçáç´ïÔÇ†ÇË
                                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                            
                                    '-----------------------------------------------ÇQçsñ⁄
                                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                    '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                            'ï\é¶ì‡óe
                                                                                            
                                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(2).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(2).Start_Pos = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(2).Max_Size = "00"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                            'ï\é¶ì‡óe
                                                                                        'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = "01"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(3).Max_Size = "13"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇTçsñ⁄
                                    Call Wel_Clear_Text_Proc
            
                                    Sendbuf = Text_Create_Proc()
                            
                            End Select
                        End If
                
                
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
'2009.10.14                         If Len(OKURI_NO) < 11 Or Len(OKURI_NO) > 13 Then
'                            If Len(OKURI_NO) < 10 Or Len(OKURI_NO) > 13 Then
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                Inspe_Proc_DEN = False
'                                Exit Function
'                            End If
                        
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            End If
                        
                        
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                                                
                            End If
                        
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        
                        
                        
                        
                        
'                            Select Case Len(Trim(OKURI_NO))
'
'                                Case FUKUYAMA_Length
'                                Case SEIBU_Length
'                                Case KURUME_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(KURUME_CODE) Then
'
'
'                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                        Sendbuf = Text_Create_Proc()
'                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                        Inspe_Proc_DEN = False
'                                        Exit Function
'
'                                    End If
'
'                                Case SAGAWA_Length, YAMATO_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(SAGAWA_CODE) Then
'
'                                        For k = 0 To UBound(YAMATO_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                Exit For
'                                            End If
'
'                                        Next k
'
'                                        If k > UBound(YAMATO_CODE) Then
'
'                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                            Sendbuf = Text_Create_Proc()
'                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                            Inspe_Proc_DEN = False
'                                            Exit Function
'
'
'
'                                        End If
'
'                                    End If
'
'
'                            End Select
                        
                        End If
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                            
                                'â^ëóâÔé–ïœä∑
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                                End If
'                                'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                                If KURUME_F Then        'ãvóØïƒ
'                                    For k = 1 To UBound(KURUME)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If FUKUYAMA_F Then      'ïüéR
'                                    For k = 1 To UBound(FUKUYAMA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If SAGAWA_F Then        'ç≤êÏ
'                                    For k = 1 To UBound(SAGAWA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
                                                    
                                                    
                                                    
                                                    
                                                    




                                                    
                                                    
                                                    
                                                    
'                                Select Case Len(Trim(OKURI_NO))
'
'                                    Case FUKUYAMA_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
'                                    Case SEIBU_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
'
'                                    Case KURUME_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(KURUME_CODE) Then
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
'                                        End If
'
'                                    Case SAGAWA_Length, YAMATO_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(SAGAWA_CODE) Then
'
'                                            For k = 0 To UBound(YAMATO_CODE)
'
'                                                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                    Exit For
'                                                End If
'
'                                            Next k
'
'                                            If k > UBound(YAMATO_CODE) Then
'                                            Else
'
'                                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
'                                            End If
'
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
'                                        End If
'
'
'                                End Select
                                                    
                                                    
                                                    
                                                    
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                                    
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
                                                                                'BOXëÆê´
                                                                                
                                                                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI              '2011.03.17
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
Select Case KONPOU_ON                               '2011.03.17
'''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)     '2011.03.17



                        
                            Case 0
                            'èWçáç´ïÔÇ»Çµ
                            
                                
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    
                                    
                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                        
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Call Wel_Head_Text_Proc
                                        '-----------------------------------------------ÇPçsñ⁄
                                        Call Wel_DETAIL_0_Text_Proc
                                        '-----------------------------------------------ÇQçsñ⁄
                                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                                                                                
                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                                
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(2).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(2).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(2).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    
                                    
                                    
                                    
                                    
                                    
                                        TOTAL_KUTI_SU = 1
                                        KUTI_SU_INPUT_F = True
                                        TOTAL_SAI_SU = 0#
                                            
                                            
                                            
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                        End If
                                            
                                            
                                
                                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                
                                        Sendbuf = Text_Create_Proc()
                                    
                                        Inspe_Proc_DEN = False
                                        Exit Function
                                    
                                    
                                    End If
                                End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                
                                
                                
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
        
                                Sendbuf = Text_Create_Proc()
                            Case Else
                            'èWçáç´ïÔÇ†ÇË
                        
                        
                                'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg 2011.03.04
                                Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                        'ï\é¶ì‡óe
                                                                                    'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                '2010.12.07
'                                Send_Text.Box_Type(3).Max_Size = "13"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                Send_Text.Box_Type(3).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                '2010.12.07
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                    End Select
                Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                'èWçáç´ïÔóLÇËéûÇÃïiî‘É`ÉFÉbÉN
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        End If
                        
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND <> "1" Then
                        
                            If KONPOU_ON <> KONPOU_ON_SUMI Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                            
                            
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    Exit Function
                            
                                End If
                            End If
                        
                        End If
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next j
                                            
                            If j <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        Else
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                        End If
                        
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                                                                                'ï\é¶ì‡óe
                        
                        If Y_SYU_CNT < 2 Then

                            If Inspection_QTY = 1 Then

                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
                            End If
                                                                                
                        Else
                        
                            If Inspection_QTY = 1 Then
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
                            End If
                        
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                
                        End If
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
            
            Next i
'''''''''''''''''''''''''''''''
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            For i = 0 To M_Gyo - 1
                
'                Select Case RTrim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), _
'                                Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 10))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2, "èoâ◊êîÅF"  'èoâ◊êî(åüïiêî)
                        
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_DEN = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            Y_SYU_CNT = 0
            SYUKA_QTY = 0
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                    End If
                End If
            Next j
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
        
                    '''ëºçsÇÃégópÇåpë±Ç∑ÇÈÇΩÇﬂ
                    '''Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    '''Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_DEN = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        'â^ëóâÔé–ïœä∑
'                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                        End If
'                        'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                        If KURUME_F Then        'ãvóØïƒ
'                            For k = 1 To UBound(KURUME)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If FUKUYAMA_F Then      'ïüéR
'                            For k = 1 To UBound(FUKUYAMA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If SAGAWA_F Then        'ç≤êÏ
'                            For k = 1 To UBound(SAGAWA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_DEN = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_DEN = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_DEN = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                End If
            
            Next j
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_DEN = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
                    
                    
                    
                    
                    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                    
            Select Case ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND
            
            
                Case "1"
                    'èWçáç´ïÔÇ»Çµ
                
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
''' â◊éDèàíu
                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
                                ID_KANRI_TBL(ING_No).LABEL_ON = False
                            Else
                            
                                PRINT_OFF = False
                                
                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                    If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                        PRINT_OFF = True
                                    End If
                                End If
                                
                                If Not PRINT_OFF Then
                                
                                    '2010.06.16
                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                            
                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    Select Case sts
                                        Case BtNoErr
                                        
                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                            
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            End If
                                        
                                        Case BtErrKeyNotFound
                                        
                                        
                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                        
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                
                                
                                    '2010.06.16
                                
                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                            
                                    Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                            
                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                
                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                    
                                    'Y_SYU_CNT = 0
                                    SYUKA_QTY = 0
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                    
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                            
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                            
                                                'Y_SYU_CNT = Y_SYU_CNT + 1
                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                            
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                    PRINT_OFF = True
                                                Else
                                            
                                                   ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                
                                                End If
                                            
                                            End If
                                        End If
                                    Next j
                                End If
                                
                                If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                    PRINT_MAISU = PRINT_MAISU - 1
                                    If PRINT_MAISU < 1 Then
                                        
                                    'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                        
                                                        GoTo Abort_Tran
                                                    
                                                    End If
                                                                                                    
                                                
                                                End If
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    End If
                                                                        
                                                End If
                                            End If
                                        Next j
                                    'é}î‘çXêV   2010.02.15
                                        
                                        PRINT_OFF = True
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                    
                                    
                                    Else
'                                            PRINT_MAISU = PRINT_MAISU - 1
                                        Start_Page_No = Start_Page_No + 1
                                    End If
                                End If
                                
                                If Not PRINT_OFF Then
                                                            
                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                    '2010.06.16
                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    '2010.06.16
                                    Select Case sts
                                        Case BtNoErr
                                        
                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                            
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            End If
                                        
                                        Case BtErrKeyNotFound
                                        
                                        
                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                        
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                                            
                                                            
'2010.02.21                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                            
'2010.02.21                                    Start_Page_No = Start_Page_No + 1
                                                            
'2010.02.21                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                                            
                                    ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01
                                                            
                                                            
                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                    End If
                                
                                
                                
                                    'é}î‘çXêV   2010.02.15
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                        
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            
                                                If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And _
                                                    (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then

                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                    
                                                        GoTo Abort_Tran
                                                    End If
                                            
                                            
                                                Else
                                            
                                            
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                    
                                                        GoTo Abort_Tran
                                                    End If
                                            
                                                End If
                                            End If
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                
                            
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    
                                                    End If
                                                
                                                
                                                
                                                End If
                                                                    
                                                                    
                                                                    
                                            End If
                                        End If
                                    Next j
                                    'é}î‘çXêV   2010.02.15
                                
                                
                                
                                
'2010.02.21                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
'                                    Else
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
'                                    End If
                                    
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                    GoTo Abort_Tran
'                                                End If
'
'                                            End If
'                                        End If
'                                    Next j
                                    
                                    'ÉfÅ[É^ëóêM
                                                                
                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                                
                                                                
                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                
                                    ID_KANRI_TBL(ING_No).LABEL_ON = True
                                
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU - 1
                                    '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                    Call Wel_Head_Print_Text_Proc(fileName)
                                
                                    Sendbuf = Text_Create_Proc()
                                    
                                
                                    Inspe_Proc_DEN = False
                                    Exit Function
                                End If
                            
                            End If
''' â◊éDèàíu
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''' â◊éDèàíu
                                PRINT_OFF = False
            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                                    PRINT_OFF = True
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                                    
                                        If KONPOU_ON = KONPOU_ON_SUMI Then
                
                                            PRINT_OFF = True
                
                                        End If
                
                                    End If
                                End If
                                
                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
                                Else
                                    
            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
                                    
                                    PRINT_OFF = False
                                    
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                            
                                                        'é}î‘çXêV   2010.02.15
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                    Start_Page_No = 1
                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                        
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                    
                                                        PRINT_OFF = True
                                        
                                                    End If
                                                
                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                        
                                    
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                    
                                                        
                                                        End If
                                                                            
                                                    End If
                                                End If
                                            Next j
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                        '2010.06.16
                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                        Select Case sts
                                            Case BtNoErr
                                            
                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                                
                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                                
                                                End If
                                            
                                            Case BtErrKeyNotFound
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            Case Else
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                GoTo Abort_Tran
                                        End Select
                                        
                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                                
                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                                
                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                        
                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                            PRINT_MAISU = PRINT_MAISU - 1
                                            
                                            
                                            
                                            If PRINT_MAISU < 1 Then
                                                
                                                        'é}î‘çXêV   2010.02.15
                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                            
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            End If
                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    Else
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                            
                                        
                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                    
                                                                    GoTo Abort_Tran
                                                                End If
                                                            
                                                            
                                                        
                                                            End If
                                                                                
                                                        End If
                                                    
                                                    
                                                    
                                                    End If
                                                Next j
                                                        'é}î‘çXêV   2010.02.15
                                                
                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                                
                                                PRINT_OFF = True
                                            Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                                Start_Page_No = Start_Page_No + 1
                                            End If
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                        
                                        Y_SYU_CNT = 0
                                        SYUKA_QTY = 0
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                
                                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                                
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                        PRINT_OFF = True
                                                    Else
                                                
                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                    
                                                    End If
                                                
                                                End If
                                            End If
                                        Next j
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                        
                                        
                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                        End If
                                        
                                        
                                        
                                        
                                        
                                                        'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                                        
                                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And Start_Page_No = 2 Then
                                                    
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    Else
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    End If
                                                
                                                End If
                                            
                                            
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    
                                                    End If
                                                                        
                                                End If
                
                                            
                                            
                                            
                                            
                                            End If
                                        Next j
                                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                        
                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                        Else
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                        End If
                                        
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                        GoTo Abort_Tran
'                                                    End If
'                                                End If
'                                            End If
'                                        Next j
                                        
                                        'ÉfÅ[É^ëóêM
                                                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
                                                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                        Call Wel_Head_Print_Text_Proc(fileName)
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
                                    
                                        Inspe_Proc_DEN = False
                                        Exit Function
                                    
                                    End If
                                End If
            ''' â◊éDèàíu
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇP
                                
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                    
                                    
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                        
                
                
                Case "2"
                    'èWçáç´ïÔÇÃÇ›
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                    
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''' â◊éDèàíu
                                PRINT_OFF = False
            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                                    PRINT_OFF = True
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                                    
                                        If KONPOU_ON = KONPOU_ON_SUMI Then
                
                                            PRINT_OFF = True
                
                                        End If
                
                                    End If
                                End If
                                
                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
                                Else
                                    
            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
                                    
                                    PRINT_OFF = False
                                    
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                            
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                    
                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        Start_Page_No = 1
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        PRINT_OFF = True
                                                    End If
                                                
                                                
                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                        
                                    
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                        
                                                        
                                                        
                                                        End If
                                                                            
                                                    End If
                                                
                                                
                                                
                                                
                                                
                                                End If
                                            Next j
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                        '2010.06.16
                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                        '2010.06.16
                                        Select Case sts
                                            Case BtNoErr
                                            
                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                                
                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                                
                                                End If
                                            
                                            Case BtErrKeyNotFound
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            Case Else
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                GoTo Abort_Tran
                                        End Select
                                        
                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                                
                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                                
                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                        
                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                                            PRINT_MAISU = PRINT_MAISU - 1
                                            If PRINT_MAISU < 1 Then
                                                
                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                        
                                                        'é}î‘çXêV   2010.02.15
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    Else
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                            
                                        
                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                    
                                                                    GoTo Abort_Tran
                                                                End If
                                                                
                                                        
                                                            
                                                            End If
                                                                                
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    End If
                                                Next j
                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                                PRINT_OFF = True
                                            Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                                Start_Page_No = Start_Page_No + 1
                                            End If
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                        
                                        Y_SYU_CNT = 0
                                        SYUKA_QTY = 0
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                
                                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                                
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                        PRINT_OFF = True
                                                    Else
                                                
                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                    
                                                    End If
                                                
                                                End If
                                            End If
                                        Next j
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                        
                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                        End If
                                        
                                        
                                        
                                        
                                        
                                        'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                End If
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    
                                                    
                                                    End If
                                                                        
                                                End If
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            End If
                                        Next j
                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                        
                                        
                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                        Else
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                        End If
                                        
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                        GoTo Abort_Tran
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
                                        
                                        'ÉfÅ[É^ëóêM
                                                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
                                                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                        Call Wel_Head_Print_Text_Proc(fileName)
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
                                    
                                        Inspe_Proc_DEN = False
                                        Exit Function
                                    
                                    End If
                                End If
            ''' â◊éDèàíu
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇQ
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                    
                Case "3"
                    'ç¨ç›
            
                    
                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
            
            
                    Select Case (KONPOU_ON - KONPOU_ON_SUMI)
            
                        Case 0
                            'å˚êîÇ÷
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------aaa------------------------------------ÇSçsñ⁄
'å˚êîinput ÇR
                            wkKONPO_F = ""
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                
                                    wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                    Exit For
                                End If
                            Next j
                            
                            If wkKONPO_F = "1" Then
                                                    
                                If Inspection_Input Then
                                    KUTI_SU_INPUT_F = False
                                Else
                                    KUTI_SU_INPUT_F = True
                                End If
                            
                            
                                TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                        
                            Else
                                TOTAL_KUTI_SU = 1
                                KUTI_SU_INPUT_F = True
                                TOTAL_SAI_SU = 0#
                            End If
                                        
                                        
                                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                            End If
                                        
                                        
                            If KUTI_SU_INPUT_F Then
                            
                                Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                            
                            
                            Else
                                Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                            
                                
                                
                                
                                
                                If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                            
                            
                            
                            End If
                        
                        
                            Sendbuf = Text_Create_Proc()
                        
                        
                        
                        
                        
                        Case Else
                            'ïiî‘Ç÷
            
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                                        
                                                                                        'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    End Select
            
            End Select
                    
                    
                    
                    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Left(Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)), 6)
                    'å˚êî
                    Case LCD_KUTI_SU_S
                
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU < 0 Then
                        
                
                
                
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            
                            End If
                    
                            KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If KUTI_SU < 1 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            End If
                        Else
                            KUTI_SU = ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU
                        End If
                    
                    
                    
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU < 0 Then
                        
                        
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            
                            End If
                    
                            SAI_SU = CDbl(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If SAI_SU <= 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_DEN = False
                                Exit Function
                            End If
                        Else
                            SAI_SU = ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU
                        
                        
                            If SAI_SU < 1 Then
                                SAI_SU = 1
                            Else
                                If SAI_SU > 1 Then
                                    SAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                                End If
                            End If
                        
                        End If
                    
                        'ëóÇËèÛç≈ëÂàÛç¸ñáêîälìæ 2010.01.21
                            
                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                
                                    If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                Else
                                
                                    If Label_Print_Total_Su_Proc(0, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                End If
                            End If
                        Next j
                                        
                            
                            
                            
                        
'                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
'
'                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            Exit Function
'                        End If
                    
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                            Else
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU <= 1 Then
                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                    End If
                                
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                                
                                End If
                            End If
                        Next j
                        
                        
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_DEN = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_DEN = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                
                                
                                
                                
                                
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                    'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                    If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                        If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                        End If
                                    Else
'''''''                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                        
                                        
                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                                                            
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                    
                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN_SAV, Format(SAI_SU, "00.00"))
                                                    
                                                    
                                Else
                                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                        
                                        'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                        If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                            If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                            Else
                                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                            End If
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                                                                
                                        End If
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                
                                
                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN_SAV, Format(SAI_SU, "00.00"))
                                
                                
                                
                                End If
                                                    
                                
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                

'                        Call Syuka_KUTI_SU_Count_Proc(TOTAL_KUTI_SU)

        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                   
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                    'IDáÇ
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
                
                                Do
                                
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                            
                                Loop
                                
                                
                                
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                                
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_DEN = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_DEN = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù

                            
'                        PRINT_OFF = False
'
'                        If KONPOU_OFF = KONPOU_OFF_SUMI Then
'
'                            PRINT_OFF = True
'
'                        End If

                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 0 Then
                            ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        End If


                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) Then
                            If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                PRINT_OFF = True
                            End If
                        End If



                        PRINT_MAISU = KUTI_SU
                                                
                                                
                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1

                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU


                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD)) Then
                            PRINT_MAISU = PRINT_MAISU - 1
                            If PRINT_MAISU < 1 Then
                                
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                                                        'é}î‘çXêV   2010.02.15
                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                
                                                GoTo Abort_Tran
                                            End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                        
                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                            
                        
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                    
                                                    
                                                    GoTo Abort_Tran
                                                
                                                End If
                                            
                                            
                                            End If
                                                                
                                        End If
                                    End If
                                Next j
                                
                                
                                
                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                
                                
                                
                                
                                PRINT_OFF = True
                            Else
'                                PRINT_MAISU = PRINT_MAISU - 1
                                Start_Page_No = Start_Page_No + 1
                            
                            End If
                        End If

''' â◊éDèàíu
                        If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                            ID_KANRI_TBL(ING_No).LABEL_ON = False
                        Else
                                
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            
                            PRINT_OFF = False
                            
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                    
                                    
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                        
                                            PRINT_OFF = True
                                        Else
                                    
                                        End If
                                    End If
                                End If
                            Next j
                                
                            If Not PRINT_OFF Then
                                
                                If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                End If
                            
                            
                            
                            
                                'é}î‘çXêV   2010.02.15
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                    
                                                    GoTo Abort_Tran
                                                
                                                
                                                End If
                        
                                            Else
                        
                        
                                                        'é}î‘çXêV   2010.02.15
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                    
                                                    GoTo Abort_Tran
                                                
                                                
                                                End If
                                                        
                                            End If
                                                        
                                                        'é}î‘çXêV   2010.02.15
                        
                        
                        
                        
                        
                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                            
                        
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                Else
                                                
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                                        
                                                
                                                End If
                                            End If
                                        End If
                                    End If
                                Next j
                                'é}î‘çXêV   2010.02.15
                            
                            
                            
'                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU
                                
                                If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                Else
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                End If
                                
'                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                            If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                GoTo Abort_Tran
'                                            End If
'
'                                        End If
'                                    End If
'                                Next j
                            
                                ID_KANRI_TBL(ING_No).LABEL_STEP = 9
                                
                                'ÉfÅ[É^ëóêM
                                                            
                                ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                            
                                ID_KANRI_TBL(ING_No).LABEL_ON = True
                            
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Print_Text_Proc(fileName)
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
                            
                                Sendbuf = Text_Create_Proc()
                            
                                Inspe_Proc_DEN = False
                                Exit Function
                            
                            End If

''' â◊éDèàíu
                        End If

                        KENPIN_END = True
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                            
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                    KENPIN_END = False
                                    Exit For
                                End If
                            End If
                        Next j



                        Select Case KENPIN_END
                    
                            Case True
    
                            'éüÇÃçÏã∆óvãÅ

                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                                            
                                            
                                            
                                            
                                            
                    
                    
                            Case Else
                    
    ''''''''''''''''''''''''''''''''''''''''''''''
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                
                                '-----------------------------------------------ÇRçsñ⁄
                                Call Wel_HIN_NO_Req_Text_3_Proc
                                '-----------------------------------------------ÇSçsñ⁄
                                Call Wel_HIN_NO_Req_Text_4_Proc
                                
                                '-----------------------------------------------ÇRçsñ⁄
'                                                                                        'BOXëÆê´
'                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                                        'ï\é¶ì‡óe
'
'                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'
'
'                                                                                        'êîílèâä˙ï\é¶
'                                Send_Text.Box_Type(2).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'                                Send_Text.Box_Type(2).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                                        'ì¸óÕåÖêî
'                                Send_Text.Box_Type(2).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                                '-----------------------------------------------ÇSçsñ⁄
'                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                                        'ï\é¶ì‡óe
'                                                                                    'ï\é¶ì‡óe
'                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                                                                        'êîílèâä˙ï\é¶
'                                Send_Text.Box_Type(3).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'                                Send_Text.Box_Type(3).Start_Pos = "01"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                                        'ì¸óÕåÖêî
'                                Send_Text.Box_Type(3).Max_Size = "13"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
'
'                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                    
                        End Select
                    
                    End Select
                
            Next i
        

        Case Step_PRINT_RES        'àÛç¸èIóπ
    
    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    
            '-----------------------------------------------ÉwÉbÉ_Å[
            Call Wel_Head_Text_Proc
    
            Select Case ID_KANRI_TBL(ING_No).LABEL_STEP
                Case 1      'ïiî‘Ç÷
                                                                            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                            
                    '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                    Call Wel_Head_Text_Proc
                                                                            
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    
                    
                    
                    
                    '-----------------------------------------------ÇRçsñ⁄
                    Call Wel_HIN_NO_Req_Text_3_Proc
                    '-----------------------------------------------ÇSçsñ⁄
                    Call Wel_HIN_NO_Req_Text_4_Proc
                    
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
'                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                            'ï\é¶ì‡óe
'
'                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'
'
'                                                                            'êîílèâä˙ï\é¶
'                    Send_Text.Box_Type(2).INIT = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'                                                                            'èâä˙ÉJÅ[É\Éãà íu
'                    Send_Text.Box_Type(2).Start_Pos = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                            'ì¸óÕåÖêî
'                    Send_Text.Box_Type(2).Max_Size = "00"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                    '-----------------------------------------------ÇSçsñ⁄
'                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                            'ï\é¶ì‡óe
'                                                                        'ï\é¶ì‡óe
'                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                                                            'êîílèâä˙ï\é¶
'                    Send_Text.Box_Type(3).INIT = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                            'èâä˙ÉJÅ[É\Éãà íu
'                    Send_Text.Box_Type(3).Start_Pos = "01"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                            'ì¸óÕåÖêî
'                    Send_Text.Box_Type(3).Max_Size = "13"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
'
'                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                    Call Wel_Clear_Text_Proc

                    Sendbuf = Text_Create_Proc()
                
                Case 2      'å˚êîÇ÷
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Call Wel_Head_Text_Proc
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    
                    
                    '-----------------------------------------------ÇSçsñ⁄
'å˚êîÅ@ÇS
                    wkKONPO_F = ""
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                    
                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                        
                            wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                            Exit For
                        End If
                    Next j
                    
                    If wkKONPO_F = "1" Then
                                            
                        If Inspection_Input Then
                            KUTI_SU_INPUT_F = False
                        Else
                            KUTI_SU_INPUT_F = True
                        End If
                    
                    
                        TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                        TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                
                    Else
                        TOTAL_KUTI_SU = 1
                        KUTI_SU_INPUT_F = True
                        TOTAL_SAI_SU = 0#
                    End If
                                
                                
                                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                    End If
                                
                                
                    If KUTI_SU_INPUT_F Then
                    
                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                    
                    
                    Else
                        Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                    
                    
                    
                        If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                    
                    
                    
                    
                    
                    
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                    
                    
                    
                    End If
                    
                    Sendbuf = Text_Create_Proc()
                
                Case 9
        
                    Select Case (Y_SYU_CNT - Sumi_CNT)
                
                        Case 0
                
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                            End Select
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                            
                            Sendbuf = Text_Create_Proc()
            
            
                        Case Else
                        
        ''''''''''''''''''''''''''''''''''''''''''''''
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            '-----------------------------------------------ÇTçsñ⁄
                            Call Wel_Clear_Text_Proc
        
                            Sendbuf = Text_Create_Proc()
        
            
                End Select
            End Select
    
    End Select
                    
                    

    Inspe_Proc_DEN = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function



Private Function Inspe_Proc_LOGISTIC_ALL(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'       'ÉçÉWÉXÉeÉbÉNÉXëŒâû
'       2010.02.25
'
'       ëSêîåüïiëŒâû    2012.03.21
'
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07


Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Long

Dim SAI_SU          As Double

Dim UNSOU_KAISHA    As String
 
Dim SYUKA_YMD       As String
Dim JYUSHO          As String
Dim BIKOU           As String

Dim SURYO           As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag

Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean

'2010.01.21
Dim KONPOU_ON           As Integer


Dim KONPOU_ON_SUMI      As Integer
Dim KONPOU_OFF          As Integer
Dim KONPOU_OFF_SUMI     As Integer
Dim PRINT_OFF           As Boolean
Dim Start_Page_No       As Long
Dim PRINT_TOTAL_SU      As Long
Dim PRINT_MAISU         As Long
Dim fileName            As String
Dim ID_SEQ              As Integer
Dim DISP_SAI_SU         As Double

Dim wkKUTI_SU           As String
Dim wkKONPO_F           As String * 1

Dim TOTAL_KUTI_SU       As Integer
Dim TOTAL_SAI_SU        As Double
Dim MUKE_NAME           As String
Dim OKURI_NO_MAX        As Integer
Dim KUTI_SU_INPUT_F     As Boolean

Dim KEN_TEL_NO          As String * 20

Dim LOGIXTICS_F         As Boolean

Dim OKURI_NO_F          As Boolean
'2010.01.21
Dim FUKUYAMA_CHK_F      As Boolean

Dim Cnt_F               As Boolean  '2012.03.31
Dim Print_bara_F        As Boolean  '2012.03.31

Dim Hin_Total           As Long     '2012.04.07

Dim KEN_HINBAN          As String * 20      '2012.10.02

    Inspe_Proc_LOGISTIC_ALL = True

    LOGIXTICS_F = True
    
    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        '2012.10.02Å@KEN_HINBANí«â¡
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, _
                                                SYUKA_YMD, _
                                                JYUSHO, _
                                                BIKOU, _
                                                Start_Page_No, _
                                                KUTI_SU, _
                                                MUKE_NAME, _
                                                OKURI_NO_MAX, , , _
                                                KEN_TEL_NO, _
                                                KEN_HINBAN)
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        End If
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                                                 
                        If Sumi_CNT = Y_SYU_CNT And Start_Page_No <> 0 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        
                        End If
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_CND = Y_SYU_TBL(j).KONPOU_CND    '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).TOTAL_SU = Y_SYU_TBL(j).TOTAL_SU        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = Y_SYU_TBL(j).SAI_SU            '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = Y_SYU_TBL(j).KUTI_SU          '2010.01.21
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = Y_SYU_TBL(j).PRINT_SUMI    '2010.01.21
                        
                                                                                                        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = Y_SYU_TBL(j).OKURI_NO_SEQ
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = Y_SYU_TBL(j).CNT_BARA_SU      'åüïié¿ê—Å@ÉoÉâ
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = Y_SYU_TBL(j).CNT_HAKO_SU      'åüïié¿ê—Å@î†
                            
                
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = Y_SYU_TBL(j).Y_HIN_CHK_CNT  'ïiî‘ì«çûÇ›âÒêî
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = Y_SYU_TBL(j).J_HIN_CHK_CNT  'ïiî‘ì«çûÇ›çœÇ›âÒêî

'2012.11.15                            ID_KANRI_TBL(ING_No).KEN_HINBAN = KEN_HINBAN
                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        'èoâ◊ì˙
                        ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = SYUKA_YMD
                        'èZèä
                        ID_KANRI_TBL(ING_No).KEN_JYUSHO = JYUSHO
                        
                        'îıçl
                        ID_KANRI_TBL(ING_No).KEN_BIKOU = BIKOU
                        'å¸ÇØêÊ
                        ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = MUKE_NAME
                        
                        'é}î‘
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO_MAX = OKURI_NO_MAX
                        'ìdòbî‘çÜ
                        ID_KANRI_TBL(ING_No).KEN_TEL_NO = KEN_TEL_NO
                        
                         'åüïi ﬂ¿∞›  2012.03.31
                        ID_KANRI_TBL(ING_No).KEN_TYPE = ""
            
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                '2012.11.15
                        ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = KEN_HINBAN    '2012.11.15
                        
                        '◊ÕﬁŸäJénÉyÅ[ÉWáÇ
                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                        
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                        
                    
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        
                        
                        
                        End If
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                        
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                        If KONPOU_ON <> 0 Then
                            If KONPOU_ON = KONPOU_ON_SUMI Then
                                                    
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                                    
                            End If
                        End If
                                   
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                
                
                
                        Else
                
                
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                                                                                    'BOXëÆê´
                                                                                    
                                                                                    
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                            
                            KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI   '2011.03.17
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            Select Case KONPOU_ON    '2011.03.17
                            
                            
''''''''''2011.03.17Select Case (KONPOU_ON - KONPOU_ON_SUMI)
                                Case 0
                                'èWçáç´ïÔÇ»Çµ
                                
                                    
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                        If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                            '-----------------------------------------------ÉwÉbÉ_Å[
                                            Call Wel_Head_Text_Proc
                                            '-----------------------------------------------ÇPçsñ⁄
                                            Call Wel_DETAIL_0_Text_Proc
                                            '-----------------------------------------------ÇQçsñ⁄
                                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                                    'BOXëÆê´
'2012.11.15                                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                                    'ì¸óÕåÖêî
'2012.11.15                                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                            '2012.11.15
                                            Call Wel_OKURI_SAKI_PROC
                                        
                                        
                                            TOTAL_KUTI_SU = 1
                                            KUTI_SU_INPUT_F = True
                                            TOTAL_SAI_SU = 0#
                                                
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                            End If
                                    
                                            Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                            ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_TYPE = "1"         '2012.03.31
                                    
                                            Sendbuf = Text_Create_Proc()
                                        
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            Exit Function
                                        End If
                                    End If
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    
                                    
                                    
                                    '-----------------------------------------------É{ÉfÉB
                                    Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
            
                                    Sendbuf = Text_Create_Proc()
                                Case Else
                                'èWçáç´ïÔÇ†ÇË
                            
                                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                                    '-----------------------------------------------ÇQçsñ⁄
                                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                    '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                            'BOXëÆê´
'2012.11.15                                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                            'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                            'êîílèâä˙ï\é¶
'2012.11.15                                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                            'ì¸óÕåÖêî
'2012.11.15                                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '2012.11.15
                                    Call Wel_OKURI_SAKI_PROC
                                    '-----------------------------------------------ÇSçsñ⁄
                                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                            'ï\é¶ì‡óe
                                                                                        'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = "01"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                            'ì¸óÕåÖêî
                                    '2010.12.07
'                                    Send_Text.Box_Type(3).Max_Size = "13"
'                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                    Send_Text.Box_Type(3).Max_Size = "13"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                    '2010.12.07
                                                                                            
                                                                                            
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇTçsñ⁄
                                    Call Wel_Clear_Text_Proc
            
                                    Sendbuf = Text_Create_Proc()
                            
                            End Select
                        End If
                        
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
                        
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            If Not OKURI_NO_F Then
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                                                
                            End If
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        End If
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ÉçÉWÉXÉeÉBÉNÉX")
                                            
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                            
'                                End If
                                
                                
                                
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
                                                                                'BOXëÆê´
                                                                                
                                                                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI '2011.03.17
    
                        ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        Select Case KONPOU_ON  '2011.03.17
'''''''''''''''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)    '2011.03.17
                            Case 0
                            'èWçáç´ïÔÇ»Çµ
                            
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                
                                If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        
                                        
                                        
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                            
                                            '-----------------------------------------------ÉwÉbÉ_Å[
                                        Call Wel_Head_Text_Proc
                                            '-----------------------------------------------ÇPçsñ⁄
                                        Call Wel_DETAIL_0_Text_Proc
                                            '-----------------------------------------------ÇQçsñ⁄
                                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                                    'BOXëÆê´
'2012.11.15                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                                    'ì¸óÕåÖêî
'2012.11.15                                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        '2012.11.15
                                        Call Wel_OKURI_SAKI_PROC
                                        
                                        TOTAL_KUTI_SU = 1
                                        KUTI_SU_INPUT_F = True
                                        TOTAL_SAI_SU = 0#
                                                
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                        End If
                                    
                                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
    
                                    
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        Exit Function
                                        
                                        
                                    End If
                                End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                            '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
            
                                Sendbuf = Text_Create_Proc()
                            Case Else
                            'èWçáç´ïÔÇ†ÇË
                        
                                'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                                    '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                    '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                        'BOXëÆê´
'2012.11.15                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                        'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                                Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                                Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '2012.11.15
                                Call Wel_OKURI_SAKI_PROC
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                        'ï\é¶ì‡óe
                                                                                    'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                '2010.12.07
'                               Send_Text.Box_Type(3).Max_Size = "13"
'                               ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                Send_Text.Box_Type(3).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                '2010.12.07
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                        
                            End Select
                        End Select
                    Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban, "èoâ◊"   'ïiî‘/èoâ◊êîÅiïiî‘Åj
                        If Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2) = "èoâ◊" Then
                            Cnt_F = True
                        Else
                            ID_KANRI_TBL(ING_No).LAST_START_PAGE = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1 '2012.04.01
                        End If
                        
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                'èWçáç´ïÔóLÇËéûÇÃïiî‘É`ÉFÉbÉN
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                        
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND <> "1" Then
                        
                            If KONPOU_ON <> KONPOU_ON_SUMI Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                            
                            
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    Exit Function
                            
                                End If
                            End If
                        
                        End If
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next k
                                            
                            If k <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02-->2012.11.15 KEN_HINBAN-->KEN_ING_HINBAN
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) Then
                            If Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) <> "" Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ëºïiî‘åüïiíÜÅI", ID_KANRI_TBL(ING_No).KEN_ING_HINBAN)
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        End If
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02
                        
                        
                        If Cnt_F Then
                        
                            If RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) <> RTrim(Hinban) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, ID_KANRI_TBL(ING_No).KEN_HINBAN, "ïiî‘ÉGÉâÅ[")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                        Print_bara_F = False
                
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1
                            End If
                        
                            
                            '2012.04.07
                            Hin_Total = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If ID_KANRI_TBL(ING_No).KEN_HINBAN = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then                '2012.09.05
                                    
                                        Hin_Total = Hin_Total + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If                                                                  '2012.09.05
                                End If
                            Next k
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)) + _
                            '                                                            (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO - _
                            '                                                            ((CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY)
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)) + _
                                                                                        (Hin_Total - _
                                                                                        ((CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY)
                            '2012.04.07
                            
                            
                            Print_bara_F = False
                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1 Then
                                'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO   2012.04.09
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = Hin_Total                                    '2012.04.09
                                Print_bara_F = True
                            Else
                                'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = CLng(ToRoundUp(CCur(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO Mod ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0))
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = CLng(ToRoundUp(CCur(Hin_Total Mod ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0))    '2012.04.09
                            End If
                            
                            
                            
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            '
                            'If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 1
                            'Else
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            'End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                            
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                        
                        End If
                        
                        If Cnt_F Then
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                                Print_bara_F = True
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                        
                        
                        End If

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02
                        '----------------------------------- ÉgÉâÉìÉUÉNÉVÉáÉìäJén -----------
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If


                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
'2012.10.02                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
'2012.10.02
'2012.10.02                                '------------------------------------   èoâ◊ó\íËÇÃèàóù
'2012.10.02                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
'2012.10.02
'2012.10.02
'2012.10.02                                Do
'2012.10.02
'2012.10.02                                    sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.10.02                                    Select Case sts
'2012.10.02                                        Case BtNoErr
'2012.10.02                                            Exit Do
'2012.10.02                                        Case BtErrKeyNotFound
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_LOGISTIC_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_LOGISTIC_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                        Case Else
'2012.10.02                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
'2012.10.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                    End Select
'2012.10.02
'2012.10.02                                Loop
'2012.10.02
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
'2012.10.02
'2012.10.02
'2012.10.02
'2012.10.02                                Do
'2012.10.02
'2012.10.02                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.10.02                                    Select Case sts
'2012.10.02                                        Case BtNoErr
'2012.10.02                                            Exit Do
'2012.10.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_LOGISTIC_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                        Case Else
'2012.10.02                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
'2012.10.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                    End Select
'2012.10.02
'2012.10.02                                Loop
'2012.10.02
'2012.10.02
'2012.10.02
'2012.10.02                            End If
                            '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
                
                
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
    

                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
    
                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))

                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
                            End If
                        
                            Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, ID_KANRI_TBL(ING_No).KEN_HINBAN)

                        
                            Do
                            
                                sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                        Next k
                        
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            Exit Function
                        End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> â◊éDî≠çsèàóù    2012.03.30
                        PRINT_OFF = False
    
    
                            
    
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                            PRINT_OFF = True
                        Else
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                            
''                                If KONPOU_ON = KONPOU_ON_SUMI Then
        
                                    PRINT_OFF = True

''                                End If
        
                            End If
                        End If

'                        PRINT_OFF = False

                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                            Not LOGIXTICS_F Then
                            If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                PRINT_OFF = True
                            End If
                        End If


                        '2012.09.05
                        If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
                                PRINT_OFF = True
                        End If
                        '2012.09.05


                        If Not PRINT_OFF Then


                            Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                            Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                            Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
                            '2010.06.16
                            sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            Select Case sts
                                Case BtNoErr
                                    If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then

                                        Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                    End If

                                Case BtErrKeyNotFound

                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                Case Else
                                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select


                            If Print_bara_F Then
                                PRINT_MAISU = Val(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                            Else
                                PRINT_MAISU = Val(StrConv(ITEMREC.KUTI_SU, vbUnicode)) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If



                            Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
    
                            PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
    
                            ID_KANRI_TBL(ING_No).LABEL_STEP = 1

                            'Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then

                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then

                                        'Y_SYU_CNT = Y_SYU_CNT + 1
                                       SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO

                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).PRINT_SUMI Then
                                            PRINT_OFF = True
                                        Else

'2012.03.                                           ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).PRINT_SUMI = True

                                        End If

                                    End If
                                End If
                            Next k
                        End If

                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                               Not LOGIXTICS_F) Then
                            PRINT_MAISU = PRINT_MAISU - 1
                            If PRINT_MAISU < 1 Then

                            'é}î‘çXêV   2010.02.15
                                For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                    If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then

                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then

'2012.04.01                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                GoTo Abort_Tran
'2012.04.01
'2012.04.01                                            End If


                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KONPOU_F <> "1" Then


'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                End If



                                            End If

                                        End If
                                    End If
                                Next k
                                'é}î‘çXêV   2010.02.15

                                PRINT_OFF = True

                                ID_KANRI_TBL(ING_No).LABEL_ON = True

                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No

                            Else
'                                            PRINT_MAISU = PRINT_MAISU - 1
                                Start_Page_No = Start_Page_No + 1
                            End If
                        End If

                        If Not PRINT_OFF Then

                            Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                            Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                            Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)

                            sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            Select Case sts
                                Case BtNoErr

                                    If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then


                                        Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                    End If

                                Case BtErrKeyNotFound


                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                Case Else
                                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select


'2010.02.21                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))

'2010.02.21                                    Start_Page_No = Start_Page_No + 1

'2010.02.21                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                            ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01

                            If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                            End If



                            'é}î‘çXêV   2010.02.15
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then

                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then

                                        If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And _
                                            (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                              Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                               Not LOGIXTICS_F) Then

'2012.04.01                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'2012.04.01
'2012.04.01                                                GoTo Abort_Tran
'2012.04.01                                            End If


                                        Else


'2012.04.01                                            If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                GoTo Abort_Tran
'2012.04.01                                            End If

                                        End If
                                    End If
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KONPOU_F <> "1" Then

'2012.04.01                                            If OKURI_NO_SEQ_Update_Proc(k, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                GoTo Abort_Tran
'2012.04.01
'2012.04.01                                            End If



                                        End If



                                    End If
                                End If
                            Next k
                                    'é}î‘çXêV   2010.02.15




'2010.02.21                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
'                                    Else
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
'                                    End If

'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                    GoTo Abort_Tran
'                                                End If
'
'                                            End If
'                                        End If
'                                    Next j

                                    'ÉfÅ[É^ëóêM

                            ID_KANRI_TBL(ING_No).LABEL_STEP = 1


                            ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ

                            ID_KANRI_TBL(ING_No).LABEL_ON = True

                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU - 1
                            '-----------------------------------------------ÉwÉbÉ_Å[

                            Call Wel_Head_Print_Text_Proc(fileName)

                            Sendbuf = Text_Create_Proc()


                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If

''' â◊éDèàíu
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> â◊éDî≠çsèàóù    2012.03.30
                
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT Then


                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True

                
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc

    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                             'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"

                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                            If Inspection_QTY = 1 Then

                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            Else
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                            End If
                            
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                                    If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                
                                                Y_SYU_CNT = Y_SYU_CNT + 1
                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                        End If
                                    End If
                            Next k
                                                                                'ï\é¶ì‡óe
                        
                        If Y_SYU_CNT < 2 Then

'                            If Inspection_QTY = 1 Then

                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
'                            Else
'                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
'                            End If
                                                                                
                        Else
                        
'                            If Inspection_QTY = 1 Then
                                
                                
                                'Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")                          '2012.04.10
                                'Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")     '2012.04.10
                                                                                                                                                                    '2012.04.10
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                                                                                                                                                    '2012.04.10
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                            Else
'                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                            End If
                        
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        Else                                            '2012.11.15
                            ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""    '2012.11.15
                        End If
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                
                        Inspe_Proc_LOGISTIC_ALL = False
                        Exit Function
                
                
                Else
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                   'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
'                       If Inspection_QTY = 1 Then
'
'                           Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                               ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                       Else
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCANK                             '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK        '2007.04.21
'                       End If
                            
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then                '2012.09.05 j-->k
                                    
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                End If
                            End If
                        Next k
                                                                                    'ï\é¶ì‡óe
                            
                        If Y_SYU_CNT < 2 Then
    
 '                          If Inspection_QTY = 1 Then
    
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
 '                              Else
 '                                      Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
 '                                  Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
 '                              End If
                                                                                        
                        Else

'                                If Inspection_QTY = 1 Then
                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                            End If
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
'                            Else
                                Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
'                            End If
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
'                            Else
                                Send_Text.Box_Type(4).Start_Pos = "01"                                              '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"                         '2007.04.21
'                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
'                            Else
                                Send_Text.Box_Type(4).Max_Size = "20"                                               '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"                          '2007.04.21
'                            End If
                                                                                    
                                                                                    
                            '2009.04.15
                            If SYUKA_QTY > 1 Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then        '2012.04.09
                                Else
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                End If                  '2012.04.09
                            End If
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            Sendbuf = Text_Create_Proc()
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                End Select
            
            Next i
'''''''''''''''''''''''''''''''
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            For i = 0 To M_Gyo - 1
                
'                Select Case RTrim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), _
'                                Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 10))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2, "èoâ◊êîÅF"  'èoâ◊êî(åüïiêî)
                        
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC_ALL = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""        '2012.11.15
            
            
            Y_SYU_CNT = 0
            SYUKA_QTY = 0
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                    End If
                End If
            Next j
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
        
                    '''ëºçsÇÃégópÇåpë±Ç∑ÇÈÇΩÇﬂ
                    '''Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    '''Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
'2012.10.31                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                '--------------------   2012.10.02  Å§
                Else
                
                    Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
    
                    Do
                    
                        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                GoTo Abort_Tran
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                GoTo Abort_Tran
                            Case Else
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                
                    Loop
                
                
                    Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
'''''''''''''''                    ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                                'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                    Do
                        sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                GoTo Abort_Tran
                        
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                
                '--------------------   2012.10.02  Å¢
                End If
            
            Next j
'2012.11.15            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.31
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
                    
                    
                    
                    
                    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                    
            Select Case ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND
            
            
                Case "1"
                    'èWçáç´ïÔÇ»Çµ
                
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
'''' â◊éDèàíu
'                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
'                                ID_KANRI_TBL(ING_No).LABEL_ON = False
'                            Else
'
'                                PRINT_OFF = False
'
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
'                                    Not LOGIXTICS_F Then
'                                    If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
'                                        PRINT_OFF = True
'                                    End If
'                                End If
'
'                                If Not PRINT_OFF Then
'
'
'                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'                                    '2010.06.16
'                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                    Select Case sts
'                                        Case BtNoErr
'
'                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            End If
'
'                                        Case BtErrKeyNotFound
'
'                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                        Case Else
'                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                            Sendbuf = Text_Create_Proc()
'                                            GoTo Abort_Tran
'                                    End Select
'
'
'
'
'
'
'
'                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
'                                    Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
'
'                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'                                    'Y_SYU_CNT = 0
'                                    SYUKA_QTY = 0
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                'Y_SYU_CNT = Y_SYU_CNT + 1
'                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'                                                    PRINT_OFF = True
'                                                Else
'
'                                                   ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
'
'                                                End If
'
'                                            End If
'                                        End If
'                                    Next j
'                                End If
'
'                                If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
'                                                       Not LOGIXTICS_F) Then
'                                    PRINT_MAISU = PRINT_MAISU - 1
'                                    If PRINT_MAISU < 1 Then
'
'                                    'é}î‘çXêV   2010.02.15
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                        GoTo Abort_Tran
'
'                                                    End If
'
'
'                                                End If
'                                            Else
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                            GoTo Abort_Tran
'
'                                                        End If
'
'
'
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
'                                    'é}î‘çXêV   2010.02.15
'
'                                        PRINT_OFF = True
'
'                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
'
'
'                                    Else
''                                            PRINT_MAISU = PRINT_MAISU - 1
'                                        Start_Page_No = Start_Page_No + 1
'                                    End If
'                                End If
'
'                                If Not PRINT_OFF Then
'
'                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'
'                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                    Select Case sts
'                                        Case BtNoErr
'
'                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            End If
'
'                                        Case BtErrKeyNotFound
'
'
'                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                        Case Else
'                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                            Sendbuf = Text_Create_Proc()
'                                            GoTo Abort_Tran
'                                    End Select
'
'
''2010.02.21                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
''2010.02.21                                    Start_Page_No = Start_Page_No + 1
'
''2010.02.21                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'
'                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
'                                    End If
'
'
'
'                                    'é}î‘çXêV   2010.02.15
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And _
'                                                    (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                      Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
'                                                       Not LOGIXTICS_F) Then
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'
'                                                        GoTo Abort_Tran
'                                                    End If
'
'
'                                                Else
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                        GoTo Abort_Tran
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Else
'                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                        GoTo Abort_Tran
'
'                                                    End If
'
'
'
'                                                End If
'
'
'
'                                            End If
'                                        End If
'                                    Next j
'                                    'é}î‘çXêV   2010.02.15
'
'
'
'
''2010.02.21                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
''                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
''                                    Else
''                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
''                                    End If
'
''                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
''
''                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
''
''                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
''
''                                                If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
''                                                    GoTo Abort_Tran
''                                                End If
''
''                                            End If
''                                        End If
''                                    Next j
'
'                                    'ÉfÅ[É^ëóêM
'
'                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'
'                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
'
'                                    ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU - 1
'                                    '-----------------------------------------------ÉwÉbÉ_Å[
'
'                                    Call Wel_Head_Print_Text_Proc(fileName)
'
'                                    Sendbuf = Text_Create_Proc()
'
'
'                                    Inspe_Proc_LOGISTIC_ALL = False
'                                    Exit Function
'                                End If
'
'                            End If
''' â◊éDèàíu
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            
                            
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            
                            
                            
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
''' â◊éDèàíu
'                                PRINT_OFF = False
'
'                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
'                                    PRINT_OFF = True
'                                Else
'                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
'
'                                        If KONPOU_ON = KONPOU_ON_SUMI Then
'
'                                            PRINT_OFF = True
'
'                                        End If
'
'                                    End If
'                                End If
'
'                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
'                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
'                                Else
'
'            '                        Y_SYU_CNT = 0
'            '                        SYUKA_QTY = 0
'
'                                    PRINT_OFF = False
'
'                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
'                                        Not LOGIXTICS_F Then
'                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
'
'                                                        'é}î‘çXêV   2010.02.15
'                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'                                                    Start_Page_No = 1
'                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'
'
'
'                                                        'é}î‘çXêV   2010.02.15
'
'                                                        PRINT_OFF = True
'
'                                                    End If
'
'                                                Else
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                GoTo Abort_Tran
'
'                                                            End If
'
'
'                                                        End If
'
'                                                    End If
'                                                End If
'                                            Next j
'                                        End If
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
'
'                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'                                        Select Case sts
'                                            Case BtNoErr
'
'                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
'
'                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                                End If
'
'                                            Case BtErrKeyNotFound
'
'                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
'
'                                            Case Else
'                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
'                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                                Sendbuf = Text_Create_Proc()
'                                                GoTo Abort_Tran
'                                        End Select
'
'                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
'
'                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
'
'                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
'
'                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
'                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
'                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
'                                                               Not LOGIXTICS_F) Then
'                                            PRINT_MAISU = PRINT_MAISU - 1
'
'
'
'                                            If PRINT_MAISU < 1 Then
'
'                                                        'é}î‘çXêV   2010.02.15
'                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                GoTo Abort_Tran
'                                                            End If
'
'                                                        End If
'
'
'
'                                                    Else
'                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'
'                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'
'                                                                    GoTo Abort_Tran
'                                                                End If
'
'
'
'                                                            End If
'
'                                                        End If
'
'
'
'                                                    End If
'                                                Next j
'                                                        'é}î‘çXêV   2010.02.15
'
'                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
'
'                                                PRINT_OFF = True
'                                            Else
'            '                                    PRINT_MAISU = PRINT_MAISU - 1
'                                                Start_Page_No = Start_Page_No + 1
'                                            End If
'                                        End If
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
'
'                                        Y_SYU_CNT = 0
'                                        SYUKA_QTY = 0
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                    Y_SYU_CNT = Y_SYU_CNT + 1
'                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'                                                        PRINT_OFF = True
'                                                    Else
'
'                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
'
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
'                                    End If
'
'                                    If Not PRINT_OFF Then
'
'                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
'                                        End If
'
'
'
'
'
'                                                        'é}î‘çXêV   2010.02.15
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'                                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And Start_Page_No = 2 Then
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'                                                    Else
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'                                                    End If
'
'                                                End If
'
'
'
'                                            Else
'                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
'                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
'
'
'                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'
'                                                            GoTo Abort_Tran
'                                                        End If
'
'                                                    End If
'
'                                                End If
'
'
'
'
'
'                                            End If
'                                        Next j
'                                                        'é}î‘çXêV   2010.02.15
'
'
'
'
'                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
'                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
'                                        Else
'                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
'                                        End If
'
''                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
''
''                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
''
''                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
''
''
''
''                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
''                                                        GoTo Abort_Tran
''                                                    End If
''                                                End If
''                                            End If
''                                        Next j
'
'                                        'ÉfÅ[É^ëóêM
'
'                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
'
'                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
'
'                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
'
'                                        '-----------------------------------------------ÉwÉbÉ_Å[
'
'                                        Call Wel_Head_Print_Text_Proc(fileName)
'
'                                        Sendbuf = Text_Create_Proc()
'
'
'                                        Inspe_Proc_LOGISTIC_ALL = False
'                                        Exit Function
'
'                                    End If
'                                End If
            ''' â◊éDèàíu
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' ïiî‘ëSêîåüïiÇ…à⁄ä«  2012.03.30
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                        'BOXëÆê´
'2012.11.15                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                        'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                                Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                                Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                                Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '2012.11.15
                                Call Wel_OKURI_SAKI_PROC
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇP
                                
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    
                                    
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                    
                                    
                                    
                                    
                                    
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.10
                                    '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    If sts <> BtNoErr Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    End If
                                            
                                                                
                                    For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                            'íPëÃç´ïÔÇPå˚éû
                                            If OKURI_NO_SEQ_Update_Proc(k, Format(1, "000"), Sendbuf, Format(TOTAL_KUTI_SU, "000")) Then
                                                GoTo Abort_Tran
                                            End If
                                            
                                        End If
                                    Next k
                                            
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                                    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    If sts <> BtNoErr Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpEndTransaction, "", 0)
                                        GoTo Abort_Tran
                                    End If
                                            
        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.10
                                
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                        
                
                
                Case "2"
                    'èWçáç´ïÔÇÃÇ›
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
''' â◊éDèàíu
                            PRINT_OFF = False

                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then '                                    PRINT_OFF = True
                            Else
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then

                                    If KONPOU_ON = KONPOU_ON_SUMI Then

                                        PRINT_OFF = True

                                    End If

                                End If
                            End If

                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                ID_KANRI_TBL(ING_No).LABEL_ON = False
                            Else

            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
'
                                PRINT_OFF = False

                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                    Not LOGIXTICS_F Then
                                    If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then

                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then

                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then






                                                    'é}î‘çXêV   2010.02.15
                                                    Start_Page_No = 1
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01                                                    End If
                                                    'é}î‘çXêV   2010.02.15
                                                    PRINT_OFF = True
                                                End If


                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                     If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
    
    
'2012.04.01                                                         If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                             GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                         End If
    
    
    
                                                     End If
    
                                                 End If





                                            End If
                                        Next j
                                    End If
                                End If

                                If Not PRINT_OFF Then

                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)

                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    Select Case sts
                                        Case BtNoErr

                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then

                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                            End If

                                        Case BtErrKeyNotFound

                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")

                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select

                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))

                                    Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1

                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU

                                    If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                            Not LOGIXTICS_F) Then
                                        PRINT_MAISU = PRINT_MAISU - 1
                                        If PRINT_MAISU < 1 Then

                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then

                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then

                                                    'é}î‘çXêV   2010.02.15
'2012.04.01                                                       If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                        End If


                                                        'é}î‘çXêV   2010.02.15



                                                    End If






                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
    
    
'2012.04.01                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                                GoTo Abort_Tran
'2012.04.01                                                            End If
    
    
    
                                                        End If
                                                    End If
                                                End If
                                            Next j
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                            PRINT_OFF = True
                                        Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                            Start_Page_No = Start_Page_No + 1
                                        End If
                                    End If
                                End If

                                If Not PRINT_OFF Then

                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1

                                    Y_SYU_CNT = 0
                                    SYUKA_QTY = 0
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then

                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then

                                                Y_SYU_CNT = Y_SYU_CNT + 1
                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO

                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                    PRINT_OFF = True
                                                Else

                                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True

                                                End If

                                            End If
                                        End If
                                    Next j
                                End If

                                If Not PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01

                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                    End If
                                    'é}î‘çXêV   2010.02.15
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then

                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01                                                End If
                                            End If

                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then


'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01                                                    End If


                                                End If

                                            End If







                                        End If
                                    Next j
                                    'é}î‘çXêV   2010.02.15





                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                    Else
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                    End If


                                    'ÉfÅ[É^ëóêM

                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 2

                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ

                                    ID_KANRI_TBL(ING_No).LABEL_ON = True

                                    '-----------------------------------------------ÉwÉbÉ_Å[

                                    Call Wel_Head_Print_Text_Proc(fileName)

                                    Sendbuf = Text_Create_Proc()


                                    Inspe_Proc_LOGISTIC_ALL = False
                                    Exit Function

                                End If
                            End If
            ''' â◊éDèàíu
                                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------aaa------------------------------------ÇSçsñ⁄
'å˚êîINPUT ÇQ
                            wkKONPO_F = ""
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                
                                    wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                    Exit For
                                End If
                            Next j
                            
                            If wkKONPO_F = "1" Then
                                                    
                                If Inspection_Input Then
                                    KUTI_SU_INPUT_F = False
                                Else
                                    KUTI_SU_INPUT_F = True
                                End If
                            
                            
                                TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                        
                            Else
                                TOTAL_KUTI_SU = 1
                                KUTI_SU_INPUT_F = True
                                TOTAL_SAI_SU = 0#
                            End If
                                            
                                            
                                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                            End If
                                        
                                        
                            If KUTI_SU_INPUT_F Then
                            
                                Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                            
                                ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                            
                            Else
                                Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                            
                                If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                            
                            
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                            
                            
                            
                            End If
                                
                            Sendbuf = Text_Create_Proc()
                    
                    End Select
                    
                Case "3"
                    'ç¨ç›
            
                    
                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
            
            
                    Select Case (KONPOU_ON - KONPOU_ON_SUMI)
            
                        Case 0
                            'å˚êîÇ÷
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------aaa------------------------------------ÇSçsñ⁄
'å˚êîinput ÇR
                            wkKONPO_F = ""
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                
                                    wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                    Exit For
                                End If
                            Next j
                            
                            If wkKONPO_F = "1" Then
                                                    
                                If Inspection_Input Then
                                    KUTI_SU_INPUT_F = False
                                Else
                                    KUTI_SU_INPUT_F = True
                                End If
                            
                            
                                TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                        
                            Else
                                TOTAL_KUTI_SU = 1
                                KUTI_SU_INPUT_F = True
                                TOTAL_SAI_SU = 0#
                            End If
                                        
                                        
                                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                            End If
                                        
                                        
                            If KUTI_SU_INPUT_F Then
                            
                                Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_TYPE = "1"

                            
                            Else
                                Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                            
                                
                                If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                            
                            
                            
                            End If
                        
                        
                            Sendbuf = Text_Create_Proc()
                        
                        
                        
                        
                        
                        Case Else
                            'ïiî‘Ç÷
            
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    End Select
            
            End Select
                    
                    
                    
                    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Left(Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)), 6)
                    'å˚êî
                    Case LCD_KUTI_SU_S
                
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU < 0 Then
                        
                
                
                
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            
                            End If
                    
                            KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If KUTI_SU < 1 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        Else
                            KUTI_SU = ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU
                        End If
                    
                    
                    
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU < 0 Then
                        
                        
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            
                            End If
                    
                            SAI_SU = CDbl(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If SAI_SU <= 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC_ALL = False
                                Exit Function
                            End If
                        Else
                            SAI_SU = ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU
                        
                            If SAI_SU < 1 Then
                                SAI_SU = 1
                            Else
                                If SAI_SU > 1 Then
                                    SAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                                End If
                            End If
                        
                        
                        End If
                    
                        'ëóÇËèÛç≈ëÂàÛç¸ñáêîälìæ 2010.01.21
                            
                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                
                                    If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                Else
                                
                                    If Label_Print_Total_Su_Proc(0, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                End If
                            End If
                        Next j
                                        
                            
                            
                            
                        
'                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
'
'                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            Exit Function
'                        End If
                    
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                            Else
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU <= 1 Then
                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                    End If
                                
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                                
                                End If
                            End If
                        Next j
                        
                        
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC_ALL = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                
                                
                                
                                
                                
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                    'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                    If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                        If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                        End If
                                    Else
'''''''                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                        
                                        
                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                                                            
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                    
                                Else
                                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                        
                                        'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                        If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                            If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                            Else
                                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                            End If
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                                                                
                                        End If
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                
                                End If
                                                    
                                
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j

        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                   
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                    'IDáÇ
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
                
                                Do
                                
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                            
                                Loop
                                
                                
                                
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                                
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù

                            
'                        PRINT_OFF = False
'
'                        If KONPOU_OFF = KONPOU_OFF_SUMI Then
'
'                            PRINT_OFF = True
'
'                        End If
                        If ID_KANRI_TBL(ING_No).KEN_TYPE = "1" Then
                            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            End If
                                    
                                                        
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SUMI Then
                                    'èWçáç´ïÔéû
                                    If OKURI_NO_SEQ_Update_Proc(k, Format(1, "000"), Sendbuf, Format(KUTI_SU, "000")) Then
                                        GoTo Abort_Tran
                                    End If
                                    
                                End If
                            Next k
                                    
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                            End If
                                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            ID_KANRI_TBL(ING_No).KEN_TYPE = ""

                            If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 0 Then
                                ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                            End If
    
    
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                Not LOGIXTICS_F Then
                                If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                    PRINT_OFF = True
                                End If
                            End If


    
                            PRINT_MAISU = KUTI_SU
                                                
                                                
                            Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1

                            PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU


                            If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                        Not LOGIXTICS_F) Then
                                PRINT_MAISU = PRINT_MAISU - 1
                                If PRINT_MAISU < 1 Then
                                
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                                                        'é}î‘çXêV   2010.02.15
'2012.04.01                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01                                                    GoTo Abort_Tran
'2012.04.01                                                End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                        
                                            End If
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                            
                        
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
'2012.04.01
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01                                                    End If
                                            
                                                
                                                End If
                                                                
                                            End If
                                        End If
                                    Next j
                                
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                
                                    PRINT_OFF = True
                                Else
'                                PRINT_MAISU = PRINT_MAISU - 1
                                    Start_Page_No = Start_Page_No + 1
                            
                                End If
                            End If

''' â◊éDèàíu
                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                ID_KANRI_TBL(ING_No).LABEL_ON = False
                            Else
                                
'2012.03.30                     Y_SYU_CNT = 0
'                               SYUKA_QTY = 0
'
'                               PRINT_OFF = False
'
'                               For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                   If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                       If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                           Y_SYU_CNT = Y_SYU_CNT + 1
'                                           SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
'
'
'                                           If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
'
'                                               PRINT_OFF = True
'                                           Else
'
'                                           End If
'                                       End If
'                                   End If
'2012.03.30                     Next j
                                
                                If Not PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LAST_END_PAGE = Start_Page_No + PRINT_MAISU - 1    '2012.04.01

                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                    End If
                            
                            
                            
                            
                                    'é}î‘çXêV   2010.02.15
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                        
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            
                            
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01
'2012.04.01                                                    End If
                            
                                                Else
                            
                            
                                                            'é}î‘çXêV   2010.02.15
'2012.04.01                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                        GoTo Abort_Tran
'2012.04.01
'2012.04.01
'2012.04.01                                                    End If
                                                            
                                                End If
                                                            
                                                            'é}î‘çXêV   2010.02.15
                                            End If
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
'2012.04.01                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01                                                        End If
                                                    Else
                                                    
'2012.04.01                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
'2012.04.01
'2012.04.01                                                            GoTo Abort_Tran
'2012.04.01                                                        End If
                                                    
                                                                            
                                                    
                                                    End If
                                                End If
                                            End If
                                        End If
                                    Next j
                                    'é}î‘çXêV   2010.02.15
                            
                            
                                
    '                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU
                                    
                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                    Else
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                    End If
                                    
                                
                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 9
                                    
                                    'ÉfÅ[É^ëóêM
                                                                
                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                
                                    ID_KANRI_TBL(ING_No).LABEL_ON = True
                                
                                    '-----------------------------------------------ÉwÉbÉ_Å[
                                    Call Wel_Head_Print_Text_Proc(fileName)
                                    '-----------------------------------------------É{ÉfÉB
                                    Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
                                
                                    Sendbuf = Text_Create_Proc()
                                
                                    Inspe_Proc_LOGISTIC_ALL = False
                                    Exit Function
                            
                                End If

''' â◊éDèàíu
                            End If
                        End If
                    

                        KENPIN_END = True
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                            
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                    KENPIN_END = False
                                    Exit For
                                End If
                            End If
                        Next j
                    
                    

                        Select Case KENPIN_END
                            
                            Case True
        
                                'éüÇÃçÏã∆óvãÅ
    
                                    Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                    Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                    sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                    Select Case sts
                                        Case BtNoErr
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                        Case Else
                                        'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                        Exit Function
                                    End Select
                                    
                                    
                                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                    If Sagyo_Send_Proc() Then
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                    
                                    Sendbuf = Text_Create_Proc()
                                            
                                            
                                            
                                            
                                            
                    
                    
                            Case Else
                    
    ''''''''''''''''''''''''''''''''''''''''''''''
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                
                                 '-----------------------------------------------ÇRçsñ⁄
                                Call Wel_HIN_NO_Req_Text_3_Proc
                                '-----------------------------------------------ÇSçsñ⁄
                                Call Wel_HIN_NO_Req_Text_4_Proc
                               
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                    
                        End Select
                    
                    End Select
                
            Next i
        

        Case Step_PRINT_RES        'àÛç¸èIóπ
    
    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    
            '-----------------------------------------------ÉwÉbÉ_Å[
            Call Wel_Head_Text_Proc
    
            Select Case ID_KANRI_TBL(ING_No).LABEL_STEP
                Case 1      'ïiî‘Ç÷
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------  2012.03.30
'
'                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
'
'                    '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
'                    Call Wel_Head_Text_Proc
'
'                    '-----------------------------------------------ÇPçsñ⁄
'                    Call Wel_DETAIL_0_Text_Proc
'                    '-----------------------------------------------ÇQçsñ⁄
'                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
'                    '-----------------------------------------------ÇRçsñ⁄
'                                                                            'BOXëÆê´
'                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                            'ï\é¶ì‡óe
'
'                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'
'
'                                                                            'êîílèâä˙ï\é¶
'                    Send_Text.Box_Type(2).INIT = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'                                                                            'èâä˙ÉJÅ[É\Éãà íu
'                    Send_Text.Box_Type(2).Start_Pos = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                            'ì¸óÕåÖêî
'                    Send_Text.Box_Type(2).Max_Size = "00"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                    '-----------------------------------------------ÇSçsñ⁄
'                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                            'ï\é¶ì‡óe
'                                                                        'ï\é¶ì‡óe
'                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                                                            'êîílèâä˙ï\é¶
'                    Send_Text.Box_Type(3).INIT = ""
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                            'èâä˙ÉJÅ[É\Éãà íu
'                    Send_Text.Box_Type(3).Start_Pos = "01"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                            'ì¸óÕåÖêî
'                    '2010.12.07
''                    Send_Text.Box_Type(3).Max_Size = "13"
''                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
'                    Send_Text.Box_Type(3).Max_Size = "20"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
'                    '2010.12.07
'
'                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
'                    '-----------------------------------------------ÇTçsñ⁄
'                    Call Wel_Clear_Text_Proc
'
'                    Sendbuf = Text_Create_Proc()
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                        If RTrim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                            Exit For
                        End If
                    
                    Next j
                    
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT Then
            
            
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
                                                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                        End If
                                
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If ID_KANRI_TBL(ING_No).KEN_HINBAN = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO And _
                                Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                'íPëÃç´ïÔéû
                                If OKURI_NO_SEQ_Update_Proc(k, Format(ID_KANRI_TBL(ING_No).LAST_START_PAGE, "000"), Sendbuf, Format(ID_KANRI_TBL(ING_No).LAST_END_PAGE, "000")) Then
                                    GoTo Abort_Tran
                                End If
                                
                            End If
                        Next k
                                
                                
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.04.01
            
            
            
            
            
            
            
            
            
            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        Else
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                        End If
                        
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                End If
                            End If
                        Next k
                                                                                    'ï\é¶ì‡óe
                            
                        If Y_SYU_CNT < 2 Then
    
'                                If Inspection_QTY = 1 Then
    
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
'                                End If
                                                                                    
                        Else
                            
'                                If Inspection_QTY = 1 Then
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                        End If
                                                                                    
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        End If
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                        Inspe_Proc_LOGISTIC_ALL = False
                        Exit Function
                
                
                    Else
                
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                            
                            
                            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
    
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                                'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                            Else
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCANK                             '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK        '2007.04.21
'                            End If
                            
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                End If
                            End If
                        Next k
                                                                                    'ï\é¶ì‡óe
                            
                        If Y_SYU_CNT < 2 Then
    
 '                               If Inspection_QTY = 1 Then
    
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
 '                               Else
 '                                   Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
 '                                   Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
 '                               End If
                                                                                    
                        Else

'                                If Inspection_QTY = 1 Then
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                            
                        End If
                                                                                
                                                                                    'êîílèâä˙ï\é¶
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
'                            Else
                        Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
'                            End If
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            If Inspection_QTY = 1 Then
'
'                                Send_Text.Box_Type(4).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
'                            Else
                        Send_Text.Box_Type(4).Start_Pos = "01"                                              '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"                         '2007.04.21
'                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
'                            If Inspection_QTY = 1 Then
'                                Send_Text.Box_Type(4).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
'                            Else
                        Send_Text.Box_Type(4).Max_Size = "20"                                               '2007.04.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"                          '2007.04.21
'                            End If
                                                                                    
                                                                                    
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then   '2012.04.13
                            Else
                                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            End If                  '2012.04.13
                        End If
                                                                            
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                        Inspe_Proc_LOGISTIC_ALL = False
                        Exit Function
                    End If
                    
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------  2012.03.30

                
                Case 2      'å˚êîÇ÷
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Call Wel_Head_Text_Proc
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    
                    '-----------------------------------------------ÇRçsñ⁄
'2012.11.15                                                                            'BOXëÆê´
'2012.11.15                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                            'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                            'êîílèâä˙ï\é¶
'2012.11.15                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                            'ì¸óÕåÖêî
'2012.11.15                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '2012.11.15
                    Call Wel_OKURI_SAKI_PROC
                    
                    
                    '-----------------------------------------------ÇSçsñ⁄
'å˚êîÅ@ÇS
                    wkKONPO_F = ""
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                    
                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                        
                            wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                            Exit For
                        End If
                    Next j
                    
                    If wkKONPO_F = "1" Then
                                            
                        If Inspection_Input Then
                            KUTI_SU_INPUT_F = False
                        Else
                            KUTI_SU_INPUT_F = True
                        End If
                    
                    
                        TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                        TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                
                    Else
                        TOTAL_KUTI_SU = 1
                        KUTI_SU_INPUT_F = True
                        TOTAL_SAI_SU = 0#
                    End If
                                
                                
                                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                    End If
                                
                                
                    If KUTI_SU_INPUT_F Then
                    
                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_TYPE = "1"
                    
                    
                    Else
                        Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                    
                        
                        If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                    
                    
                    
                    End If
                    
                    Sendbuf = Text_Create_Proc()
                
                Case 9
        
                    Select Case (Y_SYU_CNT - Sumi_CNT)
                
                        Case 0
                
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                            End Select
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                            
                            Sendbuf = Text_Create_Proc()
            
            
                        Case Else
                        
        ''''''''''''''''''''''''''''''''''''''''''''''
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            '-----------------------------------------------ÇTçsñ⁄
                            Call Wel_Clear_Text_Proc
        
                            Sendbuf = Text_Create_Proc()
        
            
                End Select
            End Select
    
    End Select
                    
                    

    Inspe_Proc_LOGISTIC_ALL = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
Private Function Inspe_Proc_LOGISTIC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'       'ÉçÉWÉXÉeÉbÉNÉXëŒâû
'       2010.02.25
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07


Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Long

Dim SAI_SU          As Double

Dim UNSOU_KAISHA    As String
 
Dim SYUKA_YMD       As String
Dim JYUSHO          As String
Dim BIKOU           As String

Dim SURYO           As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag

Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean

'2010.01.21
Dim KONPOU_ON           As Integer


Dim KONPOU_ON_SUMI      As Integer
Dim KONPOU_OFF          As Integer
Dim KONPOU_OFF_SUMI     As Integer
Dim PRINT_OFF           As Boolean
Dim Start_Page_No       As Long
Dim PRINT_TOTAL_SU      As Long
Dim PRINT_MAISU         As Long
Dim fileName            As String
Dim ID_SEQ              As Integer
Dim DISP_SAI_SU         As Double

Dim wkKUTI_SU           As String
Dim wkKONPO_F           As String * 1

Dim TOTAL_KUTI_SU       As Integer
Dim TOTAL_SAI_SU        As Double
Dim MUKE_NAME           As String
Dim OKURI_NO_MAX        As Integer
Dim KUTI_SU_INPUT_F     As Boolean

Dim KEN_TEL_NO          As String * 20

Dim LOGIXTICS_F         As Boolean

Dim OKURI_NO_F          As Boolean
'2010.01.21
Dim FUKUYAMA_CHK_F      As Boolean

    Inspe_Proc_LOGISTIC = True

    LOGIXTICS_F = True
    
    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, _
                                                SYUKA_YMD, _
                                                JYUSHO, _
                                                BIKOU, _
                                                Start_Page_No, _
                                                KUTI_SU, _
                                                MUKE_NAME, _
                                                OKURI_NO_MAX, , , _
                                                KEN_TEL_NO)
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            End If
                        End If
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        End If
                                                 
                        If Sumi_CNT = Y_SYU_CNT And Start_Page_No <> 0 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        
                        End If
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_CND = Y_SYU_TBL(j).KONPOU_CND    '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).TOTAL_SU = Y_SYU_TBL(j).TOTAL_SU        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = Y_SYU_TBL(j).SAI_SU            '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = Y_SYU_TBL(j).KUTI_SU          '2010.01.21
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = Y_SYU_TBL(j).PRINT_SUMI    '2010.01.21
                        
                                                                                                        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = Y_SYU_TBL(j).OKURI_NO_SEQ
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        'èoâ◊ì˙
                        ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = SYUKA_YMD
                        'èZèä
                        ID_KANRI_TBL(ING_No).KEN_JYUSHO = JYUSHO
                        
                        'îıçl
                        ID_KANRI_TBL(ING_No).KEN_BIKOU = BIKOU
                        'å¸ÇØêÊ
                        ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = MUKE_NAME
                        
                        'é}î‘
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO_MAX = OKURI_NO_MAX
                        'ìdòbî‘çÜ
                        ID_KANRI_TBL(ING_No).KEN_TEL_NO = KEN_TEL_NO
                        
                        
                        
                        '◊ÕﬁŸäJénÉyÅ[ÉWáÇ
                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                        
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                        
                    
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        
                        
                        
                        End If
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                        
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                        If KONPOU_ON <> 0 Then
                            If KONPOU_ON = KONPOU_ON_SUMI Then
                                                    
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                                    
                            End If
                        End If
                        
                        
                        
                        
                        
                        
                        
                        
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                
                
                
                        Else
                
                
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                                                                                    'BOXëÆê´
                                                                                    
                                                                                    
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                            
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI   '2011.03.17
        
    ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
Select Case KONPOU_ON    '2011.03.17
                            
                            
''''''''''2011.03.17Select Case (KONPOU_ON - KONPOU_ON_SUMI)
                                Case 0
                                'èWçáç´ïÔÇ»Çµ
                                
                                    
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                        If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                        
                                        
                                        
                                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                            
                                            '-----------------------------------------------ÉwÉbÉ_Å[
                                            Call Wel_Head_Text_Proc
                                            '-----------------------------------------------ÇPçsñ⁄
                                            Call Wel_DETAIL_0_Text_Proc
                                            '-----------------------------------------------ÇQçsñ⁄
                                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                            '-----------------------------------------------ÇRçsñ⁄
                                                                                                    'BOXëÆê´
                                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                    'ï\é¶ì‡óe
                                                                                                    
                                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                                    
                                                                                                    'êîílèâä˙ï\é¶
                                            Send_Text.Box_Type(2).INIT = ""
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                                            Send_Text.Box_Type(2).Start_Pos = ""
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                    'ì¸óÕåÖêî
                                            Send_Text.Box_Type(2).Max_Size = "00"
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                    
                                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                        
                                        
                                        
                                        
                                        
                                            TOTAL_KUTI_SU = 1
                                            KUTI_SU_INPUT_F = True
                                            TOTAL_SAI_SU = 0#
                                                
                                                
                                                
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                            End If
                                                
                                                
                                    
                                            Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                            ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                            ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                    
                                    
                                    
                                            Sendbuf = Text_Create_Proc()
                                        
                                            Inspe_Proc_LOGISTIC = False
                                            Exit Function
                                        
                                        
                                        End If
                                    End If
    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                    
                                    
                                    
                                    '-----------------------------------------------É{ÉfÉB
                                    Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
            
                                    Sendbuf = Text_Create_Proc()
                                Case Else
                                'èWçáç´ïÔÇ†ÇË
                            
                                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                                    '-----------------------------------------------ÇQçsñ⁄
                                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                    '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                            'ï\é¶ì‡óe
                                                                                            
                                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(2).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(2).Start_Pos = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(2).Max_Size = "00"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                            'ï\é¶ì‡óe
                                                                                        'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                            "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = "01"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                            'ì¸óÕåÖêî
                                    '2010.12.07
'                                    Send_Text.Box_Type(3).Max_Size = "13"
'                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                    Send_Text.Box_Type(3).Max_Size = "13"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                    '2010.12.07
                                                                                            
                                                                                            
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇTçsñ⁄
                                    Call Wel_Clear_Text_Proc
            
                                    Sendbuf = Text_Create_Proc()
                            
                            End Select
                        End If
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
'                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
'
'                        '-----------------------------------------------ÉwÉbÉ_Å[
'                        Call Wel_Head_Text_Proc
'                        '-----------------------------------------------ÇPçsñ⁄
'                        Call Wel_DETAIL_0_Text_Proc
'                        '-----------------------------------------------ÇQçsñ⁄
'                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, SUMI_CNT, Y_SYU_CNT)
'                        '-----------------------------------------------ÇRçsñ⁄
'                                                                                'BOXëÆê´
'                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(2).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(2).Start_Pos = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(2).Max_Size = "00"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                        '-----------------------------------------------ÇSçsñ⁄
'                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                                'ï\é¶ì‡óe
'                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
'                        Else
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
'                        End If
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(3).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(3).Start_Pos = "01"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(3).Max_Size = "20"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
'
'                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
'                        '-----------------------------------------------ÇTçsñ⁄
'                                                                                'BOXëÆê´'
'
'                        Call Wel_Clear_Text_Proc
'
'                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
'2009.10.14                         If Len(OKURI_NO) < 11 Or Len(OKURI_NO) > 13 Then
'                            If Len(OKURI_NO) < 10 Or Len(OKURI_NO) > 13 Then
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                Inspe_Proc_LOGISTIC = False
'                                Exit Function
'                            End If
                        
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            End If
                        
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                                                
                            End If
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        
                        
'                            Select Case Len(Trim(OKURI_NO))
'
'                                Case FUKUYAMA_Length
'                                Case SEIBU_Length
'                                Case KURUME_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(KURUME_CODE) Then
'
'
'                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                        Sendbuf = Text_Create_Proc()
'                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                        Inspe_Proc_LOGISTIC = False
'                                        Exit Function
'
'                                    End If
'
'                                Case SAGAWA_Length, YAMATO_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(SAGAWA_CODE) Then
'
'                                        For k = 0 To UBound(YAMATO_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                Exit For
'                                            End If
'
'                                        Next k
'
'                                        If k > UBound(YAMATO_CODE) Then
'
'                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                            Sendbuf = Text_Create_Proc()
'                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                            Inspe_Proc_LOGISTIC = False
'                                            Exit Function
'
'
'
'                                        End If
'
'                                    End If
'
'
'                            End Select
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        End If
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ÉçÉWÉXÉeÉBÉNÉX")
                                            
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                            
                                            
'                                'â^ëóâÔé–ïœä∑
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                                End If
'                                'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                                If KURUME_F Then        'ãvóØïƒ
'                                    For k = 1 To UBound(KURUME)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If FUKUYAMA_F Then      'ïüéR
'                                    For k = 1 To UBound(FUKUYAMA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If SAGAWA_F Then        'ç≤êÏ
'                                    For k = 1 To UBound(SAGAWA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                'ï®ó¨ 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
'                                End If
'
'                                'ê‘ñX 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
'                                End If
'
'                                'ÉçÉWÉXÉeÉbÉN 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ÉçÉWÉXÉeÉbÉN")
'                                End If
                                
                                
                                
                                
                                
'                                Select Case Len(Trim(OKURI_NO))
'
'                                    Case FUKUYAMA_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
'                                    Case SEIBU_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
'
'                                    Case KURUME_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(KURUME_CODE) Then
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
'                                        End If
'
'                                    Case SAGAWA_Length, YAMATO_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(SAGAWA_CODE) Then
'
'                                            For k = 0 To UBound(YAMATO_CODE)
'
'                                                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                    Exit For
'                                                End If
'
'                                            Next k
'
'                                            If k > UBound(YAMATO_CODE) Then
'                                            Else
'
'                                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
'                                            End If
'
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
'                                        End If
'
'
'                                End Select
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
'                                'ï®ó¨ 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
'                                End If
'
'                                'ê‘ñX 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
'                                End If
                                
                                
                                
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc
                                                                                'BOXëÆê´
                                                                                
                                                                                
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
KONPOU_ON = KONPOU_ON - KONPOU_ON_SUMI '2011.03.17
    
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
Select Case KONPOU_ON  '2011.03.17
'''''''''''''''''Select Case (KONPOU_ON - KONPOU_ON_SUMI)    '2011.03.17
                            Case 0
                            'èWçáç´ïÔÇ»Çµ
                            
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                                
                                If KONPOU_ON_SUMI <> 0 And KONPOU_OFF_SUMI = 0 Then
                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    
                                    
                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                        
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Call Wel_Head_Text_Proc
                                        '-----------------------------------------------ÇPçsñ⁄
                                        Call Wel_DETAIL_0_Text_Proc
                                        '-----------------------------------------------ÇQçsñ⁄
                                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                                                                                
                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                                
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(2).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(2).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(2).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    
                                    
                                    
                                    
                                    
                                    
                                        TOTAL_KUTI_SU = 1
                                        KUTI_SU_INPUT_F = True
                                        TOTAL_SAI_SU = 0#
                                            
                                            
                                            
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                        End If
                                            
                                            
                                
                                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                
                                        Sendbuf = Text_Create_Proc()
                                    
                                        Inspe_Proc_LOGISTIC = False
                                        Exit Function
                                    
                                    
                                    End If
                                End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''   2010.03.05
                            
                            
                            
                            
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
        
                                Sendbuf = Text_Create_Proc()
                            Case Else
                            'èWçáç´ïÔÇ†ÇË
                        
                                'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                                Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                        'ï\é¶ì‡óe
                                                                                    'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                        "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                '2010.12.07
'                                Send_Text.Box_Type(3).Max_Size = "13"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                Send_Text.Box_Type(3).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                '2010.12.07
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                    End Select
                Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                'èWçáç´ïÔóLÇËéûÇÃïiî‘É`ÉFÉbÉN
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        End If
                        
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND <> "1" Then
                        
                            If KONPOU_ON <> KONPOU_ON_SUMI Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                            
                            
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    Exit Function
                            
                                End If
                            End If
                        
                        End If
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next j
                                            
                            If j <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Call Wel_DETAIL_0_Text_Proc

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        '-----------------------------------------------ÇQçsñ⁄
                        Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                        
                        
                        
                        
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe


                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)


                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"

                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"

                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""

                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        Else
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                        End If
                        
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                                                                                'ï\é¶ì‡óe
                        
                        If Y_SYU_CNT < 2 Then

                            If Inspection_QTY = 1 Then

                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
                            End If
                                                                                
                        Else
                        
                            If Inspection_QTY = 1 Then
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
                            End If
                        
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                
                        End If
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
            
            Next i
'''''''''''''''''''''''''''''''
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            For i = 0 To M_Gyo - 1
                
'                Select Case RTrim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), _
'                                Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 10))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2, "èoâ◊êîÅF"  'èoâ◊êî(åüïiêî)
                        
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_LOGISTIC = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            Y_SYU_CNT = 0
            SYUKA_QTY = 0
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                    End If
                End If
            Next j
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
        
                    '''ëºçsÇÃégópÇåpë±Ç∑ÇÈÇΩÇﬂ
                    '''Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    '''Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_LOGISTIC = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
'                        'â^ëóâÔé–ïœä∑
'                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                        End If
'                        'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                        If KURUME_F Then        'ãvóØïƒ
'                            For k = 1 To UBound(KURUME)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If FUKUYAMA_F Then      'ïüéR
'                            For k = 1 To UBound(FUKUYAMA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If SAGAWA_F Then        'ç≤êÏ
'                            For k = 1 To UBound(SAGAWA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_LOGISTIC = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_LOGISTIC = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_LOGISTIC = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                End If
            
            Next j
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_LOGISTIC = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
                    
                    
                    
                    
                    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                    
            Select Case ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND
            
            
                Case "1"
                    'èWçáç´ïÔÇ»Çµ
                
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
''' â◊éDèàíu
                            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
                                ID_KANRI_TBL(ING_No).LABEL_ON = False
                            Else
                            
                                PRINT_OFF = False
                                
                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                    Not LOGIXTICS_F Then
                                    If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                        PRINT_OFF = True
                                    End If
                                End If
                                
                                If Not PRINT_OFF Then
                                
                                
                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                    '2010.06.16
                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    Select Case sts
                                        Case BtNoErr
                                        
                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            End If
                                        
                                        Case BtErrKeyNotFound
                                        
                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                        
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                
                                
                                
                                
                                
                                
                                
                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                            
                                    Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                            
                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                
                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                    
                                    'Y_SYU_CNT = 0
                                    SYUKA_QTY = 0
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                    
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                            
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                            
                                                'Y_SYU_CNT = Y_SYU_CNT + 1
                                                SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                            
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                    PRINT_OFF = True
                                                Else
                                            
                                                   ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                
                                                End If
                                            
                                            End If
                                        End If
                                    Next j
                                End If
                                
                                If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                       Not LOGIXTICS_F) Then
                                    PRINT_MAISU = PRINT_MAISU - 1
                                    If PRINT_MAISU < 1 Then
                                        
                                    'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                        
                                                        GoTo Abort_Tran
                                                    
                                                    End If
                                                                                                    
                                                
                                                End If
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    End If
                                                                        
                                                End If
                                            End If
                                        Next j
                                    'é}î‘çXêV   2010.02.15
                                        
                                        PRINT_OFF = True
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                    
                                    
                                    Else
'                                            PRINT_MAISU = PRINT_MAISU - 1
                                        Start_Page_No = Start_Page_No + 1
                                    End If
                                End If
                                
                                If Not PRINT_OFF Then
                                                            
                                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                            
                                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                    Select Case sts
                                        Case BtNoErr
                                        
                                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                            
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            End If
                                        
                                        Case BtErrKeyNotFound
                                        
                                        
                                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                        
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                                            
                                                            
'2010.02.21                                    PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                            
'2010.02.21                                    Start_Page_No = Start_Page_No + 1
                                                            
'2010.02.21                                    PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                                            
                                                            
                                    If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                    End If
                                
                                
                                
                                    'é}î‘çXêV   2010.02.15
                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                        
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            
                                                If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And _
                                                    (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                       Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                       Not LOGIXTICS_F) Then

                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                    
                                                        GoTo Abort_Tran
                                                    End If
                                            
                                            
                                                Else
                                            
                                            
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                    
                                                        GoTo Abort_Tran
                                                    End If
                                            
                                                End If
                                            End If
                                        Else
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                
                            
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    
                                                    End If
                                                
                                                
                                                
                                                End If
                                                                    
                                                                    
                                                                    
                                            End If
                                        End If
                                    Next j
                                    'é}î‘çXêV   2010.02.15
                                
                                
                                
                                
'2010.02.21                                    If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
'                                    Else
'                                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
'                                    End If
                                    
'                                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                        If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'                                                If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                    GoTo Abort_Tran
'                                                End If
'
'                                            End If
'                                        End If
'                                    Next j
                                    
                                    'ÉfÅ[É^ëóêM
                                                                
                                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                                
                                                                
                                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                
                                    ID_KANRI_TBL(ING_No).LABEL_ON = True
                                
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU - 1
                                    '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                    Call Wel_Head_Print_Text_Proc(fileName)
                                
                                    Sendbuf = Text_Create_Proc()
                                    
                                
                                    Inspe_Proc_LOGISTIC = False
                                    Exit Function
                                End If
                            
                            End If
''' â◊éDèàíu
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            
                            
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            
                            
                            
'                            '-----------------------------------------------ÇRçsñ⁄
'                                                                                    'BOXëÆê´
'                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                                    'ï\é¶ì‡óe
'
'                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                                                                                    'êîílèâä˙ï\é¶
'                            Send_Text.Box_Type(2).INIT = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            Send_Text.Box_Type(2).Start_Pos = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                                    'ì¸óÕåÖêî
'                            Send_Text.Box_Type(2).Max_Size = "00"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                            '-----------------------------------------------ÇSçsñ⁄
'                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                                    'ï\é¶ì‡óe
'                                                                                'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                                                                    'êîílèâä˙ï\é¶
'                            Send_Text.Box_Type(3).INIT = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            Send_Text.Box_Type(3).Start_Pos = "01"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                                    'ì¸óÕåÖêî
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
'
'                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''' â◊éDèàíu
                                PRINT_OFF = False
            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                                    PRINT_OFF = True
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                                    
                                        If KONPOU_ON = KONPOU_ON_SUMI Then
                
                                            PRINT_OFF = True
                
                                        End If
                
                                    End If
                                End If
                                
                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
                                Else
                                    
            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
                                    
                                    PRINT_OFF = False
                                    
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                        Not LOGIXTICS_F Then
                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                            
                                                        'é}î‘çXêV   2010.02.15
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                    Start_Page_No = 1
                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                        
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                    
                                                        PRINT_OFF = True
                                        
                                                    End If
                                                
                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                        
                                    
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                    
                                                        
                                                        End If
                                                                            
                                                    End If
                                                End If
                                            Next j
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                
                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                        Select Case sts
                                            Case BtNoErr
                                            
                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                                
                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                                
                                                End If
                                            
                                            Case BtErrKeyNotFound
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            Case Else
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                GoTo Abort_Tran
                                        End Select
                                        
                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                                
                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                                
                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                        
                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                               Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                               Not LOGIXTICS_F) Then
                                            PRINT_MAISU = PRINT_MAISU - 1
                                            
                                            
                                            
                                            If PRINT_MAISU < 1 Then
                                                
                                                        'é}î‘çXêV   2010.02.15
                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                            
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            End If
                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    Else
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                            
                                        
                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                    
                                                                    GoTo Abort_Tran
                                                                End If
                                                            
                                                            
                                                        
                                                            End If
                                                                                
                                                        End If
                                                    
                                                    
                                                    
                                                    End If
                                                Next j
                                                        'é}î‘çXêV   2010.02.15
                                                
                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                                
                                                PRINT_OFF = True
                                            Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                                Start_Page_No = Start_Page_No + 1
                                            End If
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                        
                                        Y_SYU_CNT = 0
                                        SYUKA_QTY = 0
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                
                                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                                
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                        PRINT_OFF = True
                                                    Else
                                                
                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                    
                                                    End If
                                                
                                                End If
                                            End If
                                        Next j
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                        
                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                        End If
                                        
                                        
                                        
                                        
                                        
                                                        'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                                        
                                                    If ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 And Start_Page_No = 2 Then
                                                    
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    Else
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    End If
                                                
                                                End If
                                            
                                            
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    
                                                    End If
                                                                        
                                                End If
                
                                            
                                            
                                            
                                            
                                            End If
                                        Next j
                                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                        
                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                        Else
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                        End If
                                        
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                        GoTo Abort_Tran
'                                                    End If
'                                                End If
'                                            End If
'                                        Next j
                                        
                                        'ÉfÅ[É^ëóêM
                                                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
                                                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                        Call Wel_Head_Print_Text_Proc(fileName)
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
                                    
                                        Inspe_Proc_LOGISTIC = False
                                        Exit Function
                                    
                                    End If
                                End If
            ''' â◊éDèàíu
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇP
                                
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    
                                    
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                    
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                        
                
                
                Case "2"
                    'èWçáç´ïÔÇÃÇ›
                
                    KENPIN_END = True
                    
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                KENPIN_END = False
                                Exit For
                            End If
                        End If
                    Next j
                
                
                
                
                
                
                    Select Case KENPIN_END
                    
                        Case False
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    
                    
                    
                    
                    
                        Case True
                            'écÇ»ÇµÅ@å˚êîÇ÷
                    
                    
''' â◊éDèàíu
                                PRINT_OFF = False
            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" And KONPOU_OFF_SUMI = 0 Then
                                    PRINT_OFF = True
                                Else
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "2" Then
                                    
                                        If KONPOU_ON = KONPOU_ON_SUMI Then
                
                                            PRINT_OFF = True
                
                                        End If
                
                                    End If
                                End If
                                
                                If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                                    ID_KANRI_TBL(ING_No).LABEL_ON = False
                                Else
                                    
            '                        Y_SYU_CNT = 0
            '                        SYUKA_QTY = 0
                                    
                                    PRINT_OFF = False
                                    
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                        Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                        Not LOGIXTICS_F Then
                                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                            
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                        
                                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                    
                                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        Start_Page_No = 1
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        PRINT_OFF = True
                                                    End If
                                                
                                                
                                                Else
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                        
                                    
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                        
                                                        
                                                        
                                                        End If
                                                                            
                                                    End If
                                                
                                                
                                                
                                                
                                                
                                                End If
                                            Next j
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                                        Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                
                                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                        Select Case sts
                                            Case BtNoErr
                                            
                                                If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                                
                                                    Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                                
                                                End If
                                            
                                            Case BtErrKeyNotFound
                                            
                                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                                            
                                            Case Else
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                GoTo Abort_Tran
                                        End Select
                                        
                                        PRINT_MAISU = SYUKA_QTY * CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                                                                
                                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1
                                                                
                                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                        
                                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                                Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                                Not LOGIXTICS_F) Then
                                            PRINT_MAISU = PRINT_MAISU - 1
                                            If PRINT_MAISU < 1 Then
                                                
                                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                        
                                                        'é}î‘çXêV   2010.02.15
                                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                
                                                                GoTo Abort_Tran
                                                            
                                                            End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    Else
                                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                            
                                        
                                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                                    
                                                                    GoTo Abort_Tran
                                                                End If
                                                                
                                                        
                                                            
                                                            End If
                                                                                
                                                        End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    End If
                                                Next j
                                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                                PRINT_OFF = True
                                            Else
            '                                    PRINT_MAISU = PRINT_MAISU - 1
                                                Start_Page_No = Start_Page_No + 1
                                            End If
                                        End If
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                        
                                        Y_SYU_CNT = 0
                                        SYUKA_QTY = 0
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                        
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                                
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                
                                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                                
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                                        PRINT_OFF = True
                                                    Else
                                                
                                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = True
                                                    
                                                    End If
                                                
                                                End If
                                            End If
                                        Next j
                                    End If
                                    
                                    If Not PRINT_OFF Then
                                        
                                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                        End If
                                        
                                        
                                        
                                        
                                        
                                        'é}î‘çXêV   2010.02.15
                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                    
                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                            
                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                End If
                                            
                                            Else
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                                    
                                
                                                        If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                            
                                                            GoTo Abort_Tran
                                                        End If
                                                    
                                                    
                                                    End If
                                                                        
                                                End If
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            End If
                                        Next j
                                        'é}î‘çXêV   2010.02.15
                                        
                                        
                                        
                                        
                                        
                                        If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                        Else
                                            ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                        End If
                                        
'                                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                        GoTo Abort_Tran
'                                                    End If
'
'                                                End If
'                                            End If
'                                        Next j
                                        
                                        'ÉfÅ[É^ëóêM
                                                                    
                                        ID_KANRI_TBL(ING_No).LABEL_STEP = 2
                                                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                                    
                                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                                    
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                
                                        Call Wel_Head_Print_Text_Proc(fileName)
                                    
                                        Sendbuf = Text_Create_Proc()
                                        
                                    
                                        Inspe_Proc_LOGISTIC = False
                                        Exit Function
                                    
                                    End If
                                End If
            ''' â◊éDèàíu
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------aaa------------------------------------ÇSçsñ⁄
                                
'å˚êîINPUT ÇQ
                                wkKONPO_F = ""
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                    
                                        wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                        Exit For
                                    End If
                                Next j
                                
                                If wkKONPO_F = "1" Then
                                                        
                                    If Inspection_Input Then
                                        KUTI_SU_INPUT_F = False
                                    Else
                                        KUTI_SU_INPUT_F = True
                                    End If
                                
                                
                                    TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                    TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                            
                                Else
                                    TOTAL_KUTI_SU = 1
                                    KUTI_SU_INPUT_F = True
                                    TOTAL_SAI_SU = 0#
                                End If
                                            
                                            
                                            
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                                End If
                                            
                                            
                                If KUTI_SU_INPUT_F Then
                                
                                    Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                                
                                
                                Else
                                    Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                
                                    If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                    ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                    ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                                
                                
                                
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                        
                        End Select
                    
                Case "3"
                    'ç¨ç›
            
                    
                    'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                    Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
            
            
                    Select Case (KONPOU_ON - KONPOU_ON_SUMI)
            
                        Case 0
                            'å˚êîÇ÷
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------aaa------------------------------------ÇSçsñ⁄
'å˚êîinput ÇR
                            wkKONPO_F = ""
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                
                                    wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                                    Exit For
                                End If
                            Next j
                            
                            If wkKONPO_F = "1" Then
                                                    
                                If Inspection_Input Then
                                    KUTI_SU_INPUT_F = False
                                Else
                                    KUTI_SU_INPUT_F = True
                                End If
                            
                            
                                TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                                TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                        
                            Else
                                TOTAL_KUTI_SU = 1
                                KUTI_SU_INPUT_F = True
                                TOTAL_SAI_SU = 0#
                            End If
                                        
                                        
                                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                            End If
                                        
                                        
                            If KUTI_SU_INPUT_F Then
                            
                                Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                            
                            
                            Else
                                Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                            
                                
                                If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                
                                ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                            
                            
                            
                            End If
                        
                        
                            Sendbuf = Text_Create_Proc()
                        
                        
                        
                        
                        
                        Case Else
                            'ïiî‘Ç÷
            
                            'écÇ†ÇËÅ@éüïiî‘Ç÷
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_HIN_SYUKON & _
                                                                    "(" & Format(KONPOU_ON_SUMI, "0") & "/" & Format(KONPOU_ON, "0") & ")")
                                                                                    
                                                                                    
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            '2010.12.07
'                            Send_Text.Box_Type(3).Max_Size = "13"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                            '2010.12.07
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Call Wel_Clear_Text_Proc
    
                            Sendbuf = Text_Create_Proc()
                    End Select
            
            End Select
                    
                    
                    
                    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Left(Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)), 6)
                    'å˚êî
                    Case LCD_KUTI_SU_S
                
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU < 0 Then
                        
                
                
                
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            
                            End If
                    
                            KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If KUTI_SU < 1 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            End If
                        Else
                            KUTI_SU = ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU
                        End If
                    
                    
                    
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU < 0 Then
                        
                        
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            
                            End If
                    
                            SAI_SU = CDbl(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                            If SAI_SU <= 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            End If
                        Else
                            SAI_SU = ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU
                        
                            If SAI_SU < 1 Then
                                SAI_SU = 1
                            Else
                                If SAI_SU > 1 Then
                                    SAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                                End If
                            End If
                        
                        
                        End If
                    
                        'ëóÇËèÛç≈ëÂàÛç¸ñáêîälìæ 2010.01.21
                            
                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                
                                    If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                
                                
                                Else
                                
                                    If Label_Print_Total_Su_Proc(0, PRINT_TOTAL_SU) Then
                                
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    End If
                                
                                End If
                            End If
                        Next j
                                        
                            
                            
                            
                        
'                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
'
'                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            Exit Function
'                        End If
                    
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                            Else
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU <= 1 Then
                                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = KUTI_SU
                                    End If
                                
                                    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = SAI_SU
                                
                                End If
                            End If
                        Next j
                        
                        
                        
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_LOGISTIC = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_LOGISTIC = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                
                                
                                
                                
                                
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                
                                    'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                    If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                        If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                        End If
                                    Else
'''''''                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                        
                                        
                                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                                                            
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                    
                                Else
                                                
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                                        
                                        'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                                        If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                                            If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                                            Else
                                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                            End If
                                        Else
                                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                                                                
                                        End If
                                    End If
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                                
                                End If
                                                    
                                
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                

'                        Call Syuka_KUTI_SU_Count_Proc(TOTAL_KUTI_SU)

        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                   
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                    'IDáÇ
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
                
                                Do
                                
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                            
                                Loop
                                
                                
                                
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                                
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_LOGISTIC = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_LOGISTIC = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù

                            
'                        PRINT_OFF = False
'
'                        If KONPOU_OFF = KONPOU_OFF_SUMI Then
'
'                            PRINT_OFF = True
'
'                        End If

                        If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 0 Then
                            ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        End If


                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                            Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                            Not LOGIXTICS_F Then
                            If ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = 1 Then
                                PRINT_OFF = True
                            End If
                        End If



                        PRINT_MAISU = KUTI_SU
                                                
                                                
                        Start_Page_No = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1

                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU


                        If Start_Page_No = 1 And (Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_CHARTER_CD) And _
                                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_AKABOU_CD) And _
                                                    Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) <> Trim(KEN_LOGISTIC_CD) And _
                                                    Not LOGIXTICS_F) Then
                            PRINT_MAISU = PRINT_MAISU - 1
                            If PRINT_MAISU < 1 Then
                                
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                                                        'é}î‘çXêV   2010.02.15
                                            If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                
                                                GoTo Abort_Tran
                                            End If
                                                        
                                                        
                                                        'é}î‘çXêV   2010.02.15
                        
                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                            
                        
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf) Then
                                                    
                                                    
                                                    GoTo Abort_Tran
                                                
                                                End If
                                            
                                            
                                            End If
                                                                
                                        End If
                                    End If
                                Next j
                                
                                
                                
                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                                
                                
                                
                                
                                PRINT_OFF = True
                            Else
'                                PRINT_MAISU = PRINT_MAISU - 1
                                Start_Page_No = Start_Page_No + 1
                            
                            End If
                        End If

''' â◊éDèàíu
                        If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Or PRINT_OFF Then
                            ID_KANRI_TBL(ING_No).LABEL_ON = False
                        Else
                                
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            
                            PRINT_OFF = False
                            
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            
                                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                    
                                    
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI Then
                                        
                                            PRINT_OFF = True
                                        Else
                                    
                                        End If
                                    End If
                                End If
                            Next j
                                
                            If Not PRINT_OFF Then
                                
                                If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                                End If
                            
                            
                            
                            
                                'é}î‘çXêV   2010.02.15
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU, "000")) Then
                                                    
                                                    GoTo Abort_Tran
                                                
                                                
                                                End If
                        
                                            Else
                        
                        
                                                        'é}î‘çXêV   2010.02.15
                                                If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                    
                                                    GoTo Abort_Tran
                                                
                                                
                                                End If
                                                        
                                            End If
                                                        
                                                        'é}î‘çXêV   2010.02.15
                        
                        
                        
                        
                        
                                        End If
                                    Else
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
                                            
                        
                                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" And Start_Page_No = 2 Then
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No - 1, "000"), Sendbuf, Format(Start_Page_No - 1 + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                Else
                                                
                                                    If OKURI_NO_SEQ_Update_Proc(j, Format(Start_Page_No, "000"), Sendbuf, Format(Start_Page_No + PRINT_MAISU - 1, "000")) Then
                                                        
                                                        GoTo Abort_Tran
                                                    End If
                                                
                                                                        
                                                
                                                End If
                                            End If
                                        End If
                                    End If
                                Next j
                                'é}î‘çXêV   2010.02.15
                            
                            
                            
'                                ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No + PRINT_MAISU
                                
                                If Start_Page_No = 2 And ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = 0 Then
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU + 1
                                Else
                                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + PRINT_MAISU
                                End If
                                
'                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
'
'                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
'
'                                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
'
'
'
'                                            If OKURI_NO_SEQ_Update_Proc(j, Format(ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO, "000"), Sendbuf) Then
'                                                GoTo Abort_Tran
'                                            End If
'
'                                        End If
'                                    End If
'                                Next j
                            
                                ID_KANRI_TBL(ING_No).LABEL_STEP = 9
                                
                                'ÉfÅ[É^ëóêM
                                                            
                                ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                            
                                ID_KANRI_TBL(ING_No).LABEL_ON = True
                            
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Print_Text_Proc(fileName)
                                '-----------------------------------------------É{ÉfÉB
                                Call Wel_Hin_No_Req_Text_Proc(Sumi_CNT, Y_SYU_CNT)
                            
                                Sendbuf = Text_Create_Proc()
                            
                                Inspe_Proc_LOGISTIC = False
                                Exit Function
                            
                            End If

''' â◊éDèàíu
                        End If

                        KENPIN_END = True
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                            
                                                            
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                    KENPIN_END = False
                                    Exit For
                                End If
                            End If
                        Next j



                        Select Case KENPIN_END
                    
                            Case True
    
                            'éüÇÃçÏã∆óvãÅ

                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                                
                                Sendbuf = Text_Create_Proc()
                                            
                                            
                                            
                                            
                                            
                    
                    
                            Case Else
                    
    ''''''''''''''''''''''''''''''''''''''''''''''
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Call Wel_Head_Text_Proc
                                '-----------------------------------------------ÇPçsñ⁄
                                Call Wel_DETAIL_0_Text_Proc
                                '-----------------------------------------------ÇQçsñ⁄
                                Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                                
                                 '-----------------------------------------------ÇRçsñ⁄
                                Call Wel_HIN_NO_Req_Text_3_Proc
                                '-----------------------------------------------ÇSçsñ⁄
                                Call Wel_HIN_NO_Req_Text_4_Proc
                               
'                                '-----------------------------------------------ÇRçsñ⁄
'                                                                                        'BOXëÆê´
'                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'                                                                                        'ï\é¶ì‡óe
'
'                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'
'
'                                                                                        'êîílèâä˙ï\é¶
'                                Send_Text.Box_Type(2).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'
'Å@                                                                                      'èâä˙ÉJÅ[É\Éãà íu
'                                Send_Text.Box_Type(2).Start_Pos = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'                                                                                        'ì¸óÕåÖêî
'                                Send_Text.Box_Type(2).Max_Size = "00"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'
'                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
'                                '-----------------------------------------------ÇSçsñ⁄
'                                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
'                                                                                        'ï\é¶ì‡óe
'                                                                                    'ï\é¶ì‡óe
'                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
'                                                                                        'êîílèâä˙ï\é¶
'                                Send_Text.Box_Type(3).INIT = ""
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
'                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'                                Send_Text.Box_Type(3).Start_Pos = "01"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
'                                                                                        'ì¸óÕåÖêî
'                                Send_Text.Box_Type(3).Max_Size = "13"
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
'
'                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                Call Wel_Clear_Text_Proc
        
                                Sendbuf = Text_Create_Proc()
                    
                        End Select
                    
                    End Select
                
            Next i
        

        Case Step_PRINT_RES        'àÛç¸èIóπ
    
    
            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    
            '-----------------------------------------------ÉwÉbÉ_Å[
            Call Wel_Head_Text_Proc
    
            Select Case ID_KANRI_TBL(ING_No).LABEL_STEP
                Case 1      'ïiî‘Ç÷
                                                                            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                            
                    '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                    Call Wel_Head_Text_Proc
                                                                            
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                            
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                            'ï\é¶ì‡óe
                                                                        'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    '2010.12.07
'                    Send_Text.Box_Type(3).Max_Size = "13"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                    Send_Text.Box_Type(3).Max_Size = "20"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                    '2010.12.07
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                    Call Wel_Clear_Text_Proc

                    Sendbuf = Text_Create_Proc()
                
                Case 2      'å˚êîÇ÷
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Call Wel_Head_Text_Proc
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Call Wel_DETAIL_0_Text_Proc
                    '-----------------------------------------------ÇQçsñ⁄
                    Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    
                    
                    '-----------------------------------------------ÇSçsñ⁄
'å˚êîÅ@ÇS
                    wkKONPO_F = ""
                    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                    
                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                        
                            wkKONPO_F = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F
                            Exit For
                        End If
                    Next j
                    
                    If wkKONPO_F = "1" Then
                                            
                        If Inspection_Input Then
                            KUTI_SU_INPUT_F = False
                        Else
                            KUTI_SU_INPUT_F = True
                        End If
                    
                    
                        TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU
                        TOTAL_SAI_SU = Syuka_END_Count_Proc()
                                
                    Else
                        TOTAL_KUTI_SU = 1
                        KUTI_SU_INPUT_F = True
                        TOTAL_SAI_SU = 0#
                    End If
                                
                                
                                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "3" Then
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(0).KONPOU_CND = "1"
                    End If
                                
                                
                    If KUTI_SU_INPUT_F Then
                    
                        Call Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = -1
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = -1
                    
                    
                    Else
                        Call Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU)
                    
                        
                        If KutiSai_Update_Proc(TOTAL_KUTI_SU, TOTAL_SAI_SU) Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_INP_KUTI_SU = TOTAL_KUTI_SU
                        ID_KANRI_TBL(ING_No).KEN_INP_SAI_SU = TOTAL_SAI_SU
                    
                    
                    
                    End If
                    
                    Sendbuf = Text_Create_Proc()
                
                Case 9
        
                    Select Case (Y_SYU_CNT - Sumi_CNT)
                
                        Case 0
                
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                            End Select
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                            
                            Sendbuf = Text_Create_Proc()
            
            
                        Case Else
                        
        ''''''''''''''''''''''''''''''''''''''''''''''
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                            '-----------------------------------------------ÉwÉbÉ_Å[ 02.24
                            Call Wel_Head_Text_Proc
                            '-----------------------------------------------ÇPçsñ⁄
                            Call Wel_DETAIL_0_Text_Proc
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                            Call Wel_HIN_NO_Req_Text_3_Proc
                            '-----------------------------------------------ÇSçsñ⁄
                            Call Wel_HIN_NO_Req_Text_4_Proc
                            '-----------------------------------------------ÇTçsñ⁄
                            Call Wel_Clear_Text_Proc
        
                            Sendbuf = Text_Create_Proc()
        
            
                End Select
            End Select
    
    End Select
                    
                    

    Inspe_Proc_LOGISTIC = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
















Private Function Inspe_Proc_E_BAG(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅj≤∞ ﬁØ∏ëŒâûÅx
'
'       2010.01.21
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Integer
Dim UNSOU_KAISHA    As String
Dim SURYO           As String


Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag


Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2


Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean


Dim OKURI_NO_F      As Boolean

Dim FUKUYAMA_CHK_F  As Boolean

    Inspe_Proc_E_BAG = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F)
                        
                        
                        
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        
                        
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                            End If
                        End If
                        
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                                                 
                                                 
                                                 
                                                 
                                                 
                                                 
                        If Sumi_CNT = Y_SYU_CNT Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        
                        End If
                                                 
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                                            
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                        Else
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
    
    
    
                End Select
            Next i
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                    
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
                        
'2009.10.14                         If Len(OKURI_NO) < 11 Or Len(OKURI_NO) > 13 Then
'                        If Len(OKURI_NO) < 10 Or Len(OKURI_NO) > 13 Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                            Inspe_Proc_E_BAG = False
'                            Exit Function
'                        End If
                    
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                            End If
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                                                
                            End If
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        
                        
    '                        Select Case Len(Trim(OKURI_NO))
    '
    '                            Case FUKUYAMA_Length
    '                            Case SEIBU_Length
    '                            Case KURUME_Length
    '
    '                                For k = 0 To UBound(KURUME_CODE)
    '
    '                                    If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
    '                                        Exit For
    '                                    End If
    '                                Next k
    '
    '                                If k > UBound(KURUME_CODE) Then
    '
    '
    '                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
    '
    '                                    Sendbuf = Text_Create_Proc()
    '                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
    '                                    Inspe_Proc_E_BAG = False
    '                                    Exit Function
    '
    '                                End If
    '
    '                            Case SAGAWA_Length, YAMATO_Length
    '
    '                                For k = 0 To UBound(KURUME_CODE)
    '
    '                                    If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
    '                                        Exit For
    '                                    End If
    '                                Next k
    '
    '                                If k > UBound(SAGAWA_CODE) Then
    '
    '                                    For k = 0 To UBound(YAMATO_CODE)
    '
    '                                        If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
    '                                            Exit For
    '                                        End If
    '
    '                                    Next k
    '
    '                                    If k > UBound(YAMATO_CODE) Then
    '
    '                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
    '
    '                                        Sendbuf = Text_Create_Proc()
    '                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
    '                                        Inspe_Proc_E_BAG = False
    '                                        Exit Function
    '
    '
    '
    '                                    End If
    '
    '                                End If
    '
    '
    '                        End Select
                        End If
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                            
'                                'â^ëóâÔé–ïœä∑
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                                End If
'                                'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                                If KURUME_F Then        'ãvóØïƒ
'                                    For k = 1 To UBound(KURUME)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If FUKUYAMA_F Then      'ïüéR
'                                    For k = 1 To UBound(FUKUYAMA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
'
'                                If SAGAWA_F Then        'ç≤êÏ
'                                    For k = 1 To UBound(SAGAWA)
'
'                                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                            Exit For
'                                        End If
'                                    Next k
'                                End If
                                                    
                                                    
                                                    
'                                Select Case Len(Trim(OKURI_NO))
'
'                                    Case FUKUYAMA_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
'                                    Case SEIBU_Length
'                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
'
'                                    Case KURUME_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(KURUME_CODE) Then
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
'                                        End If
'
'                                    Case SAGAWA_Length, YAMATO_Length
'
'                                        For k = 0 To UBound(KURUME_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                                Exit For
'                                            End If
'                                        Next k
'
'                                        If k > UBound(SAGAWA_CODE) Then
'
'                                            For k = 0 To UBound(YAMATO_CODE)
'
'                                                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                    Exit For
'                                                End If
'
'                                            Next k
'
'                                            If k > UBound(YAMATO_CODE) Then
'                                            Else
'
'                                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
'                                            End If
'
'                                        Else
'                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
'                                        End If
'
'
'                                End Select
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                'ï®ó¨ 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
'                                End If
'
'                                'ê‘ñX 2010.02.19
'                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
'                                End If
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_E_BAG = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                
                                                                                
                        Sumi_CNT = 0
                        Y_SYU_CNT = 0
                                                                                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        FAST_F = True
                                                                                                    
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            Else
                                If FAST_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                        Sumi_CNT = Sumi_CNT + 1
                                    End If
                                    FAST_F = False
                                
                                Else
                                    For k = 0 To j - 1
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                                Exit For
                                            End If
                                        End If
                                    Next k
                            
                                    If k > j - 1 Then
                            
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            Sumi_CNT = Sumi_CNT + 1
                                        End If
                                    End If
                                End If
                            End If
                        Next j
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                
                
                
                
                
                End Select
                
                
                
            Next i
        
        
        
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
                '2010.12.07
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                '2010.12.07
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                        
                        
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next j
                                            
                            If j <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                
                
                
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                
                                                                                
                        Sumi_CNT = 0
                        Y_SYU_CNT = 0
                                                                                

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                        FAST_F = True
                                                                                                    
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            Else
                                If FAST_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                        Sumi_CNT = Sumi_CNT + 1
                                    End If
                                    FAST_F = False
                                
                                Else
                                    For k = 0 To j - 1
                                        If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                                Exit For
                                            End If
                                        End If
                                    Next k
                            
                                    If k > j - 1 Then
                            
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                            Sumi_CNT = Sumi_CNT + 1
                                        End If
                                    End If
                                End If
                            End If
                        Next j
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù


                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        Else
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                        End If
                        
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                                                                                
                                                                                
                                                                                'ï\é¶ì‡óe
                        
                        If Y_SYU_CNT < 2 Then
                        

                            If Inspection_QTY = 1 Then

                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
                            End If
                                                                                
                                                                                
                        Else
                        
                            If Inspection_QTY = 1 Then
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
                            End If
                        
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                        Else
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                        End If
                                                                                
                                                                                
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        If Inspection_QTY = 1 Then

                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                        Else
                            Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                        End If
                                                                                
                                                                                'ì¸óÕåÖêî
                        If Inspection_QTY = 1 Then
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                        Else
                            Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                        End If
                                                                                
                                                                                
                        '2009.04.15
                        If SYUKA_QTY > 1 Then
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                
                        End If
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        
                        
                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        
                
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            
            
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case RTrim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), _
                                Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2   'èoâ◊êî(åüïiêî)
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            
            
            
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
        
                    '''ëºçsÇÃégópÇåpë±Ç∑ÇÈÇΩÇﬂ
                    '''Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                    '''Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                    
                    
                    
                                
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_E_BAG = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
'                        'â^ëóâÔé–ïœä∑
'                        If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
'                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
'                        End If
'                        'êVâ^ëóâÔé–ïœä∑ 2007.01.09
'
'                        If KURUME_F Then        'ãvóØïƒ
'                            For k = 1 To UBound(KURUME)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If FUKUYAMA_F Then      'ïüéR
'                            For k = 1 To UBound(FUKUYAMA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
'
'                        If SAGAWA_F Then        'ç≤êÏ
'                            For k = 1 To UBound(SAGAWA)
'
'                                If Left(ID_KANRI_TBL(ING_No).KEN_OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
'                                    Exit For
'                                End If
'                            Next k
'                        End If
                                            
                                            
                                            
                                            
                                            
                        Select Case Len(Trim(OKURI_NO))
                        
                            Case FUKUYAMA_Length
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
                            Case SEIBU_Length
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
                        
                            Case KURUME_Length
                        
                                For k = 0 To UBound(KURUME_CODE)
                                
                                    If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
                                        Exit For
                                    End If
                                Next k
                        
                                If k > UBound(KURUME_CODE) Then
                                Else
                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
                                End If
                        
                            Case SAGAWA_Length, YAMATO_Length
                        
                                For k = 0 To UBound(KURUME_CODE)
                                
                                    If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
                                        Exit For
                                    End If
                                Next k
                        
                                If k > UBound(SAGAWA_CODE) Then
                                
                                    For k = 0 To UBound(YAMATO_CODE)
                                    
                                        If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
                                            Exit For
                                        End If
                                    
                                    Next k
                                 
                                    If k > UBound(YAMATO_CODE) Then
                                    Else
                                
                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
                                    End If
                                
                                Else
                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
                                End If
                        
                        
                        End Select
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                        'ï®ó¨ 2010.02.19
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
                        End If
                        
                        'ê‘ñX 2010.02.19
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
                        End If
                                                                    
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_E_BAG = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_E_BAG = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                                            
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                End If
            
            Next j
                                
                                
                                
                                
                                
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_E_BAG = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                
                                
                                
                                
                                
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
        
                    
            KENPIN_END = True
            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                                
                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                        KENPIN_END = False
                        Exit For
                    End If
                End If
            Next j
        
            Sumi_CNT = 0
            Y_SYU_CNT = 0
                                                                                
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
            FAST_F = True
                                                                                        
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
            
            
                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                Else
                    If FAST_F Then
                    
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Sumi_CNT = Sumi_CNT + 1
                        End If
                        FAST_F = False
                    
                    Else
                        For k = 0 To j - 1
                            If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                    Exit For
                                End If
                            End If
                        Next k
                
                        If k > j - 1 Then
                
                            Y_SYU_CNT = Y_SYU_CNT + 1
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                                Sumi_CNT = Sumi_CNT + 1
                            End If
                        End If
                    End If
                End If
            Next j
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                                                                
                                                                                
                                                                                
        
        
        
            Select Case KENPIN_END
                Case False
                    'åüïiécÇ†ÇËÅAïiî‘Ç÷
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                    '-----------------------------------------------ÇPçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            
                                                                            

                                                                            
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                            
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    '2010.12.07
'                    Send_Text.Box_Type(3).Max_Size = "13"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                    Send_Text.Box_Type(3).Max_Size = "20"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                    '2010.12.07
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                     Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                    Sendbuf = Text_Create_Proc()
                Case True
                    'åüïiäÆóπÅAå˚êîÇ÷
            
            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    
                    
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            
                                                                            
                                                                            
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    
                    
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    
                    
                    '-----------------------------------------------ÇSçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(3).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    
                    
                    '-----------------------------------------------ÇTçsñ⁄
                    KUTI_SU = 1
                                
                    Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_KUTI_SU)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_KUTI_SU)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = Space(9) & "1"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(9) & "1"
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = "07"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "07"
                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "04"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "04"
                    
                    
                    
                    Sendbuf = Text_Create_Proc()
            
            
            
            
            
            
            
            End Select
            
                
                
                
                
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    
                    'å˚êî
                    Case LCD_KUTI_SU
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        
                        End If
                
                        KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If KUTI_SU < 1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG = False
                            Exit Function
                        End If
                
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_E_BAG = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                            
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                            
                                                            
                                                            
                                                            
                                                            
                                Call UniCode_Conv(Y_SYU_HREC.JURYO, "0002.0")
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, "01.00")
                                                            
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_E_BAG = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                
                                        'éüÇÃçÏã∆óvãÅ
            
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
                
                
                
                
                
            Next i
                
                
                
                
    
    
    End Select

    Inspe_Proc_E_BAG = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function
Private Function Inspe_Proc_E_BAG_ALL(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅj≤∞ ﬁØ∏ëŒâûÅx
'
'       2010.01.21
'       2012.06.20      ëSêîåüïiëŒâû
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Integer
Dim UNSOU_KAISHA    As String
Dim SURYO           As String


Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag


Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim KONPOU_ON       As Integer
Dim KONPOU_ON_SUMI  As Integer
Dim KONPOU_OFF      As Integer
Dim KONPOU_OFF_SUMI As Integer




Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2


Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean


Dim OKURI_NO_F      As Boolean

Dim FUKUYAMA_CHK_F  As Boolean

    
Dim Cnt_F               As Boolean  '2012.06.20
Dim Print_bara_F        As Boolean  '2012.06.20

Dim Hin_Total           As Long     '2012.06.20
    
Dim KEN_HINBAN          As String * 20      '2012.10.02
    
    
    Inspe_Proc_E_BAG_ALL = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                        '2012.10.02Å@KEN_HINBANí«â¡
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, , , , , , , , , , , _
                                                KEN_HINBAN)
                        
                        
                        
                        
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        If sts = SYS_CANCEL Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                        'ëºí[ññÇ≈égópíÜ 2011.04.07
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            End If
                        End If
                        
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                        
                        If Sumi_CNT = Y_SYU_CNT Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        
                        End If
                                                 
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = Y_SYU_TBL(j).CNT_BARA_SU      'åüïié¿ê—Å@ÉoÉâ
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = Y_SYU_TBL(j).CNT_HAKO_SU      'åüïié¿ê—Å@î†
                            
                
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = Y_SYU_TBL(j).Y_HIN_CHK_CNT  'ïiî‘ì«çûÇ›âÒêî
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = Y_SYU_TBL(j).J_HIN_CHK_CNT  'ïiî‘ì«çûÇ›çœÇ›âÒêî

'2012.11.15                            ID_KANRI_TBL(ING_No).KEN_HINBAN = KEN_HINBAN
                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                '2012.11.15
                        ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = KEN_HINBAN    '2012.11.15
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                         '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                                            
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                        Else
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO))
                        End If
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
    
    
    
                End Select
            Next i
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                    
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else
                        
                    
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            End If
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                                                
                            End If
                        
                        
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                        
                        
                        
                        End If
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                                            
                                'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_E_BAG_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                
                                                                                
                        Sumi_CNT = 0
                        Y_SYU_CNT = 0
                                                                                

                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
'2012.11.15                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
'2012.11.15
'2012.11.15
'2012.11.15                                                                                'êîílèâä˙ï\é¶
'2012.11.15                        Send_Text.Box_Type(2).INIT = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                        Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                'ì¸óÕåÖêî
'2012.11.15                        Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '2012.11.15
                        Call Wel_OKURI_SAKI_PROC
                        
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(3).Max_Size = "13"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                
                
                
                
                
                End Select
                
                
                
            Next i
        
        
        
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
                '2010.12.07
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                '2010.12.07
                    
                    Case LCD_Hinban, "èoâ◊"   'ïiî‘/èoâ◊êîÅiïiî‘Åj
                        If Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2) = "èoâ◊" Then
                            Cnt_F = True
                        Else
                            ID_KANRI_TBL(ING_No).LAST_START_PAGE = ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO + 1 '2012.04.01
                        End If
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                        
                        
                        '∑¨›æŸÇÃ¡™Ø∏
                        CANCEL_F = True
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            End If
                        Next j
                        
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ÉLÉÉÉìÉZÉãïiî‘Ç≈Ç∑ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        
                        
                        End If
                        
                        
                        
                                
                        'åüïiçœÇ›ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                Exit For
                            End If
                        Next j
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "åüïiçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                        If Inspection_Flg = 0 Then
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).KAN_KBN <> KAN_KBN_FIN Then
                                        Exit For
                                    End If
                                End If
                            Next k
                            '2012.09.24 j-->k
                            If k <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            End If
                        End If
                        'ñ¢èoå…ÇÃ¡™Ø∏   2007.05.14
                
                
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02-->2012.11.15 KEN_HINBAN-->KEN_ING_HINBAN
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) Then
                            If Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) <> "" Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ëºïiî‘åüïiíÜÅI", ID_KANRI_TBL(ING_No).KEN_ING_HINBAN)
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            End If
                        End If
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.02
                
                
                
                        If Cnt_F Then
                        
                            If RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) <> RTrim(Hinban) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, ID_KANRI_TBL(ING_No).KEN_HINBAN, "ïiî‘ÉGÉâÅ[")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                Exit Function
                            End If
                        End If
                
                
                
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                
                
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.06.20  ëSêîåüïiëŒâû
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 0 Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1
                            End If
                            Hin_Total = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                If ID_KANRI_TBL(ING_No).KEN_HINBAN = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then                '2012.09.05
                                    
                                        Hin_Total = Hin_Total + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If                                                                  '2012.09.05
                                End If
                            Next k
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)) + _
                                                                                        (Hin_Total - _
                                                                                        ((CLng(ToRoundDown(CCur(Hin_Total / ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY)
                            
                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY = 1 Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = Hin_Total
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY = CLng(ToRoundUp(CCur(Hin_Total Mod ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY), 0))    '2012.04.09
                            End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = 0
                            'ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            '
                            'If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = 1
                            'Else
                            '    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            'End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  DELETE
                        
                        
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                            
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.02  INS
                        
                        End If
                        
                        If Cnt_F Then
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT + 1
                        
                            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).BARA_QTY Then
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + 1
                                Print_bara_F = True
                            Else
                                ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).GAISO_IRI_QTY
                            End If
                        
                        
                        End If


'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02
                        '----------------------------------- ÉgÉâÉìÉUÉNÉVÉáÉìäJén -----------
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If


                        For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
'2012.10.02                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
'2012.10.02
'2012.10.02                                '------------------------------------   èoâ◊ó\íËÇÃèàóù
'2012.10.02                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
'2012.10.02
'2012.10.02
'2012.10.02                                Do
'2012.10.02
'2012.10.02                                    sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.10.02                                    Select Case sts
'2012.10.02                                        Case BtNoErr
'2012.10.02                                            Exit Do
'2012.10.02                                        Case BtErrKeyNotFound
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_E_BAG_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_E_BAG_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                        Case Else
'2012.10.02                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
'2012.10.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                    End Select
'2012.10.02
'2012.10.02                                Loop
'2012.10.02
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))
'2012.10.02
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
'2012.10.02                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
'2012.10.02
'2012.10.02
'2012.10.02
'2012.10.02                                Do
'2012.10.02
'2012.10.02                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
'2012.10.02                                    Select Case sts
'2012.10.02                                        Case BtNoErr
'2012.10.02                                            Exit Do
'2012.10.02                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.10.02                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.02                                            Inspe_Proc_E_BAG_ALL = False
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                        Case Else
'2012.10.02                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
'2012.10.02                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.10.02                                            Sendbuf = Text_Create_Proc()
'2012.10.02                                            GoTo Abort_Tran
'2012.10.02                                    End Select
'2012.10.02
'2012.10.02                                Loop
'2012.10.02
'2012.10.02                            End If
'2012.10.02
'2012.10.02
                            '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SEQ_NO, "00"))
                
                
                            Do
                            
                                sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(Hinban) Then
    

                                Call UniCode_Conv(Y_SYU_HREC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_BARA_SU, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CNT_HAKO_SU, "0"))
    
                                Call UniCode_Conv(Y_SYU_HREC.GAISO_IRI_QTY, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).GAISO_IRI_QTY, "0"))

                                Call UniCode_Conv(Y_SYU_HREC.Y_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).Y_HIN_CHK_CNT, "0"))
                                Call UniCode_Conv(Y_SYU_HREC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).J_HIN_CHK_CNT, "0"))
                            End If
                        
                            Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, ID_KANRI_TBL(ING_No).KEN_HINBAN)

                        
                            Do
                            
                                sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù  2012.10.02
                        Next k
                        
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            Exit Function
                        End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> åüïiÇÃédä|èÓïÒèëÇ´çûÇ›  2012.10.02

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.06.20  ëSêîåüïiëŒâû
                
                
                
                
                
                
                
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).Y_HIN_CHK_CNT Then
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    
                                                                                    
                        
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
    
    
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                    "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                    "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                                    'ï\é¶ì‡óe
'2012.11.15
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                                    'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                    'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            If Inspection_QTY = 1 Then
    
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            Else
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM                             '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM        '2007.04.21
                            End If
                            
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)                       '2012.09.05 J-->k
                            
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                    
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                                    
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                        SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If
                                End If
                            Next k
                                                                                    
                                                                                    
                                                                                    'ï\é¶ì‡óe
                            
                            If Y_SYU_CNT < 2 Then
    
                                '                               2012.09.05Å@DELÅ@Å§
                                'If Inspection_QTY = 1 Then
                                '    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                '    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                'Else
                                '    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)                         '2007.04.21
                                '    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su1)    '2007.04.21
                                'End If
                                '                               2012.09.05Å@DELÅ@Å¢
                                
                                
                                '                               2012.09.05Å@INSÅ@Å§
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                '                               2012.09.05Å@INSÅ@Å¢
                                                   
                                                                                    
                            Else
                            
                                '                               2012.09.05Å@DELÅ@Å§
'                                If Inspection_QTY = 1 Then
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & StrConv(Format(SYUKA_QTY, "#0"), vbWide) & "*")
'                                Else
'                                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)                       '2007.04.21
'                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Syuka_Su2)  '2007.04.21
'                                End If
                                '                               2012.09.05Å@DELÅ@Å¢
                                
                                
                                '                               2012.09.05Å@INSÅ@Å§
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                '                               2012.09.05Å@INSÅ@Å¢
                            
                            End If
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            If Inspection_QTY = 1 Then
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                            Else
                                Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                            End If
                                                                                    
                                                                                    
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            If Inspection_QTY = 1 Then
    
                                Send_Text.Box_Type(4).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                            Else
                                Send_Text.Box_Type(4).Start_Pos = "10"                                          '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "10"                     '2007.04.21
                            End If
                                                                                    
                                                                                    'ì¸óÕåÖêî
                            If Inspection_QTY = 1 Then
                                Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                            Else
                                Send_Text.Box_Type(4).Max_Size = "07"                                           '2007.04.21
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "07"                      '2007.04.21
                            End If
                                                                                    
                                                                                    
                            '2009.04.15
                            If SYUKA_QTY > 1 Then
                                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            Else                                            '2012.11.15
                                ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""    '2012.11.15
                                                                                    
                            End If
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            
                            
                            Sendbuf = Text_Create_Proc()
                
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        Else
                
                
    '------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                
                                
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
        
        ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                
                            'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                            Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
        ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                            '-----------------------------------------------ÇQçsñ⁄
                            Call Wel_DETAIL_1_Text_Proc(ID_KANRI_TBL(ING_No).ID_NO, Sumi_CNT, Y_SYU_CNT)
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´

'2012.11.15                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15
'2012.11.15                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                                                                                        'êîílèâä˙ï\é¶
'2012.11.15                            Send_Text.Box_Type(2).INIT = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                                        'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                            Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                                        'ì¸óÕåÖêî
'2012.11.15                            Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '2012.11.15
                            Call Wel_OKURI_SAKI_PROC
                            
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                       'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                        
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK                             '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK        '2007.04.21
                            
                            Y_SYU_CNT = 0
                            SYUKA_QTY = 0
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                
                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                                        
                                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then        '2012.09.05 j-->k
                                        
                                        Y_SYU_CNT = Y_SYU_CNT + 1
                                            SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).SURYO
                                    End If
                                End If
                            Next k
                                                                                    'ï\é¶ì‡óe
                            
                            If Y_SYU_CNT < 2 Then
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY)
                                                                                        
                            Else

                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "èoâ◊êîÅF" & (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU) & "/" & SYUKA_QTY & "*")
                            End If
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""                                                     '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""                                '2007.04.21
                            Send_Text.Box_Type(4).Start_Pos = "01"                                              '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"                         '2007.04.21
                            Send_Text.Box_Type(4).Max_Size = "20"                                               '2007.04.21
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"                          '2007.04.21
                            '2009.04.15
                            If SYUKA_QTY > 1 Then
                                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then        '2012.04.09
                                Else
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                End If                  '2012.04.09
                            End If
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            Sendbuf = Text_Create_Proc()
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
        
                
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiåüïiêîÅ@éÛêMÅj
            
            
            
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case RTrim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), _
                                Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    Case LCD_Syuka_Su1, LCD_Syuka_Su2   'èoâ◊êî(åüïiêî)
                        SURYO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        If Not IsNumeric(SURYO) Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        
                        End If
                
                        Y_SYU_CNT = 0
                        SYUKA_QTY = 0
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                            If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                                
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    SYUKA_QTY = SYUKA_QTY + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO
                                End If
                            End If
                        Next j
                
                
                
                        If CLng(SURYO) <> SYUKA_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊êîÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                
                End Select
            
            Next i
            
            
            
            ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = ""        '2012.11.15

            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
                                            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
                    
                    
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                        
                        
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                                 Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                    
                        Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                        Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                
                                                
                                                
                                                    'èoâ◊ó\íËèëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                    Inspe_Proc_E_BAG_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                        
                        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
        
                        Do
                        
                            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrKeyNotFound
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                    
                        Loop
                                            
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                            
                        Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                            
                                            
                                            
                                            
                                            
                        Select Case Len(Trim(OKURI_NO))
                        
                            Case FUKUYAMA_Length
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
                            Case SEIBU_Length
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
                        
                            Case KURUME_Length
                        
                                For k = 0 To UBound(KURUME_CODE)
                                
                                    If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
                                        Exit For
                                    End If
                                Next k
                        
                                If k > UBound(KURUME_CODE) Then
                                Else
                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
                                End If
                        
                            Case SAGAWA_Length, YAMATO_Length
                        
                                For k = 0 To UBound(KURUME_CODE)
                                
                                    If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
                                        Exit For
                                    End If
                                Next k
                        
                                If k > UBound(SAGAWA_CODE) Then
                                
                                    For k = 0 To UBound(YAMATO_CODE)
                                    
                                        If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
                                            Exit For
                                        End If
                                    
                                    Next k
                                 
                                    If k > UBound(YAMATO_CODE) Then
                                    Else
                                
                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
                                    End If
                                
                                Else
                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
                                End If
                        
                        
                        End Select
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                        'ï®ó¨ 2010.02.19
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
                        End If
                        
                        'ê‘ñX 2010.02.19
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
                        End If
                                                                    
                                            
                        Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
'2012.10.31                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                            
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                        Do
                            sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                    Exit Do
                                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_E_BAG_ALL = False
                                    GoTo Abort_Tran
                            
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                    Inspe_Proc_E_BAG_ALL = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        Loop
                                            
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                            
                        'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                        Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                        Call UniCode_Conv(K0_MTS.SS_CODE, "")
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                                Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                            Case Else
                                Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                                            
                                            
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    CYU_KBN_SPO, _
                                                    Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                    , , , , MENU_NO, _
                                                    ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_E_BAG_ALL = SYS_ERR
                                GoTo Abort_Tran
                        End Select
                                            
                        'åüïiçœÅIÅI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = True
                                            
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                                        
                    End If
                
                
                '--------------------   2012.10.02  Å§
                Else
                
                    Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ
    
                    Do
                    
                        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                GoTo Abort_Tran
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                GoTo Abort_Tran
                            Case Else
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                
                    Loop
                
                
                    Call UniCode_Conv(Y_SYU_HREC.KEN_HINBAN, "")                '2012.10.02
''''''''''''                    ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.02
                                                'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                    Do
                        sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_E_BAG_ALL = False
                                GoTo Abort_Tran
                        
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                Inspe_Proc_E_BAG_ALL = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                
                '--------------------   2012.10.02  Å¢
                
                
                End If
            
            Next j
                                
                                
'2012.11.15            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.31
                                
                                
                                
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO) Then
                    Inspe_Proc_E_BAG_ALL = SYS_ERR
                    Exit Function
                End If
            End If
            'çÏã∆€∏ﬁèoóÕ    2009.04.17
                                
                                
                                
                                
                                
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
        
                    
            KENPIN_END = True
            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                                                
                                                
                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                    If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                        KENPIN_END = False
                        Exit For
                    End If
                End If
            Next j
        ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                
                'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
        ''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
            Select Case KENPIN_END
                Case False
                    'åüïiécÇ†ÇËÅAïiî‘Ç÷
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                    '-----------------------------------------------ÇPçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            
                                                                            

                                                                            
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
'2012.11.15                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                            'ï\é¶ì‡óe
'2012.11.15                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15
'2012.11.15                                                                            'êîílèâä˙ï\é¶
'2012.11.15                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                            'ì¸óÕåÖêî
'2012.11.15                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '2012.11.15
                    Call Wel_OKURI_SAKI_PROC

                    '-----------------------------------------------ÇSçsñ⁄
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    '2010.12.07
'                    Send_Text.Box_Type(3).Max_Size = "13"
'                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                    Send_Text.Box_Type(3).Max_Size = "20"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                    '2010.12.07
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                     Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                    Sendbuf = Text_Create_Proc()
                Case True
                    'åüïiäÆóπÅAå˚êîÇ÷
            
            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    
                    
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                    '-----------------------------------------------ÇPçsñ⁄
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            
                                                                            
                                                                            
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    
                    
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
'2012.11.15                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
'2012.11.15                                                                            'ï\é¶ì‡óe
'2012.11.15
'2012.11.15                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
'2012.11.15
'2012.11.15                                                                            'êîílèâä˙ï\é¶
'2012.11.15                    Send_Text.Box_Type(2).INIT = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
'2012.11.15                                                                            'èâä˙ÉJÅ[É\Éãà íu
'2012.11.15                    Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
'2012.11.15                                                                            'ì¸óÕåÖêî
'2012.11.15                    Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
'2012.11.15
'2012.11.15                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'2012.11.15                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    
                    '2012.11.15
                    Call Wel_OKURI_SAKI_PROC
                    
                    '-----------------------------------------------ÇSçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(3).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    
                    
                    '-----------------------------------------------ÇTçsñ⁄
                    KUTI_SU = 1
                                
                    Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_KUTI_SU)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_KUTI_SU)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = Space(9) & "1"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(9) & "1"
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = "07"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "07"
                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "04"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "04"
                    
                    
                    
                    Sendbuf = Text_Create_Proc()
            
            
            
            
            
            
            
            End Select
            
                
                
                
                
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiå˚êîÅj
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    
                    'å˚êî
                    Case LCD_KUTI_SU
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        
                        End If
                
                        KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If KUTI_SU < 1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_E_BAG_ALL = False
                            Exit Function
                        End If
                
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
            
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_E_BAG_ALL = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        Inspe_Proc_E_BAG_ALL = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
                            'ID_NO
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                            
                                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                            
                                                            
                                                            
                                                            
                                                            
                                Call UniCode_Conv(Y_SYU_HREC.JURYO, "0002.0")
                                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, "01.00")
                                                            
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            Inspe_Proc_E_BAG_ALL = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Inspe_Proc_E_BAG_ALL = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                            End If
                                        
            
                        Next j
                                
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                
                                        'éüÇÃçÏã∆óvãÅ
            
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
                
                
                
                
                
            Next i
                
                
                
                
    
    
    End Select

    Inspe_Proc_E_BAG_ALL = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function



Private Function LABEL_RePrint_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwâ◊éDÉâÉxÉãÅ@çƒî≠çsÅx
'
'       2010.01.21
'-------------------------------------------------------
Dim sts             As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Long

Dim SAI_SU          As Double

Dim UNSOU_KAISHA    As String
 
Dim SYUKA_YMD       As String
Dim JYUSHO          As String
Dim BIKOU           As String

Dim SURYO           As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag

Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean

Dim FAST_F          As Boolean
Dim Found_F         As Boolean

'2010.01.21
Dim KONPOU_ON           As Integer
Dim KONPOU_ON_SUMI      As Integer
Dim KONPOU_OFF          As Integer
Dim KONPOU_OFF_SUMI     As Integer
Dim PRINT_OFF           As Boolean
Dim Start_Page_No       As Long
Dim PRINT_TOTAL_SU      As Long
Dim PRINT_MAISU         As Long
Dim fileName            As String
Dim ID_SEQ              As Integer
Dim DISP_SAI_SU         As Double

Dim wkKUTI_SU           As String
Dim wkKONPO_F           As String * 1

Dim TOTAL_KUTI_SU       As Integer
Dim TOTAL_SAI_SU        As Double
Dim MUKE_NAME           As String
Dim OKURI_NO_MAX        As Integer
Dim KUTI_SU_INPUT_F     As Boolean


Dim S_PAGE              As Integer
Dim E_PAGE              As Integer

Dim Label_RePrint_Kuti_Su _
                        As Integer
Dim Label_RePrint_Sai_Su _
                        As Double



'2010.01.21

    LABEL_RePrint_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, _
                                                SYUKA_YMD, _
                                                JYUSHO, _
                                                BIKOU, _
                                                Start_Page_No, _
                                                KUTI_SU, _
                                                MUKE_NAME, _
                                                OKURI_NO_MAX, _
                                                Label_RePrint_Kuti_Su, _
                                                Label_RePrint_Sai_Su)
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        
                        If Found_F Then
                        
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                LABEL_RePrint_Proc = False
                                Exit Function
                            End If
                        End If
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        End If
                                                 
'2012.03.06                        If Sumi_CNT <> Y_SYU_CNT Then
'2012.03.06
'2012.03.06                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïiñ¢èàóùÅI", "", "")
'2012.03.06                            Sendbuf = Text_Create_Proc()
'2012.03.06                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.03.06                            LABEL_RePrint_Proc = False
'2012.03.06                            Exit Function
'2012.03.06
'2012.03.06                        End If
                                                             
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                 
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN = Y_SYU_TBL(j).KAN_KBN      '2007.05.14
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_CND = Y_SYU_TBL(j).KONPOU_CND    '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).TOTAL_SU = Y_SYU_TBL(j).TOTAL_SU        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU = Y_SYU_TBL(j).SAI_SU            '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU = Y_SYU_TBL(j).KUTI_SU          '2010.01.21
                        
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).PRINT_SUMI = Y_SYU_TBL(j).PRINT_SUMI    '2010.01.21
                        
                                                                                                        '2010.01.21
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = Y_SYU_TBL(j).OKURI_NO_SEQ
                        
                        Next j
                        
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                        
                        'ëóÇËêÊ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        
                        'â^ëóâÔé–
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                        
                        'èoâ◊ì˙
                        ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = SYUKA_YMD
                        'èZèä
                        ID_KANRI_TBL(ING_No).KEN_JYUSHO = JYUSHO
                        
                        'îıçl
                        ID_KANRI_TBL(ING_No).KEN_BIKOU = BIKOU
                        'å¸ÇØêÊ
                        ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = MUKE_NAME
                        
                        'é}î‘
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO_MAX = OKURI_NO_MAX
                        
                        ID_KANRI_TBL(ING_No).Label_RePrint_Kuti_Su = Label_RePrint_Kuti_Su
                        ID_KANRI_TBL(ING_No).Label_RePrint_Sai_Su = Label_RePrint_Sai_Su
                        
                        
                        
                        '◊ÕﬁŸäJénÉyÅ[ÉWáÇ
                        ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = Start_Page_No
                        
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = KUTI_SU
                        If Label_Print_Total_Su_Proc(KUTI_SU, PRINT_TOTAL_SU) Then
                        
                    
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        
                        
                        
                        End If
                        ID_KANRI_TBL(ING_No).LABEL_PRINT_TOTAL_SU = PRINT_TOTAL_SU
                        
                        
                        'èoâ◊é¿ê—Å^èoâ◊ó\íËêîÅ^èWçáç´ïÔåèêîÅió\íËÅjÅ^íPëÃç´ïÔåèêîÅió\íËÅjÅ^èWçáç´ïÔåèêîÅié¿ê—ÅjÅ^íPëÃç´ïÔåèêîÅié¿ê—ÅjÇÃÉJÉEÉìÉg
                        Call Syuka_Kenpin_Count_Proc(Sumi_CNT, Y_SYU_CNT, KONPOU_ON, KONPOU_OFF, KONPOU_ON_SUMI, KONPOU_OFF_SUMI)
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                                
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Call Wel_Head_Text_Proc
                        '-----------------------------------------------ÇPçsñ⁄
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                    'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        If Inspection_Input Then
                            KUTI_SU_INPUT_F = False
                        Else
                            KUTI_SU_INPUT_F = True
                        End If
                        
                        TOTAL_KUTI_SU = ID_KANRI_TBL(ING_No).Label_RePrint_Kuti_Su
                        TOTAL_SAI_SU = ID_KANRI_TBL(ING_No).Label_RePrint_Sai_Su
                                            
                        If KUTI_SU_INPUT_F Then
                        
                            '-----------------------------------------------ÇQçsñ⁄
                        
                            wkKUTI_SU = Format(TOTAL_KUTI_SU, "#0")
                                        
                                        
                            Send_Text.Box_Type(1).Box_Type = TYPE_BCNUM
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_BCNUM
                                                                            'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_KUTI_SU_S)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_KUTI_SU_S)
                                                                            'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = 13
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = 13
                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "04"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "04"
                            
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    
                            wkKUTI_SU = Format(TOTAL_SAI_SU, "#0.00")
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_SAI_SU_S)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_SAI_SU_S)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = 12
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = 12
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "05"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "05"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                
                        Else
                            '-----------------------------------------------ÇQçsñ⁄
                            wkKUTI_SU = Format(TOTAL_KUTI_SU, "#0")
                                        
                                        
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_KUTI_SU_S & wkKUTI_SU)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_KUTI_SU_S & wkKUTI_SU)
                                                                            'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "00"
                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = ""
                            
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    
                            wkKUTI_SU = Format(TOTAL_SAI_SU, "#0.00")
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_SAI_SU_S & wkKUTI_SU)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_SAI_SU_S & wkKUTI_SU)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "00"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = ""
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        End If
                            
                            
                            
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                
                        wkKUTI_SU = "1"
                                    
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_S_PAGE_S)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_S_PAGE_S)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = 13
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = 13
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "03"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "03"
                        
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                            
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                
                        wkKUTI_SU = Format(TOTAL_KUTI_SU, "#0")
                                    
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_E_PAGE_S)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_E_PAGE_S)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = 13
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = 13
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "03"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "03"
                        
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            
                            
                        Sendbuf = Text_Create_Proc()
                        
                    End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiäJénÅ^èIóπÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Left(Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)), 6)
                    'äJén
                    Case LCD_S_PAGE_S
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "äJénÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        
                        End If
                    
                        S_PAGE = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If S_PAGE < 1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "äJénÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        End If
                    
                    
                    
                    'èIóπ
                    Case LCD_E_PAGE_S
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èIóπÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        
                        End If
                    
                        E_PAGE = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If E_PAGE < 1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èIóπÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        End If

                        If S_PAGE > E_PAGE Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "äJénÅÑèIóπ", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            LABEL_RePrint_Proc = False
                            Exit Function
                        End If


'2012.03.06                        If E_PAGE > ID_KANRI_TBL(ING_No).Label_RePrint_Kuti_Su Then
'2012.03.06                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èIóπÅÑå˚", "", "")
'2012.03.06
'2012.03.06                            Sendbuf = Text_Create_Proc()
'2012.03.06                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.03.06                            LABEL_RePrint_Proc = False
'2012.03.06                            Exit Function
'2012.03.06                        End If




                        PRINT_MAISU = E_PAGE - S_PAGE + 1
                                                
                        Start_Page_No = S_PAGE
                                                            
                        PRINT_TOTAL_SU = ID_KANRI_TBL(ING_No).Label_RePrint_Kuti_Su
                                                            
                                                            
                        If Label_File_Make_Proc(fileName, PRINT_MAISU, Start_Page_No, PRINT_TOTAL_SU) Then
                        End If
                                
                                
                                    
                        'ÉfÅ[É^ëóêM
                                                    
                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                    
                                                    
                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                    
                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                    
                        '-----------------------------------------------ÉwÉbÉ_Å[
                    
                        Call Wel_Head_Print_Text_Proc(fileName)
                    
                        Sendbuf = Text_Create_Proc()
                        
                    




                                            
                                            
                                            
                                                        
                End Select
            Next i

        Case Step_PRINT_RES        'àÛç¸èIóπ
    
    
        'éüÇÃçÏã∆óvãÅ

            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
        
            
    
    End Select
                    
                    

    LABEL_RePrint_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function


Private Function Inspe_Proc_GAI(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùÅiäCäOå¸ÇØÅjÅx
'
'   2009.08.07
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8
Dim Hinban          As String * 20          '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim JITU_QTY        As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim NAIGAI          As String * 1

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07



Dim KAN_FLG         As String * 1

Dim i               As Integer

Dim DEN_ID_LOOP     As Integer      '2006.06.01
Dim DEN_ID_JGYOBU   As String * 1   '2006.06.01


Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim KAN_KBN         As String * 1

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

Dim wkTEXT          As String


Dim wkKENPIN_YMD    As String * 8   'åüïiì˙ït   2007.10.10


Dim wkNull_Check    As String       '2009.04.27

Dim LK_MUKE_CODE    As String * 8

    Inspe_Proc_GAI = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiå¸ÇØêÊÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_MTS    'å¸ÇØêÊ
                                
                                
                                
                        Call UniCode_Conv(K2_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).Recv_text(i))
                        sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K2_MTS, Len(K2_MTS), 2)
                        Select Case sts
                            Case BtNoErr
                                If Len(Trim(StrConv(MTSREC.SS_CODE, vbUnicode))) <> 0 Then
                                
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "èoâ◊êÊÉGÉâÅ[", "", "")
                
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    Inspe_Proc_GAI = False
                                    Exit Function
                                
                                End If
                            
                            Case BtErrKeyNotFound
                            
                                Call UniCode_Conv(K3_MTS.SS_CODE, ID_KANRI_TBL(ING_No).Recv_text(i))
                                                    
                                sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K3_MTS, Len(K3_MTS), 3)
                                Select Case sts
                                    Case BtNoErr
                                    
                                    Case BtErrKeyNotFound
                                    
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "èoâ◊êÊÉGÉâÅ[", "", "")
                
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                        Inspe_Proc_GAI = False
                                        Exit Function
                                    
                                    Case Else
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊä«óùÉ}ÉXÉ^", 0)
                                        Exit Function
                                End Select
                    
                        End Select
                         
                        MTS_CODE = (ID_KANRI_TBL(ING_No).Recv_text(i))
                        SS_CODE = ""
                         
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = ""
                        
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN_BOU
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, MTS_CODE & SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, MTS_CODE & SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "13"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
                Select Case wkTEXT
                
                
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).Recv_text(i), "åüïiçÏã∆ïsâ¬", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_GAI = False
                            Exit Function
                        End If
    
    
    
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        For DEN_ID_LOOP = 0 To UBound(JGYOBU_T) '2006.06.01
                        
                            sts = Y_Syuka_Chek_Proc(KAN_KBN_FIN, _
                                                    JGYOBU_T(DEN_ID_LOOP).CODE, _
                                                    NAIGAI, _
                                                    Hinban, _
                                                    MTS_CODE, _
                                                    SS_CODE, _
                                                    CYU_KBN, _
                                                    Y_SYU_CNT, _
                                                    ID_NO, _
                                                    SYUKA_QTY, _
                                                    DEN_NO, _
                                                    KAN_KBN, _
                                                    JITU_QTY, _
                                                    DEN_ID_JGYOBU, _
                                                    wkKENPIN_YMD, , _
                                                    LK_MUKE_CODE)
                            If sts <> False Or Y_SYU_CNT <> 0 Then
                                Exit For
                            End If
                        
                        Next DEN_ID_LOOP
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_GAI = False
                                    Exit Function
                                End If
                
                            Case True
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Sendbuf = Text_Create_Proc()
                                Inspe_Proc_GAI = False
                                Exit Function
                        End Select
                        
                        
                        '------------------ å¸ÇØêÊÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).MTS_CODE <> LK_MUKE_CODE Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "å¸ÇØêÊÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_GAI = False
                            Exit Function
                        End If
                        '------------------ íçï∂ãÊï™ÇÃÉ`ÉFÉbÉN
                        If ID_KANRI_TBL(ING_No).CYU_KBN <> CYU_KBN Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "íçï∂ãÊï™É~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_GAI = False
                            Exit Function
                        End If
                        '------------------ èoå…äÆóπÇÃÉ`ÉFÉbÉN
                        If Inspection_Flg = 0 Then
                            If KAN_KBN <> KAN_KBN_FIN Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "çÏã∆ñ¢äÆóπ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_GAI = False
                                Exit Function
                            End If
                        End If
                        
                        '------------------ çƒåüïiÇÃÉ`ÉFÉbÉN    2007.10.10
                        If Inspection_CHK = 1 Then
                            If Trim(wkKENPIN_YMD) <> "" Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïiçœÇ≈Ç∑", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_GAI = False
                                Exit Function
                            End If
                        End If
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).MTS_CODE = LK_MUKE_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = ""
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Y_SYU_CNT = Y_SYU_CNT
                        ID_KANRI_TBL(ING_No).SYUKA_QTY = JITU_QTY
                        ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU = DEN_ID_JGYOBU      '2006.06.01
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.07.21                        Send_Text.Box_Type(3).Max_Size = "13"
'2007.07.21                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"                       '2007.07.21
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"  '2007.07.21
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                
                '2007.07.21 Å´
                If Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size) < 1 Then
                    wkTEXT = Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                Else
                    wkTEXT = Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                End If
                
'                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                Select Case wkTEXT
                '2007.07.21 Å™
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_GAI = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).Hinban) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ïiî‘ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_GAI = False
                            Exit Function
                        End If
                
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        '2009.07.29
                        If ID_KANRI_TBL(ING_No).SYUKA_QTY > 1 Then
                        
                            Send_Text.Buzzer = Wel_Inspe_BUZZER                 'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Wel_Inspe_BUZZER
                        
                        Else
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        End If
                        
                        '-----------------------------------------------ÇPçsñ⁄
'                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(0).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(0).Start_Pos = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(0).Max_Size = "00"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "èoâ◊êîÅF" & StrConv(Format(ID_KANRI_TBL(ING_No).SYUKA_QTY, "#0"), vbWide))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄


                        
                        
                        '2009.04.16
                        wkNull_Check = Replace(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode), Chr(0), " ")
                        If Trim(wkNull_Check) = "" Then
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Else
                                                                                    
                                                                                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                                                                    
                                                                                    
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Trim(StrConv(ITEMREC.INSP_MESSAGE, vbUnicode)))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        End If



                        Sendbuf = Text_Create_Proc()
                
                
                
                End Select
            
            Next i
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            'èoâ◊ó\íËÇÃì«Ç›çûÇ›
            '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU)     'éñã∆ïî
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDáÇ
    
            Do
            
                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrKeyNotFound
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_GAI = False
                        GoTo Abort_Tran
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_GAI = False
                        GoTo Abort_Tran
                    Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
        
            Loop
    
    
            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
            Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                            
            '2006.07.20 åüïiíSìñé“èoóÕí«â¡
            Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
            Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                            
                                            
                                            'èoâ◊ó\íËèëçûÇ›
            Do
                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        Inspe_Proc_GAI = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        Inspe_Proc_GAI = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            Loop
                                        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
                                        
                                        
                                        
            '2004.07.16 Å´
            
            '2006.06.01 ID_KANRI_TBL(ING_No).JGYOBU--> DEN_ID_JGYOBU
            
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).DEN_ID_JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).Hinban, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        "", , , , , MENU_NO, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE, _
                                        ID_KANRI_TBL(ING_No).SS_CODE, _
                                        ID_KANRI_TBL(ING_No).ID_NO)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Inspe_Proc_GAI = SYS_ERR
                    GoTo Abort_Tran
            End Select
            '2004.07.16 Å™
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                'åüïiämîFèIóπéûÇÕÅAì`ï[ÇhÇcóvãÅÇ…ñﬂÇ∑à◊ÇÃì¡éÍèàóù
                
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "12"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()


'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
            
                Sendbuf = Text_Create_Proc()
    
    
    End Select

    Inspe_Proc_GAI = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function





Private Function KYOSEI_END_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwåüïiã≠êßäÆóπÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'
'       2006.12.21
'-------------------------------------------------------
Dim sts             As Integer


'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07


Dim SYUKA_QTY       As Long
Dim MTS_CODE        As String * 8

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim OKURI_NO        As String
Dim KUTI_SU         As Integer

Dim SAI_SU          As Double
Dim JYURYO          As Integer


Dim UNSOU_KAISHA    As String

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag


Dim KAN_FLG         As String * 1

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer

Dim DEN_ID_LOOP     As Integer
Dim DEN_ID_JGYOBU   As String * 1

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 7
Dim KAN_KBN         As String * 1


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2


Dim KENPIN_END      As Boolean

Dim OKURI_SAKI      As String
Dim KENPIN_END_MARK As String * 1


Dim CANCEL_F        As Boolean

Dim Found_F         As Boolean


Dim OKURI_NO_F      As Boolean

Dim FUKUYAMA_CHK_F  As Boolean


    KYOSEI_END_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                                
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase Y_SYU_TBL
                                        
                        sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                                MTS_CODE, _
                                                Y_SYU_CNT, _
                                                Sumi_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                Y_SYU_TBL(), _
                                                OKURI_NO, _
                                                UNSOU_KAISHA, _
                                                OKURI_SAKI, _
                                                Found_F, , , , , , , , KUTI_SU, SAI_SU)
                        
                        
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.10.04  çÌèú
'                        'ëºí[ññÇ≈égópíÜ 2011.04.07
'                        If sts = SYS_CANCEL Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                            KYOSEI_END_PROC = False
'                            Exit Function
'                        End If
'                        'ëºí[ññÇ≈égópíÜ 2011.04.07
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> 2012.10.04  çÌèú
                        
                        
                        
                        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                        If Found_F Then
                            CANCEL_F = True
                                                     
                            For j = 0 To UBound(Y_SYU_TBL)
                            
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    CANCEL_F = False
                                    Exit For
                                End If
                            
                            Next j
                                                     
                                                     
                            If CANCEL_F Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KYOSEI_END_PROC = False
                                Exit Function
                            End If
                        End If
                        
                        
                        
                        If Y_SYU_CNT = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        End If
                
                        
                        If Y_SYU_CNT = Sumi_CNT Then

                            If Trim(OKURI_NO) = "" Then

                                KENPIN_END_MARK = ""
                            Else
                                KENPIN_END_MARK = "*"


                            End If
                        Else
                            KENPIN_END_MARK = ""

                        End If
                        
                        
                        
                        'åüïiÇã≠êßÇ≈äÆóπÇ∑ÇÈ
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                                                         
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                                
                                
                                
                        Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                                
                        For j = 0 To UBound(Y_SYU_TBL)
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                        
                        Next j
                            
                            
                            
                        ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = UNSOU_KAISHA
                            
                        ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = OKURI_SAKI
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                            
                        ID_KANRI_TBL(ING_No).SAI_SU = SAI_SU
                        ID_KANRI_TBL(ING_No).KUTI_SU = KUTI_SU
                            
                            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                                
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                        '-----------------------------------------------ÇPçsñ⁄
'                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                'ï\é¶ì‡óe
'                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                                                                                'êîílèâä˙ï\é¶
'                        Send_Text.Box_Type(0).INIT = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                'èâä˙ÉJÅ[É\Éãà íu
'                        Send_Text.Box_Type(0).Start_Pos = ""
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                'ì¸óÕåÖêî
'                        Send_Text.Box_Type(0).Max_Size = "00"
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, LCD_ID_No & ":" & Trim(KENPIN_END_MARK) & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, LCD_ID_No & ":" & Trim(KENPIN_END_MARK) & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                
                                
                                
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                
                                
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                        If Not IsNumeric(OKURI_NO) Then
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(UNSOU_KAISHA) & LCD_OKURI_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(UNSOU_KAISHA) & LCD_OKURI_NO)
                        Else
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, OKURI_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, OKURI_NO)
                        End If
                            
                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                                
                                
                        '-----------------------------------------------ÇTçsñ⁄
                        
                        If KUTI_SU = 0 Then
                            KUTI_SU = 1
                        End If
                                    
                                    
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(Trim(Format(KUTI_SU, "#0")))) & Trim(Format(KUTI_SU, "#0"))
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Trim(Format(KUTI_SU, "#0")))) & Trim(Format(KUTI_SU, "#0"))
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "07"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "07"
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "04"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "04"
                        
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                    
                                    
                        If SAI_SU = 0 Then
                        Else
                            If SAI_SU < 1 Then
                                SAI_SU = 1
                            Else
                                If SAI_SU > 1 Then
                                    SAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                                End If
                            End If
                        End If
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(SAI_SU, "#0")))) & Trim(Format(SAI_SU, "#0"))
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(SAI_SU, "#0")))) & Trim(Format(SAI_SU, "#0"))
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "07"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "07"
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "04"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "04"
                        
                        
                        Sendbuf = Text_Create_Proc()
                            
                        KYOSEI_END_PROC = False
                        Exit Function
                            
                End Select
            Next i
        
                
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇ,å˚êîÅj
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                    
                        If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) = "" Then
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                            
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        'É`ÉÉÅ[É^Å[ï÷   2010.01.21
                        
                        Else



'2009.10.14                        If Len(OKURI_NO) < 11 Or Len(OKURI_NO) > 13 Then
'                            If Len(OKURI_NO) < 10 Or Len(OKURI_NO) > 13 Then
'
'
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                KYOSEI_END_PROC = False
'                                Exit Function
'
'                            End If
                    
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KYOSEI_END_PROC = False
                                Exit Function
                            End If
                    
                    
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            
                            
                            
                            
                            If Not OKURI_NO_F Then
                            
                        
                        
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KYOSEI_END_PROC = False
                                Exit Function
                                                
                            End If
                    
                    
                    
                            '2090.04.28
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KYOSEI_END_PROC = False
                                Exit Function
                            
                            End If
                            '2090.04.28
                    
                    
                    
'                            Select Case Len(Trim(OKURI_NO))
'
'                                Case FUKUYAMA_Length
'                                Case SEIBU_Length
'                                Case KURUME_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(KURUME_CODE) Then
'
'
'                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                        Sendbuf = Text_Create_Proc()
'                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                        KYOSEI_END_PROC = False
'                                        Exit Function
'
'                                    End If
'
'                                Case SAGAWA_Length, YAMATO_Length
'
'                                    For k = 0 To UBound(KURUME_CODE)
'
'                                        If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
'                                            Exit For
'                                        End If
'                                    Next k
'
'                                    If k > UBound(SAGAWA_CODE) Then
'
'                                        For k = 0 To UBound(YAMATO_CODE)
'
'                                            If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
'                                                Exit For
'                                            End If
'
'                                        Next k
'
'                                        If k > UBound(YAMATO_CODE) Then
'
'                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
'
'                                            Sendbuf = Text_Create_Proc()
'                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                            KYOSEI_END_PROC = False
'                                            Exit Function
'
'
'
'                                        End If
'
'                                    End If
'
'
'                            End Select
                    
                    
                    
                                                
                    
                    
                    
                            ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO
                    
                    
                    
                        End If
                    
                    
                    'å˚êî
                    Case LCD_KUTI_SU
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                
                        KUTI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If KUTI_SU < 1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        End If
                
                
                
                    'çÀêî
                    Case LCD_SAI_SU
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                
                        SAI_SU = CInt(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
'                        If SAI_SU < 1 Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
'
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                            KYOSEI_END_PROC = False
'                            Exit Function
'                        End If
                
                
                        
                        If KUTI_SU = 0 And SAI_SU = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                        
                
                        If KUTI_SU = 0 And SAI_SU <> 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                
                
                        JYURYO = 0
                
                        If KUTI_SU = 1 And SAI_SU = 0 Then
                            JYURYO = 2
                        End If
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                                            
                                            
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
                        '------------------------------------   èoâ◊ó\íËÇÃèàóù
                            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                                'IDáÇ
                            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
Debug.Print Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO
                            Do
                            
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        KYOSEI_END_PROC = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        KYOSEI_END_PROC = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                        
                            Loop
    
                            Call UniCode_Conv(Y_SYUREC.WEL_ID, "")
                            Call UniCode_Conv(Y_SYUREC.PRG_ID, "")
                        
                            
                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                            
                                Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                            
                                Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                            
                            End If
                                                'èoâ◊ó\íËèëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        KYOSEI_END_PROC = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                        KYOSEI_END_PROC = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                            '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
'                            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                'ID_NO
                                Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                                Do
                        
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                                            
                                            
                                If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
                                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                    Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                                
                                    Call UniCode_Conv(Y_SYU_HREC.JURYO, Format(JYURYO, "0000.0"))
                   
                                                
                                                
                                    If Trim(StrConv(Y_SYU_HREC.KENPIN_NOW, vbUnicode)) = "" Then
                                    
                                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                                    
                                        Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                    
                                        Call UniCode_Conv(Y_SYU_HREC.KYOSEI_END, "1")
                                    
                                    End If
                                                
    '                                'â^ëóâÔé–ïœä∑
    '                                If Left(OKURI_NO, 3) = UNSOU_KAISHA_CODE Then
    '                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, UNSOU_KAISHA_NAME)
    '                                End If
    '
    '
    '                                'êVâ^ëóâÔé–ïœä∑ 2007.01.09
    '
    '                                If KURUME_F Then        'ãvóØïƒ
    '                                    For k = 1 To UBound(KURUME)
    '
    '                                        If Left(OKURI_NO, Len(KURUME(k))) = KURUME(k) Then
    '                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME(0))
    '                                            Exit For
    '                                        End If
    '                                    Next k
    '                                End If
    '
    '                                If FUKUYAMA_F Then      'ïüéR
    '                                    For k = 1 To UBound(FUKUYAMA)
    '
    '                                        If Left(OKURI_NO, Len(FUKUYAMA(k))) = FUKUYAMA(k) Then
    '                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA(0))
    '                                            Exit For
    '                                        End If
    '                                    Next k
    '                                End If
    '
    '                                If SAGAWA_F Then        'ç≤êÏ
    '                                    For k = 1 To UBound(SAGAWA)
    '
    '                                        If Left(OKURI_NO, Len(SAGAWA(k))) = SAGAWA(k) Then
    '                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA(0))
    '                                            Exit For
    '                                        End If
    '                                    Next k
    '                                End If
                                                        
                                                        
                                                        
                                                        
    '                                Select Case Len(Trim(OKURI_NO))
    '
    '                                    Case FUKUYAMA_Length
    '                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
    '                                    Case SEIBU_Length
    '                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
    '
    '                                    Case KURUME_Length
    '
    '                                        For k = 0 To UBound(KURUME_CODE)
    '
    '                                            If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
    '                                                Exit For
    '                                            End If
    '                                        Next k
    '
    '                                        If k > UBound(KURUME_CODE) Then
    '                                        Else
    '                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
    '                                        End If
    '
    '                                    Case SAGAWA_Length, YAMATO_Length
    '
    '                                        For k = 0 To UBound(KURUME_CODE)
    '
    '                                            If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
    '                                                Exit For
    '                                            End If
    '                                        Next k
    '
    '                                        If k > UBound(SAGAWA_CODE) Then
    '
    '                                            For k = 0 To UBound(YAMATO_CODE)
    '
    '                                                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
    '                                                    Exit For
    '                                                End If
    '
    '                                            Next k
    '
    '                                            If k > UBound(YAMATO_CODE) Then
    '                                            Else
    '
    '                                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
    '                                            End If
    '
    '                                        Else
    '                                            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
    '                                        End If
    '
    '
    '                                End Select
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                                        
                                    'ï®ó¨ 2010.02.19
    '                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_CHARTER_CD) Then
    '                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
    '                                End If
    '
    '                                'ê‘ñX 2010.02.19
    '                                If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_AKABOU_CD) Then
    '                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
    '                                End If
    '
    
    
    
                                    Call OKURI_NO_SET_PROC(OKURI_NO)
    
    
    
    '                                'ÉçÉWÉXÉeÉbÉN 2010.02.19
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                                        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ÉçÉWÉXÉeÉbÉN")
                                    End If
                                Else
                                                    
                                                    
                                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, "")
                                    Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, "")
                                    Call UniCode_Conv(Y_SYU_HREC.SAI_SU, "")
                                                
                                    Call UniCode_Conv(Y_SYU_HREC.JURYO, "")
                                                    
                                                    
                                End If
                                                    
                                                    
                                                    'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                                Do
                                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                    
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                            KYOSEI_END_PROC = SYS_ERR
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
'                            End If
                                        
                                        
                                        
                            '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù      2010.10.28
'                            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
'                                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
'
'                            Else
'                                MENU_NO = ""
'                            End If
'
'                            'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
'                            Call UniCode_Conv(K0_MTS.MUKE_CODE, StrConv(Y_SYUREC.MUKE_CODE, vbUnicode))
'                            Call UniCode_Conv(K0_MTS.SS_CODE, "")
'                            sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
'                            Select Case sts
'                                Case BtNoErr
'                                Case BtErrKeyNotFound
'                                    Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
'                                    Call UniCode_Conv(MTSREC.MUKE_NAME, "")
'                                Case Else
'                                    Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
'                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                    Sendbuf = Text_Create_Proc()
'                                    Exit Function
'                            End Select
'
'                            sts = IDOREKI_OUTPUT_PROC("", _
'                                                        "", _
'                                                        ID_KANRI_TBL(ING_No).JGYOBU, _
'                                                        ID_KANRI_TBL(ING_No).NAIGAI, _
'                                                        StrConv(Y_SYUREC.HIN_NO, vbUnicode), _
'                                                        "", _
'                                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
'                                                        0, _
'                                                        0, _
'                                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
'                                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
'                                                        FILE_RETRY, _
'                                                        CYU_KBN_SPO, _
'                                                        Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
'                                                        , , , , MENU_NO, _
'                                                        StrConv(Y_SYUREC.MUKE_CODE, vbUnicode), _
'                                                        "", _
'                                                        ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO, , , , 1)
'                            Select Case sts
'                                Case False      'ê≥èÌèIóπ
'                                Case Else
'                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                    Sendbuf = Text_Create_Proc()
'                                    KYOSEI_END_PROC = SYS_ERR
'                                    GoTo Abort_Tran
'                            End Select
'
'
'
'
                        Next j
'
'
'
'                    'çÏã∆€∏ﬁèoóÕ    2010.10.28
'                    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
'                        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
'
'                    Else
'
'                        MENU_NO = ""
'                    End If
'                    If Trim(MENU_NO) = "" Then
'                    Else
'                    'çÏã∆€∏ﬁèoóÕ
'
'                        If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
'                                                            (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
'                                                            ID_KANRI_TBL(ING_No).JGYOBU, _
'                                                            ID_KANRI_TBL(ING_No).NAIGAI, _
'                                                            MENU_NO, _
'                                                            (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
'                                                             , , , , , _
'                                                             ID_KANRI_TBL(ING_No).ID_NO) Then
'                            KYOSEI_END_PROC = SYS_ERR
'                            Exit Function
'                        End If
'                    End If
                    'çÏã∆€∏ﬁèoóÕ    2010.10.28
                                            
                                            
                                            
                                            
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                
                                        'éüÇÃçÏã∆óvãÅ
            
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                            Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
                
                
                
                
                
            Next i
                
                
                
                
    
    
    End Select

    KYOSEI_END_PROC = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function

Private Function Y_Syuka_H_Chek_Proc(JGYOBU As String, _
                                        MTS_CODE As String, _
                                        Y_SYU_CNT As Integer, _
                                        Sumi_CNT As Integer, _
                                        ID_NO As String, _
                                        SYUKA_QTY As Long, _
                                        DEN_NO As String, _
                                        Y_SYU_TBL() As KEN_DEN_TBL_Tag, _
                                        OKURI_NO As String, _
                                        UNSOU_KAISHA As String, _
                                        OKURI_SAKI As String, _
                                        Found_F As Boolean, _
                                        Optional SYUKA_YMD As String, _
                                        Optional JYUSHO As String, _
                                        Optional BIKOU As String, _
                                        Optional Start_Page_No As Long, _
                                        Optional KUTI_SU As Long, _
                                        Optional MUKE_NAME As String, _
                                        Optional OKURI_NO_MAX As Integer, _
                                        Optional Label_RePrint_Kuti_Su As Integer, _
                                        Optional Label_RePrint_Sai_Su As Double, _
                                        Optional KEN_TEL_NO As String, _
                                        Optional KEN_HINBAN As String) As Integer
'-------------------------------------------------------
'
'   Åwèoâ◊ó\íËÇÃégópó\ñÒÅx
'   ëÂç„ÇoÇbóp  2006.12.07
'   KEN_HINBANí«â¡  2012.10.02
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


Dim ans         As Integer

Dim RETRY_CNT   As Integer

Dim i           As Integer
Dim j           As Integer

Dim FAST_F      As Boolean


Dim KONPOU_ON   As Boolean
Dim KONPOU_OFF  As Boolean
Dim wkTOTAL     As Long
Dim wkKUTI_SU   As Long


Dim GET_F       As Boolean


Dim CANCEL_F    As Boolean

    Y_Syuka_H_Chek_Proc = True
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        Y_Syuka_H_Chek_Proc = SYS_ERR
        Exit Function
    End If



    Y_SYU_CNT = 0
    Sumi_CNT = 0
    OKURI_NO = ""
        
    Start_Page_No = 0
        
    Found_F = False
        
    'ì`ï[ÇhÇcéwíËÇ≈ÇÃèàóù
    Call UniCode_Conv(K0_Y_SYU.JGYOBU, JGYOBU)
    Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_NO)
    
    RETRY_CNT = 0
    'èoâ◊ó\íË
    
    i = -1
    
    com = BtOpGetGreaterEqual
    
    Do
        DoEvents
        sts = BTRV(com + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
        Select Case sts
            Case BtNoErr
                
''''2010.09.29                If Trim(Left(StrConv(Y_SYUREC.ID_NO, vbUnicode), 7)) <> Trim(ID_NO) Then
                If StrConv(Y_SYUREC.ID_NO, vbUnicode) <> StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode) Then

                    Call UniCode_Conv(Y_SYUREC.ID_NO, StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode))

                End If
''''2010.09.29
Debug.Print StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode)
Debug.Print StrConv(Y_SYUREC.ID_NO, vbUnicode)
                If Trim(Left(StrConv(Y_SYUREC.KEY_ID_NO, vbUnicode), 7)) <> Trim(ID_NO) Then
                    
                    
                    
                    
                    
                    sts = BTRV(BtOpUnlock, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                    If sts <> BtNoErr Then
                        Call File_Error(sts, BtOpUnlock, "èoâ◊ó\íË", 0)
                        Y_Syuka_H_Chek_Proc = SYS_ERR
                        GoTo Abort_Tran
                    End If
                        
                        
                    sts = BtErrEOF
                
                    Exit Do
                End If
            Case BtErrEOF
                Exit Do
            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                    Y_Syuka_H_Chek_Proc = SYS_CANCEL
                    GoTo Abort_Tran
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                Y_Syuka_H_Chek_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
        
                                                
        If sts = BtErrEOF Then
            Exit Do
        End If
                                                
        If Len(Trim(StrConv(Y_SYUREC.WEL_ID, vbUnicode))) = 0 And _
            Len(Trim(StrConv(Y_SYUREC.PRG_ID, vbUnicode))) = 0 Then
        Else
            If StrConv(Y_SYUREC.WEL_ID, vbUnicode) <> Format(ID_KANRI_TBL(ING_No).ID, "000") Or _
                Trim(StrConv(Y_SYUREC.PRG_ID, vbUnicode)) <> StrConv(App.EXEName, vbUpperCase) Then
                                'ëºÇ≈égópíÜ
                Y_Syuka_H_Chek_Proc = SYS_CANCEL
                GoTo Abort_Tran
            End If
        End If
            
        
        Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))
    
    
        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
        Select Case sts
            Case BtNoErr
                
            Case BtErrKeyNotFound
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                Y_Syuka_H_Chek_Proc = SYS_CANCEL
                GoTo Abort_Tran
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                Y_Syuka_H_Chek_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
            
        Found_F = True
            
            
        If Trim(StrConv(Y_SYUREC.KENPIN_YMD, vbUnicode)) = "" Then
        Else
            
'''            If Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)) <> "" Then
'''
'''                OKURI_NO = StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)
'''            End If
            
'''            UNSOU_KAISHA = Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode))
            
'''            OKURI_SAKI = Trim(StrConv(Y_SYU_HREC.OKURISAKI, vbUnicode))
        
        End If
            
        
        OKURI_NO_MAX = 0
            
        i = i + 1
        
        
        GET_F = False
        
        If Not GET_F Then
            MTS_CODE = StrConv(Y_SYUREC.MUKE_CODE, vbUnicode)
        
        
        
        
            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))
        
        
            sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
            Select Case sts
                Case BtNoErr
                    
                    
                    
                    If StrConv(Y_SYU_HREC.CANCEL_F, vbUnicode) = "1" Then
                    Else
                    
                    
                        OKURI_SAKI = Trim(StrConv(Y_SYU_HREC.OKURISAKI, vbUnicode))
                    
                        UNSOU_KAISHA = Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode))
                    
                        OKURI_NO = Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode))
                    
                    
                        SYUKA_YMD = Trim(StrConv(Y_SYU_HREC.SYUKA_YMD, vbUnicode))      '2010.01.21
                    
                        JYUSHO = Trim(StrConv(Y_SYU_HREC.JYUSHO, vbUnicode))            '2010.01.21
                        
                        BIKOU = Trim(StrConv(Y_SYU_HREC.BIKOU, vbUnicode))              '2010.01.21
                    
                        KEN_TEL_NO = Trim(StrConv(Y_SYU_HREC.TEL_NO, vbUnicode))        '2010.01.21
                    
                                                                                        '2010.01.21
                        If Trim(StrConv(Y_SYU_HREC.OKURISAKI, vbUnicode)) <> Trim(StrConv(Y_SYU_HREC.MUKE_NAME, vbUnicode)) Then
                            MUKE_NAME = Trim(StrConv(Y_SYU_HREC.MUKE_NAME, vbUnicode))
                        Else
                            MUKE_NAME = ""
                        End If
                    
                        If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU, vbUnicode)) Then             '2010.01.21
                            Label_RePrint_Kuti_Su = CInt(StrConv(Y_SYU_HREC.KUTI_SU, vbUnicode))
                        Else
                            Label_RePrint_Kuti_Su = 0
                        End If
                    
                        If IsNumeric(StrConv(Y_SYU_HREC.SAI_SU, vbUnicode)) Then             '2010.01.21
                            Label_RePrint_Sai_Su = CDbl(StrConv(Y_SYU_HREC.SAI_SU, vbUnicode))
                        Else
                            Label_RePrint_Sai_Su = 0
                        End If
                        
                        
                        KEN_HINBAN = StrConv(Y_SYU_HREC.KEN_HINBAN, vbUnicode)              '2012.10.02
                        
                        
                        
                        GET_F = True
                
                    End If
                Case BtErrKeyNotFound
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                    Y_Syuka_H_Chek_Proc = SYS_CANCEL
                    GoTo Abort_Tran
                Case Else
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                    Y_Syuka_H_Chek_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        
        
        
        
        
        
        
        
        
        
        End If
        
        
        ReDim Preserve Y_SYU_TBL(i)
'        Y_SYU_TBL(i).SEQ_NO = Right(Trim(StrConv(Y_SYUREC.ID_NO, vbUnicode)), 2)
        '2007.07.17
        Y_SYU_TBL(i).SEQ_NO = Mid(StrConv(Y_SYUREC.ID_NO, vbUnicode), 8, 3)
        
        
        Y_SYU_TBL(i).HIN_NO = StrConv(Y_SYUREC.HIN_NO, vbUnicode)
        Y_SYU_TBL(i).SURYO = CLng(StrConv(Y_SYUREC.SURYO, vbUnicode))
        
        
                
        If StrConv(Y_SYU_HREC.CANCEL_F, vbUnicode) = "1" Then
            Y_SYU_TBL(i).CANCEL_F = True
        Else
            Y_SYU_TBL(i).CANCEL_F = False
        End If
        
        
        If Trim(StrConv(Y_SYUREC.KENPIN_YMD, vbUnicode)) = "" Then
            Y_SYU_TBL(i).SUMI = False
        Else
            Y_SYU_TBL(i).SUMI = True
        End If
        
        'èoå…èÓïÒÇälìæ 2007.05.14
        Y_SYU_TBL(i).KAN_KBN = StrConv(Y_SYUREC.KAN_KBN, vbUnicode)
            
            
'        Y_SYU_TBL(i).KONPOU_F = StrConv(Y_SYU_HREC.KONPOU_F, vbUnicode)
            
        'ç´ïÔãÊï™Çälìæ 2010.01.21
        Call UniCode_Conv(K0_ITEM.JGYOBU, StrConv(Y_SYUREC.JGYOBU, vbUnicode))
        Call UniCode_Conv(K0_ITEM.NAIGAI, StrConv(Y_SYUREC.NAIGAI, vbUnicode))
        Call UniCode_Conv(K0_ITEM.HIN_GAI, StrConv(Y_SYUREC.HIN_NO, vbUnicode))
                    
        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        Select Case sts
            Case BtNoErr
                
                'Y_SYU_TBL(i).KONPOU_F = StrConv(ITEMREC.KONPOU_F, vbUnicode)
                
                                
            
            
            
            
            
            Case BtErrKeyNotFound
                Y_SYU_TBL(i).KONPOU_F = ""
            
                If Y_SYU_TBL(i).SAI_SU = 0 Then
                    Y_SYU_TBL(i).SAI_SU = 0
                End If
                
                If Y_SYU_TBL(i).KUTI_SU = 0 Then
                    Y_SYU_TBL(i).KUTI_SU = 1
                End If
                Call UniCode_Conv(ITEMREC.SAI_SU, "00.00")
            
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄œΩ¿", 0)
                Y_Syuka_H_Chek_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
            
        Y_SYU_TBL(i).KONPOU_F = StrConv(ITEMREC.KONPOU_F, vbUnicode)
            
            
        If Y_SYU_TBL(i).KONPOU_F = "1" Then
            
            If Y_SYU_TBL(i).SAI_SU = 0 Then
                If IsNumeric(StrConv(ITEMREC.SAI_SU, vbUnicode)) Then
                    
                    
                    Y_SYU_TBL(i).SAI_SU = CDbl(StrConv(ITEMREC.SAI_SU, vbUnicode))
                Else
                    Call UniCode_Conv(ITEMREC.SAI_SU, "00.00")
                    Y_SYU_TBL(i).SAI_SU = 0
                End If
            End If
                            
                        
            If Y_SYU_TBL(i).KUTI_SU = 0 Then
                If IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                    Y_SYU_TBL(i).KUTI_SU = CInt(StrConv(ITEMREC.KUTI_SU, vbUnicode))
                Else
                    Y_SYU_TBL(i).KUTI_SU = 1
                End If
            End If
        End If
            
            
        If Y_SYU_TBL(i).SUMI Then
            If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                Y_SYU_TBL(i).KUTI_SU = CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode))
            End If
            
            If IsNumeric(StrConv(Y_SYU_HREC.SAI_SU_TAN, vbUnicode)) Then
                Y_SYU_TBL(i).SAI_SU = CInt(StrConv(Y_SYU_HREC.SAI_SU_TAN, vbUnicode))
            End If
        
        
        
        
        
 '2010.02.16
            If IsNumeric(StrConv(Y_SYU_HREC.OKURI_NO_SEQ, vbUnicode)) Then
                Y_SYU_TBL(i).OKURI_NO_SEQ = CInt(StrConv(Y_SYU_HREC.OKURI_NO_SEQ, vbUnicode))
                If Y_SYU_TBL(i).OKURI_NO_SEQ > OKURI_NO_MAX Then
                    OKURI_NO_MAX = Y_SYU_TBL(i).OKURI_NO_SEQ
                End If
            
            Else
                Y_SYU_TBL(i).OKURI_NO_SEQ = 0
            End If
 '2010.02.16
        
        
        
        Else
        
            If Y_SYU_TBL(i).KONPOU_F = "1" Then
        
                Y_SYU_TBL(i).KUTI_SU = Y_SYU_TBL(i).KUTI_SU * Y_SYU_TBL(i).SURYO
'                Y_SYU_TBL(i).SAI_SU = Y_SYU_TBL(i).KUTI_SU * CDbl(StrConv(ITEMREC.SAI_SU, vbUnicode))
                Y_SYU_TBL(i).SAI_SU = Y_SYU_TBL(i).SURYO * CDbl(StrConv(ITEMREC.SAI_SU, vbUnicode))
                
            End If
        
 '2010.02.16
            Y_SYU_TBL(i).OKURI_NO_SEQ = 0
 '2010.02.16
        
        End If
            
            
            
                    
        'àÛç¸çœÇÉäÉZÉbÉg   2010.01.21
'        Y_SYU_TBL(i).PRINT_SUMI = False
'        Y_SYU_TBL(i).OKURI_NO_SEQ = 0
'
'        If IsNumeric(StrConv(Y_SYU_HREC.OKURI_NO_SEQ, vbUnicode)) Then
'            Y_SYU_TBL(i).PRINT_SUMI = True
'            Y_SYU_TBL(i).OKURI_NO_SEQ = CInt(StrConv(Y_SYU_HREC.OKURI_NO_SEQ, vbUnicode))
'
'
'            If Start_Page_No < Y_SYU_TBL(i).OKURI_NO_SEQ Then
'                Start_Page_No = Y_SYU_TBL(i).OKURI_NO_SEQ
'            End If
'
            If Y_SYU_TBL(i).KONPOU_F <> "1" Then
                If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU, vbUnicode)) Then
                    KUTI_SU = CInt(StrConv(Y_SYU_HREC.KUTI_SU, vbUnicode))
                
                    Y_SYU_TBL(i).KUTI_SU = CInt(StrConv(Y_SYU_HREC.KUTI_SU, vbUnicode))
                End If
            End If
'        End If
                    
                    
                    
                    
                    
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
        Y_SYU_TBL(i).CNT_BARA_SU = Val(StrConv(Y_SYU_HREC.CNT_BARA_SU, vbUnicode))       'åüïié¿ê—Å@ÉoÉâ
        Y_SYU_TBL(i).CNT_HAKO_SU = Val(StrConv(Y_SYU_HREC.CNT_HAKO_SU, vbUnicode))       'åüïié¿ê—Å@î†
    
        Y_SYU_TBL(i).GAISO_IRI_QTY = Val(StrConv(Y_SYU_HREC.GAISO_IRI_QTY, vbUnicode))   'äOëïì¸ÇËêî
    
        Y_SYU_TBL(i).Y_HIN_CHK_CNT = Val(StrConv(Y_SYU_HREC.Y_HIN_CHK_CNT, vbUnicode))   'ïiî‘ì«çûÇ›âÒêî
    
        Y_SYU_TBL(i).J_HIN_CHK_CNT = Val(StrConv(Y_SYU_HREC.J_HIN_CHK_CNT, vbUnicode))   'ïiî‘ì«çûÇ›çœÇ›âÒêî
    
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.02
                    
                    
                    
                    
                    
                    
            
            
            
            
            
        Call UniCode_Conv(Y_SYUREC.WEL_ID, Format(ID_KANRI_TBL(ING_No).ID, "000"))
        Call UniCode_Conv(Y_SYUREC.PRG_ID, StrConv(App.EXEName, vbUpperCase))
                                            
        RETRY_CNT = 0
                                            
                                            'èoâ◊ó\íËèëçûÇ›
        Do
            DoEvents
            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    RETRY_CNT = RETRY_CNT + 1
                    If RETRY_CNT > FILE_RETRY Then
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Y_Syuka_H_Chek_Proc = SYS_CANCEL
                        GoTo Abort_Tran
                    End If
                
                Case Else
                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                    Y_Syuka_H_Chek_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        Loop
                                

        com = BtOpGetNext
    Loop
                                
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
    
    If Found_F Then
    
        FAST_F = True
                                                                                    
        For i = 0 To UBound(Y_SYU_TBL)
        
        
            If Y_SYU_TBL(i).CANCEL_F Then
            Else
                If FAST_F Then
                
                    Y_SYU_CNT = Y_SYU_CNT + 1
                    If Y_SYU_TBL(i).SUMI Then
                        Sumi_CNT = Sumi_CNT + 1
                    End If
                    FAST_F = False
                
                Else
                    For j = 0 To i - 1
                        If Trim(Y_SYU_TBL(i).HIN_NO) = Trim(Y_SYU_TBL(j).HIN_NO) Then
                            If Not Y_SYU_TBL(j).CANCEL_F Then
                                Exit For
                            End If
                        End If
                    Next j
            
                    If j > i - 1 Then
            
                        Y_SYU_CNT = Y_SYU_CNT + 1
                        If Y_SYU_TBL(i).SUMI Then
                            Sumi_CNT = Sumi_CNT + 1
                        End If
                    End If
                End If
            End If
        Next i
    End If
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
                                
                                
''' ç´ïÔèÛë‘ÇÃämîF
                                
                                
                                
                                
    KONPOU_ON = False
    KONPOU_OFF = False
    wkTOTAL = 0
                                
                                
    If Found_F Then
        For i = 0 To UBound(Y_SYU_TBL)
        
            
            
            If Y_SYU_TBL(i).CANCEL_F Then
            Else
                If Y_SYU_TBL(i).KONPOU_F = "1" Then
                    
                    KONPOU_OFF = True
                Else
                    KONPOU_ON = True
                End If
            End If
        
            wkTOTAL = Y_SYU_TBL(i).SURYO
        
        Next i
    End If
                                
    If Found_F Then
        For i = 0 To UBound(Y_SYU_TBL)
            If KONPOU_ON And KONPOU_OFF Then
                Y_SYU_TBL(i).KONPOU_CND = "3"
            Else
                If KONPOU_ON Then
                    Y_SYU_TBL(i).KONPOU_CND = "2"
                Else
                    Y_SYU_TBL(i).KONPOU_CND = "1"
                End If
            End If
        
        
            Y_SYU_TBL(i).TOTAL_SU = wkTOTAL
        
        Next i





    

''' ç´ïÔèÛë‘ÇÃämîF
        Start_Page_No = 0
        
        wkKUTI_SU = 0
        
        For i = 0 To UBound(Y_SYU_TBL)
        
            If Y_SYU_TBL(i).KONPOU_F <> "1" Then
                
                If Not Y_SYU_TBL(i).CANCEL_F Then           '2012.04.25
                    Start_Page_No = Y_SYU_TBL(i).KUTI_SU
                End If                                      '2012.04.25
            End If
        
        Next i
                                    
        For i = 0 To UBound(Y_SYU_TBL)
        
            If Y_SYU_TBL(i).KONPOU_F = "1" Then
                
                If Y_SYU_TBL(i).SUMI Then
                    If Not Y_SYU_TBL(i).CANCEL_F Then           '2012.04.25
                       Start_Page_No = Start_Page_No + Y_SYU_TBL(i).SURYO * Y_SYU_TBL(i).KUTI_SU
                    End If                                      '2012.04.25
                End If
            End If
        
        Next i
                                
                                
                                
        '2012.10.02
        For i = 0 To UBound(Y_SYU_TBL)
        
            If Y_SYU_TBL(i).CANCEL_F <> "1" Then
                If Y_SYU_TBL(i).KONPOU_F = "1" Then
                    If Trim(Y_SYU_TBL(i).HIN_NO) = Trim(KEN_HINBAN) Then
                        Start_Page_No = Start_Page_No + Y_SYU_TBL(i).J_HIN_CHK_CNT
                    End If
                End If
            End If
        Next i
        '2012.10.02
                                
                                
'        For i = 0 To UBound(Y_SYU_TBL)
'
'            If Y_SYU_TBL(i).KONPOU_F = "1" Then
'
'                Y_SYU_TBL(i).SAI_SU = Y_SYU_TBL(i).SURYO * Y_SYU_TBL(i).KUTI_SU
'            End If
'
'        Next i
                                
                                
                                        
                                
                                
    End If
                                
                                
                                
'>>>>>>>>>>>>   2012.12.28
        '∑¨›æŸì`ï[ÇÃ¡™Ø∏
        If Not Found_F Then
            
            Y_Syuka_H_Chek_Proc = False
            GoTo Abort_Tran
        End If
                                         
                
        CANCEL_F = True
            
        For j = 0 To UBound(Y_SYU_TBL)
        
            If Not Y_SYU_TBL(j).CANCEL_F Then
                CANCEL_F = False
                Exit For
            End If
                                
        Next j
                                 
                                 
        If CANCEL_F Then
            Y_Syuka_H_Chek_Proc = False
            GoTo Abort_Tran
        End If
        
        
        If Y_SYU_CNT = 0 Then
            Y_Syuka_H_Chek_Proc = False
            GoTo Abort_Tran
        End If
                                 
        If Sumi_CNT = Y_SYU_CNT And Start_Page_No <> 0 Then
            Y_Syuka_H_Chek_Proc = False
            GoTo Abort_Tran
        
        End If
'>>>>>>>>>>>>   2012.12.28

                                
                                
Debug.Print Label_RePrint_Sai_Su
                                
    Y_Syuka_H_Chek_Proc = False

End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "", 0)
        Y_Syuka_H_Chek_Proc = SYS_ERR
        GoTo Abort_Tran
    End If
    
    
    Exit Function


Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function
Private Function Y_Syuka_OSAKA_Chek_Proc(JGYOBU As String, _
                                        NAIGAI As String, _
                                        HIN_NO As String, _
                                        Y_SYU_CNT As Integer, _
                                        Y_SURYO As Long, _
                                        J_SURYO As Long, _
                                        ID_NO As String, _
                                        BIN_NO As String) As Integer
'-------------------------------------------------------
'
'   Åwèoå…ï\èoå…éûÅAèoâ◊ó\íËÇÃégópó\ñÒÅx
'   ëÂç„ÇoÇbóp  2007.03.16
'               2007.05.16 ï÷(BIN_NO)í«â¡
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


Dim ans         As Integer

Dim RETRY_CNT   As Integer

Dim i           As Integer
Dim j           As Integer

Dim FAST_F      As Boolean



    Y_Syuka_OSAKA_Chek_Proc = True
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        Y_Syuka_OSAKA_Chek_Proc = SYS_ERR
        Exit Function
    End If



    Y_SYU_CNT = 0
    
    J_SURYO = 0
    Y_SURYO = 0
    HIN_NO = ""
        
    BIN_NO = ""         '2007.05.16
    
    RETRY_CNT = 0
    'èoâ◊ó\íË
    i = -1
    
    com = BtOpGetGreaterEqual
    'ì`ï[ÇhÇcéwíËÇ≈ÇÃèàóù
    Call UniCode_Conv(K6_Y_SYU_H.SYU_NO, ID_NO)
    
    Do
        DoEvents
        sts = BTRV(com, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K6_Y_SYU_H, Len(K6_Y_SYU_H), 6)
        Select Case sts
            Case BtNoErr
                
                If Trim(StrConv(Y_SYU_HREC.SYU_NO, vbUnicode)) <> Trim(ID_NO) Then
                    sts = BtErrEOF
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                Y_Syuka_OSAKA_Chek_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
        
                                                
        If sts = BtErrEOF Then
            Exit Do
        End If
                                                
        If Trim(BIN_NO) = "" Then
            BIN_NO = StrConv(Y_SYU_HREC.INS_BIN, vbUnicode)
        End If
                                                
                                                
                                                
        Call UniCode_Conv(K0_Y_SYU.JGYOBU, StrConv(Y_SYU_HREC.JGYOBU, vbUnicode))
        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, StrConv(Y_SYU_HREC.ID_NO, vbUnicode))
        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
        Select Case sts
            Case BtNoErr
                
            Case BtErrKeyNotFound
                Exit Do
            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                    Y_Syuka_OSAKA_Chek_Proc = SYS_CANCEL
                    GoTo Abort_Tran
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                Y_Syuka_OSAKA_Chek_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
        
                                                
                                                
        If Trim(StrConv(Y_SYUREC.WEL_ID, vbUnicode)) = "" And _
            Trim(StrConv(Y_SYUREC.PRG_ID, vbUnicode)) = "" Then
        Else
            If StrConv(Y_SYUREC.WEL_ID, vbUnicode) <> Format(ID_KANRI_TBL(ING_No).ID, "000") Or _
                Trim(StrConv(Y_SYUREC.PRG_ID, vbUnicode)) <> StrConv(App.EXEName, vbUpperCase) Then
                                'ëºÇ≈égópíÜ
                Y_Syuka_OSAKA_Chek_Proc = SYS_CANCEL
                GoTo Abort_Tran
            End If
        End If
            
                    
            
        Call UniCode_Conv(Y_SYUREC.WEL_ID, Format(ID_KANRI_TBL(ING_No).ID, "000"))
        Call UniCode_Conv(Y_SYUREC.PRG_ID, StrConv(App.EXEName, vbUpperCase))
                                            
        RETRY_CNT = 0
                                            
                                            'èoâ◊ó\íËèëçûÇ›
        Do
            DoEvents
            sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    RETRY_CNT = RETRY_CNT + 1
                    If RETRY_CNT > FILE_RETRY Then
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Y_Syuka_OSAKA_Chek_Proc = SYS_CANCEL
                        GoTo Abort_Tran
                    End If
                
                Case Else
                    Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                    Y_Syuka_OSAKA_Chek_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        Loop
                                
        
        If StrConv(Y_SYU_HREC.CANCEL_F, vbUnicode) = "1" Then
        Else
        
            Y_SYU_CNT = Y_SYU_CNT + 1
            
            Y_SURYO = Y_SURYO + CLng(StrConv(Y_SYUREC.SURYO, vbUnicode))
            J_SURYO = J_SURYO + CLng(StrConv(Y_SYUREC.JITU_SURYO, vbUnicode))
        End If
        
        If Trim(HIN_NO) = "" Then
            HIN_NO = StrConv(Y_SYUREC.HIN_NO, vbUnicode)
        End If
        
        
        
        
        
        
        com = BtOpGetNext
    Loop
                                
                                
                                
    '2011.04.07
    If Y_SURYO <= J_SURYO Then
        Y_Syuka_OSAKA_Chek_Proc = False
        GoTo Abort_Tran
    End If
    '2011.04.07
                                
                                
                                
    Y_Syuka_OSAKA_Chek_Proc = False

End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "", 0)
        Y_Syuka_OSAKA_Chek_Proc = SYS_ERR
        GoTo Abort_Tran
    End If
    
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function
Private Sub COMPO_Check_Cnt_Proc(KO_CNT As Integer, RD_CNT As Integer)
'-------------------------------------------------------
'
'   Åwéwê}ï[ÉfÅ[É^ÇÃç\ê¨ïîïiêîÅx
'
'       2011.03.02
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim ans         As Integer

Dim i           As Integer

    
    KO_CNT = UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) + 1
    RD_CNT = 0
    
    For i = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
    
        If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(i).RD_FLAG Then
        
        
            RD_CNT = RD_CNT + 1
        
        End If
    
    Next i
            


End Sub



Private Function COMPO_Check_Update_Proc(KO_CNT As Integer, RD_CNT As Integer, Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   Åwéwê}ï[ÉfÅ[É^ÇÃç\ê¨ïîïiêîçXêVÅx
'
'       2012.04.20
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim ans         As Integer

Dim i           As Integer

Dim DateTime    As String * 12

    
    COMPO_Check_Update_Proc = True
    
    KO_CNT = UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) + 1
    RD_CNT = 0
    
    For i = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
    
        If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(i).RD_FLAG Then
        
        
            RD_CNT = RD_CNT + 1
        
        End If
    
    Next i
            


    '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        Exit Function
    End If

    
    Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
    Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
    Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")

    DateTime = Format(Now, "YYYYMMDDHHSSMM")
    
    com = BtOpGetGreaterEqual


    Do
        DoEvents
    
        sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
        Select Case sts
            Case BtNoErr
                            
                If StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) <> ID_KANRI_TBL(ING_No).SHIJI_No Then
                    Exit Do
                End If
                
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, com, "éwê}ï[√ﬁ∞¿(éq)", 0)
                COMPO_Check_Update_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
        
        'íSìñé“
        Call UniCode_Conv(P_SSHIJI_K_REC.COMPO_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
        'ì˙éû
        Call UniCode_Conv(P_SSHIJI_K_REC.COMPO_YMDHS, DateTime)
        '¡™Ø∏çœÇ›êî
        Call UniCode_Conv(P_SSHIJI_K_REC.COMPO_Sumi_Cnt, Format(RD_CNT, "00"))
        'ç\ê¨êî
        Call UniCode_Conv(P_SSHIJI_K_REC.COMPO_ALL_Cnt, Format(KO_CNT, "00"))
        
        sts = BTRV(BtOpUpdate, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
        Select Case sts
            Case BtNoErr
            Case Else
                Call File_Error(sts, BtOpUpdate, "éwê}ï[√ﬁ∞¿(éq)", 0)
                COMPO_Check_Update_Proc = SYS_ERR
                GoTo Abort_Tran
        End Select
    
        com = BtOpGetNext
    
    Loop
                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpEndTransaction, "", 0)
        GoTo Abort_Tran
    End If


    COMPO_Check_Update_Proc = False
    
    Exit Function
Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function





Private Function COMPO_Check_Read_Proc(SHIJI_No As String, KO_CNT As Integer) As Integer
'-------------------------------------------------------
'
'   Åwéwê}ï[ÉfÅ[É^ÇÃç\ê¨ïîïiêîÅx
'
'       2011.03.02
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


Dim i           As Integer

            
            
Dim Check_f     As Boolean  '2011.04.18
Dim j           As Integer  '2011.04.18
            
            
            
    COMPO_Check_Read_Proc = True



    
        
    
    
    
    Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, SHIJI_No)
    
    
    sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            COMPO_Check_Read_Proc = BtErrKeyNotFound
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
            COMPO_Check_Read_Proc = SYS_ERR
            Exit Function
    End Select
    
    
    Erase ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL
    KO_CNT = -1
    
    
    Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, SHIJI_No)
    Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
    Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")
    
    com = BtOpGetGreater
            
            
    Do
    
    
        DoEvents
    
        sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
        Select Case sts
            Case BtNoErr
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éwê}ï[√ﬁ∞¿(éq)", 0)
                COMPO_Check_Read_Proc = SYS_ERR
                Exit Function
        End Select
    
    
    
        If StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) <> SHIJI_No Then
            Exit Do
        End If
    
    
        If StrConv(P_SSHIJI_K_REC.DATA_KBN, vbUnicode) = "3" Then
    
    
''''''''''''    2011.04.18
            Check_f = False
            If Kousei_check_F Then
                If Kousei_check_Tb(0) = "*" Then
                    Check_f = True
                Else
                
                
                    For j = 0 To UBound(Kousei_check_Tb)
                        If Kousei_check_Tb(j) = Trim(StrConv(P_SSHIJI_K_REC.KO_SYUBETSU, vbUnicode)) Then
                            Check_f = True
                            Exit For
                        End If
                    
                    Next j
                
                
                End If
            End If
            If Check_f Then
''''''''''''    2011.04.18
    
                If KO_CNT = -1 Then
                    KO_CNT = KO_CNT + 1
            
                    ReDim Preserve ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(0 To KO_CNT)
                        
                    ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_JGYOBU = StrConv(P_SSHIJI_K_REC.KO_JGYOBU, vbUnicode)
                    ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_NAIGAI = StrConv(P_SSHIJI_K_REC.KO_NAIGAI, vbUnicode)
                    ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_HIN_GAI = StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)
            
            
            
                Else
            
            
                    For i = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                    
                        If Trim(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(i).KO_HIN_GAI) = Trim(StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)) Then
                            Exit For
                        End If
                    
                    Next i
            
                    If i > UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) Then
        
                        KO_CNT = KO_CNT + 1
                
                        ReDim Preserve ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(0 To KO_CNT)
                            
                        ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_JGYOBU = StrConv(P_SSHIJI_K_REC.KO_JGYOBU, vbUnicode)
                        ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_NAIGAI = StrConv(P_SSHIJI_K_REC.KO_NAIGAI, vbUnicode)
                        ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_HIN_GAI = StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)
            
                    End If
            
            
                End If

''''''''''''    2011.04.18
            End If
''''''''''''    2011.04.18
        
        
        End If
    Loop
    
    COMPO_Check_Read_Proc = False

End Function








Private Function Cancel_Proc(Sendbuf As String, Optional Mode As Integer = 0, Optional Para As String = "  ") As Integer
'-------------------------------------------------------
'
'   ÅwÉLÉÉÉìÉZÉãèàóùÅiëOâÊñ åüçıÅjÅx
'
'-------------------------------------------------------
    
    Cancel_Proc = True
        
    
    Select Case ID_KANRI_TBL(ING_No).Step
    
        Case Step_Start         'éqã@ìdåπÇnÇm
        Case Step_TANTO_REQ     'íSìñé“óvãÅ
            
            Call Re_Send_Proc(Sendbuf)
                        
        Case Step_JGYOBU_REQ    'éñã∆ïîóvãÅ

'            ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
'            ID_KANRI_TBL(ING_No).JGYOBU = ""
'            Call Start_Proc(Sendbuf)

            'éñã∆ïîóvãÅÇ≈ÉãÅ[ÉvÇ∑ÇÈ
            ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
            ID_KANRI_TBL(ING_No).JGYOBU = ""
            
            
            If UBound(NAIGAI) = 0 Then
            Else
                ID_KANRI_TBL(ING_No).NAIGAI = ""
            End If
            
'            ID_KANRI_TBL(ING_No).MENU_GRP = ""
            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'            ID_KANRI_TBL(ING_No).MENU_LV3 = ""
            
            
            
            '2010.04.23
            ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
            ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
            '2010.04.23
            
            

            Call Menu_Send_Proc(Sendbuf)


        Case Step_NAIGAI_REQ    'çëì‡äOóvãÅ
            
            
            If UBound(JGYOBU_T) = 0 Then
            
                        
                ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                ID_KANRI_TBL(ING_No).NAIGAI = ""
                Call Menu_Send_Proc(Sendbuf)
            
            Else
            
                ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
                ID_KANRI_TBL(ING_No).JGYOBU = ""
                ID_KANRI_TBL(ING_No).NAIGAI = ""
            
'               ID_KANRI_TBL(ING_No).MENU_GRP = ""
                ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'               ID_KANRI_TBL(ING_No).MENU_LV3 = ""
            
            
                '2010.04.23
                ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
                ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
                '2010.04.23
            
            
            
                Call Menu_Send_Proc(Sendbuf)
            End If

        Case Step_MENU1_REQ     'ÉÅÉjÉÖÅ[ÇPóvãÅ
        
            
            If Mode = 0 Then            '2008.08.08
'                ST_LOG_OUT_F = False    '2008.08.08
            End If                      '2008.08.08
            
            If UBound(NAIGAI) = 0 Then
                
                
                
                If UBound(JGYOBU_T) = 0 Then
                
                
                
                'çëì‡äOÇÃêÿÇËï™ÇØÇ»Çµ
    '                ID_KANRI_TBL(ING_No).Step = Step_TANTO_REQ
    '                ID_KANRI_TBL(ING_No).JGYOBU = ""
    '                Call Start_Proc(Sendbuf)
                
                    ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                    
                    '2010.04.23
                    ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
                    '2010.04.23
            
                
                    Call Menu_Send_Proc(Sendbuf)
            
            
                Else
            
                    'éñã∆ïîóvãÅÇ≈ÉãÅ[ÉvÇ∑ÇÈ
                    ID_KANRI_TBL(ING_No).Step = Step_JGYOBU_REQ
                    ID_KANRI_TBL(ING_No).JGYOBU = ""
        '            ID_KANRI_TBL(ING_No).NAIGAI = ""
                    
        '            ID_KANRI_TBL(ING_No).MENU_GRP = ""
                    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                    ID_KANRI_TBL(ING_No).MENU_LV2 = ""
        '            ID_KANRI_TBL(ING_No).MENU_LV3 = ""
                    
                    
                    '2010.04.23
                    ID_KANRI_TBL(ING_No).PageNo_LV1 = 0
                    ID_KANRI_TBL(ING_No).PageNo_LV2 = 0
                    '2010.04.23
                    
                    
        
                    Call Menu_Send_Proc(Sendbuf)
                End If
            
            Else
                ID_KANRI_TBL(ING_No).Step = Step_NAIGAI_REQ
                ID_KANRI_TBL(ING_No).NAIGAI = ""
                Call Menu_Send_Proc(Sendbuf)
            End If
        
        
        
        Case Step_MENU2_REQ     'ÉÅÉjÉÖÅ[ÇQóvãÅ
        
            
            If Not CANCEL_OPE Then      '2008.09.01
                
                If Para <> "EN" Then
                
                
                
                    'ëOâÒÇ™ÉGÉâÅ[ëóêM
                    Call Re_Send_Proc(Sendbuf)
                    
                    
                    
                    Cancel_Proc = False
                    Exit Function
            
                End If
            End If
            
            
            
            
            
            ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
            ID_KANRI_TBL(ING_No).MENU_LV1 = ""
        
            If Mode = 0 Then            '2008.08.08
'                ST_LOG_OUT_F = False    '2008.08.08
            End If                      '2008.08.08
        
        
            Call Menu_Send_Proc(Sendbuf)
        
        
'2006.01.30        Case Step_MENU3_REQ     'ÉÅÉjÉÖÅ[ÇRóvãÅ
'2006.01.30
'2006.01.30            ID_KANRI_TBL(ING_No).Step = Step_MENU2_REQ
'2006.01.30            ID_KANRI_TBL(ING_No).MENU_LV2 = ""
'2006.01.30
'2006.01.30            Call Menu_Send_Proc(Sendbuf)

        Case Step_Sagyo1_REQ    'çÏã∆ÇPóvãÅ
'2006.01.30            If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV3)) <> 0 Then
'2006.01.30                ID_KANRI_TBL(ING_No).Step = Step_MENU3_REQ
'2006.01.30                ID_KANRI_TBL(ING_No).MENU_LV3 = ""
'2006.01.30                Call Menu_Send_Proc(Sendbuf)
'2006.01.30            Else
                
                
            If Mode = 0 Then            '2008.08.08
'                ST_LOG_OUT_F = False    '2008.08.08
            End If                      '2008.08.08
                
                If Len(Trim(ID_KANRI_TBL(ING_No).MENU_LV2)) <> 0 Then
                    MENU_UP_F = True   '2008.08.08
                    ID_KANRI_TBL(ING_No).Step = Step_MENU2_REQ
                    ID_KANRI_TBL(ING_No).MENU_LV2 = ""
                    Call Menu_Send_Proc(Sendbuf)
                Else
                    MENU_UP_F = True   '2008.08.08
                    ID_KANRI_TBL(ING_No).Step = Step_MENU1_REQ
                    ID_KANRI_TBL(ING_No).MENU_LV1 = ""
                    Call Menu_Send_Proc(Sendbuf)
                End If
'2006.01.30            End If
                                                    
                                                    
                                                    
                                                    'çÏã∆ÇQÅ^çÏã∆ÇRÅ^çÏã∆ÇSÅ^çÏã∆ÇTóvãÅ
        Case Step_Sagyo2_REQ, Step_Sagyo3_REQ, Step_Sagyo4_REQ, Step_Sagyo5_REQ, Step_PRINT_REQ
        
        
        
            Select Case ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE
        
                Case Wel_SHOUHINKA_CHECK
        
        
                    Select Case ID_KANRI_TBL(ING_No).Step
                    
                        Case Step_Sagyo2_REQ
                    
                    
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                            
                            Sendbuf = Text_Create_Proc()
                    
                    
                        Case Step_Sagyo3_REQ
                    
                    
                    
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            
                            
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                    Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & _
                                                                                    Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "13"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            If ID_KANRI_TBL(ING_No).GENPIN_CNT = 0 Then
                            
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
                                                                                        Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & _
                                                                                        Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                            Sendbuf = Text_Create_Proc()
                    
                    
                                            
                    
                    
                        Case Step_Sagyo4_REQ
                    
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                            
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).SHIJI_QTY, "#0"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))) & _
                                                                                Format(ID_KANRI_TBL(ING_No).LABEL_CNT, "#0"))
    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If ID_KANRI_TBL(ING_No).GENPIN_CNT = 0 Then
                            
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_G_HIN_CNT)
                            Else
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
                                                                                        Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Left(ID_KANRI_TBL(ING_No).Hinban, 13) & Space(7 - Len(Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))) & _
                                                                                        Format(ID_KANRI_TBL(ING_No).GENPIN_CNT, "#0"))
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "13"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "13"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                            Sendbuf = Text_Create_Proc()
                    
                    
                    End Select
        
                Case Else
        
            
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                    If Sagyo_Send_Proc() Then
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                    End If
                    
                    Sendbuf = Text_Create_Proc()
                
                    If Mode = 0 Then            '2008.08.08
        '                ST_LOG_OUT_F = False    '2008.08.08
                    End If                      '2008.08.08
    
            End Select
    
    End Select
    
    Cancel_Proc = False


End Function

Private Function tmpZaiko_Clear_Proc() As Integer
'-------------------------------------------------------
'
'   Åwç›å…ÉfÅ[É^ÅiàÍéûÉfÅ[É^ÅjÇÃè¡ãéÅx
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim RETRY_CNT   As Integer
    
    
    tmpZaiko_Clear_Proc = True
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, tmpZAIKO_POS, tmpZAIKOREC, Len(tmpZAIKOREC), K0_tmpZAIKO, Len(K0_tmpZAIKO), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "")
        tmpZaiko_Clear_Proc = SYS_ERR
        Exit Function
    End If
    
    com = BtOpGetFirst

    Do
        DoEvents
        RETRY_CNT = 0
        Do
            sts = BTRV(com + BtSNoWait, tmpZAIKO_POS, tmpZAIKOREC, Len(tmpZAIKOREC), K0_tmpZAIKO, Len(K0_tmpZAIKO), 0)
            Select Case sts
                                
                Case BtNoErr
                    
                    Exit Do
                
                Case BtErrEOF
                    Exit Do
                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    RETRY_CNT = RETRY_CNT + 1
                    If RETRY_CNT > FILE_RETRY Then
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ç›å…ÉfÅ[É^ÅiàÍéûÉfÅ[É^Åj")
                        tmpZaiko_Clear_Proc = SYS_CANCEL
                        GoTo Abort_Tran
                    End If
                        
                    DoEvents
                
                Case Else
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ç›å…ÉfÅ[É^ÅiàÍéûÉfÅ[É^Åj")
                    tmpZaiko_Clear_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        Loop
    
        If sts = BtErrEOF Then
            Exit Do
        End If
    
        
        RETRY_CNT = 0
        
        Do
        
            sts = BTRV(BtOpDelete, tmpZAIKO_POS, tmpZAIKOREC, Len(tmpZAIKOREC), K0_tmpZAIKO, Len(K0_tmpZAIKO), 0)
            Select Case sts
                Case BtNoErr
                    Exit Do
                Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                    RETRY_CNT = RETRY_CNT + 1
                    If RETRY_CNT > FILE_RETRY Then
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ç›å…ÉfÅ[É^ÅiàÍéûÉfÅ[É^Åj")
                        tmpZaiko_Clear_Proc = SYS_CANCEL
                        GoTo Abort_Tran
                    End If
                        
                    DoEvents
                
                Case Else
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ç›å…ÉfÅ[É^ÅiàÍéûÉfÅ[É^Åj")
                    tmpZaiko_Clear_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
        
        Loop
    
        com = BtOpGetNext
    
    Loop

End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpEndTransaction, "")
        tmpZaiko_Clear_Proc = SYS_ERR
        GoTo Abort_Tran
    End If
    
    tmpZaiko_Clear_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "")
    End If


End Function











Private Function COMPO_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwç\ê¨ï\é¶èàóùÅx    2006.10.10
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

'2010.12.07
'Dim Hinban      As String * 13
Dim Hinban      As String * 20
'2010.12.07

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim FileNo      As Integer

Dim FullPath    As String

Dim SendFileRec As SendFileRec_Tag

Dim i           As Integer
Dim j           As Integer

Dim In_cnt      As Integer

    
    COMPO_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & BA_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & BA_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If


    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            Case LCD_Hinban         'ïiî‘
                Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    
                                    
                'ç≈èâÇ…èoâ◊ó\íËÇ≈
                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Hinban)
                sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Hinban = StrConv(Y_SYUREC.HIN_NO, vbUnicode)
                    Case BtErrKeyNotFound
                    Case Else
                        'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË√ﬁ∞¿", 0)
                        Exit Function
                End Select
                                    
                                    
                                    
                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                Select Case sts
                    Case BtNoErr
                    
                    Case BtErrKeyNotFound
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        COMPO_Proc = False
                        Exit Function
                    
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                        Exit Function
                
                End Select
                
                For j = 0 To UBound(SHIMUKE_TBL)
                    If ID_KANRI_TBL(ING_No).JGYOBU = SHIMUKE_TBL(j).JGYOBU And _
                        ID_KANRI_TBL(ING_No).NAIGAI = SHIMUKE_TBL(j).NAIGAI Then
                        Exit For
                    End If
                Next j
                If j > UBound(SHIMUKE_TBL) Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "édå¸ÇØêÊê›íËÉGÉâÅ[", "", "")
                
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    COMPO_Proc = False
                    Exit Function
                End If
                
                
                '-åèêîälìæ
                
                Call UniCode_Conv(K0_P_COMPO.SHIMUKE_CODE, SHIMUKE_TBL(j).SHIMUKE_CODE)
                Call UniCode_Conv(K0_P_COMPO.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                Call UniCode_Conv(K0_P_COMPO.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                Call UniCode_Conv(K0_P_COMPO.HIN_GAI, Hinban)
                Call UniCode_Conv(K0_P_COMPO.DATA_KBN, P_DOUKON)
                Call UniCode_Conv(K0_P_COMPO.SEQNO, "")
                
                com = BtOpGetGreater
                In_cnt = 0
                            
                Do
                    
                    sts = BTRV(com, P_COMPO_POS, P_COMPO_K_REC, Len(P_COMPO_K_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                    Select Case sts
                        Case BtNoErr
                            'édå¸ÇØêÊÅ^éñã∆ïîÅ^ì‡äOÅ^ïiî‘ÉuÉåÅ[ÉNÅH
                            If StrConv(P_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> SHIMUKE_TBL(j).SHIMUKE_CODE Or _
                                StrConv(P_COMPO_K_REC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                StrConv(P_COMPO_K_REC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Or _
                                Trim(StrConv(P_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(Hinban) Or _
                                StrConv(P_COMPO_K_REC.DATA_KBN, vbUnicode) <> P_DOUKON Then
                                
                                Exit Do
                            
                            End If
                        
                        Case BtErrEOF
                            
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, com, "ç\ê¨É}ÉXÉ^", 0)
                            Exit Function
                    End Select
                    
                    
                                
                    In_cnt = In_cnt + 1
                    
                    com = BtOpGetNext
                Loop
                
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
                    
                SendFileRec.Title = "0"     'ïiî‘
                Call UniCode_Conv(SendFileRec.LCD, Hinban & Format(In_cnt, "#0") & "åè")
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
                    
                            
                Call UniCode_Conv(K0_P_COMPO.SHIMUKE_CODE, SHIMUKE_TBL(j).SHIMUKE_CODE)
                Call UniCode_Conv(K0_P_COMPO.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                Call UniCode_Conv(K0_P_COMPO.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                Call UniCode_Conv(K0_P_COMPO.HIN_GAI, Hinban)
                Call UniCode_Conv(K0_P_COMPO.DATA_KBN, P_DOUKON)
                Call UniCode_Conv(K0_P_COMPO.SEQNO, "")
                
                com = BtOpGetGreater
                
                Do
                    
                    sts = BTRV(com, P_COMPO_POS, P_COMPO_K_REC, Len(P_COMPO_K_REC), K0_P_COMPO, Len(K0_P_COMPO), 0)
                    Select Case sts
                        Case BtNoErr
                            'édå¸ÇØêÊÅ^éñã∆ïîÅ^ì‡äOÅ^ïiî‘ÉuÉåÅ[ÉNÅH
                            If StrConv(P_COMPO_K_REC.SHIMUKE_CODE, vbUnicode) <> SHIMUKE_TBL(j).SHIMUKE_CODE Or _
                                StrConv(P_COMPO_K_REC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                StrConv(P_COMPO_K_REC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Or _
                                Trim(StrConv(P_COMPO_K_REC.HIN_GAI, vbUnicode)) <> Trim(Hinban) Or _
                                StrConv(P_COMPO_K_REC.DATA_KBN, vbUnicode) <> P_DOUKON Then
                                
                                Exit Do
                            
                            End If
                        
                        Case BtErrEOF
                            
                            Exit Do
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, com, "ç\ê¨É}ÉXÉ^", 0)
                            Exit Function
                    End Select
                    
                    
                                
                    SendFileRec.Title = "1"
                            
                            
                    'ÉRÅ[ÉhÉ}ÉXÉ^ì«Ç›çûÇ›
                    Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN06_CD)
                    Call UniCode_Conv(K0_P_CODE.C_Code, StrConv(P_COMPO_K_REC.KO_SYUBETSU, vbUnicode))

                    sts = BTRV(BtOpGetEqual, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
                    Select Case sts
                        Case BtNoErr
                        
                        Case BtErrKeyNotFound
                            
                            Call UniCode_Conv(P_CODEREC.C_RNAME, "")
                        
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "ÉRÅ[ÉhÉ}ÉXÉ^ ", 0)
                            Exit Function
                    End Select
                            
                    Call UniCode_Conv(SendFileRec.LCD, Left(StrConv(P_CODEREC.C_RNAME, vbUnicode), 2) & _
                                        ":" & _
                                        Left(StrConv(P_COMPO_K_REC.KO_HIN_GAI, vbUnicode), 13) & _
                                        Format(CLng(StrConv(P_COMPO_K_REC.KO_QTY, vbUnicode)), "#0"))
                    SendFileRec.CRLF = vbCrLf
                    Put #FileNo, , SendFileRec
                        
                    
                    com = BtOpGetNext
                Loop
        
                Close #FileNo
        
        
        End Select
    Next i
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = BA_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = BA_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    COMPO_Proc = False
    

End Function


Private Function KEN_Rireki_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwåüïióöóï\é¶èàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer
Dim l               As Integer

Dim ID_NO           As String
Dim MTS_CODE        As String
Dim DEN_NO          As String
Dim OKURI_NO        As String
Dim UNSOU_KAISHA    As String

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim FileNo          As Integer

Dim FullPath        As String

Dim SendFileRec     As SendFileRec_Tag

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim DATA_CNT        As Integer
Dim SYUKA_QTY       As Long

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag
Dim wY_SYU_TBL()    As KEN_DEN_TBL_Tag

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean
    
Dim Found_F         As Boolean
    
    
    KEN_Rireki_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & BB_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & BB_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            
            Case LCD_ID_No          'ì`ï[ÇhÇc
                'êeì`ÇÇjÇdÇdÇo
                ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                 
                Erase Y_SYU_TBL
                                
                sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        MTS_CODE, _
                                        Y_SYU_CNT, _
                                        Sumi_CNT, _
                                        ID_NO, _
                                        SYUKA_QTY, _
                                        DEN_NO, _
                                        Y_SYU_TBL(), _
                                        OKURI_NO, _
                                        UNSOU_KAISHA, _
                                        OKURI_SAKI, _
                                        Found_F)
                
                
                
                sts = Data_Clear_Proc(0, Sendbuf)
                Select Case sts
                    Case SYS_ERR
                        Exit Function
                End Select
                
                
                '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                
                If Found_F Then
                    CANCEL_F = True
                                             
                    For j = 0 To UBound(Y_SYU_TBL)
                    
                        If Not Y_SYU_TBL(j).CANCEL_F Then
                            CANCEL_F = False
                            Exit For
                        End If
                    
                    Next j
                                             
                                             
                    If CANCEL_F Then
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KEN_Rireki_Proc = False
                        Exit Function
                    End If
                End If
                
                If Y_SYU_CNT = 0 Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    KEN_Rireki_Proc = False
                    Exit Function
                End If
                
                
                If Y_SYU_CNT = Sumi_CNT Then
                    
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ñ¢åüïiécÇ»ÇµÅI", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    KEN_Rireki_Proc = False
                    Exit Function
                
                
                End If
                
                Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                Erase wY_SYU_TBL
                                
                                
                For j = 0 To UBound(Y_SYU_TBL)
                
                    If Y_SYU_TBL(j).SUMI Then
                    Else
                    
                        ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                        
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                        ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                    
                    End If
                Next j
                
                k = 0
                
                Sumi_CNT = 0
                Y_SYU_CNT = 0
                
                For j = 0 To UBound(Y_SYU_TBL)
                    If k = 0 Then
                        If Y_SYU_TBL(j).CANCEL_F Then
                        Else
                    
                            ReDim Preserve wY_SYU_TBL(k)
                            wY_SYU_TBL(k).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            wY_SYU_TBL(k).SUMI = Y_SYU_TBL(j).SUMI
                            wY_SYU_TBL(k).SURYO = Y_SYU_TBL(j).SURYO
                            
                            Y_SYU_CNT = Y_SYU_CNT + 1
                            If Y_SYU_TBL(j).SUMI Then
                                Sumi_CNT = Sumi_CNT + 1
                            End If
                            
                            
                            k = k + 1
                    
                                                
                        End If
                    Else
                        For l = 0 To UBound(wY_SYU_TBL)
                        
                            If Y_SYU_TBL(j).HIN_NO = wY_SYU_TBL(l).HIN_NO Then
                                
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                
                                    wY_SYU_TBL(l).SURYO = wY_SYU_TBL(l).SURYO + Y_SYU_TBL(j).SURYO
                                    
                                    Exit For
                                End If
                            End If
                        Next l
                    
                        If l > UBound(wY_SYU_TBL) Then
                            
                            If Not Y_SYU_TBL(j).CANCEL_F Then
                                ReDim Preserve wY_SYU_TBL(k)
                                wY_SYU_TBL(k).HIN_NO = Y_SYU_TBL(j).HIN_NO
                                wY_SYU_TBL(k).SUMI = Y_SYU_TBL(j).SUMI
                                wY_SYU_TBL(k).SURYO = Y_SYU_TBL(j).SURYO
                                
                                Y_SYU_CNT = Y_SYU_CNT + 1
                                If Y_SYU_TBL(j).SUMI Then
                                    Sumi_CNT = Sumi_CNT + 1
                                End If
                                
                                k = k + 1
                            End If
                        End If
                    End If
                Next j
                
                
                
                
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, Trim(ID_NO) & "(" & _
                                                    Format(Sumi_CNT, "#0") & "/" & _
                                                    Format(Y_SYU_CNT, "#0") & ")")
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
                    
                                    
                For j = 0 To UBound(wY_SYU_TBL)
                    
                    If wY_SYU_TBL(j).SUMI Then
                    Else
                        SendFileRec.Title = "1"
                    
                        
                        Call UniCode_Conv(SendFileRec.LCD, Left(wY_SYU_TBL(j).HIN_NO, 16) & ":" & _
                                                    Format(wY_SYU_TBL(j).SURYO, "#0"))
                        SendFileRec.CRLF = vbCrLf
                                                
                        Put #FileNo, , SendFileRec
                    End If
                Next j
                    
                Close #FileNo
        End Select
    Next i
                    
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = BB_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = BB_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    KEN_Rireki_Proc = False
    

End Function






Private Function KEN_ZAN_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwèWñÒåüïiécï\é¶èàóùÅx
'   2010.02.15
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer
Dim l               As Integer

Dim ID_NO           As String
Dim MTS_CODE        As String
Dim DEN_NO          As String
Dim OKURI_NO        As String
Dim UNSOU_KAISHA    As String

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim FileNo          As Integer

Dim FullPath        As String

Dim SendFileRec     As SendFileRec_Tag

Dim Y_SYU_CNT       As Integer
Dim Sumi_CNT        As Integer
Dim DATA_CNT        As Integer
Dim SYUKA_QTY       As Long

Dim Y_SYU_TBL()     As KEN_DEN_TBL_Tag
Dim wY_SYU_TBL()    As KEN_DEN_TBL_Tag

Dim OKURI_SAKI      As String

Dim CANCEL_F        As Boolean
    
Dim Found_F         As Boolean
    
    
    KEN_ZAN_Proc = True

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & BF_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    Else
        FullPath = CtrsWsk1.SendFolder & BF_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    End If

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            
            Case LCD_ID_No          'ì`ï[ÇhÇc
                'êeì`ÇÇjÇdÇdÇo
                ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                 
                Erase Y_SYU_TBL
                                
                sts = Y_Syuka_H_Chek_Proc(ID_KANRI_TBL(ING_No).JGYOBU, _
                                        MTS_CODE, _
                                        Y_SYU_CNT, _
                                        Sumi_CNT, _
                                        ID_NO, _
                                        SYUKA_QTY, _
                                        DEN_NO, _
                                        Y_SYU_TBL(), _
                                        OKURI_NO, _
                                        UNSOU_KAISHA, _
                                        OKURI_SAKI, _
                                        Found_F)
                
                
                
                sts = Data_Clear_Proc(0, Sendbuf)
                Select Case sts
                    Case SYS_ERR
                        Exit Function
                End Select
                
                
                '∑¨›æŸì`ï[ÇÃ¡™Ø∏
                
                If Found_F Then
                    CANCEL_F = True
                                             
                    For j = 0 To UBound(Y_SYU_TBL)
                    
                        If Not Y_SYU_TBL(j).CANCEL_F Then
                            CANCEL_F = False
                            Exit For
                        End If
                    
                    Next j
                                             
                                             
                    If CANCEL_F Then
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KEN_ZAN_Proc = False
                        Exit Function
                    End If
                End If
                
                If Y_SYU_CNT = 0 Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    KEN_ZAN_Proc = False
                    Exit Function
                End If
                
                
                If Y_SYU_CNT = Sumi_CNT Then
                    
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ñ¢åüïiécÇ»ÇµÅI", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    KEN_ZAN_Proc = False
                    Exit Function
                
                
                End If
                
                Erase ID_KANRI_TBL(ING_No).KEN_DEN_TBL
                Erase wY_SYU_TBL
                                
                                
                For j = 0 To UBound(Y_SYU_TBL)
                
                    If Y_SYU_TBL(j).SUMI Then
                    Else
                    
                        
                        
                        If Y_SYU_TBL(j).KONPOU_F = "1" Then
                        Else
                        
                            ReDim Preserve ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j)
                            
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO = Y_SYU_TBL(j).SEQ_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO = Y_SYU_TBL(j).HIN_NO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO = Y_SYU_TBL(j).SURYO
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI = Y_SYU_TBL(j).SUMI
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F = Y_SYU_TBL(j).CANCEL_F
                            ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = Y_SYU_TBL(j).KONPOU_F
                        End If
                    End If
                Next j
                
                k = 0
                
                Sumi_CNT = 0
                Y_SYU_CNT = 0
                
                For j = 0 To UBound(Y_SYU_TBL)
                    If k = 0 Then
                        If Y_SYU_TBL(j).CANCEL_F Then
                        Else
                    
                            If Y_SYU_TBL(j).KONPOU_F = "1" Then
                            Else
                    
                    
                                ReDim Preserve wY_SYU_TBL(k)
                                wY_SYU_TBL(k).HIN_NO = Y_SYU_TBL(j).HIN_NO
                                wY_SYU_TBL(k).SUMI = Y_SYU_TBL(j).SUMI
                                wY_SYU_TBL(k).SURYO = Y_SYU_TBL(j).SURYO
                                
                                Y_SYU_CNT = Y_SYU_CNT + 1
                                If Y_SYU_TBL(j).SUMI Then
                                    Sumi_CNT = Sumi_CNT + 1
                                End If
                                
                                
                                k = k + 1
                            End If
                                                
                        End If
                    Else
                        For l = 0 To UBound(wY_SYU_TBL)
                        
                            If Y_SYU_TBL(j).HIN_NO = wY_SYU_TBL(l).HIN_NO Then
                                
                                If Not Y_SYU_TBL(j).CANCEL_F Then
                                    If Y_SYU_TBL(j).KONPOU_F = "1" Then
                                    Else
                                
                                        wY_SYU_TBL(l).SURYO = wY_SYU_TBL(l).SURYO + Y_SYU_TBL(j).SURYO
                                    
                                        Exit For
                                    End If
                                End If
                            End If
                        Next l
                    
                        If l > UBound(wY_SYU_TBL) Then
                            
                            
                            If Not Y_SYU_TBL(j).CANCEL_F Then
                                
                                If Y_SYU_TBL(j).KONPOU_F = "1" Then
                                Else
                                    
                                    ReDim Preserve wY_SYU_TBL(k)
                                    wY_SYU_TBL(k).HIN_NO = Y_SYU_TBL(j).HIN_NO
                                    wY_SYU_TBL(k).SUMI = Y_SYU_TBL(j).SUMI
                                    wY_SYU_TBL(k).SURYO = Y_SYU_TBL(j).SURYO
                                    
                                    Y_SYU_CNT = Y_SYU_CNT + 1
                                    If Y_SYU_TBL(j).SUMI Then
                                        Sumi_CNT = Sumi_CNT + 1
                                    End If
                                    
                                    k = k + 1
                                End If
                            End If
                        End If
                    End If
                Next j
                
                
                
                
                
                
                On Error Resume Next
                Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
                On Error GoTo 0
        
                FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
                Open FullPath For Binary As #FileNo
        
                SendFileRec.Title = "0"     'É^ÉCÉgÉãçs
                Call UniCode_Conv(SendFileRec.LCD, Trim(ID_NO) & "(" & _
                                                    Format(Sumi_CNT, "#0") & "/" & _
                                                    Format(Y_SYU_CNT, "#0") & ")")
                SendFileRec.CRLF = vbCrLf
                Put #FileNo, , SendFileRec
                    
                                    
                For j = 0 To UBound(wY_SYU_TBL)
                    
                    If wY_SYU_TBL(j).SUMI Then
                    Else
                        SendFileRec.Title = "1"
                    
                        Call UniCode_Conv(SendFileRec.LCD, Left(wY_SYU_TBL(j).HIN_NO, 13) & ":" & _
                                                    Format(wY_SYU_TBL(j).SURYO, "#0"))
                        SendFileRec.CRLF = vbCrLf
                                                
                        Put #FileNo, , SendFileRec
                    End If
                Next j
                    
                Close #FileNo
        End Select
    Next i
                    
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
    'ëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
    Send_Text.Display_Flg = Display_REF                     'ï\é¶âÊñ ÉtÉâÉO éQè∆âÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_REF
    
    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
                                                            'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    Send_Text.fileName = BF_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    ID_KANRI_TBL(ING_No).Send_Text.fileName = BF_SendFile & "." & Format(ID_KANRI_TBL(ING_No).ID, "000")
    
    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
    '-----------------------------------------------ÇPÅ`ÇTçsñ⁄
                                                            
    For i = 0 To M_Gyo - 1
                                                            'BOXëÆê´
        Send_Text.Box_Type(i).Box_Type = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Box_Type = ""
                                                            'ï\é¶ì‡óe
        Call UniCode_Conv(Send_Text.Box_Type(i).LCD, "")
        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, "")
                                                            
                                                            'êîílèâä˙ï\é¶
        Send_Text.Box_Type(i).INIT = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
        Send_Text.Box_Type(i).Start_Pos = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Start_Pos = ""
                                                            'ì¸óÕåÖêî
        Send_Text.Box_Type(i).Max_Size = "00"
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size = "00"
                                                            'ÉÅÉjÉÖÅ\î‘çÜ
        Send_Text.Box_Type(i).MENU = ""
        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).MENU = ""
        
    Next i

    Sendbuf = Text_Create_Proc()
    
    
    
    KEN_ZAN_Proc = False
    

End Function




Private Function NYUKO_KENPIN_OSAKA_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwì¸â◊åüïièàóùÅiëÂç„PCå¸ÇØÅjÅx
'       2007.06.07
'
'-------------------------------------------------------
Dim i           As Integer

'2010.12.07
'Dim Hinban      As String * 13
Dim Hinban      As String * 20
'2010.12.07


Dim Tanaban     As String * 8
Dim DEN_NO      As String * 6
Dim SEQ_NO      As String * 3

Dim sts         As Integer

Dim QTY         As Long
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long

Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1

Dim MENU_NO     As String * 2


Dim Found_F     As Integer

Dim GYO_INS     As String * 1

    NYUKO_KENPIN_OSAKA_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
                        
                                                
                                                
                        '2010.10.01
'                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, 1)
                        
                        
                        Select Case sts
                            Case BtNoErr
                                RET_JGYOBU = ID_KANRI_TBL(ING_No).JGYOBU
                                RET_NAIGAI = ID_KANRI_TBL(ING_No).NAIGAI
                            
                            
                            
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        
                                NYUKO_KENPIN_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                
                        '------------------ ì¸â◊ÉfÅ[É^ÇÃämîF
                        sts = Y_Nyuka_O_Chek_Proc(1, RET_JGYOBU, _
                                                    RET_NAIGAI, _
                                                    Hinban, _
                                                    DEN_NO, _
                                                    Found_F, _
                                                    SEQ_NO, _
                                                    QTY)
                
                
                
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Found_F = 9 Then
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    NYUKO_KENPIN_OSAKA_Proc = False
                                    Exit Function
                                End If
                
                            Case True, SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                NYUKO_KENPIN_OSAKA_Proc = False
                                Exit Function
                        End Select
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI
                
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).SEQ_NO = SEQ_NO

                        ID_KANRI_TBL(ING_No).GYO_INS = "0"

                        ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = StrConv(ITEMREC.GOODS_KBN, vbUnicode)
                        'ì¸â◊ó\íËÇÃèÓïÒÇ…ÇÊÇËèàóùÇêUÇËï™ÇØÇÈ
                        Select Case Found_F
                            Case 0
                                '-----------------  ÉfÅ[É^ñ≥Çµ
                            
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Hinban)
                                                                                        
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                                                                        
                                                                                        
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "äYìñÇ»Çµ(0:OK 1:CAN)")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "äYìñÇ»Çµ(0:OK 1:CAN)")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "ïiñ⁄í«â¡ÅH")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "ïiñ⁄í«â¡ÅH")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "11"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "11"
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(3).Max_Size = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "01"
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                            Case 1
                                '-----------------  ñ¢èàóùÉfÅ[É^
                            
                            
                            
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        
                                Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Suryo)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Suryo)
                                                                                    
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = Format(M_Keta - 4, "00")
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "05"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "05"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                                                                        
                                                                                        
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        
                                If DEN_NO = "000000" Then
                                                                                            'BOXëÆê´
                                    Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                                            'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_DEN_No)
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_DEN_No)
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 5, "00")
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 5, "00")
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(3).Max_Size = "06"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "06"
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                Else
                                
                                                                                            'BOXëÆê´
                                    Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                            'ï\é¶ì‡óe
                                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_DEN_No & DEN_NO)
                                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_DEN_No & DEN_NO)
                                                                                            'êîílèâä˙ï\é¶
                                    Send_Text.Box_Type(3).INIT = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                            'èâä˙ÉJÅ[É\Éãà íu
                                    Send_Text.Box_Type(3).Start_Pos = ""
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                            'ì¸óÕåÖêî
                                    Send_Text.Box_Type(3).Max_Size = "00"
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                            
                                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                
                                End If
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                            
                            Case 2
                                '-----------------  èàóùçœÉfÅ[É^
                        
                            
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Hinban)
                                                                                        
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                                                                        
                                                                                        
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "èàóùçœ (0:OK 1:CAN)")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "èàóùçœ (0:OK 1:CAN)")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                                                                        
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "ïiñ⁄í«â¡ÅH")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "ïiñ⁄í«â¡ÅH")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = "11"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "11"
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(3).Max_Size = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "01"
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇTçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                        
                        
                        End Select
                
                
                
                End Select
            Next i
    
        Case Step_Sagyo2_RES        'èàóùåpë±ÇÃóLñ≥
    
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    Case LCD_HIN_ANS        'åpë±óLñ≥
                        GYO_INS = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                                    
                        If GYO_INS <> "0" And GYO_INS <> "1" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, GYO_INS, "(0 OR 1)", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_KENPIN_OSAKA_Proc = False
                            Exit Function

                        End If

                        ID_KANRI_TBL(ING_No).GYO_INS = "1"
                        ID_KANRI_TBL(ING_No).DEN_NO = "000000"

                        'ì¸â◊ó\íËÇÃèÓïÒÇ…ÇÊÇËèàóùÇêUÇËï™ÇØÇÈ
                        Select Case GYO_INS
                            Case "0"
                            
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        
                                Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Suryo)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Suryo)
                                                                                    
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = Format(M_Keta - 4, "00")
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(2).Max_Size = "05"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "05"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                                                                        
                                                                                        
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_DEN_No)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_DEN_No)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 5, "00")
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 5, "00")
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(3).Max_Size = "06"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "06"
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                 Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                            
                            Case "1"        'ÉLÉÉÉìÉZÉã
                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
            
        
                                Sendbuf = Text_Create_Proc()
                        
                        
                        End Select
                
                
                
                End Select
            Next i
    
    
    
        Case Step_Sagyo3_RES        'êîó Å^ì`ï[áÇ
    
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    Case LCD_Suryo      'êîó 
                        
                                    
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_KENPIN_OSAKA_Proc = False
                            Exit Function

                        End If

                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))


                    Case LCD_DEN_No     'ì`ï[áÇ
                        
                                    
                        If IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            If CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 0 Then
                            Else
                                ID_KANRI_TBL(ING_No).DEN_NO = Format(CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))), "000000")
                            End If
                        End If

                
                
                
                End Select
            Next i
    
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                                
                                                
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
                                                
                                                
            If ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = GOODS_ON Then
                MI_QTY = QTY
                SUMI_QTY = 0
            Else
                SUMI_QTY = QTY
                MI_QTY = 0
            End If
                                                
                                                'ì¸å…çXêV
            sts = Nyuko_OSAKA_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    Format(Now, "YYYYMMDD"), _
                                    (NYUKA_SOKO_NO & "01" & "01" & "01"), _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    SUMI_QTY, _
                                    MI_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    ID_KANRI_TBL(ING_No).GYO_INS, _
                                    ID_KANRI_TBL(ING_No).DEN_NO, _
                                    ID_KANRI_TBL(ING_No).SEQ_NO, _
                                    FILE_RETRY, , MENU_NO)
            Select Case sts
                Case False
                Case True           'ì¸å…éûÇÕî≠ê∂ÇµÇ»Ç¢
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                    NYUKO_KENPIN_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Sendbuf = Text_Create_Proc()
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    NYUKO_KENPIN_OSAKA_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    
                    GoTo Abort_Tran
            End Select
        
End_Tran:
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                                'éüÇÃçÏã∆óvãÅ
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
                    
            Sendbuf = Text_Create_Proc()
    
    
    End Select
    
    
    NYUKO_KENPIN_OSAKA_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function NYUKO_TANA_OSAKA_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwé¿íIì¸å…èàóùÅiëÂç„PCå¸ÇØÅjÅx
'       2007.06.07
'       2007.11.02 ïWèÄíIî‘ï\é¶í«â¡
'-------------------------------------------------------
Dim i               As Integer

'2010.12.07
'Dim Hinban          As String * 13
Dim Hinban          As String * 20
'2010.12.07

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8
Dim DEN_NO          As String * 6
Dim SEQ_NO          As String * 3

Dim sts         As Integer

Dim QTY         As Long
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long

Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1

Dim MENU_NO     As String * 2

Dim Found_F     As Integer

Dim ST_TANABAN      As String * 11  '2007.11.02


Dim RETRY_CNT   As Integer
Dim RETRY_SU    As Integer

    NYUKO_TANA_OSAKA_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        
                                NYUKO_TANA_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                        '2007.11.02 Å´
                        If Trim(StrConv(ITEMREC.ST_SOKO, vbUnicode)) = "" Then
                            ST_TANABAN = ""
                        Else
                            ST_TANABAN = StrConv(ITEMREC.ST_SOKO, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_RETU, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_REN, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_DAN, vbUnicode)
                        End If
                        '2007.11.02 Å™
                    
                    
                
                        '------------------ ì¸â◊ÉfÅ[É^ÇÃämîF
                        sts = Y_Nyuka_O_Chek_Proc(2, RET_JGYOBU, _
                                                    RET_NAIGAI, _
                                                    Hinban, _
                                                    DEN_NO, _
                                                    Found_F, _
                                                    SEQ_NO, _
                                                    QTY)
                        Select Case sts
                            Case False          'ê≥èÌ
                                Select Case Found_F
                                    Case 9
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        NYUKO_TANA_OSAKA_Proc = False
                                        Exit Function
                                    Case 0
                                                                    
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
                                        If RECOVER_F Then
                                            sts = BTRV(BtOpGetLast, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                                            Select Case sts
                                                Case BtNoErr
                                                    SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                                                Case BtErrEOF
                                                    SEQ_NO = "000"
                                                Case Else
                                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË√ﬁ∞¿")
                                                    NYUKO_TANA_OSAKA_Proc = False
                                                    Exit Function
                                            End Select
        
                                            SEQ_NO = Format(CInt(SEQ_NO) + 1, "000")
                
                                            Call UniCode_Conv(Y_NYU_O_REC.JGYOBU, RET_JGYOBU)
                                            Call UniCode_Conv(Y_NYU_O_REC.SOKO_NO, DAITO_SOKO_NO)
                                            Call UniCode_Conv(Y_NYU_O_REC.SEQ_NO, SEQ_NO)
                                            Call UniCode_Conv(Y_NYU_O_REC.NYUKO_YMD, Format(Now, "YYYYMMDD"))
                                            Call UniCode_Conv(Y_NYU_O_REC.DEN_NO, "000000")
        
                                            Call UniCode_Conv(Y_NYU_O_REC.MAKER_CODE, StrConv(ITEMREC.MAKER_CODE, vbUnicode))
                                            Call UniCode_Conv(Y_NYU_O_REC.NAIGAI, RET_NAIGAI)
        
                                            Call UniCode_Conv(Y_NYU_O_REC.HIN_NO, Hinban)
        
                                            Call UniCode_Conv(Y_NYU_O_REC.Y_SURYO, "00000000")
        
                                            Call UniCode_Conv(Y_NYU_O_REC.ORDER_NO, "")
        
                                            Call UniCode_Conv(Y_NYU_O_REC.FILLER, "")
    
                                            Call UniCode_Conv(Y_NYU_O_REC.DEN_NO, "")
                                            Call UniCode_Conv(Y_NYU_O_REC.J_SURYO, "00000000")
    
                                            Call UniCode_Conv(Y_NYU_O_REC.TANTO_CODE, "RECOV")
        
                                            Call UniCode_Conv(Y_NYU_O_REC.KENPIN_F, "1")
        
                                            Call UniCode_Conv(Y_NYU_O_REC.WEL_ID, Format(ID_KANRI_TBL(ING_No).ID, "000"))
                                            Call UniCode_Conv(Y_NYU_O_REC.PRG_ID, StrConv(App.EXEName, vbUpperCase))
        
            
                                            RETRY_SU = 5
                                            RETRY_CNT = 0
                                            Do
                                                sts = BTRV(BtOpInsert, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                                                Select Case sts
                                                    Case BtNoErr
                                                        Exit Do
                                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                                                                'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                                                        If RETRY_SU <> 0 Then
                                                            
                                                            RETRY_CNT = RETRY_CNT + 1
                                                            If RETRY_CNT > RETRY_SU Then
                                                                                'âÒêîÉIÅ[ÉoÅ[
                                                                Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË", 0)
                                                                NYUKO_TANA_OSAKA_Proc = False
                                                                Exit Function
                                                            End If
                                                        
                                                        End If
                                                        
                                                        DoEvents
                                                    Case Else
                                                        Call File_Error(sts, BtOpInsert, "ì¸â◊ó\íË")
                                                        NYUKO_TANA_OSAKA_Proc = False
                                                        Exit Function
                                                End Select
                                            Loop
                                        
                                        
                                            DEN_NO = "000000"
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
                                        
                                        Else
                                        
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘Ç»Çµ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            NYUKO_TANA_OSAKA_Proc = False
                                            Exit Function
                                
                                        End If
                                
                                
                                End Select
                
                            Case True, SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "äYìñïiî‘égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                NYUKO_TANA_OSAKA_Proc = False
                                Exit Function
                        End Select
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI
                
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).SEQ_NO = SEQ_NO

                        ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = StrConv(ITEMREC.GOODS_KBN, vbUnicode)
                        
                        
                        If ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = GOODS_ON Then
                            ID_KANRI_TBL(ING_No).Send_MI_QTY = QTY
                            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = 0
                        Else
                            ID_KANRI_TBL(ING_No).Send_MI_QTY = 0
                            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = QTY
                        End If
                        
                        
                        
                        
                        'FROM ì¸â◊ëqå…ÇÃç›å…ÇKEEP
                        FROM_Tanaban = NYUKA_SOKO_NO & "01" & "01" & "01"
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                NYUKO_TANA_OSAKA_Proc = False
                                Exit Function
                        End Select
                    
            
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
                        If RECOVER_F Then
                            QTY = SUMI_QTY + MI_QTY
                        End If
                        If ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = GOODS_ON Then
                            ID_KANRI_TBL(ING_No).Send_MI_QTY = QTY
                            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = 0
                        Else
                            ID_KANRI_TBL(ING_No).Send_MI_QTY = 0
                            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = QTY
                        End If
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
            
            
                        If (SUMI_QTY + MI_QTY) < QTY Then
                            Call Err_Send_Proc("óLå¯ç›å…êîïsë´", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                        End If
                        
                        
                            
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
'2007.11.02                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
'2007.11.02                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban & " " & ST_TANABAN)                        '2007.11.02
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban & " " & ST_TANABAN)   '2007.11.02
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
'2007.11.02                        Send_Text.Box_Type(2).Max_Size = "09"
'2007.11.02                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                        Send_Text.Box_Type(2).Max_Size = "16"                       'ì¸óÕåÖêîïœçXÅ@2007.11.02
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "16"  'ì¸óÕåÖêîïœçXÅ@2007.11.02
                                                                                
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(QTY, "#0")))) & Format(QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(QTY, "#0")))) & Format(QTY, "#0"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(QTY, "#0"))) & Format(QTY, "#0")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(QTY, "#0"))) & Format(QTY, "#0")
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                        If DEN_NO = "000000" Then
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_DEN_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_DEN_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 5, "00")
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 5, "00")
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "06"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "06"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        Else
                        
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_DEN_No & DEN_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_DEN_No & DEN_NO)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        End If
                    

                        Sendbuf = Text_Create_Proc()
                        
                
                
                
                End Select
            Next i
    
    
    
    
        Case Step_Sagyo2_RES        'íIî‘Å^êîó Å^ì`ï[áÇ
    
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    
                    Case LCD_Tanaban    'íIî‘
                    
                        TO_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(TO_Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(TO_Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    NYUKO_TANA_OSAKA_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ ç¨ç⁄É`ÉFÉbÉN
                            If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                                If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                    StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    NYUKO_TANA_OSAKA_Proc = False
                                    Exit Function
                                End If
                            End If
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(TO_Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(TO_Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(TO_Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(TO_Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    NYUKO_TANA_OSAKA_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                NYUKO_TANA_OSAKA_Proc = False
                                Exit Function
                            End If
            
                        End If
                   
                        ID_KANRI_TBL(ING_No).Tanaban = TO_Tanaban       'íIî‘ÇÉZÅ[Éu
                    
                    
                    Case LCD_Suryo      'êîó 
                        
                                    
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function

                        End If

                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))

                        If QTY > (ID_KANRI_TBL(ING_No).Send_MI_QTY + ID_KANRI_TBL(ING_No).Send_SUMI_QTY) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                        End If


                    Case LCD_DEN_No     'ì`ï[áÇ
                        
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "ì`ï[áÇì¸óÕÉ~ÉX", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                        End If
                        If CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "ì`ï[áÇì¸óÕÉ~ÉX", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                        End If
                                                                
                                    
                        ID_KANRI_TBL(ING_No).DEN_NO = Format(CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))), "000000")

                
                
                
                End Select
            Next i
    
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
        
        
            If ID_KANRI_TBL(ING_No).ITEM_GOODS_ON_F = GOODS_ON Then
                MI_QTY = QTY
                SUMI_QTY = 0
            Else
                MI_QTY = 0
                SUMI_QTY = QTY
            End If
            sts = IDO_OSAKA_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    (NYUKA_SOKO_NO & "01" & "01" & "01"), _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    SUMI_QTY, _
                                    MI_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    ID_KANRI_TBL(ING_No).DEN_NO, _
                                    ID_KANRI_TBL(ING_No).SEQ_NO, _
                                    FILE_RETRY, , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2), ID_KANRI_TBL(ING_No).Hinban, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    NYUKO_TANA_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    NYUKO_TANA_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    NYUKO_TANA_OSAKA_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
    
    
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
            If RECOVER_F Then
            
                Call UniCode_Conv(K0_Y_NYU_O.SEQ_NO, ID_KANRI_TBL(ING_No).SEQ_NO)
            
            
                RETRY_SU = 5
                RETRY_CNT = 0
                Do
                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                                    'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                            If RETRY_SU <> 0 Then
                                
                                RETRY_CNT = RETRY_CNT + 1
                                If RETRY_CNT > RETRY_SU Then
                                                    'âÒêîÉIÅ[ÉoÅ[
                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË", 0)
                                    NYUKO_TANA_OSAKA_Proc = False
                                    Exit Function
                                End If
                            
                            End If
                            
                            DoEvents
                        Case Else
                            Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                    End Select
                Loop
            
            
            
                Call UniCode_Conv(Y_NYU_O_REC.Y_SURYO, Format(QTY, "00000000"))
                Call UniCode_Conv(Y_NYU_O_REC.J_SURYO, Format(QTY, "00000000"))
            
            
            
                RETRY_SU = 5
                RETRY_CNT = 0
                Do
                    sts = BTRV(BtOpUpdate, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                                    'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                            If RETRY_SU <> 0 Then
                                
                                RETRY_CNT = RETRY_CNT + 1
                                If RETRY_CNT > RETRY_SU Then
                                                    'âÒêîÉIÅ[ÉoÅ[
                                    Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË", 0)
                                    NYUKO_TANA_OSAKA_Proc = False
                                    Exit Function
                                End If
                            
                            End If
                            
                            DoEvents
                        Case Else
                            Call File_Error(sts, BtOpGetEqual, "ì¸â◊ó\íË")
                            NYUKO_TANA_OSAKA_Proc = False
                            Exit Function
                    End Select
                Loop
            
            
            
            End If
'---------------------------------------------- 'àŸèÌëŒèà 2011.04.02
    
    
    
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        
                                        
                            
            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
            sts = Data_Clear_Proc(0, Sendbuf)
            Select Case sts
                Case SYS_CANCEL
                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
            End Select
                                        
                                        
                                        'éüÇÃçÏã∆óvãÅ
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    
    End Select
    
    
    NYUKO_TANA_OSAKA_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function Y_Nyuka_O_Chek_Proc(Mode As Integer, _
                                        JGYOBU As String, _
                                        NAIGAI As String, _
                                        HIN_NO As String, _
                                        DEN_NO As String, _
                                        Found_F As Integer, _
                                        SEQ_NO As String, _
                                        SURYO As Long) As Integer
'-------------------------------------------------------
'
'   Åwì¸â◊ó\íËÇÃégópó\ñÒÅx
'   ëÂç„ÇoÇbóp  2007.06.07
'
'   mode   :1   ì¸â◊åüïièàóùóp
'   mode   :2   ì¸å…èàóùóp
'   mode   :3   èoâ◊èàóùóp
'
'
'   FOUND_F:0Å@ÉfÅ[É^Ç»Çµ
'          :1  ÉfÅ[É^Ç†ÇËÅiñ¢èàóùÅj
'          :2  ÉfÅ[É^Ç†ÇËÅièàóùçœÅj
'          :9  ÉfÅ[É^ëºÇ≈égópíÜ
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


Dim ans         As Integer

Dim RETRY_CNT   As Integer

Dim i           As Integer
Dim j           As Integer




    Y_Nyuka_O_Chek_Proc = True
    
    Select Case Mode
        
        Case 1
            '------------------------------------------------------ ì¸â◊åüïi
            Found_F = 0
                
                
                
            SEQ_NO = ""
            
            com = BtOpGetFirst
            Do
                DoEvents
                sts = BTRV(com, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrEOF
                        Exit Do
                    Case Else
                        Call File_Error(sts, com, "ì¸â◊ó\íË", 0)
                        Y_Nyuka_O_Chek_Proc = SYS_ERR
                        Exit Function
                End Select
            
            
            
                If JGYOBU = StrConv(Y_NYU_O_REC.JGYOBU, vbUnicode) And _
                    NAIGAI = StrConv(Y_NYU_O_REC.NAIGAI, vbUnicode) And _
                    Trim(HIN_NO) = Trim(StrConv(Y_NYU_O_REC.HIN_NO, vbUnicode)) Then
        
        
                    If Trim(StrConv(Y_NYU_O_REC.WEL_ID, vbUnicode)) <> "" Then
                        Found_F = 9
                        Exit Do
                    Else
        
                        If CLng(StrConv(Y_NYU_O_REC.J_SURYO, vbUnicode)) = 0 Then
                        
                            DEN_NO = StrConv(Y_NYU_O_REC.DEN_NO, vbUnicode)
                            SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                            Found_F = 1
                        
                            Exit Do
                        End If
                    End If
            
                End If
                com = BtOpGetNext
            
            Loop
            
            
            If Found_F = 0 Then
                com = BtOpGetFirst
                Do
                    DoEvents
                    sts = BTRV(com, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrEOF
                            Exit Do
                        Case Else
                            Call File_Error(sts, com, "ì¸â◊ó\íË", 0)
                            Y_Nyuka_O_Chek_Proc = SYS_ERR
                            Exit Function
                    End Select
                
                
                
                    If JGYOBU = StrConv(Y_NYU_O_REC.JGYOBU, vbUnicode) And _
                        NAIGAI = StrConv(Y_NYU_O_REC.NAIGAI, vbUnicode) And _
                        Trim(HIN_NO) = Trim(StrConv(Y_NYU_O_REC.HIN_NO, vbUnicode)) Then
                        
                        DEN_NO = "000000"
                        SEQ_NO = "000"
                        Found_F = 2
                    
                        Exit Do
                
                    End If
                
                    com = BtOpGetNext
                Loop
            End If
            
            
            
            If Found_F = 1 Then
            
            
                Call UniCode_Conv(K0_Y_NYU_O.SEQ_NO, SEQ_NO)
                Do
                    DoEvents
                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrKeyNotFound
                            DEN_NO = StrConv(Y_NYU_O_REC.DEN_NO, vbUnicode)
                            SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                            Found_F = 9
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            RETRY_CNT = RETRY_CNT + 1
                            If RETRY_CNT > FILE_RETRY Then
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ì¸â◊ó\íË", 0)
                                Y_Nyuka_O_Chek_Proc = SYS_CANCEL
                                Exit Function
                            End If
                        Case Else
                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                            Y_Nyuka_O_Chek_Proc = SYS_ERR
                            Exit Function
                    End Select
                    
                                                            
                Loop
                        
                
                If sts <> BtErrKeyNotFound Then
                
                    Call UniCode_Conv(Y_NYU_O_REC.WEL_ID, Format(ID_KANRI_TBL(ING_No).ID, "000"))
                    Call UniCode_Conv(Y_NYU_O_REC.PRG_ID, StrConv(App.EXEName, vbUpperCase))
                                                            
                    RETRY_CNT = 0
                                                            
                                                            'ì¸â◊ó\íËèëçûÇ›
                    Do
                        DoEvents
                        sts = BTRV(BtOpUpdate, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                RETRY_CNT = RETRY_CNT + 1
                                If RETRY_CNT > FILE_RETRY Then
                                    Call File_Error(sts, BtOpUpdate, "ì¸â◊ó\íË", 0)
                                    Y_Nyuka_O_Chek_Proc = SYS_CANCEL
                                    Exit Function
                                End If
                            
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "ì¸â◊ó\íË", 0)
                                Y_Nyuka_O_Chek_Proc = SYS_ERR
                                Exit Function
                        End Select
                    Loop
                
                End If
            
            End If
    
        Case 2
    
            '------------------------------------------------------ ì¸â◊åüïi
            Found_F = 0
                
            SEQ_NO = ""
            
            com = BtOpGetFirst
            Do
                DoEvents
                sts = BTRV(com, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrEOF
                        Exit Do
                    Case Else
                        Call File_Error(sts, com, "ì¸â◊ó\íË", 0)
                        Y_Nyuka_O_Chek_Proc = SYS_ERR
                        Exit Function
                End Select
            
            
            
                If StrConv(Y_NYU_O_REC.KENPIN_F, vbUnicode) <> "1" Then
                Else
                    'åüïiçœÇÃÇ›ëŒè€Ç∆Ç∑ÇÈ
                    If JGYOBU = StrConv(Y_NYU_O_REC.JGYOBU, vbUnicode) And _
                        NAIGAI = StrConv(Y_NYU_O_REC.NAIGAI, vbUnicode) And _
                        Trim(HIN_NO) = Trim(StrConv(Y_NYU_O_REC.HIN_NO, vbUnicode)) Then
        
        
                        If Trim(StrConv(Y_NYU_O_REC.WEL_ID, vbUnicode)) <> "" Then
                            Found_F = 9
                            Exit Do
                        Else
        
                            
                            DEN_NO = StrConv(Y_NYU_O_REC.DEN_NO, vbUnicode)
                            SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                            SURYO = CLng(StrConv(Y_NYU_O_REC.J_SURYO, vbUnicode))
                            Found_F = 1
                        
                            Exit Do
                        End If
            
                    End If
                End If
                com = BtOpGetNext
            
            Loop
    
            If Found_F = 1 Then
            
            
                Call UniCode_Conv(K0_Y_NYU_O.SEQ_NO, SEQ_NO)
                Do
                    DoEvents
                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrKeyNotFound
                            DEN_NO = StrConv(Y_NYU_O_REC.DEN_NO, vbUnicode)
                            SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                            Found_F = 9
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            RETRY_CNT = RETRY_CNT + 1
                            If RETRY_CNT > FILE_RETRY Then
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ì¸â◊ó\íË", 0)
                                Y_Nyuka_O_Chek_Proc = SYS_CANCEL
                                Exit Function
                            End If
                        Case Else
                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                            Y_Nyuka_O_Chek_Proc = SYS_ERR
                            Exit Function
                    End Select
                    
                                                            
                Loop
    
    
            End If
    
    
        Case 3
    
            '------------------------------------------------------ èoâ◊éû¡™Ø∏
            Found_F = 0
                
            SEQ_NO = ""
            
            com = BtOpGetFirst
            Do
                DoEvents
                sts = BTRV(com, Y_NYU_O_POS, Y_NYU_O_REC, Len(Y_NYU_O_REC), K0_Y_NYU_O, Len(K0_Y_NYU_O), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrEOF
                        Exit Do
                    Case Else
                        Call File_Error(sts, com, "ì¸â◊ó\íË", 0)
                        Y_Nyuka_O_Chek_Proc = SYS_ERR
                        Exit Function
                End Select
            
            
                'ì`ï[î‘çÜì¸óÕçœÇÃÇ›ëŒè€Ç∆Ç∑ÇÈ
                If JGYOBU = StrConv(Y_NYU_O_REC.JGYOBU, vbUnicode) And _
                    NAIGAI = StrConv(Y_NYU_O_REC.NAIGAI, vbUnicode) And _
                    Trim(HIN_NO) = Trim(StrConv(Y_NYU_O_REC.HIN_NO, vbUnicode)) Then
                        
                    DEN_NO = StrConv(Y_NYU_O_REC.DEN_NO, vbUnicode)
                    SEQ_NO = StrConv(Y_NYU_O_REC.SEQ_NO, vbUnicode)
                    SURYO = CLng(StrConv(Y_NYU_O_REC.J_SURYO, vbUnicode))
        
                    Found_F = 1
        
                    If Trim(DEN_NO) = "" Or DEN_NO = "000000" Then
                        Exit Do
                    End If
            
                End If
                com = BtOpGetNext
            
            Loop
    
    
    
    End Select
    
    
    
    Y_Nyuka_O_Chek_Proc = False
    

End Function

Private Function Furikae_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwéëçﬁêUë÷Å@éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx    2007.06.28
'
'-------------------------------------------------------
Dim i           As Integer

'2010.12.07
'Dim Hinban      As String * 13
Dim Hinban      As String * 20
'2010.12.07
Dim Tanaban     As String * 8
Dim sts         As Integer

Dim QTY         As Long
Dim SUMI_QTY    As Long
Dim MI_QTY      As Long

Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1

Dim MENU_NO     As String * 2

Dim WK_CODE     As String * 5
Dim WK_TANKA    As String * 11

Dim SYUSHI      As String * 3

    Furikae_Proc = True

    For i = 0 To M_Gyo - 1
        Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
            Case LCD_Tanaban        'íIî‘
                Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                
                If Trim(Tanaban) = Loc_OK_Para Then 'íIî‘OK
                Else
                '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                    Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                    sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrKeyNotFound
                
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                            Furikae_Proc = False
                            Exit Function
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                            Exit Function
                    End Select
                    '------------------ ç¨ç⁄É`ÉFÉbÉN
                    If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                        If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                            StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Furikae_Proc = False
                            Exit Function
                        End If
                    End If
                    '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                    Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                    Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                    Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                    Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrKeyNotFound
                
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Furikae_Proc = False
                            Exit Function
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                            Exit Function
                    End Select
            
                    '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                    If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        
                        Furikae_Proc = False
                        Exit Function
                    End If
            
            
                End If
            Case LCD_Hinban         'ïiî‘
                Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                
                sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                Select Case sts
                    Case BtNoErr
                        If Trim(Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                            Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                            Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                            Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                            Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                    Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    Furikae_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                        End If
                    
                        If RET_JGYOBU <> SHIZAI Or RET_NAIGAI <> NAIGAI_NAI Then
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "éëçﬁïiî‘ÇÃÇ›óLå¯", "", "")
            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
        
                            Furikae_Proc = False
                            Exit Function
                        End If
                    
                    Case BtErrKeyNotFound
                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                        Furikae_Proc = False
                        Exit Function
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                        Exit Function
                End Select
            
            Case LCD_Suryo          'êîó 
                If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                    Furikae_Proc = False
                    Exit Function
                End If
                
                QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                If QTY = 0 Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                    Furikae_Proc = False
                    Exit Function
                End If
            
            
            Case LCD_SYUSHI         'é˚éx
                
                SYUSHI = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                
                If SYUSHI = Trim(StrConv(ITEMREC.G_SYUSHI, vbUnicode)) Then
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, SYUSHI, "ìØàÍé˚éxÇ≈Ç∑", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                    Furikae_Proc = False
                    Exit Function
                End If
                
                '------------------ ÉRÅ[ÉhÉ}ÉXÉ^ì«çûÇ›
                Call UniCode_Conv(K0_P_CODE.DATA_KBN, P_KBN03_CD)
                Call UniCode_Conv(K0_P_CODE.C_Code, SYUSHI)
                sts = BTRV(BtOpGetEqual, P_CODE_POS, P_CODEREC, Len(P_CODEREC), K0_P_CODE, Len(K0_P_CODE), 0)
                Select Case sts
                    Case BtNoErr
                    Case BtErrKeyNotFound
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, SYUSHI, "é˚éxÉGÉâÅ[", "", "")
        
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
    
                        Furikae_Proc = False
                        Exit Function
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                        Exit Function
                End Select
        
        End Select
    Next i
    '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        Exit Function
    End If
                                        
                                        
    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                
    Else
                
        MENU_NO = ""
    End If
                                        
                                        
                                        'èoå…çXêV
    sts = Syuko_Update_Proc(RET_JGYOBU, _
                            RET_NAIGAI, _
                            Hinban, _
                            "", _
                            Tanaban, _
                            (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                            0, _
                            QTY, _
                            0, _
                            Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                            ID_KANRI_TBL(ING_No).TANTO_CODE, _
                            FILE_RETRY, , , , , , , MENU_NO)
    Select Case sts
        Case False
        
        Case True       'ç›å…ïsë´éûÇ…î≠ê∂
            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), Hinban, "ç›å…êîïsë´", "")
            Sendbuf = Text_Create_Proc()
            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
            Furikae_Proc = False
            GoTo Abort_Tran
        Case SYS_CANCEL
            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
            Sendbuf = Text_Create_Proc()
            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
            Furikae_Proc = False
            GoTo Abort_Tran
        Case SYS_ERR
            Sendbuf = Text_Create_Proc()
            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
            Furikae_Proc = SYS_ERR      'ÉVÉXÉeÉÄàŸèÌî≠ê∂
            
            GoTo Abort_Tran
    End Select

    '-----------------  ì¸å…èÓïÒèoóÕ
    sts = S_NYUKO_Update_Proc(Hinban, QTY, SYUSHI)
    Select Case sts
        Case False
        Case True           'ì¸å…éûÇÕî≠ê∂ÇµÇ»Ç¢
        Case SYS_CANCEL
            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
            Sendbuf = Text_Create_Proc()
            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
            Furikae_Proc = False
            GoTo Abort_Tran
        Case SYS_ERR
            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
            Sendbuf = Text_Create_Proc()
            Furikae_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
            
            GoTo Abort_Tran
    End Select







End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpEndTransaction, "", 0)
        GoTo Abort_Tran
    End If
                                        'éüÇÃçÏã∆óvãÅ
    
    Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
    Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
    sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    Select Case sts
        Case BtNoErr
        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
        Case Else
        'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
        Exit Function
    End Select
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
    If Sagyo_Send_Proc() Then
        Sendbuf = Text_Create_Proc()
        Exit Function
    End If
            
    Sendbuf = Text_Create_Proc()
    
    
    
    Furikae_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function


Private Function S_NYUKO_Update_Proc(Hinban As String, QTY As Long, SYUSHI As String) As Integer
'----------------------------------------------------------------------------
'                  éëçﬁíçï∂√ﬁ∞¿çXêV 2007.06.28
'----------------------------------------------------------------------------
Dim sts         As Integer
Dim ans         As Integer
Dim com         As Integer

Dim SEQNO       As Integer

Dim RETRY_CNT   As Integer


    S_NYUKO_Update_Proc = True
                                        
                                        
    '---------------------------------------------------    'éëçﬁíçï∂ÉfÅ[É^çXêV (êUë÷å≥)
                                        'ä«óùÉtÉ@ÉCÉãÇÊÇËéëçﬁíçï∂î‘çÜÇÃälìæ
    Call UniCode_Conv(K0_P_KANRI.REC_NO, P_ST_KANRI_No)
        
    RETRY_CNT = 0
        
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrKeyNotFound
            
                If P_KANRI_MAKE_Proc() Then
                    S_NYUKO_Update_Proc = SYS_ERR
                    Exit Function
                End If
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
            
        End Select
        
        
    Loop
    
    'íçï∂èëáÇÅ{ÇP

    If CLng(StrConv(P_KANRIREC.ORDER_NO, vbUnicode)) = 99999 Then
        Call UniCode_Conv(P_KANRIREC.ORDER_NO, "00001")
    Else
        Call UniCode_Conv(P_KANRIREC.ORDER_NO, Format(CLng(StrConv(P_KANRIREC.ORDER_NO, vbUnicode)) + 1, "00000"))
    End If


    RETRY_CNT = 0
    Do
        
        DoEvents
        
        sts = BTRV(BtOpUpdate, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpUpdate, "ä«óùÉ}ÉXÉ^", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
    Loop
                                                                            
                                                                            
    'ïiñ⁄œΩ¿ì«çûÇ›
    Call UniCode_Conv(K0_ITEM.JGYOBU, SHIZAI)
    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
    sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄œΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_CANCEL
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄œΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_ERR
            Exit Function
    End Select
                                                                            
                                                                            'íçï∂áÇ
    Call UniCode_Conv(P_SHORDER_REC.ORDER_NO, StrConv(P_KANRIREC.ORDER_NO, vbUnicode))
    Call UniCode_Conv(P_SHORDER_REC.ORDER_DT, Format(Now, "YYYYMMDD"))      'íçï∂ì˙
    Call UniCode_Conv(P_SHORDER_REC.Print_datetime, "")                     'î≠çsì˙éû
    Call UniCode_Conv(P_SHORDER_REC.TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)   'íSìñé“
    Call UniCode_Conv(P_SHORDER_REC.JGYOBU, SHIZAI)                         'éñã∆ïîÅiÅÅéëçﬁÅj
    Call UniCode_Conv(P_SHORDER_REC.NAIGAI, NAIGAI_NAI)                     'çëì‡äO
    Call UniCode_Conv(P_SHORDER_REC.HIN_GAI, Hinban)         'ïiî‘
                                                                            'íçï∂êÊ∫∞ƒﬁ
    Call UniCode_Conv(P_SHORDER_REC.ORDER_CODE, StrConv(ITEMREC.G_SHIIRE_TBL(0).CODE, vbUnicode))
    Call UniCode_Conv(P_SHORDER_REC.DELI_CODE, "")                          'î[ì¸êÊ∫∞ƒﬁ
                                                                            'íçï∂êî
    Call UniCode_Conv(P_SHORDER_REC.ORDER_QTY, Format(QTY * -1, _
                                                                "00000000.00"))
        
    Call UniCode_Conv(P_SHORDER_REC.Y_NOUKI_DT, Format(Now, "YYYYMMDD"))    'ó\íËî[ä˙
        
    If IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then              'íPâø
        Call UniCode_Conv(P_SHORDER_REC.TANKA, Format(CDbl(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)), _
                                                            "00000000.00"))
    Else
        Call UniCode_Conv(P_SHORDER_REC.TANKA, "00000000.00")
    End If
    Call UniCode_Conv(P_SHORDER_REC.LOT, "00000001")                        'LOT
    
    Call UniCode_Conv(P_SHORDER_REC.KAN_F, P_KAN_ON)                        'äÆóπÃ◊∏ﬁÅië¶äÆóπÅj
    Call UniCode_Conv(P_SHORDER_REC.KAN_DT, Format(Now, "YYYYMMDD"))        'äÆóπì˙
    Call UniCode_Conv(P_SHORDER_REC.BUNNOU_CNT, "01")                       'éÛì¸âÒêî
    Call UniCode_Conv(P_SHORDER_REC.UKEIRE_QTY, Format(QTY * -1, "00000000.00"))
    
    Call UniCode_Conv(P_SHORDER_REC.CANCEL_F, P_CANCEL_OFF)                 '∑¨›æŸÃ◊∏ﬁ
    Call UniCode_Conv(P_SHORDER_REC.CANCEL_DATETIME, "")                    '∑¨›æŸì˙éû
    
    Call UniCode_Conv(P_SHORDER_REC.PRINT_F, P_PRINT_ON)                    'àÛç¸Ã◊∏ﬁ(àÛç¸çœÇ∆Ç∑ÇÈ)
    
    Call UniCode_Conv(P_SHORDER_REC.WS_NO, Format(ID_KANRI_TBL(ING_No).ID, "000"))        'ì¸óÕí[ññ
                                                                            'édì¸ãÊï™
    Call UniCode_Conv(P_SHORDER_REC.G_SHIIRE_KBN, StrConv(ITEMREC.G_SHIIRE_KBN, vbUnicode))
        
    'é˚éxíPà 
    Call UniCode_Conv(P_SHORDER_REC.G_SYUSHI, StrConv(ITEMREC.G_SYUSHI, vbUnicode))
        
        
    'éÛï•êÊœΩ¿ì«çûÇ›
    Call UniCode_Conv(K0_P_UKEHARAI.UKEHARAI_CODE, StrConv(ITEMREC.G_SHIIRE_TBL(0).CODE, vbUnicode))
    sts = BTRV(BtOpGetEqual, P_UKEHARAI_POS, P_UKEHARAIREC, Len(P_UKEHARAIREC), K0_P_UKEHARAI, Len(K0_P_UKEHARAI), 0)
        
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éÛï•êÊœΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_CANCEL
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éÛï•êÊœΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_ERR
            Exit Function
    End Select
    
                                                                                'éÊà¯êÊãÊï™
    Call UniCode_Conv(P_SHORDER_REC.TORI_KBN, StrConv(P_UKEHARAIREC.TORI_KBN, vbUnicode))
        
        
    Call UniCode_Conv(P_SHORDER_REC.FILLER, "")

    RETRY_CNT = 0

    Do
        
        DoEvents
        
        sts = BTRV(BtOpInsert, P_SHORDER_POS, P_SHORDER_REC, Len(P_SHORDER_REC), K0_P_SHORDER, Len(K0_P_SHORDER), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpInsert, "éëçﬁíçï∂√ﬁ∞¿", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "éëçﬁíçï∂√ﬁ∞¿", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
    
    Loop
    
    
    
    
    SEQNO = 0
    
    
    
    'éëçﬁéÛì¸óöó√ﬁ∞¿èàóù
    Call UniCode_Conv(K0_P_SHUKEIRE.ORDER_NO, StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode))
    Call UniCode_Conv(K0_P_SHUKEIRE.SEQNO, "")
    
    com = BtOpGetGreater
    
    Do
    
        sts = BTRV(com, P_SHUKEIRE_POS, P_SHUKEIRE_REC, Len(P_SHUKEIRE_REC), K0_P_SHUKEIRE, Len(K0_P_SHUKEIRE), 0)
            
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_SHUKEIRE_REC.ORDER_NO, vbUnicode) <> StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode) Then
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            
            Case Else
                Call File_Error(sts, com, "éëçﬁéÛì¸óöó", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
                
        End Select
        
        
        
        SEQNO = SEQNO + 1
        
        
        com = BtOpGetNext
        
    Loop
        
                                                                                'íçï∂áÇ
    Call UniCode_Conv(P_SHUKEIRE_REC.ORDER_NO, StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode))                                                                                         'éÛì¸ì˙
                                                                                'íçï∂êÊ
    Call UniCode_Conv(P_SHUKEIRE_REC.ORDER_CODE, StrConv(P_SHORDER_REC.ORDER_CODE, vbUnicode))
                                                                                'éÛì¸ì˙
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_DT, Format(Now, "YYYYMMDD"))
                                                                                'éÛì¸êîó 
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_QTY, Format(QTY * -1, "00000000.00"))
                                                                                'éÛì¸íPâø
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_TANKA, StrConv(P_SHORDER_REC.TANKA, vbUnicode))
                                                                                'éÛì¸ã‡äz
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_KINGAKU, Format(QTY * -1 * _
                                                        CDbl(StrConv(P_SHORDER_REC.TANKA, vbUnicode)), "00000000"))
    Call UniCode_Conv(P_SHUKEIRE_REC.LAST_F, P_UKEIRE_END)
                                                                                'åvè„îNåé
    Call UniCode_Conv(P_SHUKEIRE_REC.KEIJYO_YM, Left(Format(Now, "YYYYMMDD"), 6))
        
    Call UniCode_Conv(P_SHUKEIRE_REC.FILLER, "")
                                                        'çXêVì˙éû
    Call UniCode_Conv(P_SHUKEIRE_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
    
    
    RETRY_CNT = 0
    Do
            
        SEQNO = SEQNO + 1
                                                'í«î‘
        Call UniCode_Conv(P_SHUKEIRE_REC.SEQNO, Format(SEQNO, "000"))
            
        DoEvents
            
        sts = BTRV(BtOpInsert, P_SHUKEIRE_POS, P_SHUKEIRE_REC, Len(P_SHUKEIRE_REC), K0_P_SHUKEIRE, Len(K0_P_SHUKEIRE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrDuplicates
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpInsert, "éëçﬁéÛì¸óöó", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "éëçﬁéÛì¸óöó", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
        
    Loop



    '---------------------------------------------------    'éëçﬁíçï∂ÉfÅ[É^çXêV (êUë÷êÊ)
                                        'ä«óùÉtÉ@ÉCÉãÇÊÇËéëçﬁíçï∂î‘çÜÇÃälìæ
    Call UniCode_Conv(K0_P_KANRI.REC_NO, P_ST_KANRI_No)
        
    RETRY_CNT = 0
        
    Do
        sts = BTRV(BtOpGetEqual + BtSNoWait, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrKeyNotFound
            
                If P_KANRI_MAKE_Proc() Then
                    S_NYUKO_Update_Proc = SYS_ERR
                    Exit Function
                End If
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE         'Ç±ÇÍÇÕñ≥Ç¢
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
            
        End Select
        
        
    Loop
    
    'íçï∂èëáÇÅ{ÇP

    If CLng(StrConv(P_KANRIREC.ORDER_NO, vbUnicode)) = 99999 Then
        Call UniCode_Conv(P_KANRIREC.ORDER_NO, "00001")
    Else
        Call UniCode_Conv(P_KANRIREC.ORDER_NO, Format(CLng(StrConv(P_KANRIREC.ORDER_NO, vbUnicode)) + 1, "00000"))
    End If


    RETRY_CNT = 0
    Do
        
        DoEvents
        
        sts = BTRV(BtOpUpdate, P_KANRI_POS, P_KANRIREC, Len(P_KANRIREC), K0_P_KANRI, Len(K0_P_KANRI), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ä«óùÉ}ÉXÉ^", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpUpdate, "ä«óùÉ}ÉXÉ^", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
    Loop
                                                                            
                                                                            
    'ïiñ⁄œΩ¿ì«çûÇ›
    Call UniCode_Conv(K0_ITEM.JGYOBU, SHIZAI)
    Call UniCode_Conv(K0_ITEM.NAIGAI, NAIGAI_NAI)
    Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
    sts = BTRV(BtOpGetEqual + BtSNoWait, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
        
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄œΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_CANCEL
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ïiñ⁄œΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_ERR
            Exit Function
    End Select
                                                                            
                                                                            'íçï∂áÇ
    Call UniCode_Conv(P_SHORDER_REC.ORDER_NO, StrConv(P_KANRIREC.ORDER_NO, vbUnicode))
    Call UniCode_Conv(P_SHORDER_REC.ORDER_DT, Format(Now, "YYYYMMDD"))      'íçï∂ì˙
    Call UniCode_Conv(P_SHORDER_REC.Print_datetime, "")                     'î≠çsì˙éû
    Call UniCode_Conv(P_SHORDER_REC.TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)   'íSìñé“
    Call UniCode_Conv(P_SHORDER_REC.JGYOBU, SHIZAI)                         'éñã∆ïîÅiÅÅéëçﬁÅj
    Call UniCode_Conv(P_SHORDER_REC.NAIGAI, NAIGAI_NAI)                     'çëì‡äO
    Call UniCode_Conv(P_SHORDER_REC.HIN_GAI, Hinban)         'ïiî‘
                                                                            'íçï∂êÊ∫∞ƒﬁ
    Call UniCode_Conv(P_SHORDER_REC.ORDER_CODE, StrConv(ITEMREC.G_SHIIRE_TBL(0).CODE, vbUnicode))
    Call UniCode_Conv(P_SHORDER_REC.DELI_CODE, "")                          'î[ì¸êÊ∫∞ƒﬁ
                                                                            'íçï∂êî
    Call UniCode_Conv(P_SHORDER_REC.ORDER_QTY, Format(QTY, "00000000.00"))
        
    Call UniCode_Conv(P_SHORDER_REC.Y_NOUKI_DT, Format(Now, "YYYYMMDD"))    'ó\íËî[ä˙
        
    If IsNumeric(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)) Then              'íPâø
        Call UniCode_Conv(P_SHORDER_REC.TANKA, Format(CDbl(StrConv(ITEMREC.G_ST_SHITAN, vbUnicode)), _
                                                            "00000000.00"))
    Else
        Call UniCode_Conv(P_SHORDER_REC.TANKA, "00000000.00")
    End If
    Call UniCode_Conv(P_SHORDER_REC.LOT, "00000001")                        'LOT
    
    Call UniCode_Conv(P_SHORDER_REC.KAN_F, P_KAN_ON)                        'äÆóπÃ◊∏ﬁÅië¶äÆóπÅj
    Call UniCode_Conv(P_SHORDER_REC.KAN_DT, Format(Now, "YYYYMMDD"))        'äÆóπì˙
    Call UniCode_Conv(P_SHORDER_REC.BUNNOU_CNT, "01")                       'éÛì¸âÒêî
    Call UniCode_Conv(P_SHORDER_REC.UKEIRE_QTY, Format(QTY, "00000000.00"))
    
    Call UniCode_Conv(P_SHORDER_REC.CANCEL_F, P_CANCEL_OFF)                 '∑¨›æŸÃ◊∏ﬁ
    Call UniCode_Conv(P_SHORDER_REC.CANCEL_DATETIME, "")                    '∑¨›æŸì˙éû
    
    Call UniCode_Conv(P_SHORDER_REC.PRINT_F, P_PRINT_ON)                    'àÛç¸Ã◊∏ﬁ(àÛç¸çœÇ∆Ç∑ÇÈ)
    
    Call UniCode_Conv(P_SHORDER_REC.WS_NO, Format(ID_KANRI_TBL(ING_No).ID, "000"))        'ì¸óÕí[ññ
                                                                            'édì¸ãÊï™
    Call UniCode_Conv(P_SHORDER_REC.G_SHIIRE_KBN, StrConv(ITEMREC.G_SHIIRE_KBN, vbUnicode))
        
    'é˚éxíPà 
    Call UniCode_Conv(P_SHORDER_REC.G_SYUSHI, SYUSHI)
        
        
    'éÛï•êÊœΩ¿ì«çûÇ›
    Call UniCode_Conv(K0_P_UKEHARAI.UKEHARAI_CODE, StrConv(ITEMREC.G_SHIIRE_TBL(0).CODE, vbUnicode))
    sts = BTRV(BtOpGetEqual, P_UKEHARAI_POS, P_UKEHARAIREC, Len(P_UKEHARAIREC), K0_P_UKEHARAI, Len(K0_P_UKEHARAI), 0)
        
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éÛï•êÊœΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_CANCEL
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éÛï•êÊœΩ¿", 0)
            S_NYUKO_Update_Proc = SYS_ERR
            Exit Function
    End Select
    
                                                                                'éÊà¯êÊãÊï™
    Call UniCode_Conv(P_SHORDER_REC.TORI_KBN, StrConv(P_UKEHARAIREC.TORI_KBN, vbUnicode))
        
        
    Call UniCode_Conv(P_SHORDER_REC.FILLER, "")

    RETRY_CNT = 0

    Do
        
        DoEvents
        
        sts = BTRV(BtOpInsert, P_SHORDER_POS, P_SHORDER_REC, Len(P_SHORDER_REC), K0_P_SHORDER, Len(K0_P_SHORDER), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpInsert, "éëçﬁíçï∂√ﬁ∞¿", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "éëçﬁíçï∂√ﬁ∞¿", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
    
    Loop
    
    
    
    
    SEQNO = 0
    
    
    
    'éëçﬁéÛì¸óöó√ﬁ∞¿èàóù
    Call UniCode_Conv(K0_P_SHUKEIRE.ORDER_NO, StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode))
    Call UniCode_Conv(K0_P_SHUKEIRE.SEQNO, "")
    
    com = BtOpGetGreater
    
    Do
    
        sts = BTRV(com, P_SHUKEIRE_POS, P_SHUKEIRE_REC, Len(P_SHUKEIRE_REC), K0_P_SHUKEIRE, Len(K0_P_SHUKEIRE), 0)
            
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_SHUKEIRE_REC.ORDER_NO, vbUnicode) <> StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode) Then
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            
            Case Else
                Call File_Error(sts, com, "éëçﬁéÛì¸óöó", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
                
        End Select
        
        
        
        SEQNO = SEQNO + 1
        
        
        com = BtOpGetNext
        
    Loop
        
                                                                                'íçï∂áÇ
    Call UniCode_Conv(P_SHUKEIRE_REC.ORDER_NO, StrConv(P_SHORDER_REC.ORDER_NO, vbUnicode))                                                                                         'éÛì¸ì˙
                                                                                'íçï∂êÊ
    Call UniCode_Conv(P_SHUKEIRE_REC.ORDER_CODE, StrConv(P_SHORDER_REC.ORDER_CODE, vbUnicode))
                                                                                'éÛì¸ì˙
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_DT, Format(Now, "YYYYMMDD"))
                                                                                'éÛì¸êîó 
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_QTY, Format(QTY, "00000000.00"))
                                                                                'éÛì¸íPâø
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_TANKA, StrConv(P_SHORDER_REC.TANKA, vbUnicode))
                                                                                'éÛì¸ã‡äz
    Call UniCode_Conv(P_SHUKEIRE_REC.UKEIRE_KINGAKU, Format(QTY * _
                                                        CDbl(StrConv(P_SHORDER_REC.TANKA, vbUnicode)), "00000000"))
    Call UniCode_Conv(P_SHUKEIRE_REC.LAST_F, P_UKEIRE_END)
                                                                                'åvè„îNåé
    Call UniCode_Conv(P_SHUKEIRE_REC.KEIJYO_YM, Left(Format(Now, "YYYYMMDD"), 6))
        
    Call UniCode_Conv(P_SHUKEIRE_REC.FILLER, "")
                                                        'çXêVì˙éû
    Call UniCode_Conv(P_SHUKEIRE_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
    
    
    RETRY_CNT = 0
    Do
            
        SEQNO = SEQNO + 1
                                                'í«î‘
        Call UniCode_Conv(P_SHUKEIRE_REC.SEQNO, Format(SEQNO, "000"))
            
        DoEvents
            
        sts = BTRV(BtOpInsert, P_SHUKEIRE_POS, P_SHUKEIRE_REC, Len(P_SHUKEIRE_REC), K0_P_SHUKEIRE, Len(K0_P_SHUKEIRE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrDuplicates
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                RETRY_CNT = RETRY_CNT + 1
                If RETRY_CNT > FILE_RETRY Then
                    Call File_Error(sts, BtOpInsert, "éëçﬁéÛì¸óöó", 0)
                    S_NYUKO_Update_Proc = SYS_CANCEL
                    Exit Function
                End If
            Case Else
                Call File_Error(sts, BtOpInsert, "éëçﬁéÛì¸óöó", 0)
                S_NYUKO_Update_Proc = SYS_ERR
                Exit Function
        End Select
        
    Loop


    
    S_NYUKO_Update_Proc = False
    
End Function

Private Function SYUKA_CANCEL_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwèoâ◊ó\íËÉLÉÉÉìÉZÉãèàóùÅx
'   2007.11.02
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8


Dim Hinban          As String * 20      '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim JITU_QTY        As Long

Dim SYUKO_QTY       As Long
Dim KENPIN_YMD      As String * 8


Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim KAN_KBN         As String * 1

Dim MENU_NO         As String * 2

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim CAN_ANS         As String * 1

Dim RETRY_CNT       As Integer

    SYUKA_CANCEL_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            RET_JGYOBU = Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 1)
                            ID_NO = Right(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 12)
                        Else
                            RET_JGYOBU = ID_KANRI_TBL(ING_No).JGYOBU
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                RET_JGYOBU, _
                                                RET_NAIGAI, _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN, _
                                                JITU_QTY, _
                                                , _
                                                KENPIN_YMD, _
                                                SYUKO_QTY)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKA_CANCEL_Proc = False
                                    Exit Function
                                End If
                
                
                
                
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKA_CANCEL_Proc = False
                                Exit Function
                        End Select
                
                
                        If KAN_KBN <> KAN_KBN_UN Then
                            
                            
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
                            
                            
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…èàóùçœÇ›", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKA_CANCEL_Proc = False
                            Exit Function
                        End If
                                                        
                                                        
                                                        
                        If SYUKO_QTY <> 0 Or Trim(KENPIN_YMD) <> "" Then
                            
                            
                            sts = Data_Clear_Proc(0, Sendbuf)
                            Select Case sts
                                Case SYS_CANCEL
                                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                Case SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
                            
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoå…é¿ê—óLÇË", "ÉLÉÉÉìÉZÉãïsâ¬", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKA_CANCEL_Proc = False
                            Exit Function
                        End If
                                                        
                                                        
                                                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
                           
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_CAN_ANS)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_CAN_ANS)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "20"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "01"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÇÕÇ¢Å^Ç¢Ç¢Ç¶Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                    
                    Case LCD_CAN_ANS    'ÅiÇÕÇ¢Å^Ç¢Ç¢Ç¶Åj
                        CAN_ANS = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        Select Case CAN_ANS
                        
                        
                        
                            Case "1"        'ÇÕÇ¢Å@ÉfÅ[É^çXêV
                        
                        
                        
                                '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    Exit Function
                                End If
                                            
            
            
            
            
                                                        'èoâ◊ó\íËì«çûÇ›
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).S_JGYOBU)   'éñã∆ïî
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDNo

                                RETRY_CNT = 0
                                Do
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            
                                            SYUKA_CANCEL_Proc = False
                                            GoTo Abort_Tran
                                                
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                                            If FILE_RETRY <> 0 Then
    
                                                RETRY_CNT = RETRY_CNT + 1
                                                If RETRY_CNT > FILE_RETRY Then
                                                            'âÒêîÉIÅ[ÉoÅ[
                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                                    Sendbuf = Text_Create_Proc()
                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                                    
                                                    SYUKA_CANCEL_Proc = False
                                                    GoTo Abort_Tran
    
                                                End If
    
                                            End If
    
                                            DoEvents
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            SYUKA_CANCEL_Proc = SYS_ERR
                                            GoTo Abort_Tran
                                    End Select
                                Loop
            
                                                        'èoâ◊ó\íËçÌèú
                                Do
                                
                                
                                    sts = BTRV(BtOpDelete, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            
                                            SYUKA_CANCEL_Proc = False
                                            GoTo Abort_Tran
                                                
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                                            If FILE_RETRY <> 0 Then
    
                                                RETRY_CNT = RETRY_CNT + 1
                                                If RETRY_CNT > FILE_RETRY Then
                                                            'âÒêîÉIÅ[ÉoÅ[
                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                                    Sendbuf = Text_Create_Proc()
                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                                    
                                                    SYUKA_CANCEL_Proc = False
                                                    GoTo Abort_Tran
    
                                                End If
    
                                            End If
    
                                            DoEvents
                                        Case Else
                                            Call File_Error(sts, BtOpDelete, "èoâ◊ó\íË", 0)
                                            SYUKA_CANCEL_Proc = SYS_ERR
                                            GoTo Abort_Tran
                                    End Select
                                
                                
                                Loop
            
            
                                If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                    If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                                Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                                ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                                                ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                                                ID_KANRI_TBL(ING_No).MENU_LV1, _
                                                                ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                                                ID_KANRI_TBL(ING_No).Hinban, _
                                                                0, 0, , , _
                                                                ID_KANRI_TBL(ING_No).ID_NO, _
                                                                ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                                ID_KANRI_TBL(ING_No).SS_CODE) Then
        

                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpEndTransaction, "", 0)
                                        GoTo Abort_Tran
                                    End If
                                End If
                                                
                                If SYUKA_LOG_ON Then
                                    Call SYUKA_LOG_OUT_PROC("DEL", "AFT")
                                End If
                                                
                                                
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpEndTransaction, "", 0)
                                    GoTo Abort_Tran
                                End If
                                        
                                        
                                        
                                        
                                        
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ÉLÉÉÉìÉZÉãÇµÇ‹ÇµÇΩ")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ÉLÉÉÉìÉZÉãÇµÇ‹ÇµÇΩ")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).ID_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).ID_NO)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                                                                        
                                Send_Text.Box_Type(3).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                        
                                                                                        
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                            Case "9"        'Ç¢Ç¢Ç¶Å@èàóùÇ»Çµ
                                        
                                            
                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    
                                    Case SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
                                        
                                        
                                                'éüÇÃçÏã∆óvãÅ
                                                
                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                    
                                Sendbuf = Text_Create_Proc()
                        Case Else
                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, CAN_ANS, "(1 OR 9)", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKA_CANCEL_Proc = False
                                Exit Function
                
                
                    End Select
                End Select
            Next i
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                'åüïiämîFèIóπéûÇÕÅAì`ï[ÇhÇcóvãÅÇ…ñﬂÇ∑à◊ÇÃì¡éÍèàóù
                
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "12"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()


'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
            
                Sendbuf = Text_Create_Proc()
    
    
    End Select
    SYUKA_CANCEL_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function



Private Function SYUKO_CANCEL_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwèoå…ÉLÉÉÉìÉZÉãèàóùÅx
'   2008.12.05
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 8


Dim Hinban          As String * 20      '2007.07.21 13-->20
Dim SYUKA_QTY       As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim JITU_QTY        As Long

Dim SYUKO_QTY       As Long
Dim KENPIN_YMD      As String * 8


Dim i               As Integer

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim KAN_KBN         As String * 1

Dim MENU_NO         As String * 2

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim CAN_ANS         As String * 1

Dim RETRY_CNT       As Integer

    SYUKO_CANCEL_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            RET_JGYOBU = Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 1)
                            ID_NO = Right(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), 12)
                        Else
                            RET_JGYOBU = ID_KANRI_TBL(ING_No).JGYOBU
                            ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                RET_JGYOBU, _
                                                RET_NAIGAI, _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN, _
                                                JITU_QTY, _
                                                , _
                                                KENPIN_YMD, _
                                                SYUKO_QTY)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKO_CANCEL_Proc = False
                                    Exit Function
                                End If
                
                
                
                
                
                            Case True
                                Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_CANCEL_Proc = False
                                Exit Function
                        End Select
                
                                                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).DEN_NO = DEN_NO
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        ID_KANRI_TBL(ING_No).CYU_KBN = CYU_KBN
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
                           
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        ID_KANRI_TBL(ING_No).Send_Syuka_QTY = SYUKA_QTY
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ì`ï[ID:" & ID_KANRI_TBL(ING_No).ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_CAN_ANS)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_CAN_ANS)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "20"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "01"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÇÕÇ¢Å^Ç¢Ç¢Ç¶Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                
                    
                    Case LCD_CAN_ANS    'ÅiÇÕÇ¢Å^Ç¢Ç¢Ç¶Åj
                        CAN_ANS = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        Select Case CAN_ANS
                        
                        
                        
                            Case "1"        'ÇÕÇ¢Å@ÉfÅ[É^çXêV
                        
                        
                        
                                '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    Exit Function
                                End If
                                            
            
            
            
            
                                                        'èoâ◊ó\íËì«çûÇ›
                                Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).S_JGYOBU)   'éñã∆ïî
                                Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDNo

                                RETRY_CNT = 0
                                Do
                                    sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            
                                            SYUKO_CANCEL_Proc = False
                                            GoTo Abort_Tran
                                                
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                                            If FILE_RETRY <> 0 Then
    
                                                RETRY_CNT = RETRY_CNT + 1
                                                If RETRY_CNT > FILE_RETRY Then
                                                            'âÒêîÉIÅ[ÉoÅ[
                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                                    Sendbuf = Text_Create_Proc()
                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                                    
                                                    SYUKO_CANCEL_Proc = False
                                                    GoTo Abort_Tran
    
                                                End If
    
                                            End If
    
                                            DoEvents
                                        Case Else
                                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                            SYUKO_CANCEL_Proc = SYS_ERR
                                            GoTo Abort_Tran
                                    End Select
                                Loop
            
                                                        'èoâ◊ó\íËÉNÉäÉAÅ[çXêV
                                
                                'äÆóπãÊï™
                                Call UniCode_Conv(Y_SYUREC.KAN_KBN, KAN_KBN_UN)
                                'äÆóπì˙ït
                                Call UniCode_Conv(Y_SYUREC.KAN_YMD, "")
                                'åüïiì˙ït
                                Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, "")
                                'é¿ê—êîó 
                                Call UniCode_Conv(Y_SYUREC.JITU_SURYO, "0000000")
                                'åüïiíSìñé“
                                Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, "")
                                'åüïiéûçè
                                Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, "")
    
                                'âÊñ åüïiÃ◊∏ﬁ
                                Call UniCode_Conv(Y_SYUREC.G_KENPIN_F, "")
                                'åüïiéûêîó 
                                Call UniCode_Conv(Y_SYUREC.KENPIN_SURYO, "0000000")
    
    
                                
                                Do
                                
                                
                                    sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            
                                            SYUKO_CANCEL_Proc = False
                                            GoTo Abort_Tran
                                                
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            'ÉäÉgÉâÉCâÒêîÉ`ÉFÉbÉN
                                            If FILE_RETRY <> 0 Then
    
                                                RETRY_CNT = RETRY_CNT + 1
                                                If RETRY_CNT > FILE_RETRY Then
                                                            'âÒêîÉIÅ[ÉoÅ[
                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                                    Sendbuf = Text_Create_Proc()
                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                                    
                                                    SYUKO_CANCEL_Proc = False
                                                    GoTo Abort_Tran
    
                                                End If
    
                                            End If
    
                                            DoEvents
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                            SYUKO_CANCEL_Proc = SYS_ERR
                                            GoTo Abort_Tran
                                    End Select
                                
                                
                                Loop
            
            
                                If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                    If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                                Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                                ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                                                ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                                                ID_KANRI_TBL(ING_No).MENU_LV1, _
                                                                ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE, _
                                                                ID_KANRI_TBL(ING_No).Hinban, _
                                                                0, 0, , , _
                                                                ID_KANRI_TBL(ING_No).ID_NO, _
                                                                ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                                ID_KANRI_TBL(ING_No).SS_CODE) Then
        

                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Call File_Error(sts, BtOpEndTransaction, "", 0)
                                        GoTo Abort_Tran
                                    End If
                                End If
                                                
'                                If SYUKA_LOG_ON Then
'                                    Call SYUKA_LOG_OUT_PROC("DEL", "AFT")
'                                End If
                                                
                                                
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpEndTransaction, "", 0)
                                    GoTo Abort_Tran
                                End If
                                        
                                        
                                        
                                        
                                        
                                '-----------------------------------------------ÉwÉbÉ_Å[
                                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                
                                
                                '-----------------------------------------------ÇPçsñ⁄
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(0).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(0).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(0).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                '-----------------------------------------------ÇQçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "ÉLÉÉÉìÉZÉãÇµÇ‹ÇµÇΩ")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "ÉLÉÉÉìÉZÉãÇµÇ‹ÇµÇΩ")
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(1).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(1).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(1).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).ID_NO)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).ID_NO)
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                                                                        
                                Send_Text.Box_Type(3).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                        
                                                                                        
                                                                                        
                                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(4).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                        
                                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                                Sendbuf = Text_Create_Proc()
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                            Case "9"        'Ç¢Ç¢Ç¶Å@èàóùÇ»Çµ
                                        
                                            
                                sts = Data_Clear_Proc(0, Sendbuf)
                                Select Case sts
                                    Case SYS_CANCEL
                                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                    
                                    Case SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
                                        
                                        
                                                'éüÇÃçÏã∆óvãÅ
                                                
                                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                                Select Case sts
                                    Case BtNoErr
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Case Else
                                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                    Exit Function
                                End Select
                                
                                
                                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                                If Sagyo_Send_Proc() Then
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                End If
                    
                                Sendbuf = Text_Create_Proc()
                        Case Else
                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, CAN_ANS, "(1 OR 9)", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SYUKO_CANCEL_Proc = False
                                Exit Function
                
                
                    End Select
                End Select
            Next i
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                'åüïiämîFèIóπéûÇÕÅAì`ï[ÇhÇcóvãÅÇ…ñﬂÇ∑à◊ÇÃì¡éÍèàóù
                
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).MTS_CODE & ID_KANRI_TBL(ING_No).SS_CODE)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_ID_No)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_ID_No)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "12"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()


'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
            
                Sendbuf = Text_Create_Proc()
    
    
    End Select
    SYUKO_CANCEL_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function SYUKA_DEL_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   Åwèoâ◊çÌèúèàóùÅx
'       2009.03.17
'-------------------------------------------------------
Dim sts             As Integer

Dim Tanaban         As String * 11
Dim Hinban          As String * 20
Dim SYUKA_QTY       As Long
Dim JITU_QTY        As Long
Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim MTS_CODE        As String * 8
Dim SS_CODE         As String * 8
Dim CYU_KBN         As String * 1
Dim NAIGAI          As String * 1

'2010.12.07
'Dim HIN_NO          As String * 13
Dim HIN_NO          As String * 20
'2010.12.07

Dim Y_SYU_CNT       As Integer
Dim ID_NO           As String * 12
Dim DEN_NO          As String * 6
Dim KAN_KBN         As String * 1


Dim i               As Integer

Dim MENU_NO         As String * 2



    SYUKA_DEL_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No      'ì`ï[ÇhÇc
    
    
                        If Len(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) = 13 Then
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "èoâ◊èàóùïsâ¬", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SYUKA_DEL_Proc = False
                            Exit Function
                        End If
    
    
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        '------------------ égópâ¬î\Ç»èoâ◊ó\íËÇÃó\ñÒÇçsÇ¢ÅAèoâ◊ó\íËêîÇälìæÇ∑ÇÈ
                        sts = Y_Syuka_Chek_Proc(KAN_KBN_UN, _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                NAIGAI, _
                                                Hinban, _
                                                MTS_CODE, _
                                                SS_CODE, _
                                                CYU_KBN, _
                                                Y_SYU_CNT, _
                                                ID_NO, _
                                                SYUKA_QTY, _
                                                DEN_NO, _
                                                KAN_KBN, _
                                                JITU_QTY)
                        Select Case sts
                            Case False          'ê≥èÌ
                                If Y_SYU_CNT = 0 Then   'ëŒè€ÉfÅ[É^Ç»Çµ
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    SYUKA_DEL_Proc = False
                                    Exit Function
                                End If
                
                            Case True
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Sendbuf = Text_Create_Proc()
                                SYUKA_DEL_Proc = False
                                Exit Function
                        End Select
                
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        ID_KANRI_TBL(ING_No).MTS_CODE = MTS_CODE
                        ID_KANRI_TBL(ING_No).SS_CODE = SS_CODE
                        
                        
                        
                        ID_KANRI_TBL(ING_No).SYUKA_QTY = SYUKA_QTY
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "00"
                                                                                
                        Send_Text.Box_Type(1).Max_Size = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = ""  '2007.07.21
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                
                                                                                
                                                                                
                                                                                
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, MTS_CODE & SS_CODE)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, MTS_CODE & SS_CODE)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "00"
                                                                                
                        Send_Text.Box_Type(2).Max_Size = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = ""  '2007.07.21
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "00"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = ""
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""



                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo & ":" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo & ":" & StrConv(Format(SYUKA_QTY, "#0"), vbWide))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "20"
                                                                                
                        Send_Text.Box_Type(4).Max_Size = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "01"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""


                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
            
            
            
            
        Case Step_Sagyo2_RES        '2âÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            
            
            
            
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            'èoâ◊ó\íËÇÃì«Ç›çûÇ›
            Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
            Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_KANRI_TBL(ING_No).ID_NO)   'IDáÇ
    
            Do
            
                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrKeyNotFound
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        SYUKA_DEL_Proc = False
                        GoTo Abort_Tran
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        SYUKA_DEL_Proc = False
                        GoTo Abort_Tran
                    Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
        
            Loop


                                            
                                            
                                            'èoâ◊ó\íËèëçûÇ›
            Do
                sts = BTRV(BtOpInsert, DEL_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_DEL_SYU, Len(K0_DEL_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        SYUKA_DEL_Proc = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        SYUKA_DEL_Proc = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            Loop
                                        
                                            'èoâ◊ó\íËèëçûÇ›
            Do
                sts = BTRV(BtOpDelete, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                        Sendbuf = Text_Create_Proc()
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        SYUKA_DEL_Proc = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                        SYUKA_DEL_Proc = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            Loop
                                        
                                        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
                                        
            '2004.07.16 Å´
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).Hinban, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        "", , , , , MENU_NO, _
                                        ID_KANRI_TBL(ING_No).MTS_CODE, ID_KANRI_TBL(ING_No).SS_CODE, _
                                        ID_KANRI_TBL(ING_No).ID_NO)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    SYUKA_DEL_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
            '2004.07.16 Å™
                                        
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
    
    
    End Select

    SYUKA_DEL_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If



End Function




Private Function Label_File_Make_Proc(fileName As String, Print_Su As Long, Start_Page_No As Long, PRINT_TOTAL_SU As Long) As Integer
'-------------------------------------------------------
'
'   Åwâ◊éDópÉfÅ[É^ÉtÉ@ÉCÉãçÏê¨Åx
'       2010.01.28
'-------------------------------------------------------
Dim sts         As Integer


Dim FileNo      As Long

Dim FullPath    As String


Dim LCnt        As Integer

Dim OKURI_NO    As Integer


Dim Work        As String * 20


    
Dim c           As String * 128     '2010.06.08
Dim DEF_FLG     As Boolean          '2010.06.08

    
    
'''''Exit Function
    
    Label_File_Make_Proc = True








    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    Else
        FullPath = CtrsWsk1.SendFolder & F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    End If


    If GetIni("LABEL", "LABEL_DEF", "F110010LABEL", c) Then   '2010.06.08
        DEF_FLG = False
    Else
        DEF_FLG = True
    End If


    On Error Resume Next
    Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
    On Error GoTo 0
        
    FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
    Open FullPath For Output As #FileNo

    Print #FileNo, "#"
    Print #FileNo, "JOB"
    
    
    If DEF_FLG Then                                     '2010.06.08
        Print #FileNo, Trim(c)
    Else
        Print #FileNo, "DEF MK=1,DK=8,MD=3,PW=384,PH=344,XO=8,UM=24,BM=0,AF=1"
    End If





'    Print #FileNo, "DEF MK=1,DK=8,MD=1,PW=384,PH=344,XO=8,UM=8"
    Print #FileNo, "START"
    OKURI_NO = Len(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) + 1
    'ëóÇËèÛáÇ(BC)
    If Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_CHARTER_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_AKABOU_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_LOGISTIC_CD) Then
        Print #FileNo, ""
    Else
        
        
'        Print #FileNo, "BCD TP=6,X=0,Y=22,RA=1,HT=40,HR=0,MG=0,NS=" & Format(OKURI_NO, "#0") & ",NE=2,NZ=0"
        Print #FileNo, "BCD TP=6,X=0,Y=0,RA=1,HT=80,HR=1,MG=0,NS=" & Format(OKURI_NO, "#0") & ",NE=2,NZ=0"
        Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) & Format(Start_Page_No, "00")
    End If
    
    Print #FileNo, "#FONT TP=3,CS=0"
    
    'ëóÇËèÛáÇ
    If Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_CHARTER_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_AKABOU_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_LOGISTIC_CD) Then
        Print #FileNo, ""
    Else
        Print #FileNo, "#TEXT X=33,Y=60,L=1,NS=12,NS=" & Format(OKURI_NO, "#0") & ",NE=2,NZ=0"
        Print #FileNo, "#" & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) & Format(Start_Page_No, "00")
    End If
    
    
    'àÛç¸ñáêî
    Print #FileNo, "FONT TP=7,CS=0,LG=72,WD=36,LS=0"
    Print #FileNo, "TEXT X=214,Y=245,L=1,NS=1,NE=3,NZ=1"
    Print #FileNo, Format(Start_Page_No, "000") & "/" & Format(PRINT_TOTAL_SU, "#")
    
    
    
         
         
    'íÖìX
'    Print #FileNo, "FONT TP=7,CS=0,LG=36,WD=18,LS=0"
'    Print #FileNo, "TEXT X=574,Y=65,L=1"
'
'    Print #FileNo, "íÖìX:000"
         
    
    
    
'    Print #FileNo, "TEXT X=0,Y=65,L=7"
    
    Print #FileNo, "FONT TP=7,CS=0,LG=36,WD=18,LS=0"
    Print #FileNo, "TEXT X=0,Y=65,L=7"
'    Print #FileNo, "TEXT X=0,Y=0,L=1,NS=1,NE=3,NZ=1"
    
    
    'TEL
'    If Len(Trim(ID_KANRI_TBL(ING_No).KEN_TEL_NO)) < 1 Then
'        Print #FileNo, ""
'    Else
'        If IsNumeric(Mid(Trim(ID_KANRI_TBL(ING_No).KEN_TEL_NO), 1, 1)) Then
'            Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_TEL_NO)
'        Else
'            Print #FileNo, ""
'        End If
'    End If
     Print #FileNo, ""
    
    
    
'    Print #FileNo, "00-0000-0000"
    
    
    
    'èZèä1
    Print #FileNo, Trim(Mid(ID_KANRI_TBL(ING_No).KEN_JYUSHO, 1, 20))
    
    'èZèä2
    Print #FileNo, Trim(Mid(ID_KANRI_TBL(ING_No).KEN_JYUSHO, 21, 20))
    
    'ëóÇËêÊ
    Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
    
    'îıçl
'    Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_BIKOU)
'    Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_MUKE_NAME)
    Print #FileNo, ""
    
    'ì˙ït
    Print #FileNo, Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 1, 4) & _
                                               "îN" & Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 5, 2) & _
                                               "åé" & Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 7, 2) & "ì˙"
    


    
    'ëóÇËå≥
    Print #FileNo, "ÇrÇcÇbì‡Å@ïîçﬁó¨í Çb"
    
    
    
    Print #FileNo, "QTY P=" & Format(Print_Su, "#")
    Print #FileNo, "END"


    
    Print #FileNo, "JOBE"
    
    fileName = F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
'    fileName = "label001" & ".txt"
'    fileName = "label091" & ".txt"










    Close #FileNo


'''''''''''''''''''''''''''''''''''''''


'
'    On Error Resume Next
'    Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
'    On Error GoTo 0
'
'    FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
'    Open FullPath For Output As #FileNo
'
'    Print #FileNo, "JOB"
'
'    Print #FileNo, "JOBE"
'
'
'    Close #FileNo
'''''''''''''''''''''''''''''''''''''''

    Label_File_Make_Proc = False


End Function




Private Function Label_Print_File_Make_Proc(fileName As String, Hinban As String, IRI_QTY As Long) As Integer
'-------------------------------------------------------
'
'   Åwïiî‘◊ÕﬁŸópÉfÅ[É^ÉtÉ@ÉCÉãçÏê¨Åx
'       2011.03.05
'
'-------------------------------------------------------
Dim sts         As Integer


Dim FileNo      As Long

Dim FullPath    As String

Dim wkHinban    As String * 14
Dim wklen       As Long
Dim wkmod       As Long

    
    
    Label_Print_File_Make_Proc = True
'-------------------------  2012.03.19
'    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
'        FullPath = CtrsWsk1.SendFolder & "\" & EF_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
'    Else
'        FullPath = CtrsWsk1.SendFolder & EF_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
'    End If
    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & fileName & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    Else
        FullPath = CtrsWsk1.SendFolder & fileName & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    End If
'-------------------------  2012.03.19




    On Error Resume Next
    Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
    On Error GoTo 0
        
    FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
    Open FullPath For Output As #FileNo







    Print #FileNo, "#"
    Print #FileNo, "JOB"
    
    
    Print #FileNo, "DEF MK=1,DK=8,MD=3,PW=384,PH=344,XO=8,UM=24,BM=0,AF=1"





    Print #FileNo, "START"
    
    Print #FileNo, "FONT TP=7,CS=0,LG=80,WD=45,LS=0"
    Print #FileNo, "TEXT X=15,Y=30,L=1"
    
    
    
    
    wkHinban = Trim(Hinban)
    If Len(Trim(wkHinban)) < 14 Then
        wklen = 14 - Len(Trim(wkHinban))
        
        
        wklen = ToRoundDown(CCur(wklen / 2), 0)
        If wklen < 1 Then
        Else
            wkHinban = Space(wklen) & Trim(wkHinban)
        End If
    End If
    
'    Print #FileNo, Left(Trim(Hinban), 14)
    Print #FileNo, wkHinban

    
    Print #FileNo, "BCD TP=7,X=40,Y=120,DR=0,NW=1,RA=,HT=100,HR=0,MG=0,NS=0,NE=0,NZ=0"
    Print #FileNo, Left(Hinban, 14)
    
    
    If IRI_QTY = 0 Then
    Else
        Print #FileNo, "FONT TP=7,CS=0,LG=60,WD=45,LS=0"
        Print #FileNo, "TEXT X=150,Y=230,L=1"
        Print #FileNo, Format(IRI_QTY, "0") & "å¬"
    End If
    
    
    Print #FileNo, "QTY P=1"
    Print #FileNo, "END"


    
    Print #FileNo, "JOBE"
    

    Close #FileNo

    fileName = EF_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"


    Label_Print_File_Make_Proc = False


End Function



Private Sub Syuka_Kenpin_Count_Proc(Sumi_CNT As Integer, _
                                    Y_SYU_CNT As Integer, _
                                    KONPOU_ON As Integer, _
                                    KONPOU_OFF As Integer, _
                                    KONPOU_ON_SUMI As Integer, _
                                    KONPOU_OFF_SUMI As Integer)
'-------------------------------------------------------
'
'   Åwåüïiä÷åWé¿êîÇÃÉJÉEÉìÉgÅx
'       2010.01.21
'-------------------------------------------------------
                        
Dim FAST_F  As Boolean
                        
Dim i       As Integer
Dim j       As Integer
                                                
Dim k       As Integer
                        
                        
                        
    Sumi_CNT = 0
    Y_SYU_CNT = 0
                                                            
                                                            
                                                            
    KONPOU_ON = 0
    KONPOU_OFF = 0
                                                            
                                                            
                                                            

    KONPOU_OFF_SUMI = 0
    KONPOU_ON_SUMI = 0

''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
    FAST_F = True
                                                                                
    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
    
    
        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
        Else
            If FAST_F Then
            
                Y_SYU_CNT = Y_SYU_CNT + 1
                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                    Sumi_CNT = Sumi_CNT + 1
                End If
                
                
                
                If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                    KONPOU_OFF = KONPOU_OFF + 1
                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                        KONPOU_OFF_SUMI = KONPOU_OFF_SUMI + 1
                    End If
                
                
                Else
                    KONPOU_ON = KONPOU_ON + 1
                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                        KONPOU_ON_SUMI = KONPOU_ON_SUMI + 1
                    End If
                
                
                
                End If
                
                
                FAST_F = False
            
                                            
            
            
            
            Else
                For k = 0 To j - 1
                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                            Exit For
                        End If
                    End If
                Next k
        
                If k > j - 1 Then
        
                    Y_SYU_CNT = Y_SYU_CNT + 1
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                        Sumi_CNT = Sumi_CNT + 1
                    End If
                
                
                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
                        KONPOU_OFF = KONPOU_OFF + 1
                    
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            KONPOU_OFF_SUMI = KONPOU_OFF_SUMI + 1
                        End If
                    
                    
                    Else
                        KONPOU_ON = KONPOU_ON + 1
                    
                        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
                            KONPOU_ON_SUMI = KONPOU_ON_SUMI + 1
                        End If
                    
                    
                    
                    End If
                
                
                
                
                End If
            End If
        End If
    Next j

End Sub

Private Sub Syuka_KUTI_SU_Count_Proc(TOTAL_KUTI_SU As Integer)
'-------------------------------------------------------
'
'   Åwå˚êîçáåvÇÃÉJÉEÉìÉgÅx
'       2010.01.21
'-------------------------------------------------------
                        
Dim FAST_F  As Boolean
                        
Dim i       As Integer
Dim j       As Integer
                                                
Dim k       As Integer
                        
                        
    TOTAL_KUTI_SU = 0
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
    FAST_F = True
                                                                                
    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
    
    
        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
        
        
            If FAST_F Then
            
                TOTAL_KUTI_SU = TOTAL_KUTI_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU
                    
                FAST_F = False
            
            Else
                For k = 0 To j - 1
                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
                            Exit For
                        End If
                    End If
                Next k
        
                If k > j - 1 Then
        
                    TOTAL_KUTI_SU = TOTAL_KUTI_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KUTI_SU
                
                End If
            End If
        End If
    Next j

End Sub




Private Function Syuka_END_Count_Proc() As Double
'-------------------------------------------------------
'
'   ÅwçÀêîçáåvÇÃÉJÉEÉìÉgÅx
'       2010.01.21
'-------------------------------------------------------
                        
Dim FAST_F  As Boolean
                        
Dim i       As Integer
Dim j       As Integer
                                                
Dim k       As Integer
                        
                        
    Syuka_END_Count_Proc = 0
''' ïiî‘íPà Ç≈ÇÃä€Çﬂèàóù
    FAST_F = True
                                                                                
    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
    
    
    
        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F = "1" Then
    
            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
            
                Syuka_END_Count_Proc = Syuka_END_Count_Proc + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU
            End If
        End If
    Next j


    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
    
    
    
        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
    
            If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
            
                Syuka_END_Count_Proc = Syuka_END_Count_Proc + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SAI_SU
            
                Exit For
            End If
        End If
    Next j


End Function



Private Function Label_Print_Total_Su_Proc(KUTI_SU As Long, PRINT_TOTAL_SU As Long) As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùéûÇÃÉâÉxÉãàÛç¸ñáêîälìæÅx
'       2010.01.21
'-------------------------------------------------------
Dim sts     As Integer

Dim FAST_F  As Boolean
                        
Dim i       As Integer
Dim j       As Integer
                                                
Dim k       As Integer


    Label_Print_Total_Su_Proc = True
    
    
    
    
    
    PRINT_TOTAL_SU = KUTI_SU
    
    FAST_F = True
                                                                                
    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
    
    
        If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F Then
        Else
            If FAST_F Then
            
                Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO)
                
                
                sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                Select Case sts
                    Case BtNoErr
                        
                        If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                        End If
                        
                        
                    
                    
                    Case BtErrKeyNotFound
                    
                        Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                    
                    
                    Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        Exit Function
                End Select
                
                
                If StrConv(ITEMREC.KONPOU_F, vbUnicode) = "1" Then
                
                
                    PRINT_TOTAL_SU = PRINT_TOTAL_SU + (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO * CLng(StrConv(ITEMREC.KUTI_SU, vbUnicode)))
                
                
                End If
                
                FAST_F = False
            
                                            
            
            
            
            Else
'                For k = 0 To j - 1
'                    If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).HIN_NO) Then
'                        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(k).CANCEL_F Then
'                            Exit For
'                        End If
'                    End If
'                Next k
        
'                If k > j - 1 Then
        
                
                    Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                    Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
                    Call UniCode_Conv(K0_ITEM.HIN_GAI, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO)
                    
                    
                    sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                    Select Case sts
                        Case BtNoErr
                            
                            If Not IsNumeric(StrConv(ITEMREC.KUTI_SU, vbUnicode)) Then
                                Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                            End If
                            
                            
                        
                        
                        Case BtErrKeyNotFound
                        
                            Call UniCode_Conv(ITEMREC.KUTI_SU, "0001")
                        
                        
                        Case Else
                            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                            Exit Function
                    End Select
                    
                    
                    If StrConv(ITEMREC.KONPOU_F, vbUnicode) = "1" Then
                    
                    
                        PRINT_TOTAL_SU = PRINT_TOTAL_SU + (ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SURYO * CLng(StrConv(ITEMREC.KUTI_SU, vbUnicode)))
                    
                    
                    End If
                
                
                
'                End If
            End If
        End If
    Next j
    
    
    
    
    
    
    
    
    
    
    Label_Print_Total_Su_Proc = False
        

End Function

Private Function OKURI_NO_SEQ_Update_Proc(j As Integer, OKURI_NO_SEQ As String, Sendbuf As String, _
                                            Optional OKURI_NO_SEQ_TO As String = "   ") As Integer
'-------------------------------------------------------
'
'   ÅwåüïièàóùéûÇÃèoâ◊ó\íËÅ@ëóÇËèÛáÇé}î‘çXêVÅx
'       2010.01.21
'-------------------------------------------------------
    
Dim sts As Integer
    
    OKURI_NO_SEQ_Update_Proc = True
    
    
    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ <> 0 Then
        OKURI_NO_SEQ_Update_Proc = False
        Exit Function
    End If
    
                                            
    ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).OKURI_NO_SEQ = CInt(OKURI_NO_SEQ)
    
    If Trim(OKURI_NO_SEQ_TO) = "" Then
        OKURI_NO_SEQ_TO = OKURI_NO_SEQ
    End If
    
    '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù

    Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)    'IDáÇ

    Do

        sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrKeyNotFound
                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËïsñæ", "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                OKURI_NO_SEQ_Update_Proc = False
                Exit Function
            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                OKURI_NO_SEQ_Update_Proc = False
                Exit Function
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Exit Function
        End Select

    Loop
    
        
    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ, OKURI_NO_SEQ)
    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ_TO, OKURI_NO_SEQ_TO)
            'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
    Do
        sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                OKURI_NO_SEQ_Update_Proc = False
                Exit Function
        
            Case Else
                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                OKURI_NO_SEQ_Update_Proc = SYS_ERR
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                
                Exit Function
        End Select
    Loop

    OKURI_NO_SEQ_Update_Proc = False


End Function


Private Sub Wel_Head_Text_Proc()
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK

    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF

    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only

    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"

    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""

    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
'--

End Sub




Private Sub Wel_Head_Print_Text_Proc(fileName As String)
    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK

    Send_Text.Display_Flg = Display_LABEL                   'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_LABEL

    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only

    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"

    Send_Text.fileName = fileName                           'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
    ID_KANRI_TBL(ING_No).Send_Text.fileName = fileName

    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF

End Sub

Private Sub Wel_DETAIL_0_Text_Proc()
                                                            'BOXëÆê´
    Send_Text.Box_Type(0).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(0).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(0).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(0).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                            
    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""

End Sub
Private Sub Wel_DETAIL_1_Text_Proc(ID_NO As String, Sumi_CNT As Integer, Y_SYU_CNT As Integer)
                                                                                'BOXëÆê´
    Send_Text.Box_Type(1).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_NO) & _
                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(1).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(1).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(1).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                            
    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""

End Sub



Private Sub Wel_Clear_Text_Proc()
    Send_Text.Box_Type(4).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(4).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                            'ì¸óÕåÖêî
     Send_Text.Box_Type(4).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                            
    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
'--

End Sub


Private Sub Wel_Hin_No_Req_Text_Proc(Sumi_CNT As Integer, Y_SYU_CNT As Integer)
    '-----------------------------------------------ÇPçsñ⁄
    Send_Text.Box_Type(0).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(0).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(0).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(0).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                            
    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
    '-----------------------------------------------ÇQçsñ⁄
                                                            
    Send_Text.Box_Type(1).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                
                                                                
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(Y_SYU_CNT, "0") & ")")
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(1).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(1).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(1).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                            
    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
    '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
    Send_Text.Box_Type(2).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
                                                            
    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(2).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(2).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(2).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                            
    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
    '-----------------------------------------------ÇSçsñ⁄
    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                            'ï\é¶ì‡óe
                                                        'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(3).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(3).Start_Pos = "01"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                            'ì¸óÕåÖêî
    '2010.12.07
'    Send_Text.Box_Type(3).Max_Size = "13"
'    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
    Send_Text.Box_Type(3).Max_Size = "20"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
    '2010.12.07
                                                            
    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
    '-----------------------------------------------ÇTçsñ⁄
    Call Wel_Clear_Text_Proc

End Sub

Private Sub Wel_Kuti_Su_Input_text_Proc(TOTAL_KUTI_SU As Integer, TOTAL_SAI_SU As Double)

Dim wkKUTI_SU As String
                                    
                                    
    wkKUTI_SU = Format(TOTAL_KUTI_SU, "#0")
                
                
    Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                    'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S)
                                                    'êîílèâä˙ï\é¶
    Send_Text.Box_Type(3).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                    'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(3).Start_Pos = 13
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = 13
                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(3).Max_Size = "04"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "04"
    
    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
    '-----------------------------------------------ÇTçsñ⁄
                                                            
    wkKUTI_SU = Format(TOTAL_SAI_SU, "#0.00")
                                                            'BOXëÆê´
    Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(4).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(wkKUTI_SU)) & wkKUTI_SU
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(4).Start_Pos = 12
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = 12
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(4).Max_Size = "05"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                            
    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

End Sub

Private Sub Wel_Kuti_Su_Notinput_text_Proc(TOTAL_KUTI_SU As Integer, TOTAL_SAI_SU As Double)
                                    
Dim wkKUTI_SU       As String
                                    
                                    
Dim wkTOTAL_SAI_SU  As Long
                                    
                                    
    wkKUTI_SU = Format(TOTAL_KUTI_SU, "#0")
                
                
    Send_Text.Box_Type(3).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                    'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & wkKUTI_SU)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & wkKUTI_SU)
                                                    'êîílèâä˙ï\é¶
    Send_Text.Box_Type(3).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                    'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(3).Start_Pos = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "00"
                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(3).Max_Size = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = ""
    
    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
    
    '-----------------------------------------------ÇTçsñ⁄
                                                            
    wkTOTAL_SAI_SU = TOTAL_SAI_SU
    If TOTAL_SAI_SU < 1 Then
        wkTOTAL_SAI_SU = 1
    Else
        If TOTAL_SAI_SU > 1 Then
            wkTOTAL_SAI_SU = CLng(ToHalfAdjust(CCur(TOTAL_SAI_SU), 0))
        End If
    End If
                                                            
'    wkKUTI_SU = Format(TOTAL_SAI_SU, "#0.00")
    wkKUTI_SU = Format(wkTOTAL_SAI_SU, "#0")
                                                            'BOXëÆê´
    Send_Text.Box_Type(4).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S & wkKUTI_SU)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S & wkKUTI_SU)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(4).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(4).Start_Pos = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "00"
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(4).Max_Size = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = ""
                                                            
    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

End Sub

Private Function KutiSai_Update_Proc(KUTI_SU As Integer, SAI_SU As Double) As Integer
                        
                        
Dim sts         As Integer

Dim j           As Integer

Dim wkSAI_SU    As Integer
                        
    KutiSai_Update_Proc = True
    '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
    sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
        Exit Function
    End If
                                            
    For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
                        
                        
        '------------------------------------   èoâ◊ó\íËÇÃèàóù
        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                            'IDáÇ
        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)
    
        
        sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
        Select Case sts
            Case BtNoErr
            
            Case BtErrKeyNotFound
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                KutiSai_Update_Proc = False
                GoTo Abort_Tran
             Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                KutiSai_Update_Proc = False
                GoTo Abort_Tran
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                GoTo Abort_Tran
        End Select

        '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù
                    
        'ID_NO
        If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘

            Do
    
                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrKeyNotFound
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                    Case Else
                        GoTo Abort_Tran
                End Select

            Loop
                                            
                                
            If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F <> "1" Then
            
                If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                    If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                    Else
                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                    End If
                Else
                    
                    
                    Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "00.00"))
                                                        
                End If
                Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                                
            Else
                            
                If Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) Then
                    
                    'Call UniCode_Conv(Y_SYU_HREC.KONPOU_F, ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KONPOU_F)
                    If IsNumeric(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) Then
                        If CInt(StrConv(Y_SYU_HREC.KUTI_SU_TAN, vbUnicode)) > 0 Then
                        Else
                            Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                        End If
                    Else
                        Call UniCode_Conv(Y_SYU_HREC.KUTI_SU_TAN, Format(KUTI_SU, "0000"))
                                                            
                    End If
                End If
                Call UniCode_Conv(Y_SYU_HREC.SAI_SU_TAN, Format(SAI_SU, "00.00"))
                            
            End If
                                                    
                                
                                'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
            Do
                sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                Select Case sts
                    Case BtNoErr
                        Exit Do
                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                        GoTo Abort_Tran
                End Select
            Loop
        End If
                    

    Next j

        
     For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)

     '------------------------------------   èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)ÇÃèàóù

         'ID_NO
         If Not ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CANCEL_F And ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SUMI Then
             
             Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                 'IDáÇ
             Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO) & ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).SEQ_NO)

             Do
             
                 sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                 Select Case sts
                     Case BtNoErr
                         Exit Do
                     Case BtErrKeyNotFound
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                      Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                     Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                        GoTo Abort_Tran
                 End Select
         
             Loop
             
             
             
             Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘

             Do
     
                 sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                 Select Case sts
                     Case BtNoErr
                         Exit Do
                     Case BtErrKeyNotFound
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                     Case Else
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                        GoTo Abort_Tran
                 End Select
 
             Loop
                             
                             
            If SAI_SU < 1 Then
                wkSAI_SU = 1
            Else
                If SAI_SU > 1 Then
                    wkSAI_SU = CLng(ToHalfAdjust(CCur(SAI_SU), 0))
                End If
            End If
                             
                             
                             
             Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
             Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(wkSAI_SU, "00.00"))
                                 
                                 'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
             Do
                 sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                 Select Case sts
                     Case BtNoErr
                         Exit Do
                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        KutiSai_Update_Proc = False
                        GoTo Abort_Tran
                     Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                        GoTo Abort_Tran
                 End Select
             Loop
         End If
                     

     Next j
             
                         'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
     sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
     If sts <> BtNoErr Then
         Call File_Error(sts, BtOpEndTransaction, "", 0)
         GoTo Abort_Tran
     End If

    KutiSai_Update_Proc = False

    Exit Function





Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If







End Function

Private Sub Wel_HIN_NO_Req_Text_3_Proc()
                                                            'BOXëÆê´
    Send_Text.Box_Type(2).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
                                                            
    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                            
                                                            
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(2).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(2).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(2).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                            
    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""

End Sub



Private Sub Wel_HIN_NO_Req_Text_4_Proc()
                            
    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                            'ï\é¶ì‡óe
                                                        'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(3).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(3).Start_Pos = "01"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                            'ì¸óÕåÖêî
    '2010.12.07
'    Send_Text.Box_Type(3).Max_Size = "13"
'    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "13"
    Send_Text.Box_Type(3).Max_Size = "20"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
    '2010.12.07
                                                            
    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""

End Sub


Private Function OKURI_NO_CHECK_PROC(OKURI_NO As String, OKURI_NO_F As Boolean, FUKUYAMA_CHK_F As Boolean) As Integer
    
Dim k   As Integer
    
    OKURI_NO_F = False
    FUKUYAMA_CHK_F = False
    
    
    If Len(Trim(OKURI_NO)) = FUKUYAMA_Length Then
        
        If FUKUYAMA_CODE(0) = "*" Then
            OKURI_NO_F = True
    
    
        Else
            For k = 0 To UBound(FUKUYAMA_CODE)
            
                If Mid(OKURI_NO, 1, Len(FUKUYAMA_CODE(k))) = FUKUYAMA_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k

    
        End If
    
    
    
        '2010.04.28 ïüéRÉ`ÉFÉbÉNí«â¡
        If Not IsNumeric(Left(OKURI_NO, FUKUYAMA_Length - 1)) Then
            FUKUYAMA_CHK_F = True
        Else
            If Left(OKURI_NO, FUKUYAMA_Length - 1) - (ToRoundDown(CCur(Left(OKURI_NO, FUKUYAMA_Length - 1) / 7), 0) * 7) <> Val(Right(OKURI_NO, 1)) Then
                FUKUYAMA_CHK_F = True
            End If
        End If
        '2010.04.28
    
    
    
    
    End If

    If Len(Trim(OKURI_NO)) = SEIBU_Length Then
        If SEIBU_CODE(0) = "*" Then
            OKURI_NO_F = True
    
    
        Else
            For k = 0 To UBound(SEIBU_CODE)
            
                If Mid(OKURI_NO, 1, Len(SEIBU_CODE(k))) = SEIBU_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k

    
        End If
    End If

    If Len(Trim(OKURI_NO)) = KURUME_Length Then
    
        If KURUME_CODE(0) = "*" Then
            OKURI_NO_F = True
        Else
            For k = 0 To UBound(KURUME_CODE)
            
                If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k
        End If
    
    End If

    If Len(Trim(OKURI_NO)) = SAGAWA_Length Then
    
        If SAGAWA_CODE(0) = "*" Then
            OKURI_NO_F = True
        Else
            For k = 0 To UBound(SAGAWA_CODE)
            
                If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k
        End If
    
    End If
    
    If Len(Trim(OKURI_NO)) = YAMATO_Length Then
    
        If YAMATO_CODE(0) = "*" Then
            OKURI_NO_F = True
        Else
            For k = 0 To UBound(YAMATO_CODE)
            
                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k
        End If
    
    End If




    ' ﬂ≈Œ∞— 2011.06.06
    If Len(Trim(OKURI_NO)) = PANA_Length Then
    
        If PANA_CODE(0) = "*" Then
            OKURI_NO_F = True
        Else
            For k = 0 To UBound(PANA_CODE)
            
                If Mid(OKURI_NO, 1, Len(PANA_CODE(k))) = PANA_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k
        End If
    
    End If
    'êœêÖ 2011.06.06
    If Len(Trim(OKURI_NO)) = SEKISUI_Length Then
    
        If SEKISUI_CODE(0) = "*" Then
            OKURI_NO_F = True
        Else
            For k = 0 To UBound(SEKISUI_CODE)
            
                If Mid(OKURI_NO, 1, Len(SEKISUI_CODE(k))) = SEKISUI_CODE(k) Then
                    OKURI_NO_F = True
                End If
            Next k
        End If
    
    End If


End Function

Public Sub OKURI_NO_SET_PROC(OKURI_NO As String)
    
Dim k   As Integer
    
    If Len(Trim(OKURI_NO)) = FUKUYAMA_Length Then
        
        If FUKUYAMA_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
    
    
        Else
            For k = 0 To UBound(FUKUYAMA_CODE)
            
                If Mid(OKURI_NO, 1, Len(FUKUYAMA_CODE(k))) = FUKUYAMA_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, FUKUYAMA_Name)
                End If
            Next k

    
        End If
    End If

    If Len(Trim(OKURI_NO)) = SEIBU_Length Then
        If SEIBU_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
    
    
        Else
            For k = 0 To UBound(SEIBU_CODE)
            
                If Mid(OKURI_NO, 1, Len(SEIBU_CODE(k))) = SEIBU_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEIBU_Name)
                End If
            Next k

    
        End If
    End If

    If Len(Trim(OKURI_NO)) = KURUME_Length Then
    
        If KURUME_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
        Else
            For k = 0 To UBound(KURUME_CODE)
            
                If Mid(OKURI_NO, 1, Len(KURUME_CODE(k))) = KURUME_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KURUME_Name)
                End If
            Next k
        End If
    
    End If

    If Len(Trim(OKURI_NO)) = SAGAWA_Length Then
    
        If SAGAWA_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
        Else
            For k = 0 To UBound(SAGAWA_CODE)
            
                If Mid(OKURI_NO, 1, Len(SAGAWA_CODE(k))) = SAGAWA_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SAGAWA_Name)
                End If
            Next k
        End If
    
    End If
    
    If Len(Trim(OKURI_NO)) = YAMATO_Length Then
    
        If YAMATO_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
        Else
            For k = 0 To UBound(YAMATO_CODE)
            
                If Mid(OKURI_NO, 1, Len(YAMATO_CODE(k))) = YAMATO_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, YAMATO_Name)
                End If
            Next k
        End If
    
    End If
    
    
    
    
    
    ' ﬂ≈Œ∞— 2011.06.06
    If Len(Trim(OKURI_NO)) = PANA_Length Then
    
        If PANA_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, PANA_Name)
        Else
            For k = 0 To UBound(PANA_CODE)
            
                If Mid(OKURI_NO, 1, Len(PANA_CODE(k))) = PANA_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, PANA_Name)
                End If
            Next k
        End If
    
    End If
    
    'êœêÖ 2011.06.06
    If Len(Trim(OKURI_NO)) = SEKISUI_Length Then
    
        If SEKISUI_CODE(0) = "*" Then
            Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEKISUI_Name)
        Else
            For k = 0 To UBound(SEKISUI_CODE)
            
                If Mid(OKURI_NO, 1, Len(PANA_CODE(k))) = SEKISUI_CODE(k) Then
                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, SEKISUI_Name)
                End If
            Next k
        End If
    
    End If
    
    
    
    
    
    'ï®ó¨ 2010.02.19
    If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ï®ó¨")
        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KEN_CHARTER_NM)
    End If
    
    'ê‘ñX 2010.02.19
    If Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Then
'                                    Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ê‘ñX")
        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, KEN_AKABOU_NM)
    End If
    
    'ÉçÉWÉXÉeÉbÉN 2010.02.19
    If Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
        Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "ÉçÉWÉXÉeÉbÉN")
    End If

End Sub










Private Function LABEL_Print_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwÉâÉxÉãî≠çsèàóùÅx
'
'   2011.03.05
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

Dim Hinban      As String * 20


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim FileNo      As Integer

Dim FullPath    As String

Dim SendFileRec As SendFileRec_Tag

Dim DATA_CNT    As Integer

Dim MENU_NO     As String * 2   '2008.08.08

Dim fileName    As String

Dim IRI_QTY     As Long

    LABEL_Print_Proc = True


    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj



            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                            
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                LABEL_Print_Proc = False
                                Exit Function
                            
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        
                        End Select
                                            
                                            
                
                        Call UniCode_Conv(K8_Y_SYU.JGYOBU, StrConv(ITEMREC.JGYOBU, vbUnicode))
                        Call UniCode_Conv(K8_Y_SYU.NAIGAI, StrConv(ITEMREC.NAIGAI, vbUnicode))
                        Call UniCode_Conv(K8_Y_SYU.KEY_HIN_NO, StrConv(ITEMREC.HIN_GAI, vbUnicode))
                        Call UniCode_Conv(K8_Y_SYU.KAN_YMD, "99999999")
                        Call UniCode_Conv(K8_Y_SYU.KAN_HMS, "999999")
                
                
                        IRI_QTY = 0
                
                
                        com = BtOpGetLessEqual
                
                        Do
                            
                            
                            DoEvents
                            
                            
                            sts = BTRV(com, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K8_Y_SYU, Len(K8_Y_SYU), 8)
                            Select Case sts
                                Case BtNoErr
                                    
                                                    
                                    If StrConv(Y_SYUREC.JGYOBU, vbUnicode) <> StrConv(ITEMREC.JGYOBU, vbUnicode) Or _
                                       StrConv(Y_SYUREC.NAIGAI, vbUnicode) <> StrConv(ITEMREC.NAIGAI, vbUnicode) Or _
                                        StrConv(Y_SYUREC.HIN_NO, vbUnicode) <> StrConv(ITEMREC.HIN_GAI, vbUnicode) Then
                                    
                                    
                                        Exit Do
                                    
                                    
                                    End If
        
                                    
                                    If StrConv(Y_SYUREC.KAN_KBN, vbUnicode) = KAN_KBN_FIN Then
                                    
                                        IRI_QTY = Val(StrConv(Y_SYUREC.SURYO, vbUnicode))
                                    
                                    
                                        Exit Do
                                    
                                    End If
                                    
                                    
                        
                                Case BtErrEOF
                                    Exit Do
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË", 0)
                                    Exit Function
                            End Select
                        
                        
                            com = BtOpGetPrev
                        
                        Loop
        
                        fileName = EF_SendFile
        
                        If Label_Print_File_Make_Proc(fileName, Hinban, IRI_QTY) Then
                        End If
                                
                                
                                    
                        'ÉfÅ[É^ëóêM
                        ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                    
                                                    
                        ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                    
                        ID_KANRI_TBL(ING_No).LABEL_ON = True
                    
                        '-----------------------------------------------ÉwÉbÉ_Å[
                    
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                        Send_Text.Display_Flg = Display_LABEL                   'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_LABEL
                    
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                        Send_Text.fileName = fileName                           'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = fileName
                    
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                        Sendbuf = Text_Create_Proc()
                        Exit For
                    
                    
                End Select
            Next i
        Case Step_PRINT_RES         'ÇQâÒñ⁄ÇÃéÛêMÅiàÛç¸èIóπÅj
    
                'çÏã∆€∏ﬁèoóÕ    2008.08.08
                If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                    MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                            
                Else
                            
                    MENU_NO = ""
                End If
                If Trim(MENU_NO) = "" Then
                Else
                'çÏã∆€∏ﬁèoóÕ
                    
                    If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                        RET_JGYOBU, _
                                                        RET_NAIGAI, _
                                                        MENU_NO, _
                                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                        Hinban) Then
                        LABEL_Print_Proc = SYS_ERR
                        Exit Function
                    End If
                End If
        
        
                                                    'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                    Case BtNoErr
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                    Case Else
                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
                End Select
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                If Sagyo_Send_Proc() Then
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                End If
                        
                Sendbuf = Text_Create_Proc()
            
            
            
            
    End Select

    
    
    
    
    LABEL_Print_Proc = False
    

End Function



Private Function SEK_PACKING_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXÅ@ì@ï ç´ïÔèàóùÅx
'
'   2011.04.25
'               2011.07.20 ïiî‘ñàÇÃèWñÒÇîpé~
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

Dim k           As Integer      '2011.06.27
Dim l           As Integer      '2011.06.27




Dim Hinban      As String * 20

Dim ID_NO       As String * 13
Dim Found_Flg   As Integer
Dim JUC_SUU     As Long
Dim HINB_CD_CNT As Long



Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1
    

Dim MENU_NO     As String * 2

Dim In_Word     As String * 30
Dim Out_Word    As String * 16


Dim SAI_SU      As Double

    SEK_PACKING_Proc = True





    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SEK_ID_NO      'éwê}ÇhÇc
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        sts = Y_SYUKA_TEI_Check_Proc(ID_NO, Found_Flg)
                        Select Case sts
                            Case BtNoErr          'ê≥èÌ
                
                                '------------------ ç´ïÔçœÇ›ÇÃÉ`ÉFÉbÉN
                                If Not Found_Flg Then
                                    
                                    
                                    
                                    
                                    
                                    If ID_KANRI_TBL(ING_No).SEK_SAI_SU = 0 Then
                                        
                                        
                                        ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_NO
                                        
                                        'çÀêîì¸óÕ
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                        
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                                
                                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                                
                                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                                
                                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                                
                                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                                
                                        Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                        
                                        '-----------------------------------------------ÇPçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(0).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(0).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(0).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                        
                                        '-----------------------------------------------ÇQçsñ⁄
                                        In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                                
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(1).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(1).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(1).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        
                                        'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                                        Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                                        
                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(2).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(2).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                
                                        Send_Text.Box_Type(2).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        '-----------------------------------------------ÇSçsñ⁄
                                                                                                'BOXëÆê´
                                                
                                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(3).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(3).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(3).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                
                                        '-----------------------------------------------ÇTçsñ⁄
                                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(4).Start_Pos = "12"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(4).Max_Size = "05"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                        Sendbuf = Text_Create_Proc()
                                    
                                        SEK_PACKING_Proc = False
                                        Exit Function
                                    
                                    Else
                                    
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ëSêîç´ïÔçœÇ›Ç≈Ç∑", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_Proc = False
                                        Exit Function
                                
                                    End If
                                End If
                            Case BtErrEOF
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "íçï∂√ﬁ∞¿Ç»Çµ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_Proc = False
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                
                        ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_NO
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                        
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                        'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                        Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                        
                        
                        
                        
                        
                        
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
        
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban     'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_Proc = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        
                        
                        
                        
                        
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_HINB_CD) Then
                                Exit For
                            End If
                        Next j
                        
                        
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_Proc = False
                            Exit Function
                        End If
                        
                        'PipeÉZÉbÉgÇÃ¡™Ø∏   2011.07.20
'                        If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_KONPO_F Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                            SEK_PACKING_Proc = False
'                            Exit Function
'                        End If
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_HINB_CD) And Not ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_KONPO_F Then
                                ID_KANRI_TBL(ING_No).SEK_LINE = j
                                Exit For
                            End If
                        Next j
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
                    
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_Proc = False
                            Exit Function
                        End If
                        'PipeÉZÉbÉgÇÃ¡™Ø∏   2011.07.20
                        '------------------------------------------------------------   2011.06.27
                        For k = 0 To UBound(ID_KANRI_TBL)
                            If k = ING_No Then
                            Else
                                If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = _
                                    ID_KANRI_TBL(k).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(k).Sagyo_Code.YOIN_CODE Then
                                                            
                                    If ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_KANRI_TBL(k).SEK_TEI_LABELID Then
                                        
                                        'PipeÉZÉbÉgÇÃ¡™Ø∏   2011.07.20
'                                        For l = 0 To UBound(ID_KANRI_TBL(k).SEK_TBL)
'
'                                            If Trim(Hinban) = Trim(ID_KANRI_TBL(k).SEK_TBL(l).SEK_HINB_CD) Then
'
'
'                                                If ID_KANRI_TBL(k).SEK_TBL(l).SEK_KONPO_F Then
'                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
'                                                    Sendbuf = Text_Create_Proc()
'                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                                    SEK_PACKING_Proc = False
'                                                    Exit Function
'                                                End If
'
'                                            End If
'                                        Next l
                                        
                                        If ID_KANRI_TBL(k).SEK_TBL(ID_KANRI_TBL(ING_No).SEK_LINE).SEK_KONPO_F Then
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_PACKING_Proc = False
                                            Exit Function
                                        End If
                                        'PipeÉZÉbÉgÇÃ¡™Ø∏   2011.07.20
                                    End If
                                End If
                            End If
                        Next k
                        '------------------------------------------------------------   2011.06.27
''                        If Inspection_Flg = 0 Then
''                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL)
''                                If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).HIN_NO) Then
''                                    If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).KAN_KBN <> KAN_KBN_FIN Then
''                                        Exit For
''                                    End If
''                                End If
''                            Next j
''
''                            If j <= UBound(ID_KANRI_TBL(ING_No).KEN_DEN_TBL) Then
''                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, Hinban, "ñ¢èoå…ï™óLÇËÅIÅI", "")
''                                Sendbuf = Text_Create_Proc()
''                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
''                                SEK_PACKING_Proc = False
''                                Exit Function
''                            End If
''                        End If
                        
                        ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_KONPO_F = True
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        
                        If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU = 1 Then
                            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        Else
                            Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        End If
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                
                        In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                
                                                                                
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_DATA_CNT = 1 Then

                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                                                                
                        Else
                        
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                        
                        
                        End If
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                        
                
                End Select
            
            Next i
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
    
    
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
                                            
                        
            '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
            
            com = BtOpGetGreaterEqual
            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
            
            Do
                
                DoEvents
            
                Do
                
                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrEOF
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_Proc = False
                            GoTo Abort_Tran
                        Case Else
                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
            
                Loop
            
                
                If sts = BtErrEOF Then
                    Exit Do
                End If
                
                If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                    Exit Do
                End If
                '2011.07.20 IFèåèí«â¡
                If Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) And _
                    StrConv(Y_SYU_TEI_REC.SEQ_NO, vbUnicode) = ID_KANRI_TBL(ING_No).SEK_TBL(ID_KANRI_TBL(ING_No).SEK_LINE).SEK_SEQ_NO Then
                
                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                    Do
                        DoEvents
                        sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_Proc = False
                                GoTo Abort_Tran
                             Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_Proc = False
                                GoTo Abort_Tran
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                
                End If
                
                com = BtOpGetNext
                
                
            Loop
                                            
            '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                MENU_NO = ""
            End If
                                            
                                            
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        ID_KANRI_TBL(ING_No).SEK_SYU_JUN & " " & Trim(ID_KANRI_TBL(ING_No).SEK_TEI_NM), _
                                        , , , , MENU_NO, _
                                        , _
                                        "", _
                                        , , , , 1, , , , , , , ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    SEK_PACKING_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
            
            '------------------------------------   çÏã∆ÉçÉOÇÃèàóù
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                    SEK_PACKING_Proc = SYS_ERR
                    Exit Function
                End If
            End If
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
            'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
            Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
    
            If HINB_CD_CNT <> ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT Then
            'éüÅ@ïiî‘
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                
                
                
                
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        
                                                                        
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                
                
                
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                
                'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                
                
                
                
                
                
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                                                                        
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                Sendbuf = Text_Create_Proc()
            
            Else
            'ç´ïÔäÆóπ
            
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                
                '-----------------------------------------------ÇRçsñ⁄
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "åüïiäÆóπ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "åüïiäÆóπ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                                                                        
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å®ENT")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å®ENT")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                Sendbuf = Text_Create_Proc()
            End If
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            
            
            
            If ID_KANRI_TBL(ING_No).SEK_SAI_SU = 0 Then
                'çÀêîì¸óÕ
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                
                '-----------------------------------------------ÇQçsñ⁄
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                
                'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                        
                '-----------------------------------------------ÇTçsñ⁄
                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(4).Max_Size = "05"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                Sendbuf = Text_Create_Proc()
            
            Else
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                    Case BtNoErr
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                    Case Else
                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                
                If Sagyo_Send_Proc() Then
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                End If
            
                Sendbuf = Text_Create_Proc()
    
            End If
    
    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiçÀêîÅj
    
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_Proc = False
                            Exit Function
                        
                        End If
                
                        SAI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                
                
                        If SAI_SU = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_Proc = False
                            Exit Function
                        
                        End If
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                        '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
                        Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
                        com = BtOpGetGreaterEqual
            
                        Do
                    
                            DoEvents
                
                            Do
                    
                                sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrEOF
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                
                            Loop
            
                
                            If sts = BtErrEOF Then
                                Exit Do
                            End If
                    
                            If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                                Exit Do
                            End If
                        
                
                            Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, "0001")
                            Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(SAI_SU, "000.00"))
                        
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                        
                        
                
                            Do
                                DoEvents
                                sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_Proc = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                
                
                            com = BtOpGetNext
                
                
                        Loop
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
    
                        'éüÇÃçÏã∆óvãÅ
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                    
                        Sendbuf = Text_Create_Proc()
                    
                End Select
            Next i
    End Select

    SEK_PACKING_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If









    SEK_PACKING_Proc = False

End Function
Private Function SEK_PACKING_ALL_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXÅ@ì@ï ç´ïÔèàóùÅx
'
'   2011.04.25
'               2011.07.20 ïiî‘ñàÇÃèWñÒÇîpé~
'
'               ëSêîåüïiëŒâû    2012.03.21
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

Dim k           As Integer      '2011.06.27
Dim l           As Integer      '2011.06.27




Dim Hinban      As String * 20

Dim ID_NO       As String * 13
Dim Found_Flg   As Integer
Dim JUC_SUU     As Long
Dim HINB_CD_CNT As Long



Dim RET_JGYOBU  As String * 1
Dim RET_NAIGAI  As String * 1
    

Dim MENU_NO     As String * 2

Dim In_Word     As String * 30
Dim Out_Word    As String * 16


Dim SAI_SU      As Double

Dim Cnt_F       As Boolean


    SEK_PACKING_ALL_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SEK_ID_NO      'éwê}ÇhÇc
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        sts = Y_SYUKA_TEI_Check_Proc(ID_NO, Found_Flg)
                        Select Case sts
                            Case BtNoErr          'ê≥èÌ
                
                                '------------------ ç´ïÔçœÇ›ÇÃÉ`ÉFÉbÉN
                                If Not Found_Flg Then
                                    
                                    If ID_KANRI_TBL(ING_No).SEK_SAI_SU = 0 Then
                                        
                                        
                                        ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_NO
                                        
                                        'çÀêîì¸óÕ
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                                        
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                                
                                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                                
                                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                                
                                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                                
                                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                                
                                        Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                                        
                                        '-----------------------------------------------ÇPçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(0).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(0).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(0).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                        
                                        '-----------------------------------------------ÇQçsñ⁄
                                        In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                                
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(1).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(1).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(1).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                        
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        
                                        'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                                        Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                                        
                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(2).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(2).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                
                                        Send_Text.Box_Type(2).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        '-----------------------------------------------ÇSçsñ⁄
                                                                                                'BOXëÆê´
                                                
                                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(3).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(3).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(3).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                
                                        '-----------------------------------------------ÇTçsñ⁄
                                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(4).Start_Pos = "12"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(4).Max_Size = "05"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                        Sendbuf = Text_Create_Proc()
                                    
                                        SEK_PACKING_ALL_Proc = False
                                        Exit Function
                                    
                                    Else
                                    
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ëSêîç´ïÔçœÇ›Ç≈Ç∑", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_ALL_Proc = False
                                        Exit Function
                                
                                    End If
                                End If
                            Case BtErrEOF
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "íçï∂√ﬁ∞¿Ç»Çµ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_ALL_Proc = False
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                
                        ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_NO
                        
'2012.11.15                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Trim(StrConv(Y_SYU_TEI_REC.KEN_HINBAN, vbUnicode))    '2012.10.24
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                                                                '2012.11.15
                        ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = Trim(StrConv(Y_SYU_TEI_REC.KEN_HINBAN, vbUnicode))            '2012.11.15
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                        
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        
                        'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                        Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                        
                        
                        
                        
                        
                        
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            Cnt_F = False
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    
                    Case LCD_Hinban, " êî", "*êî"   'ïiî‘/êîó 
                        
                        If Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2) = " êî" Or _
                            Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2) = "*êî" Then
                        
                            Cnt_F = True
                        End If
                        
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                    
                            Case BtErrKeyNotFound
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_ALL_Proc = False
                                Exit Function
                        
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                
                        End Select
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_HINB_CD) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ïiî‘ÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            Exit Function
                        End If
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
                            If Trim(Hinban) = Trim(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_HINB_CD) Then
                                If Not ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_KONPO_F Then
                                    ID_KANRI_TBL(ING_No).SEK_LINE = j
                                    Exit For
                                End If
                            End If
                        Next j
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
                    
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            Exit Function
                        End If
                        
                        For k = 0 To UBound(ID_KANRI_TBL)
                            If k = ING_No Then
                            Else
                                If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = _
                                    ID_KANRI_TBL(k).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(k).Sagyo_Code.YOIN_CODE Then
                                                            
                                    If ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_KANRI_TBL(k).SEK_TEI_LABELID Then
                                        
                                        
                                        If ID_KANRI_TBL(k).SEK_TBL(ID_KANRI_TBL(ING_No).SEK_LINE).SEK_KONPO_F Then
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ç´ïÔçœÇ›ÅI", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_PACKING_ALL_Proc = False
                                            Exit Function
                                        End If
                                    End If
                                End If
                            End If
                        Next k
                        
                        
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.24-->2012.11.15 KEN_HINBAN-->KEN_ING_HINBAN
                        If Trim(Hinban) <> Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) Then
                            If Trim(ID_KANRI_TBL(ING_No).KEN_ING_HINBAN) <> "" Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, "ëºïiî‘åüïiíÜÅI", ID_KANRI_TBL(ING_No).KEN_ING_HINBAN)
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_ALL_Proc = False
                                Exit Function
                            End If
                        End If
                        'édä|íÜïiî‘ÇÃ¡™Ø∏   2012.10.24
                        
                        
                                                
                        '---------------------  ïiî‘édä|íÜÅ@É`ÉFÉbÉN    2012.04.05
                        If Cnt_F Then
                            If RTrim(ID_KANRI_TBL(ING_No).KEN_HINBAN) <> RTrim(Hinban) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, Hinban, ID_KANRI_TBL(ING_No).KEN_HINBAN, "ïiî‘ÉGÉâÅ[")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_PACKING_ALL_Proc = False
                                Exit Function
                            End If
                        End If
                        '---------------------  ïiî‘édä|íÜÅ@É`ÉFÉbÉN    2012.04.05
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).KEN_HINBAN = Hinban
                        If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY = 0 Then
                            ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY = Val(StrConv(ITEMREC.GAISO_IRI_QTY, vbUnicode))
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY = 0 Then
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY = 1
                            End If
                        
                            
                            ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_Y_HIN_CHK_CNT = CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU / ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY), 0)) + _
                                                                                (ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU - _
                                                                                ((CLng(ToRoundDown(CCur(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU / ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY), 0)))) * ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY)
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY = 1 Then
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_BARA_QTY = ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU
                            Else
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_BARA_QTY = CLng(ToRoundUp(CCur(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU Mod ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY), 0))
                            End If
                            
                            
                            
                            '2012.10.24
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT = 0 And _
                                IsNumeric(StrConv(Y_SYU_TEI_REC.J_HIN_CHK_CNT, vbUnicode)) Then
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU = Val(StrConv(Y_SYU_TEI_REC.CNT_BARA_SU, vbUnicode))
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU = Val(StrConv(Y_SYU_TEI_REC.CNT_HAKO_SU, vbUnicode))
                            
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT = Val(StrConv(Y_SYU_TEI_REC.J_HIN_CHK_CNT, vbUnicode))
                            
                                Cnt_F = True
                            Else
                            '2012.10.24
                            
                            
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU = 0
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU = 0
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT + 1
                            
                                If ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_BARA_QTY Then
                                    ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU = 1
                                Else
                                    ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY
                                End If
                            End If      '2012.10.24
                        
                        
                        
                        
                        End If
                        
                        If Cnt_F Then
                        
                            ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT = ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT + 1
                        
                        
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU < ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_BARA_QTY Then
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU = ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + 1
                            Else
                                ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU = ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_GAISO_IRI_QTY
                            End If
                        
                        
                        End If
                        
                        If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT >= ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_Y_HIN_CHK_CNT Then
                            
'------------------------------------------ ëSêîåüïièIóπÅ@----------------------------------------------------------
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_KONPO_F = True
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                            
                            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    
                            In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                            Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_DATA_CNT = 1 Then
    
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                                                                    
                            Else
                            
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                            
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            
                            
                            '>>>>>>>>>>>>>>>    2012.06.21
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU > 1 Then

                                '2012.09.27
'                               If ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).KEN_DEN_TBL(j).CNT_HAKO_SU > 1 Then
                                If ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU > 1 Then
                                    Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ïWèÄ
                                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE


                                '2012.09.27
                                Else
                                End If
                            End If
                            '>>>>>>>>>>>>>>>    2012.06.21
                            
                            Sendbuf = Text_Create_Proc()
                        
                            SEK_PACKING_ALL_Proc = False
                            
                            Exit Function
                        
                        
                        Else
                        
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.24
                            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                                                            
                                                            
                                        
                            '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
            
                            com = BtOpGetGreaterEqual
                            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
                            
                            Do
                                
                                DoEvents
                            
                                Do
                                
                                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrEOF
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_PACKING_ALL_Proc = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                            
                                Loop
                            
                                
                                If sts = BtErrEOF Then
                                    Exit Do
                                End If
                                
                                If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                                    Exit Do
                                End If

                        
                                For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
                                    If Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) = Trim(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_HINB_CD) Then
                                            
                                            Call UniCode_Conv(Y_SYU_TEI_REC.J_HIN_CHK_CNT, Format(ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_J_HIN_CHK_CNT, "0000000"))
                                            
                                            Call UniCode_Conv(Y_SYU_TEI_REC.CNT_BARA_SU, Format(ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU, "0000000"))
                                            Call UniCode_Conv(Y_SYU_TEI_REC.CNT_HAKO_SU, Format(ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU, "0000000"))
                                            Exit For
                                    End If
                                Next j
                        
                        
                                Call UniCode_Conv(Y_SYU_TEI_REC.KEN_HINBAN, Hinban)
                
                                Do
                                    DoEvents
                                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_PACKING_ALL_Proc = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_PACKING_ALL_Proc = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                
                
                
                                com = BtOpGetNext
                
                            Loop
                                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                            End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.10.24
'------------------------------------------ ëSêîåüïiédä|íÜÅ@----------------------------------------------------------
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                            
                            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    
                            In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                            Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).KEN_HINBAN)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            If ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_DATA_CNT = 1 Then
    
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su1 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                                                                    
                            Else
                            
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_Su2 & (ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_BARA_SU + ID_KANRI_TBL(ING_No).SEK_TBL(j).CNT_HAKO_SU) & "/" & ID_KANRI_TBL(ING_No).SEK_TBL(j).SEK_JUC_SUU)
                            
                            
                            End If
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                            Sendbuf = Text_Create_Proc()
                        
                            SEK_PACKING_ALL_Proc = False
                            
                            Exit Function
                        
                        End If
                
                End Select
            
            Next i
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
    
    
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
                                            
                        
            '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
            
            com = BtOpGetGreaterEqual
            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
            
            Do
                
                DoEvents
            
                Do
                
                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrEOF
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            GoTo Abort_Tran
                        Case Else
                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
            
                Loop
            
                
                If sts = BtErrEOF Then
                    Exit Do
                End If
                
                If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                    Exit Do
                End If
                
'2012.10.24                If Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) And _
'2012.10.24                    StrConv(Y_SYU_TEI_REC.SEQ_NO, vbUnicode) = ID_KANRI_TBL(ING_No).SEK_TBL(ID_KANRI_TBL(ING_No).SEK_LINE).SEK_SEQ_NO Then
'2012.10.24
'2012.10.24                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
'2012.10.24                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
'2012.10.24
'2012.10.24                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
'2012.10.24                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
'2012.10.24
'2012.10.24                    Do
'2012.10.24                        DoEvents
'2012.10.24                        sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
'2012.10.24                        Select Case sts
'2012.10.24                            Case BtNoErr
'2012.10.24                                Exit Do
'2012.10.24                            Case BtErrKeyNotFound
'2012.10.24                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
'2012.10.24                                Sendbuf = Text_Create_Proc()
'2012.10.24                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.24                                SEK_PACKING_ALL_Proc = False
'2012.10.24                                GoTo Abort_Tran
'2012.10.24                             Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2012.10.24                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
'2012.10.24                                Sendbuf = Text_Create_Proc()
'2012.10.24                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2012.10.24                                SEK_PACKING_ALL_Proc = False
'2012.10.24                                GoTo Abort_Tran
'2012.10.24                            Case Else
'2012.10.24                                Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
'2012.10.24                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2012.10.24                                Sendbuf = Text_Create_Proc()
'2012.10.24                                GoTo Abort_Tran
'2012.10.24                        End Select
'2012.10.24                    Loop
'2012.10.24
'2012.10.24                End If
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.24
                If Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)) = Trim(ID_KANRI_TBL(ING_No).KEN_HINBAN) And _
                    StrConv(Y_SYU_TEI_REC.SEQ_NO, vbUnicode) = ID_KANRI_TBL(ING_No).SEK_TBL(ID_KANRI_TBL(ING_No).SEK_LINE).SEK_SEQ_NO Then
                
                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
                    Call UniCode_Conv(Y_SYU_TEI_REC.KONPO_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                                
                
                End If
                
'2012.10.31                ID_KANRI_TBL(ING_No).KEN_HINBAN = ""
                Call UniCode_Conv(Y_SYU_TEI_REC.KEN_HINBAN, "")
                
                Do
                    DoEvents
                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrKeyNotFound
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            GoTo Abort_Tran
                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            GoTo Abort_Tran
                        Case Else
                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
                Loop
                
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.10.24
                
                
                com = BtOpGetNext
                
                
            Loop
                                            
'2012.11.15            ID_KANRI_TBL(ING_No).KEN_HINBAN = ""                        '2012.10.31
            '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                MENU_NO = ""
            End If
                                            
                                            
            sts = IDOREKI_OUTPUT_PROC("", _
                                        "", _
                                        ID_KANRI_TBL(ING_No).JGYOBU, _
                                        ID_KANRI_TBL(ING_No).NAIGAI, _
                                        ID_KANRI_TBL(ING_No).KEN_HINBAN, _
                                        "", _
                                        (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                        0, _
                                        0, _
                                        (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                        ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                        FILE_RETRY, _
                                        , _
                                        ID_KANRI_TBL(ING_No).SEK_SYU_JUN & " " & Trim(ID_KANRI_TBL(ING_No).SEK_TEI_NM), _
                                        , , , , MENU_NO, _
                                        , _
                                        "", _
                                        , , , , 1, , , , , , , ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
            Select Case sts
                Case False      'ê≥èÌèIóπ
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    SEK_PACKING_ALL_Proc = SYS_ERR
                    GoTo Abort_Tran
            End Select
            
            '------------------------------------   çÏã∆ÉçÉOÇÃèàóù
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).KEN_HINBAN, , , , , _
                                                     ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                    SEK_PACKING_ALL_Proc = SYS_ERR
                    Exit Function
                End If
            End If
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                    
            'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
            Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
    
            If HINB_CD_CNT <> ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT Then
            'éüÅ@ïiî‘
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                
                ID_KANRI_TBL(ING_No).KEN_ING_HINBAN = "" '2012.11.15
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                
                
                
                
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        
                                                                        
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                
                
                
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                
                'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                
                
                
                
                
                
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                                                                        
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                Sendbuf = Text_Create_Proc()
            
            Else
            'ç´ïÔäÆóπ
            
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                
                '-----------------------------------------------ÇRçsñ⁄
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "åüïiäÆóπ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "åüïiäÆóπ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                                                                        
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å®ENT")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å®ENT")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                Sendbuf = Text_Create_Proc()
            End If
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            
            
            
            If ID_KANRI_TBL(ING_No).SEK_SAI_SU = 0 Then
                'çÀêîì¸óÕ
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DOUBLE                    'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID, 7) & "    " & _
                                        "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID), 2)), "#0") & "/" & Format(ID_KANRI_TBL(ING_No).SEK_HAKO_SU, "#0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                
                '-----------------------------------------------ÇQçsñ⁄
                In_Word = ID_KANRI_TBL(ING_No).SEK_TEI_NM
                Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                        
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYU_JUN) & " " & Out_Word)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                
                'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                Call SEK_HINB_CD_CNT_Proc(HINB_CD_CNT)
                
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT, "#0)"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                        
                '-----------------------------------------------ÇTçsñ⁄
                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = "12"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(4).Max_Size = "05"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                Sendbuf = Text_Create_Proc()
            
            Else
            'éüÇÃçÏã∆óvãÅ
                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                Select Case sts
                    Case BtNoErr
                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                    Case Else
                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                        Exit Function
                End Select
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                
                If Sagyo_Send_Proc() Then
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                End If
            
                Sendbuf = Text_Create_Proc()
    
            End If
    
    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiçÀêîÅj
    
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            Exit Function
                        
                        End If
                
                        SAI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                
                
                        If SAI_SU = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_PACKING_ALL_Proc = False
                            Exit Function
                        
                        End If
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                        '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
                        Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_TEI_LABELID)
                        com = BtOpGetGreaterEqual
            
                        Do
                    
                            DoEvents
                
                            Do
                    
                                sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrEOF
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_ALL_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                
                            Loop
            
                
                            If sts = BtErrEOF Then
                                Exit Do
                            End If
                    
                            If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_TEI_LABELID) Then
                                Exit Do
                            End If
                        
                
                            Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, "0001")
                            Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(SAI_SU, "000.00"))
                        
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                        
                        
                
                            Do
                                DoEvents
                                sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_ALL_Proc = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_PACKING_ALL_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                
                
                            com = BtOpGetNext
                
                
                        Loop
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
    
                        'éüÇÃçÏã∆óvãÅ
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                    
                        Sendbuf = Text_Create_Proc()
                    
                End Select
            Next i
    End Select

    SEK_PACKING_ALL_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If









    SEK_PACKING_ALL_Proc = False

End Function

Private Function Y_SYUKA_TEI_Check_Proc(ID_NO As String, Found_Flg As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXèoâ◊ç´ïÔÅ@íçï∂ÉfÅ[É^ÇÃÉ`ÉFÉbÉNÅx
'               2011.04.25
'               2011.07.20 ïiî‘ñàÇÃèWñÒÇîpé~
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer

Dim Fsw         As Integer


    Y_SYUKA_TEI_Check_Proc = True
    
    
    Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_NO)
    com = BtOpGetGreaterEqual
    
    
    Found_Flg = False
    Fsw = True
    
    Erase ID_KANRI_TBL(ING_No).SEK_TBL
    ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT = 0
    
    
    Do
    
        DoEvents
    
        sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
        Y_SYUKA_TEI_Check_Proc = sts
        Select Case sts
            Case BtNoErr
                If Trim(ID_NO) <> Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Y_SYUKA_TEI_Check_Proc = SYS_ERR
                Exit Function
        End Select
    
    
        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
            Found_Flg = True
        End If
        
        If Fsw Then

            ID_KANRI_TBL(ING_No).SEK_SYU_JUN = StrConv(Y_SYU_TEI_REC.SYU_JUN, vbUnicode)
            ID_KANRI_TBL(ING_No).SEK_TEI_NM = StrConv(Y_SYU_TEI_REC.TEI_NM, vbUnicode)

            ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT = ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT + 1
            ID_KANRI_TBL(ING_No).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))


            ReDim Preserve ID_KANRI_TBL(ING_No).SEK_TBL(0 To 0)
            ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_HINB_CD = StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)
'------------------------------------------------------------------ ëSêîåüïiëŒâû    2012.03.21
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_GAISO_IRI_QTY = 0
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_Y_HIN_CHK_CNT = 0
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_J_HIN_CHK_CNT = 0
'------------------------------------------------------------------ ëSêîåüïiëŒâû    2012.03.21
            ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_JUC_SUU = Val(StrConv(Y_SYU_TEI_REC.JUC_SUU, vbUnicode))
            ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_DATA_CNT = 1

            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
                ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_KONPO_F = False
                Found_Flg = True
            Else
                ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_KONPO_F = True
            End If

            '2011.07.20
            ID_KANRI_TBL(ING_No).SEK_TBL(0).SEK_SEQ_NO = StrConv(Y_SYU_TEI_REC.SEQ_NO, vbUnicode)
            '2011.07.20


            Fsw = False
        Else
'-------------------------------    2011.07.20
            
'            For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
'
'                If Trim(ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_HINB_CD) = Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)) Then
'                   Exit For
'                End If
'
'            Next i
'
'            If i > UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
'                ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT = ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT + 1
'
'                ReDim Preserve ID_KANRI_TBL(ING_No).SEK_TBL(0 To i)
'                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_HINB_CD = StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)
'                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_JUC_SUU = Val(StrConv(Y_SYU_TEI_REC.JUC_SUU, vbUnicode))
'                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
'                    ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_KONPO_F = False
'                    Found_Flg = True
'                Else
'                    ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_KONPO_F = True
'                End If
'                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_DATA_CNT = 1
'
'            Else
'                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_JUC_SUU = ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_JUC_SUU + _
'                                                                Val(StrConv(Y_SYU_TEI_REC.JUC_SUU, vbUnicode))
'                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_DATA_CNT = ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_DATA_CNT + 1
'
'            End If
            i = i + 1
            ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT = ID_KANRI_TBL(ING_No).SEK_HINB_CD_CNT + 1

            ReDim Preserve ID_KANRI_TBL(ING_No).SEK_TBL(0 To i)
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_HINB_CD = StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_JUC_SUU = Val(StrConv(Y_SYU_TEI_REC.JUC_SUU, vbUnicode))
            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_KONPO_F = False
                Found_Flg = True
            Else
                ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_KONPO_F = True
            End If
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_DATA_CNT = 1
            
            ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_SEQ_NO = StrConv(Y_SYU_TEI_REC.SEQ_NO, vbUnicode)
'-------------------------------    2011.07.20
                
        End If
        
        com = BtOpGetNext
    
    Loop
    
    If Not Fsw Then
        Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, Left(ID_NO, 8) & "zz")
        sts = BTRV(BtOpGetLessEqual, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
    
        Select Case sts
            Case BtNoErr
                If Left(ID_NO, 8) <> Left(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode), 8) Then
                    Y_SYUKA_TEI_Check_Proc = BtErrEOF
                Else
                    ID_KANRI_TBL(ING_No).SEK_HAKO_SU = Val(StrConv(Y_SYU_TEI_REC.HAKO_NO, vbUnicode))
                End If
                Y_SYUKA_TEI_Check_Proc = BtNoErr
            Case BtErrEOF
                Y_SYUKA_TEI_Check_Proc = BtErrEOF
            Case Else
                Y_SYUKA_TEI_Check_Proc = SYS_ERR
                Exit Function
        End Select
    
    Else
        Y_SYUKA_TEI_Check_Proc = BtErrEOF
    End If


End Function

Private Sub SEK_HINB_CD_CNT_Proc(HINB_CD_CNT As Long)

'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXèoâ◊ç´ïÔÅ@ïiî‘èÛë‘ÇÃÉJÉEÉìÉgÅx
'               2011.04.25
'
'-------------------------------------------------------
Dim i   As Integer

Dim k   As Integer
Dim l   As Integer

    HINB_CD_CNT = 0
    For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_TBL)
    
        If ID_KANRI_TBL(ING_No).SEK_TBL(i).SEK_KONPO_F Then
            HINB_CD_CNT = HINB_CD_CNT + 1
        End If
    
    Next i
    '------------------------------------------------------------   2011.06.27
    For k = 0 To UBound(ID_KANRI_TBL)
        If k = ING_No Then
        Else
            If ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE = _
                ID_KANRI_TBL(k).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(k).Sagyo_Code.YOIN_CODE Then
                
                
                If ID_KANRI_TBL(ING_No).SEK_TEI_LABELID = ID_KANRI_TBL(k).SEK_TEI_LABELID Then
                    For l = 0 To UBound(ID_KANRI_TBL(k).SEK_TBL)
                        
                        
                        If l <= UBound(ID_KANRI_TBL(ING_No).SEK_TBL) Then
                            If ID_KANRI_TBL(ING_No).SEK_TBL(l).SEK_KONPO_F Then
                            Else
                                If ID_KANRI_TBL(k).SEK_TBL(l).SEK_KONPO_F Then
                                    HINB_CD_CNT = HINB_CD_CNT + 1
                                End If
                            End If
                        Else
                            If ID_KANRI_TBL(k).SEK_TBL(l).SEK_KONPO_F Then
                                HINB_CD_CNT = HINB_CD_CNT + 1
                            End If
                        End If
                    
                    Next l
                End If
            End If
        End If
    Next k
    '------------------------------------------------------------   2011.06.27



End Sub


Private Function Inspe_Proc_SEK(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXåüïièàóùÅiëÓîzì`ï[ì«Ç›çûÇ› ëÂç„ÇoÇbå¸ÇØÅjÅx
'
'       2011.05.09
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer
Dim l               As Integer

Dim MENU_NO         As String * 2

Dim ID_NO           As String * 12
Dim SEK_ID_NO       As String

Dim CANCEL_F        As Boolean
Dim KENPIN_F        As Boolean
Dim SHOGO_F         As Boolean
Dim Y_Found_F       As Boolean
Dim T_Found_F       As Boolean

Dim Sumi_CNT        As Integer
Dim KUTI_SU         As Integer
Dim SAI_SU          As Double
Dim INPUT_SAI_SU    As Double



Dim OKURI_NO        As String
Dim OKURI_NO_F      As Boolean
Dim FUKUYAMA_CHK_F  As Boolean

Dim fileName        As String

Dim In_Word         As String * 30
Dim Out_Word        As String * 16

Dim wkTEI_LABELID() As String * 13
                        
Dim wkSai_Input     As Long

Dim wkSEK_PAGE_NO   As Integer
Dim From_Page_No    As Integer
Dim To_Page_No      As Integer
Dim wkKUTI_SU       As Integer

Dim SKIP_F          As Boolean          '2012.12.27

    Inspe_Proc_SEK = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì`ï[ÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_ID_No  'ì`ï[ÇhÇc
                        
                                        
                        'êeì`ÇÇjÇdÇdÇo
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        CANCEL_F = True
                        KENPIN_F = True
                        Y_Found_F = False
                        T_Found_F = False
                        
                        Erase ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL
                        
                        
                        ID_KANRI_TBL(ING_No).SEK_PAGE_NO = 0
                        j = -1
                            
                        
                        'ç´ïÔçœÇ›ÅïÉLÉÉÉìÉZÉãÇÃÉ`ÉFÉbÉN
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, ID_NO)
                                                
                                                
                        com = BtOpGetGreaterEqual
                        
                        Do
                        
                            sts = BTRV(com, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                    If Trim(ID_NO) <> Left(StrConv(Y_SYUREC.ID_NO, vbUnicode), 7) Then
                                        Exit Do
                                    End If
                                Case BtErrEOF
                                    Exit Do
                                Case Else
                                    Call File_Error(sts, com, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
                        
                            
                            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))
                                            
                            sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                                    Call File_Error(sts, com, "èoâ◊ó\íË(H)", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "èoâ◊√ﬁ∞¿±›œØ¡", Trim(ID_NO), "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                                
                                
                                Case Else
                                    Call File_Error(sts, com, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
                        
                            If StrConv(Y_SYU_HREC.CANCEL_F, vbUnicode) <> "1" Then
                                CANCEL_F = False
                            End If
                        
                        
                            ID_KANRI_TBL(ING_No).KEN_OKURI_NO = Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode))               'ëóÇËèÛáÇ
                            ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode))       'â^ëóâÔé–
                            ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI = Trim(StrConv(Y_SYU_HREC.OKURISAKI, vbUnicode))            'ëóÇËêÊ
                                                                                                                            'å¸ÇØêÊ
                            If Trim(StrConv(Y_SYU_HREC.OKURISAKI, vbUnicode)) <> Trim(StrConv(Y_SYU_HREC.MUKE_NAME, vbUnicode)) Then
                                ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = Trim(StrConv(Y_SYU_HREC.MUKE_NAME, vbUnicode))
                            Else
                                ID_KANRI_TBL(ING_No).KEN_MUKE_NAME = ""
                            End If
                            ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD = Trim(StrConv(Y_SYU_HREC.SYUKA_YMD, vbUnicode))             'èoâ◊ì˙
                            ID_KANRI_TBL(ING_No).KEN_JYUSHO = Trim(StrConv(Y_SYU_HREC.JYUSHO, vbUnicode))                   'èZèä
                            ID_KANRI_TBL(ING_No).KEN_BIKOU = Trim(StrConv(Y_SYU_HREC.BIKOU, vbUnicode))                     'îıçl
                            
                            If Trim(StrConv(Y_SYUREC.KENPIN_TANTO_CODE, vbUnicode)) = "" Then
                                KENPIN_F = False
                            End If
                            
                            
                            If IsNumeric(StrConv(Y_SYU_HREC.OKURI_NO_SEQ_TO, vbUnicode)) Then
                                                                                                                            'â◊éDàÛç¸äJénÕﬂ∞ºﬁ
                                If ID_KANRI_TBL(ING_No).SEK_PAGE_NO < CInt(StrConv(Y_SYU_HREC.OKURI_NO_SEQ_TO, vbUnicode)) Then
                                    ID_KANRI_TBL(ING_No).SEK_PAGE_NO = CInt(StrConv(Y_SYU_HREC.OKURI_NO_SEQ_TO, vbUnicode))
                                End If
                            End If
                            
                            
                            Y_Found_F = True
                            
                            Call UniCode_Conv(K2_Y_SYU_TEI.KEN_NO, StrConv(Y_SYU_HREC.SEK_KEN_NO, vbUnicode))
                            Call UniCode_Conv(K2_Y_SYU_TEI.HIN_NO, StrConv(Y_SYU_HREC.SEK_HIN_NO, vbUnicode))
                            
                            sts = BTRV(BtOpGetEqual, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K2_Y_SYU_TEI, Len(K2_Y_SYU_TEI), 2)
                            Select Case sts
                                Case BtNoErr
                                    
                                    If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) = "" And Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) = "" Then
                                    Else
                                        T_Found_F = True
                                    
                                        If j = -1 Then
                                            j = j + 1
                                            ReDim Preserve ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(0 To j)
                                            
                                            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> "" Then
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO = StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)
                                            Else
                                                
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                            
                                            
                                            
                                            
                                            End If
                                        
                                                                                                            'èoâ◊èá
                                            ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN = Trim(StrConv(Y_SYU_TEI_REC.SYU_JUN, vbUnicode))
                                                                                                            'ì@ñº
                                            ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_TEI_NM = Trim(StrConv(Y_SYU_TEI_REC.TEI_NM, vbUnicode))
                                                                                                            'å˚êî
                                            ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KUTI_SU = Val(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode))
                                                                                                            'çÀêî
                                            ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                            
                                            
                                            If Trim(StrConv(Y_SYU_TEI_REC.KENPIN_TANTO, vbUnicode)) <> "" Then
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KENPIN_F = True
                                            Else
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KENPIN_F = False
                                            End If
                                            
                                            
                                            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPOU_F = True
                                            Else
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPOU_F = False
                                            End If
                                            
                                            If Trim(StrConv(Y_SYU_TEI_REC.SHOGO_TANTO, vbUnicode)) <> "" Then
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SHOGO_F = True
                                            Else
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SHOGO_F = False
                                            End If
        
                                        Else
                                        
                                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> "" Then
                                                    If Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO) = Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) Then
                                                        Exit For
                                                    End If
                                                End If
                                            
                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) = "" Then
                                            
                                                    If Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO) = Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
                                                        Exit For
                                                    End If
                                                End If
                                            Next j
                                        
                                        
                                            If j > UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) Then
                                        
                                                ReDim Preserve ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(0 To j)
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO = StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)
                                                Else
                                                    
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                                
                                                
                                                
                                                End If
                                                                                                            'èoâ◊èá
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN = Trim(StrConv(Y_SYU_TEI_REC.SYU_JUN, vbUnicode))
                                                                                                                'ì@ñº
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_TEI_NM = Trim(StrConv(Y_SYU_TEI_REC.TEI_NM, vbUnicode))
                                                                                                                'å˚êî
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KUTI_SU = Val(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode))
                                                                                                                'çÀêî
                                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.KENPIN_TANTO, vbUnicode)) <> "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KENPIN_F = True
                                                Else
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KENPIN_F = False
                                                End If
                                                
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPOU_F = True
                                                Else
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPOU_F = False
                                                End If
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.SHOGO_TANTO, vbUnicode)) <> "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SHOGO_F = True
                                                Else
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SHOGO_F = False
                                                End If
                                            
                                            
                                                If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO)) > 13 Then
                                                                                                                    'ç´ïÔIDñàÇÃåèêî
                                                End If
                                            
                                            
                                            Else
                                            
                                            
                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPOU_F = False
                                                End If
                                                
                                                If Trim(StrConv(Y_SYU_TEI_REC.SHOGO_TANTO, vbUnicode)) = "" Then
                                                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SHOGO_F = False
                                                End If
                                            
                                            
                                            End If
                                        
                                        End If
                                    End If
                                Case BtErrKeyNotFound
                                Case Else
                                    Call File_Error(sts, com, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Exit Function
                            End Select
                            
                            
                        
                            com = BtOpGetNext
                                
                        Loop
                        
                        'èoâ◊ÉfÅ[É^óLñ≥É`ÉFÉbÉN
                        If Not Y_Found_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "èoâ◊ó\íËñ≥Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        End If
                        'ÉLÉÉÉìÉZÉãÉ`ÉFÉbÉN
                        If CANCEL_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "ÉLÉÉÉìÉZÉãì`ï[Ç≈Ç∑ÅB", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        End If
                        'åüïièàóùçœÇ›É`ÉFÉbÉN
                        If KENPIN_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_NO, "åüïièàóùçœÅI", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        End If
                        
                        
                        
                        'ç´ïÔÇhÇcñàÇÃåèêîÇèWåv
 '                       For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)
 '
 '                           If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO)) > 13 Then
 '
 '                               Erase wkTEI_LABELID
 '                               Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO)
 '
 '                               com = BtOpGetGreaterEqual
 '                               k = -1
 '                               Do
 '
 '                                   DoEvents
 '
 '                                   sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
 '                                   Select Case sts
 '                                       Case BtNoErr
 '                                           If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(StrConv(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO, vbUnicode)) Then
 '                                               Exit Do
 '                                           End If
 '                                       Case BtErrEOF
 '                                           Exit Do
 '                                       Case Else
 '                                           Call File_Error(sts, com, "ì@ï íçï∂√ﬁ∞¿", 0)
 '                                           Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
 '                                           Sendbuf = Text_Create_Proc()
 '                                           Exit Function
 '                                   End Select
 '
 '                                   If k = -1 Then
 '                                        k = k + 1
 '                                       ReDim Preserve wkTEI_LABELID(0 To k)
 '                                       wkTEI_LABELID(k) = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
 '                                   Else
 '                                       For k = 0 To UBound(wkTEI_LABELID)
 '
 '                                           If Trim(wkTEI_LABELID(k)) = Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
 '                                                Exit For
 '                                           End If
 '
 '                                       Next k
 '
 '
 '                                       If k > UBound(wkTEI_LABELID) Then
 '                                           ReDim Preserve wkTEI_LABELID(0 To k)
 '                                           wkTEI_LABELID(k) = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
 '                                       End If
 '
 '                                   End If
 '
 '                                   com = BtOpGetNext
 '
 '                               Loop
 '
 '
 '
 '                               If k = -1 Then
 '                                   ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT = 0
 '                               Else
 '                                   ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT = UBound(wkTEI_LABELID) + 1
 '
 '                               End If
 '                           Else
 '                               ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT = 0
 '                           End If
 '
 '                       Next j
                        
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).ID_NO = ID_NO
                        
                        
                        
                        If Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) = "" Then
                        
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            '-----------------------------------------------ÇPçsñ⁄
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(0/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(0/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
                
                
                
                        Else
                
                
                            Call SEK_Kenpin_Count_Proc(Sumi_CNT)
                
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                        
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                        
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                        
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                        
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                        
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                            'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    
                            
                            '-----------------------------------------------ÇQçsñ⁄
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                                                                                'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
    
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
            
                            Sendbuf = Text_Create_Proc()
                        End If
                
                
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiëóÇËèÛáÇÅj
                
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'ëóÇËèÛáÇ
                    Case Trim(ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA) & LCD_OKURI_NO, _
                                LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                        
                        If Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) = LCD_OKURI_NO_S & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) Then
                            
                            If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) > Len(LCD_OKURI_NO_S) Then
                                If Left(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), Len(LCD_OKURI_NO_S)) = LCD_OKURI_NO_S Then
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)
                                Else
                                    OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                                End If
                            Else
                                OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                            End If
                        Else
                            OKURI_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        End If
                        
                        If Trim(OKURI_NO) = Trim(KEN_CHARTER_CD) Or Trim(OKURI_NO) = Trim(KEN_AKABOU_CD) Or Trim(OKURI_NO) = Trim(KEN_LOGISTIC_CD) Then
                        
                        
                        Else
                        
                            If Not IsNumeric(OKURI_NO) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                Exit Function
                            End If
                        
                        
                        
                            If OKURI_NO_CHECK_PROC(OKURI_NO, OKURI_NO_F, FUKUYAMA_CHK_F) Then
                            End If
                            
                            If Not OKURI_NO_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ëóÇËèÛáÇÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                Exit Function
                                                
                            End If
                        
                            If FUKUYAMA_CHK_F Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, OKURI_NO, "ïüéR ¡™Ø∏√ﬁºﬁØƒ¥◊∞", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                Exit Function
                            
                            End If
                        
                        End If
                    
                        'ëóÇËèÛáÇ
                        ID_KANRI_TBL(ING_No).KEN_OKURI_NO = OKURI_NO

                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                    
                        Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)     'éñã∆ïî
                                                                                            'IDáÇ
                        Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, Trim(ID_KANRI_TBL(ING_No).ID_NO))
                        com = BtOpGetGreaterEqual
                        Do
                        
                            DoEvents
                                                        
                            sts = BTRV(com, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                            Select Case sts
                                Case BtNoErr
                                
                                    If Left(StrConv(Y_SYUREC.ID_NO, vbUnicode), 7) <> Trim(ID_KANRI_TBL(ING_No).ID_NO) Then
                                        Exit Do
                                    End If
                                
                                Case BtErrEOF
                                    Exit Do
                                Case Else
                                    Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                            End Select
                        
                            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, StrConv(Y_SYUREC.ID_NO, vbUnicode))                                                                                           'í«î‘
        
                            Do
                        
                                sts = BTRV(BtOpGetEqual + BtSNoWait, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_SEK = False
                                        GoTo Abort_Tran
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_SEK = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                            
                                            
                            If StrConv(Y_SYU_HREC.CANCEL_F, vbUnicode) = "1" Then
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, "")
                                Call UniCode_Conv(Y_SYU_HREC.UNSOU_KAISHA, "")
                            Else
                                Call UniCode_Conv(Y_SYU_HREC.OKURI_NO, OKURI_NO)
                                Call OKURI_NO_SET_PROC(OKURI_NO)
                            End If
                                                        
                            'èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)èëçûÇ›
                            Do
                                sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        Inspe_Proc_SEK = False
                                        GoTo Abort_Tran
                                
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(ŒΩƒ≤“∞ºﬁ)", 0)
                                        Inspe_Proc_SEK = SYS_ERR
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                        
                            com = BtOpGetNext
                        
                        Loop
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                        Call SEK_Kenpin_Count_Proc(Sumi_CNT)
            
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                
                        
                        '-----------------------------------------------ÇQçsñ⁄
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´

                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiéwé¶áÇÅj
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 3)
                    
                    Case LCD_SEK_ID_NO     'éwé¶ID
                        SEK_ID_NO = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)
                        
                            If Trim(SEK_ID_NO) = Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO) Then
                                Exit For
                            End If
                        
                        Next j
                        
                        'éwé¶áÇ¡™Ø∏
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, SEK_ID_NO, "éwé¶áÇÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        
                        End If
                        
                        If Len(Trim(SEK_ID_NO)) > 13 Then
                        'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
                            Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, SEK_ID_NO)
                        Else
                        'ì@ï IDÇ≈ÇÃ¡™Ø∏
                            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, SEK_ID_NO)
                        End If
                                                        
                        com = BtOpGetGreaterEqual
                        T_Found_F = False
                        
                        Do
                        
                            DoEvents
                        
                            If Len(Trim(SEK_ID_NO)) > 13 Then
                                sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                            Else
                                sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                            End If
                            
                            Select Case sts
                                Case BtNoErr
                                        
                                    If Len(Trim(SEK_ID_NO)) > 13 Then
                                    'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
                                        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(SEK_ID_NO) Then
                                            Exit Do
                                        End If
                                    Else
                                    'ì@ï IDÇ≈ÇÃ¡™Ø∏
                                        If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(SEK_ID_NO) Then
                                            Exit Do
                                        End If
                                    End If
                                    
                                
                                Case BtErrEOF
                                    Exit Do
                                Case Else
                                    Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                    Inspe_Proc_SEK = SYS_ERR
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
'                                   GoTo Abort_Tran                  2011.12.22
                                    Exit Function                   '2011.12.22
                            End Select
                        
                            '2011.05.27
                            If SEK_KEN_SHOGO_F Then
                                If Trim(StrConv(Y_SYU_TEI_REC.SHOGO_TANTO, vbUnicode)) = "" Then
                            
'2011.06.22                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "ñ¢è∆çáíçï∂óLÇËÅIÅI", "")
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "ñ¢è∆çáíçï∂Ç≈Ç∑ÅIÅI", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_SEK = False
                                    Exit Function
                                End If
                            End If
                        
                        
                            If SEK_KEN_KONPO_F Then
                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" And Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) = "" Then
                            
'2011.06.22                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "ñ¢ç´ïÔóLÇËÅI", "")
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "ñ¢ç´ïÔÇ≈Ç∑ÅIÅI", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_SEK = False
                                    Exit Function
                                End If
                            End If
                        
                                                
                            If SEK_KEN_KENPIN_F Then
                        
                                If Trim(StrConv(Y_SYU_TEI_REC.KENPIN_TANTO, vbUnicode)) <> "" Then
                            
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "åüïiçœÇ›ÅIÅI", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Inspe_Proc_SEK = False
                                    Exit Function
                                End If
                            
                            End If
                            '2011.05.27
                                                
                        
                            T_Found_F = True
                        
                        
                            com = BtOpGetNext
                        
                        
                        Loop
                        
                        If Not T_Found_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, SEK_ID_NO, "ì@ï íçï∂ÉfÅ[É^Ç»ÇµÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        End If
                                    
                        
                        ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO = SEK_ID_NO
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        
                        '-----------------------------------------------ÇQçsñ⁄
                        
                        Call SEK_Kenpin_Count_Proc(Sumi_CNT)
                        
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        
                        
                        In_Word = ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_TEI_NM
                        Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                        
                        
                        
                        If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
                            
                           'ç´ïÔÇhÇcñàÇÃåèêîÇèWåv
    
                            Erase wkTEI_LABELID
                            Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO)
    
                            com = BtOpGetGreaterEqual
                            k = -1
                            Do
    
                                DoEvents
    
                                sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                Select Case sts
                                    Case BtNoErr
                                        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO) Then
                                            Exit Do
                                        End If
                                    Case BtErrEOF
                                        Exit Do
                                    Case Else
                                        Call File_Error(sts, com, "ì@ï íçï∂√ﬁ∞¿", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
    
    
                                '2012.12.27
'                                Call UniCode_Conv(K8_Y_SYU_H.SEK_HIN_NO, StrConv(Y_SYU_TEI_REC.HIN_NO, vbUnicode))
'                                Call UniCode_Conv(K8_Y_SYU_H.SEK_KEN_NO, StrConv(Y_SYU_TEI_REC.KEN_NO, vbUnicode))
'                                SKIP_F = False
'                                sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K8_Y_SYU_H, Len(K8_Y_SYU_H), 8)
'                                Select Case sts
'                                    Case BtNoErr
'
'                                        If Left(ID_KANRI_TBL(ING_No).ID_NO, 7) <> Left(StrConv(Y_SYU_HREC.ID_NO, vbUnicode), 7) Then
'                                            SKIP_F = True
'                                        End If
'
'                                    Case BtErrKeyNotFound
'                                        SKIP_F = True
'                                    Case Else
'                                        Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË(H)", 0)
'                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                        Sendbuf = Text_Create_Proc()
'                                        Exit Function
'                                End Select
    
                                    
'                                If SKIP_F Then
                                '2012.12.27
    
    
                                    If k = -1 Then
                                        k = k + 1
                                        ReDim Preserve wkTEI_LABELID(0 To k)
    '''                                    wkTEI_LABELID(k) = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                        wkTEI_LABELID(k) = Left(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode), 7)
                                    Else
                                        For k = 0 To UBound(wkTEI_LABELID)
    
    '''                                           If Trim(wkTEI_LABELID(k)) = Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
                                               If Left(wkTEI_LABELID(k), 7) = Left(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode), 7) Then
                                                    Exit For
                                               End If
        
                                        Next k
        
        
                                        If k > UBound(wkTEI_LABELID) Then
                                            ReDim Preserve wkTEI_LABELID(0 To k)
    '''                                        wkTEI_LABELID(k) = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                            wkTEI_LABELID(k) = Left(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode), 7)
                                        End If
        
                                    End If
    
'                                End If          '2012.12.27
    
                                com = BtOpGetNext
    
                            Loop
    
    
    
                            If k = -1 Then
                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT = 0
                            Else
                                ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT = UBound(wkTEI_LABELID) + 1

                            End If
                            
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Format(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT, "#0") & "åè(" _
                                                                                & Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN) & " " & _
                                                                                Out_Word & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Format(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KONPO_CNT, "#0") & "åè" _
                                                                                & Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN) & " " & _
                                                                                Out_Word)
                        Else
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN) & " " & Out_Word)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_SYU_JUN) & " " & Out_Word)
                        End If
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        
                        Sendbuf = Text_Create_Proc()
                
                End Select
            
            Next i
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiANY KEYÅ@éÛêMÅj
            
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
                                            
                                                    
            '----------------------------------- ì@ï íçï∂ÉfÅ[É^èàóù -----------
            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)
                If ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO = ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO Then
                    wkKUTI_SU = ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KUTI_SU
                    Exit For
                End If
            Next j
            
            
            
            If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
            'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
                Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
            Else
            'ì@ï IDÇ≈ÇÃ¡™Ø∏
                Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
            End If
                                                        
            com = BtOpGetGreaterEqual
                        
            Do
            
                DoEvents
            
                If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
                    sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                Else
                    sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                End If
                
                Select Case sts
                    Case BtNoErr
                            
                        If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
                        'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
                            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO) Then
                                Exit Do
                            End If
                        Else
                        'ì@ï IDÇ≈ÇÃ¡™Ø∏
                            If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO) Then
                                Exit Do
                            End If
                        End If
                        
                    
                    Case BtErrEOF
                        Exit Do
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                        Inspe_Proc_SEK = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
            '----------------------------------- èoâ◊ó\íË(H)èàóù -----------
                
                
                '2012.12.27
                Call UniCode_Conv(K8_Y_SYU_H.SEK_HIN_NO, StrConv(Y_SYU_TEI_REC.HIN_NO, vbUnicode))
                Call UniCode_Conv(K8_Y_SYU_H.SEK_KEN_NO, StrConv(Y_SYU_TEI_REC.KEN_NO, vbUnicode))
                SKIP_F = False
                sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K8_Y_SYU_H, Len(K8_Y_SYU_H), 8)
                Select Case sts
                    Case BtNoErr
                    
                        If Left(ID_KANRI_TBL(ING_No).ID_NO, 7) <> Left(StrConv(Y_SYU_HREC.ID_NO, vbUnicode), 7) Then
                            SKIP_F = True
                        End If
                        
                    Case BtErrKeyNotFound
                        SKIP_F = True
                    Case Else
                        Call File_Error(sts, BtOpGetEqual, "èoâ◊ó\íË(H)", 0)
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                End Select

                    
                If SKIP_F Then
                '2012.12.27
                
                
                    Call UniCode_Conv(K8_Y_SYU_H.SEK_KEN_NO, StrConv(Y_SYU_TEI_REC.KEN_NO, vbUnicode))
                    Call UniCode_Conv(K8_Y_SYU_H.SEK_HIN_NO, StrConv(Y_SYU_TEI_REC.HIN_NO, vbUnicode))
                                                
                    sts = BTRV(BtOpGetEqual, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K8_Y_SYU_H, Len(K8_Y_SYU_H), 8)
                    
                    Select Case sts
                        Case BtNoErr
                        
                        Case BtErrKeyNotFound
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO, "èoâ◊ó\íË(H)", "ÉAÉìÉ}ÉbÉ`ÅI")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            Exit Function
                        Case Else
                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                            Inspe_Proc_SEK = SYS_ERR
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
            '----------------------------------- èoâ◊ó\íËèàóù -----------
                    Call UniCode_Conv(K0_Y_SYU.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
                    Call UniCode_Conv(K0_Y_SYU.KEY_ID_NO, StrConv(Y_SYU_HREC.ID_NO, vbUnicode))
                                                
                    sts = BTRV(BtOpGetEqual, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                    
                    Select Case sts
                        Case BtNoErr
                        
                        Case BtErrKeyNotFound
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO, "èoâ◊ó\íË", "ÉAÉìÉ}ÉbÉ`ÅI")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            'Exit Function              2011.12.22
                            GoTo Abort_Tran         '   2011.12.22
                        Case Else
                            GoTo Abort_Tran
                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                            Inspe_Proc_SEK = SYS_ERR
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
                                                
            '----------------------------------- èoâ◊ó\íËèëÇ´çûÇ›èàóù -----------
                                        
                    Call UniCode_Conv(Y_SYUREC.KENPIN_YMD, Format(Now, "YYYYMMDD"))
                                                        
                    Call UniCode_Conv(Y_SYUREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                    Call UniCode_Conv(Y_SYUREC.KENPIN_HMS, Format(Now, "HHMMSS"))
                                                    
                                                    
                                                    
                    Call UniCode_Conv(Y_SYUREC.UPD_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                                                    
                    Do
                        sts = BTRV(BtOpUpdate, Y_SYU_POS, Y_SYUREC, Len(Y_SYUREC), K0_Y_SYU, Len(K0_Y_SYU), 0)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íËégópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                GoTo Abort_Tran
                        
                            Case Else
                                
                                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË", 0)
                                Inspe_Proc_SEK = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                                            
                                            
            '----------------------------------- èoâ◊ó\íË(H)èëÇ´çûÇ›èàóù -----------
                                            
                    Call UniCode_Conv(Y_SYU_HREC.KENPIN_NOW, Format(Now, "YYYYMMDDHHMMSS"))
                    Call UniCode_Conv(Y_SYU_HREC.KENPIN_TANTO_CODE, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                        
                    
                     If com = BtOpGetGreaterEqual Then
                    
                        wkSEK_PAGE_NO = ID_KANRI_TBL(ING_No).SEK_PAGE_NO
                        
                        
                        ID_KANRI_TBL(ING_No).SEK_PAGE_NO = ID_KANRI_TBL(ING_No).SEK_PAGE_NO + 1
                        From_Page_No = ID_KANRI_TBL(ING_No).SEK_PAGE_NO
                        
                        ID_KANRI_TBL(ING_No).SEK_PAGE_NO = ID_KANRI_TBL(ING_No).SEK_PAGE_NO + wkKUTI_SU - 1
                        To_Page_No = ID_KANRI_TBL(ING_No).SEK_PAGE_NO
                                                
                    End If
                                                
                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ, Format(From_Page_No, "000"))
                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ_TO, Format(To_Page_No, "000"))
                                                
                    Call UniCode_Conv(Y_SYU_HREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                    Call UniCode_Conv(Y_SYU_HREC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                                                
                                                
                                                
                    Do
                        sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K8_Y_SYU_H, Len(K8_Y_SYU_H), 8)
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                GoTo Abort_Tran
                        
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                                Inspe_Proc_SEK = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                
            '----------------------------------- ì@ï íçï∂√ﬁ∞¿(H)èëÇ´çûÇ›èàóù -----------
                                            
                    Call UniCode_Conv(Y_SYU_TEI_REC.KENPIN_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                    Call UniCode_Conv(Y_SYU_TEI_REC.KENPIN_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
                                                
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                    Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                                
                                                
                    Do
                        
                        If Len(Trim(SEK_ID_NO)) > 13 Then
                        'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
                            sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU, Len(K3_Y_SYU), 3)
                        Else
                        'ì@ï IDÇ≈ÇÃ¡™Ø∏
                            sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU, Len(K1_Y_SYU), 1)
                        End If
                        
                        
                        Select Case sts
                            Case BtNoErr
                                Exit Do
                            Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂√ﬁ∞¿égópíÜ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                GoTo Abort_Tran
                        
                            Case Else
                                Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂√ﬁ∞¿", 0)
                                Inspe_Proc_SEK = SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                GoTo Abort_Tran
                        End Select
                    Loop
                '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                    If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                        MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                
                    Else
                        MENU_NO = ""
                    End If
                                                
                    'óöóèoóÕÇÃà◊ÇÃì«Ç›çûÇ›
                    Call UniCode_Conv(K0_MTS.MUKE_CODE, ID_KANRI_TBL(ING_No).MTS_CODE)
                    Call UniCode_Conv(K0_MTS.SS_CODE, "")
                    sts = BTRV(BtOpGetEqual, MTS_POS, MTSREC, Len(MTSREC), K0_MTS, Len(K0_MTS), 0)
                    Select Case sts
                        Case BtNoErr
                        Case BtErrKeyNotFound
                            Call UniCode_Conv(MTSREC.MUKE_DNAME, "")
                            Call UniCode_Conv(MTSREC.MUKE_NAME, "")
                        Case Else
                            Call File_Error(sts, BtOpGetEqual, "å¸ÇØêÊÉ}ÉXÉ^", 0)
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            'Exit Function              2011.12.22
                            GoTo Abort_Tran         '   2011.12.22
                                            
                    End Select
                    sts = IDOREKI_OUTPUT_PROC("", _
                                                "", _
                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                ID_KANRI_TBL(ING_No).NAIGAI, _
                                                "", _
                                                "", _
                                                (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                0, _
                                                0, _
                                                (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                FILE_RETRY, _
                                                CYU_KBN_SPO, _
                                                Trim(StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)) & " ëóÇËèÛáÇ:" & Trim(StrConv(Y_SYU_HREC.OKURI_NO, vbUnicode)), _
                                                , , , , MENU_NO, _
                                                ID_KANRI_TBL(ING_No).MTS_CODE, _
                                                "", _
                                                ID_KANRI_TBL(ING_No).ID_NO & "-" & ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO, , , , 1)
                    Select Case sts
                        Case False      'ê≥èÌèIóπ
                        Case Else
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Inspe_Proc_SEK = SYS_ERR
                            GoTo Abort_Tran
                    End Select
                
                    'â^ëóâÔé–
                    ID_KANRI_TBL(ING_No).KEN_UNSOU_KAISHA = StrConv(Y_SYU_HREC.UNSOU_KAISHA, vbUnicode)
                
                End If                  '2012.12.27
                
                com = BtOpGetNext
            
            Loop
            
            'çÏã∆€∏ﬁèoóÕ
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     , , , , , _
                                                     ID_KANRI_TBL(ING_No).ID_NO, ID_KANRI_TBL(ING_No).MTS_CODE) Then
                    Inspe_Proc_SEK = SYS_ERR
                    'Exit Function          2011.12.22
                   GoTo Abort_Tran      '   2011.12.22
                End If
            End If
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If

            
            For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)
                If Trim(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_ID_NO) = Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO) Then
                    ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(j).SEK_KENPIN_F = True
                    Exit For
                End If
            Next j
            
            
                    
            Call SEK_Kenpin_Count_Proc(Sumi_CNT)
                    
                    
            ''' â◊éDèàíu
            If Trim(F0_SendFile) = "" Or Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) = "" Then
            
            
                If Sumi_CNT = UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1 Then
                '--------------------------------------------------------------------å˚êîÅEçÀêîÇ÷
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    '-----------------------------------------------ÇPçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                    '-----------------------------------------------ÇQçsñ⁄
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                            "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                '-----------------------------------------------ÇRçsñ⁄
                                                                            'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                            
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '--------------------------------------------------ÇSçsñ⁄
                    Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
                                                                'BOXëÆê´
                                
                    Send_Text.Box_Type(3).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "00"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = ""
                    
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
        
                    '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                    If SAI_SU >= 999999 Or SAI_SU = 0 Then
                    
                    
                    
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                    
                    
                    Else
                    
                    
                    
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(SAI_SU, "#0.00"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(SAI_SU, "#0.00"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                    
'                        ID_KANRI_TBL(ING_No).SEK_SAI_SU = SAI_SU
'                        ID_KANRI_TBL(ING_No).SEK_KUTI_SU = KUTI_SU
                            
                    
                    End If
                            
                            
                    Sendbuf = Text_Create_Proc()
                Else
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    '-----------------------------------------------ÉwÉbÉ_Å[
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                    
                    '-----------------------------------------------ÇPçsñ⁄
                                                    'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            
                    
                    '-----------------------------------------------ÇQçsñ⁄
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                                                                            
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                    Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                            'ï\é¶ì‡óe
                                                                        'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = "01"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "20"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                            
                    Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇTçsñ⁄
                                                                            'BOXëÆê´
    
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                            'ì¸óÕåÖêî
                     Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                            
                    Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                    Sendbuf = Text_Create_Proc()
                End If
            
            Else
                
                Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
                
'''''''''''''''''''''''''   2011.06.29
                If wkSEK_PAGE_NO = 0 Then
                    wkSEK_PAGE_NO = SEK_LABEL_PAGE - 1
                End If
'''''''''''''''''''''''''   2011.06.29
                
                If SEK_Label_File_Make_Proc(fileName, wkSEK_PAGE_NO, wkKUTI_SU, KUTI_SU) Then
                    Inspe_Proc_SEK = SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    'GoTo Abort_Tran        2011.12.22
                    Exit Function       '   2011.12.22
                End If
                If ID_KANRI_TBL(ING_No).SEK_PAGE_NO < SEK_LABEL_PAGE Then

                    If Sumi_CNT = UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1 Then
                    '--------------------------------------------------------------------å˚êîÅEçÀêîÇ÷
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK

                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF

                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only

                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"

                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""

                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"

                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                                "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"

                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                    '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe

                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)

                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"

                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '--------------------------------------------------ÇSçsñ⁄
                        Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
                                                                    'BOXëÆê´

                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "00"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = ""

                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""

                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        If ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU > 999 Or ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU = 0 Then



                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                            'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                            'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00")))) & Trim(Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "12"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "05"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"


                        Else



                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(SAI_SU, "#0.00"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(SAI_SU, "#0.00"))
                                                                            'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"



                        End If



                        Sendbuf = Text_Create_Proc()
                    Else

                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK

                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF

                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only

                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"

                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""

                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF

                        '-----------------------------------------------ÇPçsñ⁄
                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"

                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""


                        '-----------------------------------------------ÇQçsñ⁄
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(0/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"

                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe

                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"

                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                                                            'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"

                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´

                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"

                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                    End If




                
                Else
            
                'àÛç¸óvãÅëóêM
                                            
                    ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                                
                                                
                    ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
                
                    ID_KANRI_TBL(ING_No).LABEL_ON = True
                
                    ID_KANRI_TBL(ING_No).LABEL_START_PAGE_NO = ID_KANRI_TBL(ING_No).SEK_PAGE_NO
                    '-----------------------------------------------ÉwÉbÉ_Å[
                
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                    Send_Text.Display_Flg = Display_LABEL                   'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_LABEL
                
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                    Send_Text.fileName = fileName                           'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = fileName
                
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                    Sendbuf = Text_Create_Proc()
            
                End If
            
            End If
                    
        Case Step_PRINT_RES        'àÛç¸èIóπ
                    
            Call SEK_Kenpin_Count_Proc(Sumi_CNT)
                    
            If Sumi_CNT = UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1 Then
            '--------------------------------------------------------------------å˚êîÅEçÀêîÇ÷
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo5_REQ
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                        "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & _
                                                        "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                                                                        
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                                        
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '--------------------------------------------------ÇSçsñ⁄
                Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
                                                            'BOXëÆê´
                            
                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(KUTI_SU, "0"))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "00"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = ""
                
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
    
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                If SAI_SU >= 999999 Or SAI_SU = 0 Then
                
                
                
                    Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = "12"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "05"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                
                
                Else
                
                
                
                    Send_Text.Box_Type(4).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S & Format(SAI_SU, "#0.00"))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S & Format(SAI_SU, "#0.00"))
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                            'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                
'                    ID_KANRI_TBL(ING_No).SEK_SAI_SU = SAI_SU
'                    ID_KANRI_TBL(ING_No).SEK_KUTI_SU = KUTI_SU
                        
                        
                End If
                        
                        
                Sendbuf = Text_Create_Proc()
            Else
            
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                '-----------------------------------------------ÉwÉbÉ_Å[
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                
                '-----------------------------------------------ÇPçsñ⁄
                                                'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
        
                
                '-----------------------------------------------ÇQçsñ⁄
                
                Call SEK_Kenpin_Count_Proc(Sumi_CNT)
                
                
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, LCD_ID_No & ":" & Trim(ID_KANRI_TBL(ING_No).ID_NO) & "(" & Format(Sumi_CNT, "0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL) + 1, "0") & ")")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                                                                        
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI))
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                    'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SEK_ID_NO)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´

                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()
            End If
    
        Case Step_Sagyo5_RES        'ÇTâÒñ⁄ÇÃéÛêMÅiANY KEYÅ@éÛêMÅj
            
            Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
            
            If SAI_SU >= 999999 Or SAI_SU = 0 Then
            
            
                For i = 0 To M_Gyo - 1
            
                
                
                    Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                        'çÀêî
                        Case LCD_SAI_SU_S
                    
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                Exit Function
                            
                            End If
                    
                            INPUT_SAI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                    
                    
                            If INPUT_SAI_SU = 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Inspe_Proc_SEK = False
                                Exit Function
                            
                            End If
            
            
'2011.05.26                            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
'2011.05.26                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
'2011.05.26                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'2011.05.26                            If sts <> BtNoErr Then
'2011.05.26                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2011.05.26                                Sendbuf = Text_Create_Proc()
'2011.05.26                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
'2011.05.26                                Exit Function
'2011.05.26                            End If
'2011.05.26                            '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
'2011.05.26
'2011.05.26
'2011.05.26                            If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
'2011.05.26                            'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
'2011.05.26                                Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
'2011.05.26                            Else
'2011.05.26                            'ì@ï IDÇ≈ÇÃ¡™Ø∏
'2011.05.26                                Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)
'2011.05.26                            End If
'2011.05.26
'2011.05.26                            com = BtOpGetGreaterEqual
'2011.05.26
'2011.05.26                            Do
'2011.05.26
'2011.05.26                                DoEvents
'2011.05.26
'2011.05.26                                Do
'2011.05.26                                    If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
'2011.05.26                                        sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
'2011.05.26                                    Else
'2011.05.26                                        sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
'2011.05.26                                    End If
'2011.05.26
'2011.05.26                                    Select Case sts
'2011.05.26                                        Case BtNoErr
'2011.05.26                                            If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO)) > 13 Then
'2011.05.26                                            'ç´ïÔIDÇ≈ÇÃ¡™Ø∏
'2011.05.26                                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO) Then
'2011.05.26                                                    sts = BtErrEOF
'2011.05.26                                                    Exit Do
'2011.05.26                                                End If
'2011.05.26                                            Else
'2011.05.26                                            'ì@ï IDÇ≈ÇÃ¡™Ø∏
'2011.05.26                                                If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KEN_ID_NO) Then
'2011.05.26                                                    sts = BtErrEOF
'2011.05.26                                                    Exit Do
'2011.05.26                                                End If
'2011.05.26                                            End If
'2011.05.26                                            Exit Do
'2011.05.26                                        Case BtErrEOF
'2011.05.26                                            Exit Do
'2011.05.26                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2011.05.26                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
'2011.05.26                                            Sendbuf = Text_Create_Proc()
'2011.05.26                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2011.05.26                                            Inspe_Proc_SEK = False
'2011.05.26                                            GoTo Abort_Tran
'2011.05.26                                        Case Else
'2011.05.26                                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
'2011.05.26                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2011.05.26                                            Sendbuf = Text_Create_Proc()
'2011.05.26                                            GoTo Abort_Tran
'2011.05.26                                    End Select
'2011.05.26
'2011.05.26                                Loop
'2011.05.26
'2011.05.26
'2011.05.26                                If sts = BtErrEOF Then
'2011.05.26                                    Exit Do
'2011.05.26                                End If
'2011.05.26
'2011.05.26                                Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, "0001")
'2011.05.26                                Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(INPUT_SAI_SU, "000.00"))
'2011.05.26
'2011.05.26
'2011.05.26                                Do
'2011.05.26                                    DoEvents
'2011.05.26                                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
'2011.05.26                                    Select Case sts
'2011.05.26                                        Case BtNoErr
'2011.05.26                                            Exit Do
'2011.05.26                                        Case BtErrKeyNotFound
'2011.05.26                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
'2011.05.26                                            Sendbuf = Text_Create_Proc()
'2011.05.26                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2011.05.26                                            Inspe_Proc_SEK = False
'2011.05.26                                            GoTo Abort_Tran
'2011.05.26                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
'2011.05.26                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
'2011.05.26                                            Sendbuf = Text_Create_Proc()
'2011.05.26                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'2011.05.26                                            Inspe_Proc_SEK = False
'2011.05.26                                            GoTo Abort_Tran
'2011.05.26                                        Case Else
'2011.05.26                                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
'2011.05.26                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2011.05.26                                            Sendbuf = Text_Create_Proc()
'2011.05.26                                            GoTo Abort_Tran
'2011.05.26                                    End Select
'2011.05.26                                Loop
'2011.05.26
'2011.05.26
'2011.05.26                                com = BtOpGetNext
'2011.05.26
'2011.05.26
'2011.05.26                            Loop
'2011.05.26                                    'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
'2011.05.26                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
'2011.05.26                            If sts <> BtNoErr Then
'2011.05.26                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'2011.05.26                                Sendbuf = Text_Create_Proc()
'2011.05.26                                Call File_Error(sts, BtOpEndTransaction, "", 0)
'2011.05.26                                GoTo Abort_Tran
'2011.05.26                            End If
'2011.05.26
                    End Select
                Next i
                Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
                wkSai_Input = 1
                SAI_SU = INPUT_SAI_SU
            Else
                wkSai_Input = 0
                Call SEK_KUTI_SU_Count_Proc(SAI_SU, KUTI_SU)
            End If
            
            
            '----------------------------------- èoâ◊ó\íË(H)èàóù -----------
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            
            
            Call UniCode_Conv(K4_Y_SYU_H.ID_NO, Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") & "00")
            
            com = BtOpGetGreaterEqual
            
            Do
                
                DoEvents
                sts = BTRV(com, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                
                Select Case sts
                    Case BtNoErr
                    
                        If Left(StrConv(Y_SYU_HREC.ID_NO, vbUnicode), 7) <> Format(ID_KANRI_TBL(ING_No).ID_NO, "0000000") Then
                            Exit Do
                        End If
                    
                    Case BtErrEOF
                        
                        Exit Do
                    Case Else
                        Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                        Inspe_Proc_SEK = SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        GoTo Abort_Tran
                End Select
                                            
                                            
            '----------------------------------- èoâ◊ó\íË(H)èëÇ´çûÇ›èàóù -----------
                
                Call UniCode_Conv(Y_SYU_HREC.KUTI_SU, Format(KUTI_SU, "0000"))
                Call UniCode_Conv(Y_SYU_HREC.SAI_SU, Format(SAI_SU, "00.00"))
                                            
                                            
''                If wkSai_Input = 1 Then
''                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ, "001")
''                    Call UniCode_Conv(Y_SYU_HREC.OKURI_NO_SEQ_TO, Format(KUTI_SU, "000"))
''                End If
                                            
                Call UniCode_Conv(Y_SYU_HREC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                Call UniCode_Conv(Y_SYU_HREC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                                            
                                            
                Do
                    sts = BTRV(BtOpUpdate, Y_SYU_H_POS, Y_SYU_HREC, Len(Y_SYU_HREC), K4_Y_SYU_H, Len(K4_Y_SYU_H), 4)
                    Select Case sts
                        Case BtNoErr
                            Exit Do
                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "èoâ◊ó\íË(H)égópíÜ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Inspe_Proc_SEK = False
                            GoTo Abort_Tran
                    
                        Case Else
                            Call File_Error(sts, BtOpUpdate, "èoâ◊ó\íË(H)", 0)
                            Inspe_Proc_SEK = SYS_ERR
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            GoTo Abort_Tran
                    End Select
                Loop
                
            
                
                com = BtOpGetNext
            
            Loop
            
                                'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
    
    
    
    
    
    
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    
    
    
    
    
    
    
    
    
    
    End Select
                    
                    

    Inspe_Proc_SEK = False
    
    Exit Function

Abort_Tran:
    
   sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

    


End Function




Private Sub SEK_Kenpin_Count_Proc(Sumi_CNT As Integer)
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXå¸ÇØèoâ◊ó\íË åüïiçœÇ›ÇÃÉJÉEÉìÉgÅx
'   ëÂç„ÇoÇbóp  2011.05.09
'-------------------------------------------------------
Dim i   As Integer

    Sumi_CNT = 0

    For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)

        If ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_KENPIN_F Then
            Sumi_CNT = Sumi_CNT + 1
        End If

    Next i

End Sub
Private Function SEK_SYUGO_PACKING_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXÅ@ì@ï èWçáç´ïÔèàóùÅx
'
'   2011.05.12
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim i               As Integer
Dim j               As Integer


Dim KONPO_ID        As String * 20

Dim ID_NO           As String * 13
Dim Found_Flg       As Integer
Dim SYUGO_SUMI_CNT  As Long

Dim In_Word         As String * 50
Dim Out_Word        As String * 20


Dim SAI_SU          As Double

Dim MENU_NO         As String * 2


    SEK_SYUGO_PACKING_Proc = True





    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ÇhÇcÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SEK_SYUGO_ID_NO      'éwê}ÇhÇc
                        KONPO_ID = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        sts = Y_SYUKA_TEI_SYUGO_Check_Proc(KONPO_ID, Found_Flg)
                        Select Case sts
                            Case BtNoErr          'ê≥èÌ
                
                                '------------------ ç´ïÔçœÇ›ÇÃÉ`ÉFÉbÉN
                                If Not Found_Flg Then
                                    
                                    If ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU >= 999999 Then
                                    
                                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                                        ID_KANRI_TBL(ING_No).SEK_KONPO_ID = KONPO_ID
                            
                            
                                        '-----------------------------------------------ÉwÉbÉ_Å[
                                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                                
                                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                                
                                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                                
                                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                                
                                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                                
                                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                        
                                        '-----------------------------------------------ÇPçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(0).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(0).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(0).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                                        '-----------------------------------------------ÇQçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        In_Word = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME)
                                        Call Moji_Cut_Proc(In_Word, Out_Word, 20)
                                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(1).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(1).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(1).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                                        
                                        
                                        '-----------------------------------------------ÇRçsñ⁄
                                                                                                
                                        'èWçáç´ïÔèÛë‘ÇÃÉJÉEÉìÉg
                                        Call SEK_SYUGO_CNT_Proc(SYUGO_SUMI_CNT)
                                                                                                
                                                                                                
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                                'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                                    " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                                    " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                                                                                                'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(2).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(2).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(2).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                                
                                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                        
                                        '-----------------------------------------------ÇSçsñ⁄
                                                                                                'BOXëÆê´
                                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(3).INIT = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(3).Start_Pos = ""
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(3).Max_Size = "00"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                
                                        '-----------------------------------------------ÇTçsñ⁄
                                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                        'ï\é¶ì‡óe
                                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                                        'êîílèâä˙ï\é¶
                                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                        Send_Text.Box_Type(4).Start_Pos = "12"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                                'ì¸óÕåÖêî
                                        Send_Text.Box_Type(4).Max_Size = "05"
                                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                        
                            
                                        Sendbuf = Text_Create_Proc()
                                    
                                        SEK_SYUGO_PACKING_Proc = False
                                        Exit Function
                                    
                                    Else
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, KONPO_ID, "ëSêîç´ïÔçœÇ›Ç≈Ç∑", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_SYUGO_PACKING_Proc = False
                                        Exit Function
                                    End If
                                End If
                            Case BtErrEOF
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, KONPO_ID, "íçï∂√ﬁ∞¿Ç»Çµ", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_SYUGO_PACKING_Proc = False
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                
                        ID_KANRI_TBL(ING_No).SEK_KONPO_ID = KONPO_ID
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        
                        
                        In_Word = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME)
                        Call Moji_Cut_Proc(In_Word, Out_Word, 20)
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(Out_Word))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(Out_Word))
                        
                        
'                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
'                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                        
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                
                        'èWçáç´ïÔèÛë‘ÇÃÉJÉEÉìÉg
                        Call SEK_SYUGO_CNT_Proc(SYUGO_SUMI_CNT)
                                                                                
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                    " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                    " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                        
                        
                        
                        '-----------------------------------------------ÇTçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_ID_NO)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_ID_NO)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "01"                  'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiéwé¶áÇÅj
        
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 3)
                    
                    Case LCD_SEK_ID_NO     'éwé¶áÇ
                        ID_NO = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                        'äYìñïiî‘óLñ≥ÇÃ¡™Ø∏
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL)
                            If Trim(ID_NO) = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_TEI_LABELID) Then
                                Exit For
                            End If
                        Next j
                        
                        If j > UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_KONPO_ID, ID_NO, "éwé¶áÇÉGÉâÅ[", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_SYUGO_PACKING_Proc = False
                            Exit Function
                        End If
                        
                
                        If ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_SYUGO_F Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_KONPO_ID, ID_NO, "ç´ïÔçœÇ›ÅI", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_SYUGO_PACKING_Proc = False
                            Exit Function
                        End If
                
                        '2011.05.27
                        If SEK_KONPO_F Then
                            For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL)
                                If Trim(ID_NO) = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_TEI_LABELID) Then
                                    If Not ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_KONPO_F Then
                                        Exit For
                                    End If
                                End If
                            Next j

                            If j <= UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) Then
'2011.06.22                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_KONPO_ID, ID_NO, "ñ¢ç´ïÔï™óLÇËÅIÅI", "")
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).SEK_KONPO_ID, ID_NO, "ñ¢ç´ïÔÇ≈Ç∑ÅIÅI", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_SYUGO_PACKING_Proc = False
                                Exit Function
                            End If
                        End If
                        '2011.05.27
                        
                        For j = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL)
                            If Trim(ID_NO) = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_TEI_LABELID) Then
                                Exit For
                            End If
                        Next j
                        
                        ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(j).SEK_SYUGO_F = True
                        ID_KANRI_TBL(ING_No).SEK_KEN_TEI_LABELID = ID_NO
    
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                        '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
                        
                        com = BtOpGetGreaterEqual
                        Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_KEN_TEI_LABELID)
            
                        Do
                            
                            DoEvents
                        
                            Do
                            
                                sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrEOF
                                        Exit Do
                                    Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_SYUGO_PACKING_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                                    
                            If sts = BtErrEOF Then
                                Exit Do
                            End If
            
                            If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KEN_TEI_LABELID) Then
                                Exit Do
                            End If
                        
                
                            Call UniCode_Conv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
                            Call UniCode_Conv(Y_SYU_TEI_REC.SYUGO_KONPO_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                            Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                
                
                            Do
                                DoEvents
                                sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        Exit Do
                                    Case BtErrKeyNotFound
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_SYUGO_PACKING_Proc = False
                                        GoTo Abort_Tran
                                     Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        SEK_SYUGO_PACKING_Proc = False
                                        GoTo Abort_Tran
                                    Case Else
                                        Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        GoTo Abort_Tran
                                End Select
                            Loop
                
                
                            com = BtOpGetNext
                
                
                        Loop
                                            
                        '------------------------------------   ç›å…à⁄ìÆóöóÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                            MENU_NO = ""
                        End If
                                                        
                                                        
                        sts = IDOREKI_OUTPUT_PROC("", _
                                                    "", _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    "", _
                                                    "", _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    0, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, _
                                                    , _
                                                    ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME, _
                                                    , , , , MENU_NO, _
                                                    , _
                                                    "", _
                                                    , , , , 1, , , , , , , ID_KANRI_TBL(ING_No).SEK_KEN_TEI_LABELID)
                        Select Case sts
                            Case False      'ê≥èÌèIóπ
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                SEK_SYUGO_PACKING_Proc = SYS_ERR
                                GoTo Abort_Tran
                        End Select
            
                        '------------------------------------   çÏã∆ÉçÉOÇÃèàóù
                        If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                            MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                    
                        Else
                                    
                            MENU_NO = ""
                        End If
                        If Trim(MENU_NO) = "" Then
                        Else
                        'çÏã∆€∏ﬁèoóÕ
                            
                            If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                                (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                                ID_KANRI_TBL(ING_No).JGYOBU, _
                                                                ID_KANRI_TBL(ING_No).NAIGAI, _
                                                                MENU_NO, _
                                                                (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                                 , , , , , _
                                                                 ID_KANRI_TBL(ING_No).SEK_KEN_TEI_LABELID) Then
                                SEK_SYUGO_PACKING_Proc = SYS_ERR
                                Exit Function
                            End If
                        End If
                                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
                    
                        'èWçáç´ïÔèÛë‘ÇÃÉJÉEÉìÉg
                        Call SEK_SYUGO_CNT_Proc(SYUGO_SUMI_CNT)
        
                        If SYUGO_SUMI_CNT <> UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1 Then
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            
                            In_Word = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME)
                            Call Moji_Cut_Proc(In_Word, Out_Word, 20)
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(Out_Word))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(Out_Word))
                            
                            
                            
'                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            
                            
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                            
                            
                            
                            
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCANK
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SEK_ID_NO)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SEK_ID_NO)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "01"                    'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "01"
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "20"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "20"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
            
                        Else
                        'ç´ïÔäÆóπ
            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                            '-----------------------------------------------ÇPçsñ⁄
'                                                                                    'BOXëÆê´
'                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'                                                                                    'êîílèâä˙ï\é¶
'                            Send_Text.Box_Type(0).INIT = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            Send_Text.Box_Type(0).Start_Pos = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                    'ì¸óÕåÖêî
'                            Send_Text.Box_Type(0).Max_Size = "00"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            
                            In_Word = Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME)
                            Call Moji_Cut_Proc(In_Word, Out_Word, 20)
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                            
                            
 '                           Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
 '                           Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    
                            'èWçáç´ïÔèÛë‘ÇÃÉJÉEÉìÉg
                            Call SEK_SYUGO_CNT_Proc(SYUGO_SUMI_CNT)
                                                                                    
                                                                                    
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 1, 4) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 5, 2) & "/" & Mid(ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) + 1, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                            
                            
                            
                            
                            
                            
                            
                            
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                                    
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                            'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & " 1")
                                                                            'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                            'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                    
                            '-----------------------------------------------ÇTçsñ⁄
                                    
                            If ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU >= 999999 Then
                            
                            
                            
                                Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                                'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(0, "#0.00")))) & Trim(Format(0, "#0.00"))
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(4).Start_Pos = "12"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(4).Max_Size = "05"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                            
                            
                            Else
                            
                            
                            
                                Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S & Format(ID_KANRI_TBL(ING_No).SEK_SAI_SU, "#0.00"))
                                                                                'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(3).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(3).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                                Send_Text.Box_Type(3).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                            
                            End If
                            
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
'                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
'                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "Å®ENT")
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "Å®ENT")
'                                                                                    'êîílèâä˙ï\é¶
'                            Send_Text.Box_Type(4).INIT = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
'                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
'                                                                                    'ì¸óÕåÖêî
'                             Send_Text.Box_Type(4).Max_Size = "00"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
'
'                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                
                            Sendbuf = Text_Create_Proc()
                        End If
                End Select
            Next i
                    
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiAny KeyÅj
            
            
            
            If ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU >= 999999 Then
            
            
                For i = 0 To M_Gyo - 1
            
                
                
                    Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                        'çÀêî
                        Case LCD_SAI_SU_S
                    
                            If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_SYUGO_PACKING_Proc = False
                                Exit Function
                            
                            End If
                    
                            SAI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                    
                    
                            If SAI_SU = 0 Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                SEK_SYUGO_PACKING_Proc = False
                                Exit Function
                            
                            End If
            
            
            
            
                            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                            'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                            '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
                            Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KONPO_ID)
                            com = BtOpGetGreaterEqual
            
                            Do
                        
                                DoEvents
                    
                                Do
                        
                                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrEOF
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_SYUGO_PACKING_Proc = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                    
                                Loop
                        
                            
                                If sts = BtErrEOF Then
                                    Exit Do
                                End If
                    
                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KONPO_ID) Then
                                    Exit Do
                                End If
                        
                
                                Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, "0001")
                                Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(SAI_SU, "000.00"))
                        
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                
                                
                                Do
                                    DoEvents
                                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_SYUGO_PACKING_Proc = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_SYUGO_PACKING_Proc = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                
                
                                com = BtOpGetNext
                            
                    
                            Loop
                                    'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpEndTransaction, "", 0)
                                GoTo Abort_Tran
                            End If
            
                    End Select
                Next i
            End If
            
            
            
            
            
            
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
    
    
    End Select

    SEK_SYUGO_PACKING_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

    SEK_SYUGO_PACKING_Proc = False

End Function


Private Function Y_SYUKA_TEI_SYUGO_Check_Proc(ID_NO As String, Found_Flg As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXèoâ◊èWçáç´ïÔÅ@íçï∂ÉfÅ[É^ÇÃÉ`ÉFÉbÉNÅx
'               2011.05.12
'
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer

Dim i           As Integer
Dim j           As Integer



    Y_SYUKA_TEI_SYUGO_Check_Proc = True
    
    
    Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_NO)
    com = BtOpGetGreaterEqual
    
    
    Found_Flg = False
    
    i = -1
    Erase ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL
    
    
    Do
    
        DoEvents
    
        sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
        Y_SYUKA_TEI_SYUGO_Check_Proc = sts
        Select Case sts
            Case BtNoErr
                If Trim(ID_NO) <> Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) Then
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            Case Else
                Y_SYUKA_TEI_SYUGO_Check_Proc = SYS_ERR
                Exit Function
        End Select
    
    
        If Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) = "" Then
            Found_Flg = True
        End If
        
        If i = -1 Then
            
            
            ID_KANRI_TBL(ING_No).SEK_SYUGO_SYU_YMD = StrConv(Y_SYU_TEI_REC.SYU_YMD, vbUnicode)
            ID_KANRI_TBL(ING_No).SEK_SYUGO_L_TOK_NAME = StrConv(Y_SYU_TEI_REC.L_TOK_NAME, vbUnicode)
            ID_KANRI_TBL(ING_No).SEK_SYUGO_SAI_SU = StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)
            
            i = i + 1
                
            ReDim Preserve ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(0 To i)
            ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_TEI_LABELID = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
            
            
            If Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) = "" Then
                ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_SYUGO_F = False
                Found_Flg = True
            Else
                ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_SYUGO_F = True
            End If
            
            
            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
                ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_KONPO_F = False
                Found_Flg = True
            Else
                ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_KONPO_F = True
            End If
            
            
            
            
        Else
            
            For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL)
                
                If Trim(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_TEI_LABELID) = Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
                    Exit For
                End If
            
            Next i
            
            
            If i > UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL) Then
            
                ReDim Preserve ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(0 To i)
                ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_TEI_LABELID = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                
                
                If Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) = "" Then
                    ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_SYUGO_F = False
                    Found_Flg = True
                Else
                    ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_SYUGO_F = True
                End If
                
                
                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) = "" Then
                    ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_KONPO_F = False
                    Found_Flg = True
                Else
                    ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_KONPO_F = True
                End If
            End If
        
        End If
            
            
        
        
            
        
        com = BtOpGetNext
    
    Loop
    
    Y_SYUKA_TEI_SYUGO_Check_Proc = False
    If i = -1 Then
        Y_SYUKA_TEI_SYUGO_Check_Proc = BtErrEOF
    End If

End Function

Private Sub SEK_SYUGO_CNT_Proc(SEK_SYUGO_CNT As Long)

'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXèoâ◊èWçáç´ïÔÅ@ç´ïÔèÛë‘ÇÃÉJÉEÉìÉgÅx
'               2011.05.12
'
'-------------------------------------------------------
Dim i   As Integer


    SEK_SYUGO_CNT = 0
    For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL)
    
        If ID_KANRI_TBL(ING_No).SEK_SYUGO_TBL(i).SEK_SYUGO_F Then
            SEK_SYUGO_CNT = SEK_SYUGO_CNT + 1
        End If
    
    Next i



End Sub

Private Function SEK_Label_File_Make_Proc(fileName As String, Start_Page_No As Integer, Mai_Su As Integer, TOTAL_Mai_Su As Integer) As Integer
'-------------------------------------------------------
'
'
'   ÅwêœêÖå¸ÇØÅ@â◊éDópÉfÅ[É^ÉtÉ@ÉCÉãçÏê¨Åx
'       2011.05.09
'-------------------------------------------------------
Dim sts         As Integer


Dim FileNo      As Long

Dim FullPath    As String


Dim LCnt        As Integer

Dim OKURI_NO    As Integer


Dim Work        As String * 20


    
Dim c           As String * 128
Dim DEF_FLG     As Boolean

    
    
''''''''''''''''''  ì@ï åüïiéûÅAÇPñáñ⁄Ç©ÇÁâ◊éDî≠çs      2011.05.25
'    If ID_KANRI_TBL(ING_No).SEK_PAGE_NO < SEK_LABEL_PAGE Then
'        ID_KANRI_TBL(ING_No).SEK_PAGE_NO = ID_KANRI_TBL(ING_No).SEK_PAGE_NO + 1
'        SEK_Label_File_Make_Proc = False
'        Exit Function
'    End If
''''''''''''''''''  ì@ï åüïiéûÅAÇPñáñ⁄Ç©ÇÁâ◊éDî≠çs      2011.05.25
    
'sts = MsgBox("â◊éDçÏê¨", vbYesNo, "ÉeÉXÉgóp")
'If sts = vbNo Then
'    SEK_Label_File_Make_Proc = False
'    Exit Function
'End If
    
''''''''''''''''''''''''''''''' 2011.06.29
    If Start_Page_No < SEK_LABEL_PAGE Then
        Mai_Su = Mai_Su - Start_Page_No
    End If
''''''''''''''''''''''''''''''' 2011.06.29
    
    
    
    SEK_Label_File_Make_Proc = True
        
    Start_Page_No = Start_Page_No + 1

    If Right(CtrsWsk1.SendFolder, 1) <> "\" Then
        FullPath = CtrsWsk1.SendFolder & "\" & F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    Else
        FullPath = CtrsWsk1.SendFolder & F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"
    End If


    If GetIni("LABEL", "LABEL_DEF", "F110010LABEL", c) Then
        DEF_FLG = False
    Else
        DEF_FLG = True
    End If


    On Error Resume Next
    Kill (FullPath)             'ëóêMópÉtÉ@ÉCÉãçÌèú
    On Error GoTo 0
        
    FileNo = FreeFile           'ëóêMópÉtÉ@ÉCÉãÇnÇoÇdÇm
    Open FullPath For Output As #FileNo

    Print #FileNo, "#"
    Print #FileNo, "JOB"
    
    
    If DEF_FLG Then
        Print #FileNo, Trim(c)
    Else
        Print #FileNo, "DEF MK=1,DK=8,MD=3,PW=384,PH=344,XO=8,UM=24,BM=0,AF=1"
    End If
    
    Print #FileNo, "START"
    OKURI_NO = Len(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) + 1
    'ëóÇËèÛáÇ(BC)
    If Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_CHARTER_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_AKABOU_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_LOGISTIC_CD) Then
        Print #FileNo, ""
    Else
        
        
        Print #FileNo, "BCD TP=6,X=0,Y=0,RA=1,HT=80,HR=1,MG=0,NS=" & Format(OKURI_NO, "#0") & ",NE=2,NZ=0"
        Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) & Format(Start_Page_No, "00")
    End If
    
    Print #FileNo, "#FONT TP=3,CS=0"
    
    'ëóÇËèÛáÇ
    If Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_CHARTER_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_AKABOU_CD) Or _
        Trim(Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO)) = Trim(KEN_LOGISTIC_CD) Then
        Print #FileNo, ""
    Else
        Print #FileNo, "#TEXT X=33,Y=60,L=1,NS=12,NS=" & Format(OKURI_NO, "#0") & ",NE=2,NZ=0"
        Print #FileNo, "#" & Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_NO) & Format(Start_Page_No, "00")
    End If
    
    
    'àÛç¸ñáêî
    Print #FileNo, "FONT TP=7,CS=0,LG=72,WD=36,LS=0"
    Print #FileNo, "TEXT X=214,Y=245,L=1,NS=1,NE=3,NZ=1"
    Print #FileNo, Format(Start_Page_No, "000") & "/" & Format(TOTAL_Mai_Su, "#")
    
    Print #FileNo, "FONT TP=7,CS=0,LG=36,WD=18,LS=0"
    Print #FileNo, "TEXT X=0,Y=65,L=7"
    
    Print #FileNo, ""
    
    
    
    
    
    
    'èZèä1
    Print #FileNo, Trim(Mid(ID_KANRI_TBL(ING_No).KEN_JYUSHO, 1, 20))
    
    'èZèä2
    Print #FileNo, Trim(Mid(ID_KANRI_TBL(ING_No).KEN_JYUSHO, 21, 20))
    
    'ëóÇËêÊ
    Print #FileNo, Trim(ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
    
    Print #FileNo, ""
    
    'ì˙ït
    Print #FileNo, Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 1, 4) & _
                                               "îN" & Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 5, 2) & _
                                               "åé" & Mid(ID_KANRI_TBL(ING_No).KEN_SYUKA_YMD, 7, 2) & "ì˙"
    


    
    'ëóÇËå≥
    Print #FileNo, "ÇrÇcÇbì‡Å@ïîçﬁó¨í Çb"
    
    
    
    Print #FileNo, "QTY P=" & Format(Mai_Su, "#0")
    Print #FileNo, "END"


    
    Print #FileNo, "JOBE"
    
    fileName = F0_SendFile & Format(ID_KANRI_TBL(ING_No).ID, "000") & ".txt"










    Close #FileNo



    SEK_Label_File_Make_Proc = False


End Function


Private Sub SEK_KUTI_SU_Count_Proc(SAI_SU As Double, KUTI_SU As Integer)
'-------------------------------------------------------
'
'   ÅwêœêÖÉnÉEÉXå¸ÇØèoâ◊ó\íË å˚êîÅ^çÀêîÇÃÉJÉEÉìÉgÅx
'   ëÂç„ÇoÇbóp  2011.05.09
'-------------------------------------------------------
Dim i   As Integer

    KUTI_SU = 0
    SAI_SU = 0

    For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)



'        KUTI_SU = KUTI_SU + ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_KUTI_SU
'        If ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_SAI_SU > 999 Or ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_SAI_SU = 0 Then
        If ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_SAI_SU >= 999999 Then
            SAI_SU = ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_SAI_SU
            Exit For
        Else
            SAI_SU = SAI_SU + ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_SAI_SU
        End If


    Next i


    For i = 0 To UBound(ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL)

        KUTI_SU = KUTI_SU + ID_KANRI_TBL(ING_No).SEK_KENPIN_TBL(i).SEK_KUTI_SU


Debug.Print KUTI_SU

    Next i


End Sub



Private Function Ido_Out_Hin_Furikae_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbïiî‘êUë÷à⁄ìÆèoå…éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx
'
'-------------------------------------------------------
Dim sts             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long


Dim i               As Integer

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8

Dim Hinban          As String * 20

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

    Ido_Out_Hin_Furikae_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Tanaban        'íIî‘
                        FROM_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        If Trim(FROM_Tanaban) = Loc_OK_Para Then 'íIî‘OK
                        Else
                            '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(FROM_Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    Ido_Out_Hin_Furikae_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                            '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                            Call UniCode_Conv(K0_TANA.SOKO_NO, Left(FROM_Tanaban, 2))
                            Call UniCode_Conv(K0_TANA.Retu, Mid(FROM_Tanaban, 3, 2))
                            Call UniCode_Conv(K0_TANA.Ren, Mid(FROM_Tanaban, 5, 2))
                            Call UniCode_Conv(K0_TANA.Dan, Right(FROM_Tanaban, 2))
                            sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                            Select Case sts
                                Case BtNoErr
                                Case BtErrKeyNotFound
                
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                    Ido_Out_Hin_Furikae_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                    Exit Function
                            End Select
            
                            '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                            If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                Ido_Out_Hin_Furikae_Proc = False
                                Exit Function
                            End If
            
                        End If
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
'                        Call UniCode_Conv(K0_ITEM.JGYOBU, ID_KANRI_TBL(ING_No).JGYOBU)
'                        Call UniCode_Conv(K0_ITEM.NAIGAI, ID_KANRI_TBL(ING_No).NAIGAI)
'                        Call UniCode_Conv(K0_ITEM.HIN_GAI, Hinban)
'                        sts = BTRV(BtOpGetEqual, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                                If Trim(TO_Tanaban) = Loc_OK_Para Then
                                    'íIî‘OKéûÇÃíIî‘É`ÉFÉbÉN
                                    Call UniCode_Conv(K0_TANA.SOKO_NO, StrConv(ITEMREC.ST_SOKO, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Retu, StrConv(ITEMREC.ST_RETU, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Ren, StrConv(ITEMREC.ST_REN, vbUnicode))
                                    Call UniCode_Conv(K0_TANA.Dan, StrConv(ITEMREC.ST_DAN, vbUnicode))
                                    sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                                    Select Case sts
                                        Case BtNoErr
                                            FROM_Tanaban = StrConv(TANAREC.SOKO_NO, vbUnicode) & StrConv(TANAREC.Retu, vbUnicode) & StrConv(TANAREC.Ren, vbUnicode) & StrConv(TANAREC.Dan, vbUnicode)
                                        Case BtErrKeyNotFound
                                        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                    
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                            Ido_Out_Hin_Furikae_Proc = False
                                            Exit Function
                                        Case Else
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                            Exit Function
                                    End Select
                                End If
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Ido_Out_Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                End Select
            Next i
            
            '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                                        'FROM é¿íIî‘
            sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
            Select Case sts
                Case False
                Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                    Exit Function
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                Case SYS_CANCEL
                    Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Ido_Out_Hin_Furikae_Proc = False
                    Exit Function
            End Select
                    
            If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                Ido_Out_Hin_Furikae_Proc = False
                Exit Function
            End If
        
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
            ID_KANRI_TBL(ING_No).Tanaban = FROM_Tanaban     'íIî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Hinban = Hinban            'ïiî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
            ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiÇÃêîó 
                                                            
            ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
            ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
                                                            
                                                            
                                                            
                                                            'è§ïiâªópëqå…ãÊï™ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).GOODS_ON_F = StrConv(SOKOREC.GOODS_ON_F, vbUnicode)
            'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
            '-----------------------------------------------ÇPçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(0).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(0).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(0).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(0).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            '-----------------------------------------------ÇQçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(1).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                    Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))

            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                    Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(1).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(1).Start_Pos = "01"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = "01"
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(1).Max_Size = "08"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "08"
                                                                                
            Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
            '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(2).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                             'êîílèâä˙ï\é¶
            Send_Text.Box_Type(2).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                           'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(2).Start_Pos = "01"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(2).Max_Size = "20"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                                                                                
            Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            '-----------------------------------------------ÇSçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(0, "#")))) & Format(0, "#"))
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(0, "#")))) & Format(0, "0"))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(0, "#"))) & Format(0, "#")
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(0, "#"))) & Format(0, "#")
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(3).Max_Size = "05"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                
            Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            '-----------------------------------------------ÇTçsñ⁄
                                                            'BOXëÆê´
'            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
'                                                            'ï\é¶ì‡óe
'            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(MI_QTY, "#0")))) & Format(MI_QTY, "#0"))
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(MI_QTY, "#0")))) & Format(MI_QTY, "#0"))
'                                                            'êîílèâä˙ï\é¶
'            Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(MI_QTY, "#0"))) & Format(MI_QTY, "#0")
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(MI_QTY, "#0"))) & Format(MI_QTY, "#0")
'                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
'                                                            'ì¸óÕåÖêî
'            Send_Text.Box_Type(4).Max_Size = "05"
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
'
'            Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
        
        
        
            Send_Text.Box_Type(4).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(4).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(4).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(4).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        
            Sendbuf = Text_Create_Proc()
        
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiè§ïiÅ^ñ¢è§ïiêîó Åj
            
            QTY = 0
            SUMI_QTY = 0
            MI_QTY = 0
            
            
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
            
            
                    Case LCD_Suryo          'êîó 
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Ido_Out_Hin_Furikae_Proc = False
                            Exit Function
                        End If
                
                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Ido_Out_Hin_Furikae_Proc = False
                            Exit Function
                        End If
            
            
                        If QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                            Ido_Out_Hin_Furikae_Proc = False
                            Exit Function
                        End If
        
                End Select
            Next i
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
            Else
                MENU_NO = ""
            End If
        
            sts = IDO_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"), _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    QTY, _
                                    0, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2), ID_KANRI_TBL(ING_No).Hinban, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Ido_Out_Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Ido_Out_Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Ido_Out_Hin_Furikae_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        
                                        
            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
            sts = Data_Clear_Proc(0, Sendbuf)
            Select Case sts
                Case SYS_CANCEL
                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
            End Select
                                        
                                        'éüÇÃçÏã∆óvãÅ
            
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    Ido_Out_Hin_Furikae_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function


Private Function Hin_Furikae_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbïiî‘êUë÷éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx
'
'   2011.06.01
'-------------------------------------------------------
Dim sts             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long


Dim i               As Integer

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8

Dim Hinban          As String * 20
Dim TO_Hinban       As String * 20


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

    Hin_Furikae_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiêUë÷ëOïiî‘Å^êUë÷å„ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_BEF_Hinban         'êUë÷ëOïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
        
        
        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                                                    'FROM âºëzíIî‘
                        FROM_Tanaban = ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_Proc = False
                                Exit Function
                        End Select
                                
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Hin_Furikae_Proc = False
                            Exit Function
                        End If
        
        
        
        
        
                        ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN = Hinban
        
        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
        
        
        
                        ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                        ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
        
        
                    Case LCD_AFT_Hinban         'êUë÷å„ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                        Call UniCode_Conv(K0_FURIKAE.JGYOBU_MAE, RET_JGYOBU)        '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.NAIGAI_MAE, RET_NAIGAI)        '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.HIN_MAE, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        
                        Call UniCode_Conv(K0_FURIKAE.JGYOBU_GO, RET_JGYOBU)        '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.NAIGAI_GO, RET_NAIGAI)        '2012.03.13
                        
                        
                        Call UniCode_Conv(K0_FURIKAE.HIN_GO, Hinban)
                        sts = BTRV(BtOpGetEqual, FURIKAE_POS, FURIKAEREC, Len(FURIKAEREC), K0_FURIKAE, Len(K0_FURIKAE), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, Hinban, "êUë÷ïiî‘ÉGÉâÅ[", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiî‘êUë÷Çl", 0)
                                Exit Function
                        End Select
                                        
                
                        
                                        
'-----------------------    2011.06.13
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select

                        ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN = Hinban

                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                                    
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
            
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                        Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            
                        '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            
            
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, _
                                        LCD_Tanaban & " " & StrConv(ITEMREC.ST_SOKO, vbUnicode) & "-" & StrConv(ITEMREC.ST_RETU, vbUnicode) & "-" & StrConv(ITEMREC.ST_REN, vbUnicode) & "-" & StrConv(ITEMREC.ST_DAN, vbUnicode))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, _
                                        LCD_Tanaban & " " & StrConv(ITEMREC.ST_SOKO, vbUnicode) & "-" & StrConv(ITEMREC.ST_RETU, vbUnicode) & "-" & StrConv(ITEMREC.ST_REN, vbUnicode) & "-" & StrConv(ITEMREC.ST_DAN, vbUnicode))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "12"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""            'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
            '
                    
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i

'-----------------------    2011.06.13
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    Case LCD_Tanaban    'íIî‘
                        TO_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(TO_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(TO_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ ç¨ç⁄É`ÉFÉbÉN
                        If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                            If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_Proc = False
                                Exit Function
                            End If
                        End If
                        '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_TANA.SOKO_NO, Left(TO_Tanaban, 2))
                        Call UniCode_Conv(K0_TANA.Retu, Mid(TO_Tanaban, 3, 2))
                        Call UniCode_Conv(K0_TANA.Ren, Mid(TO_Tanaban, 5, 2))
                        Call UniCode_Conv(K0_TANA.Dan, Right(TO_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                Hin_Furikae_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
        
                        '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                        If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIégópïsâ¬", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
        
                            Hin_Furikae_Proc = False
                            Exit Function
                        End If
        
                
                
        
                
                
                    ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                    
                    ID_KANRI_TBL(ING_No).Tanaban = TO_Tanaban       'íIî‘ÇÉZÅ[Éu
                                                                
                                                                
                                                                
                    SUMI_QTY = ID_KANRI_TBL(ING_No).Send_SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                    MI_QTY = ID_KANRI_TBL(ING_No).Send_MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
                                                                
                                                                
                                                                'è§ïiâªópëqå…ãÊï™ÇÉZÅ[Éu
                    ID_KANRI_TBL(ING_No).GOODS_ON_F = StrConv(SOKOREC.GOODS_ON_F, vbUnicode)
                    'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                    Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                    ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                    Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                    ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
            
                    Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                    ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                    Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                    ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                    Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                    ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
            
                    Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                    ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                                
                    '-----------------------------------------------ÇPçsñ⁄
                                                                    'BOXëÆê´
                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(0).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
        
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(0).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                    Send_Text.Box_Type(0).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                    Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
        
                    '-----------------------------------------------ÇQçsñ⁄
                                                                    'BOXëÆê´
                    Send_Text.Box_Type(1).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(1).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(1).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                    Send_Text.Box_Type(1).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                    Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                    
                    
                    
                    '-----------------------------------------------ÇRçsñ⁄
                                                                    'BOXëÆê´
                    Send_Text.Box_Type(2).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(2).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(2).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                    Send_Text.Box_Type(2).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                        
                    Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                    
                    
                    '-----------------------------------------------ÇSçsñ⁄
                                                                    'BOXëÆê´
                    Send_Text.Box_Type(3).Box_Type = TYPE_REF
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(3).LCD, _
                                    Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2))
        
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, _
                                    Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2))
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(3).INIT = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                    
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(3).Start_Pos = ""
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
                    Send_Text.Box_Type(3).Max_Size = "00"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                        
                    Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                    '-----------------------------------------------ÇSçsñ⁄
                                                                    'BOXëÆê´
                    Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                    'ï\é¶ì‡óe
                    Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(SUMI_QTY + MI_QTY, "#")))) & Format(SUMI_QTY + MI_QTY, "#"))
                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(SUMI_QTY + MI_QTY, "#")))) & Format(SUMI_QTY + MI_QTY, "#"))
                                                                    'êîílèâä˙ï\é¶
                    Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SUMI_QTY + MI_QTY, "#"))) & Format(SUMI_QTY + MI_QTY, "#")
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(SUMI_QTY + MI_QTY, "#"))) & Format(SUMI_QTY + MI_QTY, "#")
                                                                    'èâä˙ÉJÅ[É\Éãà íu
                    Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
                                                                    'ì¸óÕåÖêî
                    Send_Text.Box_Type(4).Max_Size = "05"
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                                                        
                    Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
        '
                
                    Sendbuf = Text_Create_Proc()
                End Select
            
            
            Next i
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiè§ïiÅ^ñ¢è§ïiêîó Åj
            
            QTY = 0
            SUMI_QTY = 0
            MI_QTY = 0
            
            
            For i = 0 To M_Gyo - 1
            
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
            
            
                    Case LCD_Suryo          'êîó ÅiÇ±Ç±ÇÕñ≥Ç¢Åj
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_Proc = False
                            Exit Function
                        End If
                
                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_Proc = False
                            Exit Function
                        End If
            
            
                        If QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_Proc = False
                            Exit Function
                        End If
            
            
            
            
                End Select
            Next i
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
        
        
            sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, _
                                    "", _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"), _
                                    YOIN_BEF_HINBAN, _
                                    QTY, _
                                    0, 0, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, Trim(ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN) & "Ç÷êUë÷", _
                                    , , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "-" & "01-01-01", ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Hin_Furikae_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
    
    
    
            sts = Nyuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN, _
                                    Format(Now, "YYYYMMDD"), _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    YOIN_AFT_HINBAN, _
                                    QTY, _
                                    0, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, Trim(ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN) & "ÇÊÇËêUë÷", , , , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "-" & "01-01-01", ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Hin_Furikae_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Hin_Furikae_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
    
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        
                                        
                            
            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
            sts = Data_Clear_Proc(0, Sendbuf)
            Select Case sts
                Case SYS_CANCEL
                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
            End Select
                                        
                                        
                                        'éüÇÃçÏã∆óvãÅ
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    Hin_Furikae_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function


Private Function SEK_KYOSEI_END_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwêœêÖã≠êßäÆóπÅiëÂç„ÇoÇbå¸ÇØÅjÅx
'
'       2011.06.28
'-------------------------------------------------------
Dim sts                     As Integer
Dim com                     As Integer

Dim ID_NO                   As String * 20



Dim i                       As Integer
Dim j                       As Integer


Dim SYU_JUN                 As String * 10          'èoâ◊èáî‘
Dim TEI_NM                  As String * 30          'ì@ñº
Dim SYUGO_SYU_YMD           As String * 8           'èoâ◊ämíËì˙
Dim SYUGO_L_TOK_NAME        As String * 50          'ìæà”êÊñº

Dim SYUGO_SUMI_CNT          As Integer
Dim HINB_CD_CNT             As Integer


Dim SEK_KYOSEI_TBL()        As SEK_KYOSEI_TBL_Tag
Dim SEK_KYOSEI_HINB_CD_TBL() _
                            As SEK_KYOSEI_HINB_CD_TBL_Tag
                        


Dim KUTI_SU                 As Integer
Dim SAI_SU                  As Double

Dim In_Word                 As String * 30
Dim Out_Word                As String * 16



    SEK_KYOSEI_END_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiì@ï ÇhÇcÅ^ç´ïÔÇhÇcÅj
        
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SEK_ID_NO      'ì@ï ID/ç´ïÔID
                                
                        ID_NO = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                         
                        Erase SEK_KYOSEI_TBL
                        j = -1
                        com = BtOpGetGreaterEqual
                        If Len(Trim(ID_NO)) > 13 Then
                        'èWçáç´ïÔ
                            Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_NO)
                            
                            Do
                            
                                sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                Select Case sts
                                    Case BtNoErr
                                        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_NO) Then
                                            Exit Do
                                        End If
                                    Case BtErrEOF
                                        Exit Do
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
                        
                        
                                If j = -1 Then
                                    j = j + 1
                                    SYUGO_SYU_YMD = StrConv(Y_SYU_TEI_REC.SYU_YMD, vbUnicode)
                                    SYUGO_L_TOK_NAME = StrConv(Y_SYU_TEI_REC.L_TOK_NAME, vbUnicode)
                                    ReDim Preserve SEK_KYOSEI_TBL(0 To j)
                                    SEK_KYOSEI_TBL(j).SEK_ID = StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)
                                    If Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) <> "" Then
                                        SEK_KYOSEI_TBL(j).SEK_KONPO_F = True
                                    Else
                                        SEK_KYOSEI_TBL(j).SEK_KONPO_F = False
                                    End If
                                    
                                    If IsNumeric(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode)) Then
                                        KUTI_SU = Val(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode))
                                    Else
                                        KUTI_SU = 1
                                    End If
                                    
                                    
                                    If IsNumeric(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) Then
                                        If Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) > 999999 Then
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                        Else
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                        End If
                                    Else
                                        SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                    End If
                                Else
                                
                                    For j = 0 To UBound(SEK_KYOSEI_TBL)
                                                                    
                                        If Trim(SEK_KYOSEI_TBL(j).SEK_ID) = Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) Then
                                            Exit For
                                        End If
                                    
                                    Next j
                                
                                    If j > UBound(SEK_KYOSEI_TBL) Then
                                    
                                        ReDim Preserve SEK_KYOSEI_TBL(0 To j)
                                        SEK_KYOSEI_TBL(j).SEK_ID = StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)
                                        If Trim(StrConv(Y_SYU_TEI_REC.SYUGO_KONPO_TANTO, vbUnicode)) <> "" Then
                                            SEK_KYOSEI_TBL(j).SEK_KONPO_F = True
                                        Else
                                            SEK_KYOSEI_TBL(j).SEK_KONPO_F = False
                                        End If
                                    
                                    
                                        If IsNumeric(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) Then
                                            If Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) > 999999 Then
                                                SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                            Else
                                                SEK_KYOSEI_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                    
                                    
                                            End If
                                        Else
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                        End If
                                    End If
                                
                                End If
                                com = BtOpGetNext
                            Loop
                        Else
                        'ì@ï ç´ïÔ
                            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_NO)
                            Erase SEK_KYOSEI_HINB_CD_TBL
                            Do
                            
                                sts = BTRV(com, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                Select Case sts
                                    Case BtNoErr
                                        If Left(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode), 7) <> Left(ID_NO, 7) Then
                                            Exit Do
                                        End If
                                    Case BtErrEOF
                                        Exit Do
                                    Case Else
                                        Call File_Error(sts, BtOpGetEqual + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                        Sendbuf = Text_Create_Proc()
                                        Exit Function
                                End Select
                        
                        
                                If j = -1 Then
                                    j = j + 1
                                    SYU_JUN = Trim(StrConv(Y_SYU_TEI_REC.SYU_JUN, vbUnicode))
                                    TEI_NM = Trim(StrConv(Y_SYU_TEI_REC.TEI_NM, vbUnicode))
                                    
                                    ReDim Preserve SEK_KYOSEI_TBL(0 To j)
                                    SEK_KYOSEI_TBL(j).SEK_ID = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                    If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                        SEK_KYOSEI_TBL(j).SEK_KONPO_F = True
                                    Else
                                        SEK_KYOSEI_TBL(j).SEK_KONPO_F = False
                                    End If
                                    
                                    If IsNumeric(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode)) Then
                                        KUTI_SU = Val(StrConv(Y_SYU_TEI_REC.KUTI_SU, vbUnicode))
                                    Else
                                        KUTI_SU = 1
                                    End If
                                
                                
                                
                                    If IsNumeric(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) Then
                                        SEK_KYOSEI_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                        If SEK_KYOSEI_TBL(j).SEK_SAI_SU > 999 Then
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                        End If
                                    Else
                                        SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                    
                                    End If
                                
                                
                                    If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) = Trim(ID_NO) Then
                                        ReDim Preserve SEK_KYOSEI_HINB_CD_TBL(0 To j)
                                        SEK_KYOSEI_HINB_CD_TBL(j).SEK_HINB_CD = Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode))
                                        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                            SEK_KYOSEI_HINB_CD_TBL(j).SEK_KONPO_F = True
                                        Else
                                            SEK_KYOSEI_HINB_CD_TBL(j).SEK_KONPO_F = False
                                        End If
                                    End If
                                Else
                                
                                    For j = 0 To UBound(SEK_KYOSEI_TBL)
                                                                    
                                        If Trim(SEK_KYOSEI_TBL(j).SEK_ID) = Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) Then
                                            Exit For
                                        End If
                                    Next j
                                
                                    If j > UBound(SEK_KYOSEI_TBL) Then
                                        ReDim Preserve SEK_KYOSEI_TBL(0 To j)
                                        SEK_KYOSEI_TBL(j).SEK_ID = StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)
                                        If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                            SEK_KYOSEI_TBL(j).SEK_KONPO_F = True
                                        Else
                                            SEK_KYOSEI_TBL(j).SEK_KONPO_F = False
                                        End If
                                    
                                    
                                        If IsNumeric(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode)) Then
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = Val(StrConv(Y_SYU_TEI_REC.SAI_SU, vbUnicode))
                                            If SEK_KYOSEI_TBL(j).SEK_SAI_SU > 999 Then
                                                SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                            End If
                                        
                                        Else
                                            SEK_KYOSEI_TBL(j).SEK_SAI_SU = 0
                                        End If
                                    
                                    End If
                                
                                
                                
                                    If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) = Trim(ID_NO) Then
                                        
'2011.11.18                                        For j = 0 To UBound(SEK_KYOSEI_TBL)
                                        For j = 0 To UBound(SEK_KYOSEI_HINB_CD_TBL)
                                                                        
                                            If Trim(SEK_KYOSEI_HINB_CD_TBL(j).SEK_HINB_CD) = Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode)) Then
                                                Exit For
                                            End If
                                        Next j
                                        
'2011.11.18                                        If j > UBound(SEK_KYOSEI_TBL) Then
                                        If j > UBound(SEK_KYOSEI_HINB_CD_TBL) Then
                                        
                                            ReDim Preserve SEK_KYOSEI_HINB_CD_TBL(0 To j)
                                            SEK_KYOSEI_HINB_CD_TBL(j).SEK_HINB_CD = Trim(StrConv(Y_SYU_TEI_REC.HINB_CD, vbUnicode))
                                            If Trim(StrConv(Y_SYU_TEI_REC.KONPO_TANTO, vbUnicode)) <> "" Then
                                                SEK_KYOSEI_HINB_CD_TBL(j).SEK_KONPO_F = True
                                            Else
                                                SEK_KYOSEI_HINB_CD_TBL(j).SEK_KONPO_F = False
                                            End If
                                        End If
                                    End If
                                
                                
                                
                                End If
                                com = BtOpGetNext
                            Loop
                        End If
                                        
                        If j = -1 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_NO, "íçï∂√ﬁ∞¿Ç»Çµ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_KYOSEI_END_PROC = False
                            Exit Function
                        End If
                                                            
                        ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID = ID_NO
                                                            
                                                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        If Len(Trim(ID_NO)) > 13 Then
                            'èWçáç´ïÔ
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            In_Word = Trim(SYUGO_L_TOK_NAME)
                            Call Moji_Cut_Proc(In_Word, Out_Word, 20)
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(Out_Word))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                            'èWçáç´ïÔèÛë‘ÇÃÉJÉEÉìÉg
                            SYUGO_SUMI_CNT = 0
                            For j = 0 To UBound(SEK_KYOSEI_TBL)
                                If SEK_KYOSEI_TBL(j).SEK_KONPO_F Then
                                    SYUGO_SUMI_CNT = SYUGO_SUMI_CNT + 1
                                End If
                            Next j
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Mid(SYUGO_SYU_YMD, 1, 4) & "/" & Mid(SYUGO_SYU_YMD, 5, 2) & "/" & Mid(SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(SEK_KYOSEI_TBL) + 1, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Mid(SYUGO_SYU_YMD, 1, 4) & "/" & Mid(SYUGO_SYU_YMD, 5, 2) & "/" & Mid(SYUGO_SYU_YMD, 7, 2) & _
                                                                        " (" & Format(SYUGO_SUMI_CNT, "#0") & "/" & Format(UBound(SEK_KYOSEI_TBL) + 1, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        Else
                            'ì@ï ç´ïÔ
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID), 2)), "#0") & "/" & Format(UBound(SEK_KYOSEI_TBL) + 1, "#0") & ")")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, Left(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID, 7) & "    " & _
                                                    "(" & Format(Val(Right(Trim(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID), 2)), "#0") & "/" & Format(UBound(SEK_KYOSEI_TBL) + 1, "#0") & ")")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            
                            '-----------------------------------------------ÇQçsñ⁄
                            In_Word = TEI_NM
                            Call Moji_Cut_Proc(In_Word, Out_Word, 16)
                                                                                    
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Trim(SYU_JUN) & " " & Out_Word)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Trim(SYU_JUN) & " " & Out_Word)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            
                            'ïiî‘èÛë‘ÇÃÉJÉEÉìÉg
                            HINB_CD_CNT = 0
                            
                            For j = 0 To UBound(SEK_KYOSEI_HINB_CD_TBL)
                                If SEK_KYOSEI_HINB_CD_TBL(j).SEK_KONPO_F Then
                                    HINB_CD_CNT = HINB_CD_CNT + 1
                                End If
                            Next j
                                                        
                                                        
                            
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(UBound(SEK_KYOSEI_HINB_CD_TBL) + 1, "#0)"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "çÀêîì¸óÕ" & "(" & Format(HINB_CD_CNT, "#0/") & Format(UBound(SEK_KYOSEI_HINB_CD_TBL) + 1, "#0)"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        End If
                        '-----------------------------------------------ÇSçsñ⁄
                        
'                        KUTI_SU = 0
'                        For j = 0 To UBound(SEK_KYOSEI_TBL)
'
'                            If SEK_KYOSEI_TBL(j).SEK_ID = ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID Then
'                                KUTI_SU = KUTI_SU + SEK_KYOSEI_TBL(j)
'                            End If
'
'                        Next j
                        
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_KUTI_SU_S)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(Trim(Format(KUTI_SU, "#0")))) & Trim(Format(KUTI_SU, "#0"))
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Trim(Format(KUTI_SU, "#0")))) & Trim(Format(KUTI_SU, "#0"))
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "12"
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "04"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "04"
                        '-----------------------------------------------ÇTçsñ⁄
                        SAI_SU = 0
                        For j = 0 To UBound(SEK_KYOSEI_TBL)
                        
                            If SEK_KYOSEI_TBL(j).SEK_ID = ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID Then
                                SAI_SU = SAI_SU + SEK_KYOSEI_TBL(j).SEK_SAI_SU
                            End If
                        
                        Next j
                        
                        
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_SAI_SU_S)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(SAI_SU, "#0.00")))) & Trim(Format(SAI_SU, "#0.00"))
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Trim(Format(SAI_SU, "#0.00")))) & Trim(Format(SAI_SU, "#0.00"))
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "12"
                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                        Sendbuf = Text_Create_Proc()
                            
                        SEK_KYOSEI_END_PROC = False
                        Exit Function
                            
                End Select
            Next i
        
                
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêM(å˚êî,ì¸ÇËêîÅj
                
                
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    'å˚êî
                    Case LCD_KUTI_SU_S
                    
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                    
                        KUTI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If KUTI_SU <= 0 Then
                        
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "å˚êîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                    
                    'çÀêî
                    Case LCD_SAI_SU_S
                
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                
                        SAI_SU = Val(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                
                
                        If SAI_SU <= 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "çÀêîÉGÉâÅ[", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            SEK_KYOSEI_END_PROC = False
                            Exit Function
                        
                        End If
                
                
                        '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                        sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                            Exit Function
                        End If
                        '------------------------------------   íçï∂√ﬁ∞¿ÇÃèàóù
                        If Len(Trim(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID)) > 13 Then
                        
                            Call UniCode_Conv(K3_Y_SYU_TEI.KONPO_ID, ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID)
                            com = BtOpGetGreaterEqual
            
                            Do
                    
                                DoEvents
                
                                Do
                    
                                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrEOF
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                
                                Loop
            
                
                                If sts = BtErrEOF Then
                                    Exit Do
                                End If
                    
                                If Trim(StrConv(Y_SYU_TEI_REC.KONPO_ID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID) Then
                                    Exit Do
                                End If
                        
                
                                Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(SAI_SU, "000.00"))
                            
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                        
                        
                
                                Do
                                    DoEvents
                                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K3_Y_SYU_TEI, Len(K3_Y_SYU_TEI), 3)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                
                    
                                com = BtOpGetNext
                
                
                            Loop
                        
                        Else
                            Call UniCode_Conv(K1_Y_SYU_TEI.TEI_LABELID, ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID)
                            com = BtOpGetGreaterEqual
            
                            Do
                    
                                DoEvents
                
                                Do
                    
                                    sts = BTRV(com + BtSNoWait, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrEOF
                                            Exit Do
                                        Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, com + BtSNoWait, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                
                                Loop
            
                
                                If sts = BtErrEOF Then
                                    Exit Do
                                End If
                    
                                If Trim(StrConv(Y_SYU_TEI_REC.TEI_LABELID, vbUnicode)) <> Trim(ID_KANRI_TBL(ING_No).SEK_KYOSEI_END_ID) Then
                                    Exit Do
                                End If
                        
                
                                Call UniCode_Conv(Y_SYU_TEI_REC.KUTI_SU, Format(KUTI_SU, "0000"))
                                Call UniCode_Conv(Y_SYU_TEI_REC.SAI_SU, Format(SAI_SU, "000.00"))
                            
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_TANTO, StrConv(App.EXEName, vbUpperCase))
                                Call UniCode_Conv(Y_SYU_TEI_REC.UPD_DATETIME, Format(Now, "YYYYMMDDHHMMSS"))
                        
                        
                
                                Do
                                    DoEvents
                                    sts = BTRV(BtOpUpdate, Y_SYU_TEI_POS, Y_SYU_TEI_REC, Len(Y_SYU_TEI_REC), K1_Y_SYU_TEI, Len(K1_Y_SYU_TEI), 1)
                                    Select Case sts
                                        Case BtNoErr
                                            Exit Do
                                        Case BtErrKeyNotFound
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^ïsñæ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                         Case BtErrFILE_INUSE, BtErrRECORD_INUSE
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ID_KANRI_TBL(ING_No).ID_NO, "ì@ï íçï∂ÉfÅ[É^égópíÜ", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            SEK_KYOSEI_END_PROC = False
                                            GoTo Abort_Tran
                                        Case Else
                                            Call File_Error(sts, BtOpUpdate, "ì@ï íçï∂ÉfÅ[É^", 0)
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            GoTo Abort_Tran
                                    End Select
                                Loop
                
                    
                                com = BtOpGetNext
                
                
                            Loop
                        End If
                            'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                        sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                        If sts <> BtNoErr Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Call File_Error(sts, BtOpEndTransaction, "", 0)
                            GoTo Abort_Tran
                        End If
    
    
                        'éüÇÃçÏã∆óvãÅ
                        Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                        Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                        sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                        Select Case sts
                            Case BtNoErr
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            Case Else
                            'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                        
                        If Sagyo_Send_Proc() Then
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                    
                        Sendbuf = Text_Create_Proc()
                    
                End Select
            Next i
                
    End Select

    SEK_KYOSEI_END_PROC = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If


End Function


Private Function NYUKO_KENPIN_OSAKA_S_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@éëçﬁåüé˚ì¸å…Åx
'
'   2012.03.06
'
'-------------------------------------------------------
Dim i               As Integer


Dim Hinban          As String * 20
Dim Tanaban         As String * 8
Dim QTY             As Long

Dim sts             As Integer


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2


Dim wkORDER_QTY     As Long
Dim wkNYUKO_QTY     As Long
Dim wkQty           As Long

Dim ST_TANABAN      As String * 11


    NYUKO_KENPIN_OSAKA_S_Proc = True


    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj

            For i = 0 To M_Gyo - 1
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                        
                                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        
                                NYUKO_KENPIN_OSAKA_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        
                        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        If Trim(StrConv(ITEMREC.ST_SOKO, vbUnicode)) = "" Then
                            ST_TANABAN = ""
                        Else
                            ST_TANABAN = StrConv(ITEMREC.ST_SOKO, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_RETU, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_REN, vbUnicode) & "-" & _
                                            StrConv(ITEMREC.ST_DAN, vbUnicode)
                        End If
                        
                        
                        
                        'ìñåéédì¸ó\íËécèWåv
                        If ORDER_ZAN_Proc(RET_JGYOBU, NAIGAI_NAI, Hinban, wkORDER_QTY, wkNYUKO_QTY) Then
                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                            Sendbuf = Text_Create_Proc()
                            Exit Function
                        End If
                        
                        ID_KANRI_TBL(ING_No).ORDER_QTY = wkORDER_QTY
                        ID_KANRI_TBL(ING_No).NYUKO_QTY = wkNYUKO_QTY
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban & " " & ST_TANABAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban & " " & ST_TANABAN)
                                                                                
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "16"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "16"
                                                                                
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                    
                    
                    

                        Sendbuf = Text_Create_Proc()
                        
                        Exit Function
                
                End Select
            Next i
    
    
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
                    Case LCD_Tanaban        'íIî‘
                        Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        
                        '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                    
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                NYUKO_KENPIN_OSAKA_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ ç¨ç⁄É`ÉFÉbÉN
                        If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                            If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).S_JGYOBU Or _
                                StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                NYUKO_KENPIN_OSAKA_S_Proc = False
                                Exit Function
                            End If
                        End If
                        '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_TANA.SOKO_NO, Left(Tanaban, 2))
                        Call UniCode_Conv(K0_TANA.Retu, Mid(Tanaban, 3, 2))
                        Call UniCode_Conv(K0_TANA.Ren, Mid(Tanaban, 5, 2))
                        Call UniCode_Conv(K0_TANA.Dan, Right(Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                    
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                        
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                                NYUKO_KENPIN_OSAKA_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
                    
                        '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                        If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                                
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2), "íIégópïsâ¬", "", "")
                    
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            Exit Function
                        End If
                        ID_KANRI_TBL(ING_No).Tanaban = Tanaban
    
    
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, _
                            Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))

                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, _
                            Left(Tanaban, 2) & "-" & Mid(Tanaban, 3, 2) & "-" & Mid(Tanaban, 5, 2) & "-" & Right(Tanaban, 2))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "íçéc(" & USE_YM & "):" & Format(ID_KANRI_TBL(ING_No).ORDER_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "íçéc(" & USE_YM & "):" & Format(ID_KANRI_TBL(ING_No).ORDER_QTY, "#0"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""

                        '-----------------------------------------------ÇTçsñ⁄
                                                            'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        
                        wkQty = ID_KANRI_TBL(ING_No).ORDER_QTY - ID_KANRI_TBL(ING_No).NYUKO_QTY
                        If wkQty < 0 Then
                            wkQty = 0
                        End If
                        
                        
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_Suryo)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_Suryo)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(wkQty, "#0"))) & Format(wkQty, "#0")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(wkQty, "#0"))) & Format(wkQty, "#0")
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                        
                        NYUKO_KENPIN_OSAKA_S_Proc = False
                        Exit Function
                End Select
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiêîó Åj
            For i = 0 To M_Gyo - 1
            
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
            
            
                    Case LCD_Suryo          'êîó 
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            Exit Function
                        End If
                
                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            Exit Function
                        End If
                
                
                        If QTY <= (ID_KANRI_TBL(ING_No).ORDER_QTY - ID_KANRI_TBL(ING_No).NYUKO_QTY) Then
                        
                        
                                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                                                                
                                                                
                            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                        
                            Else
                                        
                                MENU_NO = ""
                            End If
                                                                'ì¸å…çXêV
                            sts = Nyuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).Hinban, _
                                                    Format(Now, "YYYYMMDD"), _
                                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    QTY, _
                                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, , , , , MENU_NO)
                            Select Case sts
                                Case False
                                Case True           'ì¸å…éûÇÕî≠ê∂ÇµÇ»Ç¢
                                Case SYS_CANCEL
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    
                                    NYUKO_KENPIN_OSAKA_S_Proc = False
                                    GoTo Abort_Tran
                                Case SYS_ERR
                                    Sendbuf = Text_Create_Proc()
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    NYUKO_KENPIN_OSAKA_S_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                                    
                                    GoTo Abort_Tran
                            End Select
                                        
                            GoTo End_Tran
                        
                                                    
                        Else
                        
                            ID_KANRI_TBL(ING_No).INPUT_QTY = QTY
                        
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DOUBLE                        'ÉuÉUÅ[âπÅ@ìÒèdåxçêâπ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                            
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
'                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
'                                                                                    'ï\é¶ì‡óe
'                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
'                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
'                                                                                    'êîílèâä˙ï\é¶
'                            Send_Text.Box_Type(0).INIT = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
'                                                                                    'èâä˙ÉJÅ[É\Éãà íu
'                            Send_Text.Box_Type(0).Start_Pos = ""
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
'                                                                                    'ì¸óÕåÖêî
'                            Send_Text.Box_Type(0).Max_Size = "00"
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
'
'                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
'                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).Hinban)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "íçï∂éc:" & Format(ID_KANRI_TBL(ING_No).ORDER_QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "íçï∂éc:" & Format(ID_KANRI_TBL(ING_No).ORDER_QTY, "#0"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "ëçì¸å…êî:" & Format(ID_KANRI_TBL(ING_No).NYUKO_QTY + QTY, "#0"))
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "ëçì¸å…êî:" & Format(ID_KANRI_TBL(ING_No).NYUKO_QTY + QTY, "#0"))
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        
                            '-----------------------------------------------ÇSçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "íIì¸ÇÍÇçsÇ¢Ç‹Ç∑Ç©ÅH")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "íIì¸ÇÍÇçsÇ¢Ç‹Ç∑Ç©ÅH")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        
                            '-----------------------------------------------ÇTçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_CAN_ANS)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_CAN_ANS)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = "20"                  'êîílÇÕÇTåÖå≈íË
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "20"
                                                                                    'ì¸óÕåÖêî
                             Send_Text.Box_Type(4).Max_Size = "01"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "01"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
    
                            Sendbuf = Text_Create_Proc()
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            
                            Exit Function
                        End If
                
                End Select
            Next i
    
    
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅièàóùåpë±(Y/N)Åj
            
            
            
            For i = 0 To M_Gyo - 1
            
                
                Select Case Trim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
            
            
                    Case LCD_CAN_ANS          'êîó 
                        If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) <> "1" And Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) <> "9" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "1 OR 9 Çì¸óÕ", "ÇµÇƒâ∫Ç≥Ç¢ÅB", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            Exit Function
                        End If
                
                
                
                        If Trim(ID_KANRI_TBL(ING_No).Recv_text(i)) = "1" Then
                                                                'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                            If sts <> BtNoErr Then
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                Exit Function
                            End If
                                                                
                                                                
                            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                        
                            Else
                                        
                                MENU_NO = ""
                            End If
                                                                'ì¸å…çXêV
                            sts = Nyuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                                    ID_KANRI_TBL(ING_No).Hinban, _
                                                    Format(Now, "YYYYMMDD"), _
                                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                    0, _
                                                    ID_KANRI_TBL(ING_No).INPUT_QTY, _
                                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    FILE_RETRY, , , , , MENU_NO)
                            Select Case sts
                                Case False
                                Case True           'ì¸å…éûÇÕî≠ê∂ÇµÇ»Ç¢
                                Case SYS_CANCEL
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                    
                                    NYUKO_KENPIN_OSAKA_S_Proc = False
                                    GoTo Abort_Tran
                                Case SYS_ERR
                                    Sendbuf = Text_Create_Proc()
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    NYUKO_KENPIN_OSAKA_S_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                                    
                                    GoTo Abort_Tran
                            End Select
                                        
                            GoTo End_Tran
                        Else
                                                                'éüÇÃçÏã∆óvãÅ
                            
                            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
                            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
                            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
                            Select Case sts
                                Case BtNoErr
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Case Else
                                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                                Exit Function
                            End Select
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
                            If Sagyo_Send_Proc() Then
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            End If
                                    
                            Sendbuf = Text_Create_Proc()
                            
                            
                            
                            NYUKO_KENPIN_OSAKA_S_Proc = False
                            
                            Exit Function
                        
                        End If
            
                End Select
            Next i
    End Select

End_Tran:
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
    sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpEndTransaction, "", 0)
        GoTo Abort_Tran
    End If
                                        'éüÇÃçÏã∆óvãÅ
    
    Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
    Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
    sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
    Select Case sts
        Case BtNoErr
        '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
        Case Else
        'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
        Exit Function
    End Select
    
    
    ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
    If Sagyo_Send_Proc() Then
        Sendbuf = Text_Create_Proc()
        Exit Function
    End If
            
    Sendbuf = Text_Create_Proc()
    
    
    
    NYUKO_KENPIN_OSAKA_S_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function
Private Function ORDER_ZAN_Proc(JGYOBU As String, NAIGAI As String, Hinban As String, ORDER_QTY As Long, NYUKO_QTY As Long) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@éëçﬁíçï∂écèWåvÅx
'
'   2012.03.06
'
'-------------------------------------------------------
Dim com         As Integer
Dim sts         As Integer
    
    
Dim i           As Integer
    
Dim wkJgyobu    As String * 1
    
    
    ORDER_ZAN_Proc = True
    
    If JGYOBU = BUZAI Then
        wkJgyobu = SHIZAI
    Else
        wkJgyobu = JGYOBU
    End If
    
    Call UniCode_Conv(K7_P_SHORDER.USE_YM, USE_YM)
    Call UniCode_Conv(K7_P_SHORDER.JGYOBU, wkJgyobu)
    Call UniCode_Conv(K7_P_SHORDER.NAIGAI, NAIGAI)
    Call UniCode_Conv(K7_P_SHORDER.HIN_GAI, Hinban)
    Call UniCode_Conv(K7_P_SHORDER.CANCEL_F, P_CANCEL_OFF)
    
    ORDER_QTY = 0
    com = BtOpGetGreaterEqual
    
        
    Do
        
        DoEvents
        
        sts = BTRV(com, P_SHORDER_POS, P_SHORDER_REC, Len(P_SHORDER_REC), K7_P_SHORDER, Len(K7_P_SHORDER), 7)
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_SHORDER_REC.USE_YM, vbUnicode) <> USE_YM Or _
                    StrConv(P_SHORDER_REC.JGYOBU, vbUnicode) <> wkJgyobu Or _
                    StrConv(P_SHORDER_REC.NAIGAI, vbUnicode) <> NAIGAI Or _
                    RTrim(StrConv(P_SHORDER_REC.HIN_GAI, vbUnicode)) <> RTrim(Hinban) Or _
                    StrConv(P_SHORDER_REC.CANCEL_F, vbUnicode) <> P_CANCEL_OFF Then
                       
                    Exit Do
                    
                End If
            
            Case BtErrEOF
                Exit Do
            
            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
            Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call File_Error(sts, BtOpGetEqual, "éëçﬁíçï∂√ﬁ∞¿", 0)
                Exit Function
        End Select
    
        ORDER_QTY = ORDER_QTY + (Val(StrConv(P_SHORDER_REC.ORDER_QTY, vbUnicode)) - Val(StrConv(P_SHORDER_REC.UKEIRE_QTY, vbUnicode)))
    
        com = BtOpGetNext
    
    Loop
    
    Call UniCode_Conv(K1_IDO.JGYOBU, JGYOBU)
    Call UniCode_Conv(K1_IDO.NAIGAI, NAIGAI)
    Call UniCode_Conv(K1_IDO.HIN_GAI, Hinban)
    Call UniCode_Conv(K1_IDO.JITU_DT, BUZAI_DATE_S)
    Call UniCode_Conv(K1_IDO.JITU_TM, "")
    NYUKO_QTY = 0
    com = BtOpGetGreaterEqual
    
    Do
        
        DoEvents
        
        sts = BTRV(com, IDO_POS, IDOREC, Len(IDOREC), K1_IDO, Len(K1_IDO), 1)
        Select Case sts
            Case BtNoErr
            
                If StrConv(IDOREC.JGYOBU, vbUnicode) <> JGYOBU Or _
                    StrConv(IDOREC.NAIGAI, vbUnicode) <> NAIGAI Or _
                    RTrim(StrConv(IDOREC.HIN_GAI, vbUnicode)) <> RTrim(Hinban) Or _
                    StrConv(IDOREC.JITU_DT, vbUnicode) > BUZAI_DATE_E Then
                       
                    Exit Do
                    
                End If
            
            Case BtErrEOF
                Exit Do
            
            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
            Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call File_Error(sts, BtOpGetEqual, "ç›å…à⁄ìÆó", 0)
                Exit Function
        End Select
    
    
    
            
    
        For i = 0 To UBound(IN_TANA_S_OSAKA)
        
            If StrConv(IDOREC.RIRK_ID, vbUnicode) = IN_TANA_S_OSAKA(i) Then
            
                NYUKO_QTY = NYUKO_QTY + (Val(StrConv(IDOREC.SUMI_JITU_QTY, vbUnicode)) + Val(StrConv(IDOREC.MI_JITU_QTY, vbUnicode)))
                    
            
            End If
        
        Next i
        
        com = BtOpGetNext
    
    Loop
    
    
    
    
    ORDER_ZAN_Proc = False

End Function
Private Function Ido_Out_OSAKA_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@ïîçﬁópà⁄ìÆèoå…éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx
'       2012.03.10
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long


Dim i               As Integer
Dim j               As Integer      '2012.03.29

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8

Dim Hinban          As String * 20

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim SHIJI_No        As String * 8
Dim Found_F         As Boolean

Dim MENU_NO         As String * 2

Dim fileName        As String

Dim wkQty           As Long         '2012.04.07
Dim SYUKO_QTY       As Long         '2012.04.07


Dim Hinban_GO       As String * 20  '2012.12.27


    Ido_Out_OSAKA_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ï[áÇÅj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SHIJI_NO       'éwê}ï[áÇ
                        SHIJI_No = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, SHIJI_No)
                        
                        
                        sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ñ¢ìoò^Ç≈Ç∑", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Ido_Out_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "è§ïiâªéwê}ï[(êe)", 0)
                                Ido_Out_OSAKA_Proc = SYS_ERR
                                Exit Function
                        End Select
                        'ÉLÉÉÉìÉZÉãçœ
                        If StrConv(P_SSHIJI_O_REC.CANCEL_F, vbUnicode) = "1" Then
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
                        'äÆóπçœ
                        If StrConv(P_SSHIJI_O_REC.KAN_F, vbUnicode) = "1" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
                        ID_KANRI_TBL(ING_No).SHIJI_No = SHIJI_No
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & SHIJI_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & SHIJI_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "09"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                        Ido_Out_OSAKA_Proc = False
                        Exit Function
            
                End Select
            Next i
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Å^ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case RTrim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    Case LCD_Tanaban        'íIî‘
                        FROM_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(FROM_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(FROM_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Ido_Out_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_TANA.SOKO_NO, Left(FROM_Tanaban, 2))
                        Call UniCode_Conv(K0_TANA.Retu, Mid(FROM_Tanaban, 3, 2))
                        Call UniCode_Conv(K0_TANA.Ren, Mid(FROM_Tanaban, 5, 2))
                        Call UniCode_Conv(K0_TANA.Dan, Right(FROM_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                Ido_Out_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                        If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIégópïsâ¬", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
        
                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        '------------------ ïiñ⁄É}ÉXÉ^ì«çûÇ›
                        
                        For j = 0 To UBound(JGYOBU_T)
                            
                            If JGYOBU_T(j).CODE = SHIZAI Then
                                sts = Item_Read_Proc(JGYOBU_T(j).CODE, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                            Else
                                sts = Item_Read_Proc(JGYOBU_T(j).CODE, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                            End If
                            Select Case sts
                                Case BtNoErr
                                    Exit For
                                Case BtErrKeyNotFound
                                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                                
                                    Sendbuf = Text_Create_Proc()
                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            
                                    Ido_Out_OSAKA_Proc = False
                                    Exit Function
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                    Exit Function
                            End Select
                        Next j
                        
                                                
                        
                        '------------------ éqïiî‘ÇÃóLñ≥
                        Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
                        Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
                        Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")
        
                        Found_F = False
                        com = BtOpGetGreater
        
                        Do
                            
                            DoEvents
                            sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
                            Select Case sts
                                Case BtNoErr
                                    If ID_KANRI_TBL(ING_No).SHIJI_No <> StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) Then
                                        Exit Do
                                    End If
                                
                                    If RTrim(Hinban) = RTrim(StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)) Then
                                        
                                        
                                        '>>>>>>>>>>>>>>>>>>>>>>>>êUë÷åüçı   2012.12.27
                                        
                                        If Fueikae_Read_Proc(Hinban, Hinban_GO) Then
                                            Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                            Sendbuf = Text_Create_Proc()
                                            Exit Function
                                        End If
                                        
                                        If Trim(Hinban_GO) <> "" Then
                                            Hinban = Hinban_GO
                                            SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.HIKIATE_QTY, vbUnicode))
                                            ID_KANRI_TBL(ING_No).KO_SHIJI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode)) * Val(StrConv(FURIKAEREC.CUT_SU, vbUnicode))
                                        Else
                                            
                                            SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode)) - Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI_QTY, vbUnicode))                           '2012.04.13
                                            ID_KANRI_TBL(ING_No).KO_SHIJI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))
                                        
                                        
                                        End If
                                        '>>>>>>>>>>>>>>>>>>>>>>>>êUë÷åüçı   2012.12.27
                                        
                                        
                                        'ID_KANRI_TBL(ING_No).Send_MI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))    2012.04.07
                                        'SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))                           2012.04.13
'2012.12.27                                        SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode)) - Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI_QTY, vbUnicode))                           '2012.04.13
'2012.12.27                                        ID_KANRI_TBL(ING_No).KO_SHIJI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))    '2012.04.13
                                        
                                        
                                        Found_F = True
                                        Exit Do
                                    End If
                                
                                Case BtErrEOF
                                    Exit Do
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpGetEqual, "éwê}ï[(éq)", 0)
                                    Exit Function
                            End Select
                            
                            com = BtOpGetNext
                        
                        Loop
        
        
                        If Not Found_F Then
                            
                            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.27
                            
'                            '-------------------------------------  ì«Ç›ë÷Ç¶ÉRÅ[ÉhÇ≈çƒì«Ç›çûÇ›  2012.04.05
'
'                            '------------------ éqïiî‘ÇÃóLñ≥
'                            Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
'                            Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
'                            Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")
'
'
'                            com = BtOpGetGreater
'
'                            Do
'
'                                DoEvents
'                                sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
'                                Select Case sts
'                                    Case BtNoErr
'                                        If ID_KANRI_TBL(ING_No).SHIJI_No <> StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) Then
'                                            Exit Do
'                                        End If
'                                        Call UniCode_Conv(K1_FURIKAE.JGYOBU_GO, BUZAI)
'                                        Call UniCode_Conv(K1_FURIKAE.NAIGAI_GO, NAIGAI_NAI)
'                                        Call UniCode_Conv(K1_FURIKAE.HIN_GO, Hinban)
'
'                                        Call UniCode_Conv(K1_FURIKAE.JGYOBU_MAE, BUZAI)
'                                        Call UniCode_Conv(K1_FURIKAE.NAIGAI_MAE, NAIGAI_NAI)
'                                        Call UniCode_Conv(K1_FURIKAE.HIN_MAE, StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode))
'
'
'                                        sts = BTRV(BtOpGetEqual, FURIKAE_POS, FURIKAEREC, Len(FURIKAEREC), K1_FURIKAE, Len(K1_FURIKAE), 1)
'                                        Select Case sts
'                                            Case BtNoErr
'
'                                                'ID_KANRI_TBL(ING_No).Send_MI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))    2012.04.07
'                                                'SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))                           2012.04.13
'                                                SYUKO_QTY = Val(StrConv(P_SSHIJI_K_REC.HIKIATE_QTY, vbUnicode))                             '2012.04.13
'                                                ID_KANRI_TBL(ING_No).KO_SHIJI_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_SHIJI_QTY, vbUnicode))    '2012.04.13
'
'                                                Found_F = True
'                                                Exit Do
'
'                                            Case BtErrKeyNotFound
'
'
'                                            Case Else
'                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                                Sendbuf = Text_Create_Proc()
'                                                Call File_Error(sts, BtOpGetEqual, "ïiî‘êUë÷É}ÉXÉ^", 0)
'                                                Exit Function
'                                        End Select
'
'                                    Case BtErrEOF
'                                        Exit Do
'                                    Case Else
'                                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                                        Sendbuf = Text_Create_Proc()
'                                        Call File_Error(sts, BtOpGetEqual, "éwê}ï[(éq)", 0)
'                                        Exit Function
'                                End Select
'
'                                com = BtOpGetNext
'
'                            Loop
'
'                            '-------------------------------------  ì«Ç›ë÷Ç¶ÉRÅ[ÉhÇ≈çƒì«Ç›çûÇ›  2012.04.05
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.27
                            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                            
                            If Not Found_F Then
                            
                            
                                
                            
                            
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "éqïiî‘ÉGÉâÅ[", "", "")
                            
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                        
                                Ido_Out_OSAKA_Proc = False
                                Exit Function
                            End If
                        End If
        
        
                        If StrConv(P_SSHIJI_K_REC.IDO_SUMI, vbUnicode) = "9" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "è§ïiâªópÇ…à⁄ìÆçœÇ›ÅI", "", "")
                        
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
        
        
        
                End Select
            Next i
            
            '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                                        'FROM é¿íIî‘
            sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
            Select Case sts
                Case False
                Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                    Exit Function
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                Case SYS_CANCEL
                    Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Ido_Out_OSAKA_Proc = False
                    Exit Function
            End Select
                    
            If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                Sendbuf = Text_Create_Proc()
                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                Ido_Out_OSAKA_Proc = False
                Exit Function
            End If
        
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
            
            ID_KANRI_TBL(ING_No).Tanaban = FROM_Tanaban     'íIî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Hinban = Hinban            'ïiî‘ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
            ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                                                            
            ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
            ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
                                                            
                                                            
                                                            
                                                            'è§ïiâªópëqå…ãÊï™ÇÉZÅ[Éu
            ID_KANRI_TBL(ING_No).GOODS_ON_F = StrConv(SOKOREC.GOODS_ON_F, vbUnicode)
            'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                        
            '-----------------------------------------------ÇPçsñ⁄
            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                                                            'BOXëÆê´
            Send_Text.Box_Type(0).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
'            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                            
            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(0).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                            
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(0).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(0).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            '-----------------------------------------------ÇQçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(1).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, _
                    Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))

            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, _
                    Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(1).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(1).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(1).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
            '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(2).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Hinban)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Hinban)
                                                             'êîílèâä˙ï\é¶
            Send_Text.Box_Type(2).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                           'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(2).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(2).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
            Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
'            '-----------------------------------------------ÇSçsñ⁄
'                                                            'BOXëÆê´
'            Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
'                                                            'ï\é¶ì‡óe
'            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SUMI_Suryo & Space(M_Keta - (Len(LCD_SUMI_Suryo) * 2) - 5 + (5 - Len(Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0")))) & Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SUMI_Suryo & Space(M_Keta - (Len(LCD_SUMI_Suryo) * 2) - 5 + (5 - Len(Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0")))) & Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))
'                                                            'êîílèâä˙ï\é¶
'            Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0")
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0")
'                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
'                                                            'ì¸óÕåÖêî
'            Send_Text.Box_Type(3).Max_Size = "05"
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
'
'            Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
'            '-----------------------------------------------ÇTçsñ⁄
'                                                            'BOXëÆê´
'            Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
'                                                        'ï\é¶ì‡óe
'            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0")))) & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0"))
'            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_MI_Suryo & Space(M_Keta - (Len(LCD_MI_Suryo) * 2) - 5 + (5 - Len(Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0")))) & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0"))
'                                                            'êîílèâä˙ï\é¶
'            Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0")
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = Space(10 - Len(Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0"))) & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0")
'                                                            'èâä˙ÉJÅ[É\Éãà íu
'            Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = Format(M_Keta - 4, "00")
'                                                            'ì¸óÕåÖêî
'            Send_Text.Box_Type(4).Max_Size = "05"
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "05"
'
'            Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
'            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
'
'            '-----------------------------------------------ÇSçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                           'ï\é¶ì‡óe
            
            
            
            
            If ID_KANRI_TBL(ING_No).S_JGYOBU = BUZAI Then
                
                If SYUKO_QTY = 0 Then                               '2012.04.13
                    SYUKO_QTY = ID_KANRI_TBL(ING_No).KO_SHIJI_QTY   '2012.04.13
                End If                                              '2012.04.13
                
                
                If ID_KANRI_TBL(ING_No).Send_MI_QTY < SYUKO_QTY Then
                    wkQty = ID_KANRI_TBL(ING_No).Send_MI_QTY
                Else
                    wkQty = SYUKO_QTY
                End If
                ID_KANRI_TBL(ING_No).Send_MI_QTY = wkQty
                ID_KANRI_TBL(ING_No).Send_SUMI_QTY = 0
            Else
                
                If SYUKO_QTY = 0 Then                               '2012.04.13
                    SYUKO_QTY = ID_KANRI_TBL(ING_No).KO_SHIJI_QTY   '2012.04.13
                End If                                              '2012.04.13
                
                
                If ID_KANRI_TBL(ING_No).Send_SUMI_QTY < SYUKO_QTY Then
                    wkQty = ID_KANRI_TBL(ING_No).Send_SUMI_QTY
                Else
                    wkQty = SYUKO_QTY
                End If
                ID_KANRI_TBL(ING_No).Send_MI_QTY = 0
                ID_KANRI_TBL(ING_No).Send_SUMI_QTY = wkQty
            End If
            
            
            
            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_OSAKA_IDO_OUT & Space(M_Keta - (Len(LCD_OSAKA_IDO_OUT) * 2) - 5 + (5 - Len(Format(wkQty, "#0")))) & Format(wkQty, "#0"))
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_OSAKA_IDO_OUT & Space(M_Keta - (Len(LCD_OSAKA_IDO_OUT) * 2) - 5 + (5 - Len(Format(wkQty, "#0")))) & Format(wkQty, "#0"))
                                                           'êîílèâä˙ï\é¶
            Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(wkQty, "#0"))) & Format(wkQty, "#0")
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(wkQty, "#0"))) & Format(wkQty, "#0")
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(3).Max_Size = "05"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"

            Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""

            '-----------------------------------------------ÇTçsñ⁄
                                                            'BOXëÆê´
            Send_Text.Box_Type(4).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                        'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                            'êîílèâä˙ï\é¶
            Send_Text.Box_Type(4).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(4).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                            'ì¸óÕåÖêî
            Send_Text.Box_Type(4).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
            Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
        
        
            Sendbuf = Text_Create_Proc()
            Ido_Out_OSAKA_Proc = False
            Exit Function
        
        
        Case Step_Sagyo3_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiè§ïiÅ^ñ¢è§ïiêîó Åj
            
            QTY = 0
            SUMI_QTY = 0
            MI_QTY = 0
            
            
            For i = 0 To M_Gyo - 1
            
                
                
                Select Case Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size)))
            
            
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
'                    Case LCD_Suryo          'êîó ÅiÇ±Ç±ÇÕñ≥Ç¢Åj
'                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                            Ido_Out_OSAKA_Proc = False
'                            Exit Function
'                        End If
'
'                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
'                        If QTY = 0 Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                            Ido_Out_OSAKA_Proc = False
'                            Exit Function
'                        End If
'
'
'                    Case LCD_SUMI_Suryo, LCD_MI_Suryo    'êîó Åiè§ïiâªçœÇ›êîó Å^ñ¢è§ïiêîó Åj
'
'                       If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
'                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
'                            Sendbuf = Text_Create_Proc()
'                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                            Ido_Out_OSAKA_Proc = False
'                            Exit Function
'                        End If
'
'
'                        If Trim(Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), Len(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode)) - CInt(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).Max_Size))) = LCD_SUMI_Suryo Then
'                            SUMI_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
''                            If SUMI_QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY Then
''                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
''                                Sendbuf = Text_Create_Proc()
''                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
''
''                                Ido_Out_OSAKA_Proc = False
''                                Exit Function
''                            End If
'                        Else
'                            MI_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
''                            If SUMI_QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY Then
''                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
''                                Sendbuf = Text_Create_Proc()
''                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
''
''                                Ido_Out_OSAKA_Proc = False
''                                Exit Function
''                            End If
'                        End If
'
'                        If i = M_Gyo - 1 Then       'ç≈èIçsÇæÇ¡ÇΩÇÁ
'                            If SUMI_QTY = 0 And MI_QTY = 0 Then
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "è§ïiÅ^ñ¢è§ïiÅÅÇO", "êîó ì¸óÕÉ~ÉX", "", "")
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                                Ido_Out_OSAKA_Proc = False
'                                Exit Function
'                            End If
'
'
'                            If SUMI_QTY + MI_QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY Then
'                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "êîó ÉIÅ[ÉoÅ[", "êîó ì¸óÕÉ~ÉX", "", "")
'                                Sendbuf = Text_Create_Proc()
'                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'
'                                Ido_Out_OSAKA_Proc = False
'                                Exit Function
'                            End If
'
'                        End If
                    Case LCD_OSAKA_IDO_OUT
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If

                        QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êîó ì¸óÕÉ~ÉX", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
               
                        If QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "êîó ÉIÅ[ÉoÅ[", "êîó ì¸óÕÉ~ÉX", Format(QTY, "#0"), Format(ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY, "#0"))
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1

                            Ido_Out_OSAKA_Proc = False
                            Exit Function
                        End If
              
               
                
                End Select
            Next i
            
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
            Else
                MENU_NO = ""
            End If
        
            
            
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
            If ID_KANRI_TBL(ING_No).S_JGYOBU = BUZAI Then
                MI_QTY = QTY
                SUMI_QTY = 0
            Else
                MI_QTY = 0
                SUMI_QTY = QTY
            End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>    2012.04.07 èoå…êîÇÇPçsÇ…ïœçX
            
            
            sts = IDO_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"), _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    SUMI_QTY, _
                                    MI_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, ID_KANRI_TBL(ING_No).SHIJI_No, MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2), ID_KANRI_TBL(ING_No).Hinban, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Ido_Out_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Ido_Out_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Ido_Out_OSAKA_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
    
    
    
            '------------------ éqïiî‘ÇÃà⁄ìÆçœÇ›çXêV
            Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
            Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
            Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")

            Found_F = False
            com = BtOpGetGreater

            Do
                
                DoEvents
                sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
                Select Case sts
                    Case BtNoErr
                        If ID_KANRI_TBL(ING_No).SHIJI_No <> StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) Then
                            Exit Do
                        End If
                    
                        If RTrim(ID_KANRI_TBL(ING_No).Hinban) = RTrim(StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)) Then
                            
                            
                            QTY = Val(StrConv(P_SSHIJI_K_REC.HIKIATE_QTY, vbUnicode))                                   '2012.04.13
                            QTY = QTY - (SUMI_QTY + MI_QTY)                                                             '2012.04.13
                            If QTY < 0 Then
                                QTY = 0
                            End If
                            'Call UniCode_Conv(P_SSHIJI_K_REC.HIKIATE_QTY, Format(SUMI_QTY + MI_QTY, "00000000.00"))    2012.04.13
                            Call UniCode_Conv(P_SSHIJI_K_REC.HIKIATE_QTY, Format(QTY, "00000000.00"))                   '2012.04.13
                            
                            
                            
                            QTY = Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI_QTY, vbUnicode))                                  '2012.04.13
                            QTY = QTY + (SUMI_QTY + MI_QTY)                                                             '2012.04.13
                            Call UniCode_Conv(P_SSHIJI_K_REC.IDO_SUMI_QTY, Format(QTY, "00000000.00"))                  '2012.04.13
                            
                            If QTY >= ID_KANRI_TBL(ING_No).KO_SHIJI_QTY Then                                            '2012.04.13
                                Call UniCode_Conv(P_SSHIJI_K_REC.IDO_SUMI, "9")
                            End If                                                                                      '2012.04.13
                            
                            sts = BTRV(BtOpUpdate, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
                        
                            Select Case sts
                                Case BtNoErr
                                Case Else
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpUpdate, "éwê}ï[(éq)", 0)
                                    Exit Function
                            End Select
                        
                        
                        
                        
                        End If
                    
                    Case BtErrEOF
                        Exit Do
                    Case Else
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Call File_Error(sts, BtOpGetEqual, "éwê}ï[(éq)", 0)
                        Exit Function
                End Select
                
                com = BtOpGetNext
            
            Loop
    
    
    
    
    
    
    
    
    
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
            
            'ÉâÉxÉãî≠çsèàóù
            If LABEL_88_SendFile <> "" And _
                Trim(ID_KANRI_TBL(ING_No).CTR_TYPE) <> "" Then
                
                
                fileName = LABEL_88_SendFile
                
                If Label_Print_File_Make_Proc(fileName, ID_KANRI_TBL(ING_No).Hinban, 0) Then
                End If
            
            
            
                'ÉfÅ[É^ëóêM
                ID_KANRI_TBL(ING_No).LABEL_STEP = 1
                                            
                                            
                ID_KANRI_TBL(ING_No).Step = Step_PRINT_REQ
            
                ID_KANRI_TBL(ING_No).LABEL_ON = True
            
                '-----------------------------------------------ÉwÉbÉ_Å[
            
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
            
                Send_Text.Display_Flg = Display_LABEL                   'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_LABEL
            
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
            
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
            
                Send_Text.fileName = fileName                           'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = fileName
            
                Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
            
                Sendbuf = Text_Create_Proc()
                Ido_Out_OSAKA_Proc = False
                
                Exit Function
            
            Else
                'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
                sts = Data_Clear_Proc(0, Sendbuf)
                Select Case sts
                    Case SYS_CANCEL
                        Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                    
                    Case SYS_ERR
                        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                        Sendbuf = Text_Create_Proc()
                        Exit Function
                End Select
                                            
'                                            'éüÇÃçÏã∆óvãÅ
'
'
'                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
'                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
'                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
'                Select Case sts
'                    Case BtNoErr
'                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'                    Case Else
'                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
'                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                    Sendbuf = Text_Create_Proc()
'                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
'                    Exit Function
'                End Select
'
'                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
'
'                Sendbuf = Text_Create_Proc()
'                Ido_Out_OSAKA_Proc = False
'
'                Exit Function
            
                '>>>>2012.03.29Å@ïiî‘ì¸óÕÇ÷
                '-----------------------------------------------ÉwÉbÉ_Å[
                
                ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                
                Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
        
                Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
        
                Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
        
                Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
        
                Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
        
                Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(0).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(0).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(0).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(0).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(1).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(1).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(1).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(1).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(2).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(2).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(2).Max_Size = "09"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                                                                        
                Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(3).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(3).Start_Pos = "01"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                Send_Text.Box_Type(3).Max_Size = "20"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                        
                                                                        
                                                                        
                Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                Send_Text.Box_Type(4).Box_Type = TYPE_REF
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                    
                                                                        'êîílèâä˙ï\é¶
                Send_Text.Box_Type(4).INIT = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                Send_Text.Box_Type(4).Start_Pos = ""
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                 Send_Text.Box_Type(4).Max_Size = "00"
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                        
                Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                Sendbuf = Text_Create_Proc()
                Ido_Out_OSAKA_Proc = False
                Exit Function
            
            
            
            
            End If
                                        
                                        
                                        
        Case Step_PRINT_RES         'ÇQâÒñ⁄ÇÃéÛêMÅiàÛç¸èIóπÅj
'                                                    'éüÇÃçÏã∆óvãÅ
'                Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
'                Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
'                sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
'                Select Case sts
'                    Case BtNoErr
'                    '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
'                    Case Else
'                    'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
'                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
'                    Sendbuf = Text_Create_Proc()
'                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
'                    Exit Function
'                End Select
'                ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
'                If Sagyo_Send_Proc() Then
'                    Sendbuf = Text_Create_Proc()
'                    Exit Function
'                End If
'
'                Sendbuf = Text_Create_Proc()
                                        
            '>>>>2012.03.29Å@ïiî‘ì¸óÕÇ÷
            '-----------------------------------------------ÉwÉbÉ_Å[
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
            
            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
    
            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
    
            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
    
            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
    
            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
    
            Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
            '-----------------------------------------------ÇPçsñ⁄
                                                                    'BOXëÆê´
            Send_Text.Box_Type(0).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_DNAME)
                                                                    'êîílèâä˙ï\é¶
            Send_Text.Box_Type(0).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(0).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
            Send_Text.Box_Type(0).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                    
            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            '-----------------------------------------------ÇQçsñ⁄
                                                                    'BOXëÆê´
            Send_Text.Box_Type(1).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                    'êîílèâä˙ï\é¶
            Send_Text.Box_Type(1).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(1).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
            Send_Text.Box_Type(1).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                    
            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
            '-----------------------------------------------ÇRçsñ⁄
                                                                    'BOXëÆê´
            Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Tanaban)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Tanaban)
                                                                    'êîílèâä˙ï\é¶
            Send_Text.Box_Type(2).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(2).Start_Pos = "01"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                    'ì¸óÕåÖêî
            Send_Text.Box_Type(2).Max_Size = "09"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "09"
                                                                    
            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            '-----------------------------------------------ÇSçsñ⁄
                                                                    'BOXëÆê´
            Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Hinban)
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Hinban)
                                                                    'êîílèâä˙ï\é¶
            Send_Text.Box_Type(3).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(3).Start_Pos = "01"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                    'ì¸óÕåÖêî
            Send_Text.Box_Type(3).Max_Size = "20"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                    
                                                                    
                                                                    
            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            '-----------------------------------------------ÇSçsñ⁄
                                                                    'BOXëÆê´
            Send_Text.Box_Type(4).Box_Type = TYPE_REF
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                    'ï\é¶ì‡óe
            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                
                                                                    'êîílèâä˙ï\é¶
            Send_Text.Box_Type(4).INIT = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                    'èâä˙ÉJÅ[É\Éãà íu
            Send_Text.Box_Type(4).Start_Pos = ""
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                    'ì¸óÕåÖêî
             Send_Text.Box_Type(4).Max_Size = "00"
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                    
            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

            Sendbuf = Text_Create_Proc()
            Ido_Out_OSAKA_Proc = False
            Exit Function
            
            
            
            
                                        
                                        
                                        
    
    End Select

    Ido_Out_OSAKA_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function


Private Function Hin_Furikae_S_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇb ïîçﬁæ›¿∞ïiî‘êUë÷éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx
'
'           2012.03.13
'-------------------------------------------------------
Dim sts             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long

Dim BEF_QTY         As Long
Dim AFT_QTY         As Long



Dim i               As Integer

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8
Dim ST_TANABAN      As String * 8


Dim Hinban          As String * 20
Dim TO_Hinban       As String * 20


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

    Hin_Furikae_S_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiêUë÷ëOïiî‘Å^êUë÷å„ïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_BEF_Hinban         'êUë÷ëOïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                        ST_TANABAN = StrConv(ITEMREC.ST_SOKO, vbUnicode) & _
                                        StrConv(ITEMREC.ST_RETU, vbUnicode) & _
                                        StrConv(ITEMREC.ST_REN, vbUnicode) & _
                                        StrConv(ITEMREC.ST_REN, vbUnicode)
        
                        ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN = Hinban
        
        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU      'éëçﬁëŒâûÇÃéñã∆ïî2006.01.06
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI      'éëçﬁëŒâûÇÃçëì‡äO2006.01.06
        
        
        
                        ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                        ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
        
        
                    Case LCD_AFT_Hinban         'êUë÷å„ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
                        Call UniCode_Conv(K0_FURIKAE.JGYOBU_MAE, RET_JGYOBU)        '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.NAIGAI_MAE, RET_NAIGAI)        '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.HIN_MAE, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        
                        Call UniCode_Conv(K0_FURIKAE.JGYOBU_GO, RET_JGYOBU)         '2012.03.13
                        Call UniCode_Conv(K0_FURIKAE.NAIGAI_GO, RET_NAIGAI)         '2012.03.13
                        
                        
                        Call UniCode_Conv(K0_FURIKAE.HIN_GO, Hinban)
                        sts = BTRV(BtOpGetEqual, FURIKAE_POS, FURIKAEREC, Len(FURIKAEREC), K0_FURIKAE, Len(K0_FURIKAE), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, Hinban, "êUë÷ïiî‘ÉGÉâÅ[", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiî‘êUë÷Çl", 0)
                                Exit Function
                        End Select
                                        
                
                        
                                        
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select

                        ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN = Hinban

                        ID_KANRI_TBL(ING_No).CUT_SU = Val(StrConv(FURIKAEREC.CUT_SU, vbUnicode))


                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
            
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                                    
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
            
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                        Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            
                        '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        
                        
                        
                        '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
            
            
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, _
                                        LCD_Tanaban & " " & Mid(ST_TANABAN, 1, 2) & "-" & Mid(ST_TANABAN, 3, 2) & "-" & Mid(ST_TANABAN, 5, 2) & "-" & Mid(ST_TANABAN, 7, 2))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, _
                                        LCD_Tanaban & " " & Mid(ST_TANABAN, 1, 2) & "-" & Mid(ST_TANABAN, 3, 2) & "-" & Mid(ST_TANABAN, 5, 2) & "-" & Mid(ST_TANABAN, 7, 2))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "12"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""            'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
            '
                    
                        Sendbuf = Text_Create_Proc()
                End Select
            Next i

'-----------------------    2011.06.13
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    Case LCD_Tanaban    'íIî‘
                        FROM_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(FROM_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ ç¨ç⁄É`ÉFÉbÉN
                        If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                            If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            End If
                        End If
                        '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_TANA.SOKO_NO, Left(FROM_Tanaban, 2))
                        Call UniCode_Conv(K0_TANA.Retu, Mid(FROM_Tanaban, 3, 2))
                        Call UniCode_Conv(K0_TANA.Ren, Mid(FROM_Tanaban, 5, 2))
                        Call UniCode_Conv(K0_TANA.Dan, Right(FROM_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                Hin_Furikae_S_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
        
                        '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                        If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIégópïsâ¬", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
        
                            Hin_Furikae_S_Proc = False
                            
                            Exit Function
                        End If
        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                                                    'FROM íIî‘
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, ID_KANRI_TBL(ING_No).S_JGYOBU, ID_KANRI_TBL(ING_No).S_NAIGAI, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Hin_Furikae_S_Proc = False
                                Exit Function
                        End Select
                                
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Hin_Furikae_S_Proc = False
                            Exit Function
                        End If
                
                
        
                
                
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                        
                        ID_KANRI_TBL(ING_No).Tanaban = FROM_Tanaban         'íIî‘ÇÉZÅ[Éu
                                                                    
                                                                    
                                                                    
                        ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY       'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                        ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY           'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
                                                                    
                                                                    
                                                                    'è§ïiâªópëqå…ãÊï™ÇÉZÅ[Éu
                        ID_KANRI_TBL(ING_No).GOODS_ON_F = StrConv(SOKOREC.GOODS_ON_F, vbUnicode)
                        'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                                    
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
    '                    Send_Text.Box_Type(0).Box_Type = TYPE_REF
    '                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
    '                                                                    'ï\é¶ì‡óe
    '                    Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
    '                    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
    '                                                                    'êîílèâä˙ï\é¶
    '                    Send_Text.Box_Type(0).INIT = ""
    '                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
    '
    '                                                                    'èâä˙ÉJÅ[É\Éãà íu
    '                    Send_Text.Box_Type(0).Start_Pos = ""
    '                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
    '                                                                    'ì¸óÕåÖêî
    '                    Send_Text.Box_Type(0).Max_Size = "00"
    '                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
    '                    Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
    '                    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
            
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        
                        
                        
                        '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, _
                                        Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, _
                                        Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_BCNUM
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_BEF_Su & Space(M_Keta - (Len(LCD_BEF_Su) * 2) - 5 + (5 - Len(Format(0, "#")))) & Format(0, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_BEF_Su & Space(M_Keta - (Len(LCD_Suryo) * 2) - 5 + (5 - Len(Format(0, "#")))) & Format(0, "#"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(0, "#"))) & Format(0, "#")
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = Space(10 - Len(Format(0, "#"))) & Format(0, "#")
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")      'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = Format(M_Keta - 4, "00")
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "05"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "05"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            
            
            
                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        Sendbuf = Text_Create_Proc()
                
                        Hin_Furikae_S_Proc = False
                        Exit Function
                
                End Select
            
            
            Next i
        
        
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiêUë÷ëOêîó Åj
            
            
            
            For i = 0 To M_Gyo - 1
            
                
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 5)
            
            
                    Case LCD_BEF_Su          'êîó ÅiêUë÷ëOÅj
                        If Not IsNumeric(Trim(ID_KANRI_TBL(ING_No).Recv_text(i))) Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êUë÷ëOêîó ", "êîó ì¸óÕÉ~ÉX", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_S_Proc = False
                            Exit Function
                        End If
                
                        BEF_QTY = CLng(Trim(ID_KANRI_TBL(ING_No).Recv_text(i)))
                        If BEF_QTY = 0 Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êUë÷ëOêîó ", "êîó ì¸óÕÉ~ÉX", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_S_Proc = False
                            Exit Function
                        End If
            
            
                        If BEF_QTY > ID_KANRI_TBL(ING_No).Send_SUMI_QTY + ID_KANRI_TBL(ING_No).Send_MI_QTY Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, Trim(ID_KANRI_TBL(ING_No).Recv_text(i)), "êUë÷ëOêîó ", "êîó ì¸óÕÉ~ÉX", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                            Hin_Furikae_S_Proc = False
                            Exit Function
                        End If
                
                        ID_KANRI_TBL(ING_No).BEF_QTY = BEF_QTY
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo4_REQ
                                    
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        
                        
                        
                        '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, _
                                        Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, _
                                        Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_BEF_Su & Format(BEF_QTY, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_BEF_Su & Format(BEF_QTY, "#"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
            
            
            
                        '-----------------------------------------------ÇTçsñ⁄
                        AFT_QTY = BEF_QTY * ID_KANRI_TBL(ING_No).CUT_SU
                        ID_KANRI_TBL(ING_No).AFT_QTY = AFT_QTY
                                                                        
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_AFT_Su & Format(AFT_QTY, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_AFT_Su & Format(AFT_QTY, "#"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                        
                        Sendbuf = Text_Create_Proc()
            
                        Hin_Furikae_S_Proc = False
                        Exit Function
            
            
                End Select
            
            
            Next i
            
            
        Case Step_Sagyo4_RES        'ÇSâÒñ⁄ÇÃéÛêMÅiÇdÇmÇsÅj
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
        
        
            sts = Syuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, _
                                    "", _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    YOIN_BEF_HINBAN_S, _
                                    0, _
                                    ID_KANRI_TBL(ING_No).BEF_QTY, _
                                    0, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, Trim(ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN) & "Ç÷êUë÷", _
                                    , , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "-" & "01-01-01", ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Hin_Furikae_S_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Hin_Furikae_S_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Hin_Furikae_S_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
    
    
    
            sts = Nyuko_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).FURI_AFT_HINBAN, _
                                    Format(Now, "YYYYMMDD"), _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"), _
                                    YOIN_AFT_HINBAN_S, _
                                    0, _
                                    ID_KANRI_TBL(ING_No).AFT_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, Trim(ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN) & "ÇÊÇËêUë÷", , , , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "-" & "01-01-01", ID_KANRI_TBL(ING_No).FURI_BEF_HINBAN, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Hin_Furikae_S_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Hin_Furikae_S_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Hin_Furikae_S_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
    
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        
                                        
                            
            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
            sts = Data_Clear_Proc(0, Sendbuf)
            Select Case sts
                Case SYS_CANCEL
                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
            End Select
                                        'éüÇÃçÏã∆óvãÅ
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    Hin_Furikae_S_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function Ido_In_OSAKA_Proc(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇb ïîçﬁæ›¿∞à⁄ìÆì¸å…éwíËéûÇÃÉ`ÉFÉbÉNÅïçXêVèàóùÅx
'
'       2012.03.15
'-------------------------------------------------------
Dim sts             As Integer

Dim SUMI_QTY        As Long
Dim MI_QTY          As Long
Dim QTY             As Long


Dim i               As Integer

Dim FROM_Tanaban    As String * 8
Dim TO_Tanaban      As String * 8
Dim ST_TANABAN      As String * 8


Dim Hinban          As String * 20

Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1

Dim MENU_NO         As String * 2

    Ido_In_OSAKA_Proc = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiïiî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_Hinban         'ïiî‘
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                
                        sts = Item_Read_Proc(ID_KANRI_TBL(ING_No).JGYOBU, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Hinban, "ïiî‘ÉGÉâÅ[", "", "")
                    
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                
                                Ido_In_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
        
                        '------------------ ç›å…ÇÃégópó\ñÒÇçsÇ¢ÅAóLå¯ç›å…êîÇälìæÇ∑ÇÈ
                                                    'FROM âºëzíIî‘
                        FROM_Tanaban = ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"
                        sts = Zaiko_Reserve_Proc(ID_KANRI_TBL(ING_No).ID, FROM_Tanaban, RET_JGYOBU, RET_NAIGAI, Hinban, SUMI_QTY, MI_QTY)
                        Select Case sts
                            Case False
                            Case True           'Ç±Ç±Ç≈ÇÕî≠ê∂ÇµÇ»Ç¢
                                Exit Function
                            Case SYS_ERR
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                            Case SYS_CANCEL
                                Call Err_Send_Proc("ç›å…égópíÜ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Ido_In_OSAKA_Proc = False
                                Exit Function
                        End Select
                    
                        If (SUMI_QTY = 0) And (MI_QTY = 0) Then
                            Call Err_Send_Proc("óLå¯ç›å…ñ≥Çµ", Left(FROM_Tanaban, 2) & "-" & Mid(FROM_Tanaban, 3, 2) & "-" & Mid(FROM_Tanaban, 5, 2) & "-" & Right(FROM_Tanaban, 2), Hinban, "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            Ido_In_OSAKA_Proc = False
                            Exit Function
                        End If
        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = RET_JGYOBU
                        ID_KANRI_TBL(ING_No).S_NAIGAI = RET_NAIGAI
                        ID_KANRI_TBL(ING_No).Hinban = Hinban
                        
                        ID_KANRI_TBL(ING_No).Send_SUMI_QTY = SUMI_QTY   'ëóêMÇ∑ÇÈè§ïiâªçœÇ›êîó 
                        ID_KANRI_TBL(ING_No).Send_MI_QTY = MI_QTY       'ëóêMÇ∑ÇÈñ¢è§ïiêîó 
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                       'ÉuÉUÅ[âπÅ@ïWèÄ
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, Hinban)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                        
                        ST_TANABAN = StrConv(ITEMREC.ST_SOKO, vbUnicode) & StrConv(ITEMREC.ST_RETU, vbUnicode) & StrConv(ITEMREC.ST_REN, vbUnicode) & StrConv(ITEMREC.ST_DAN, vbUnicode)
                        
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, _
                                        LCD_Tanaban & " " & Mid(ST_TANABAN, 1, 2) & "-" & Mid(ST_TANABAN, 3, 2) & "-" & Mid(ST_TANABAN, 5, 2) & "-" & Mid(ST_TANABAN, 7, 2))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, _
                                        LCD_Tanaban & " " & Mid(ST_TANABAN, 1, 2) & "-" & Mid(ST_TANABAN, 3, 2) & "-" & Mid(ST_TANABAN, 5, 2) & "-" & Mid(ST_TANABAN, 7, 2))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "12"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "12"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                                                                                
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                            
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                        Ido_In_OSAKA_Proc = False
                        Exit Function
            
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiíIî‘Åj
            For i = 0 To M_Gyo - 1
                Select Case Left(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode), 2)
                    Case LCD_Tanaban        'íIî‘
                        TO_Tanaban = Right(ID_KANRI_TBL(ING_No).Recv_text(i), Len(ID_KANRI_TBL(ING_No).Recv_text(i)) - 1)
                        '------------------ ëqå…É}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_SOKO.SOKO_NO, Left(TO_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, SOKO_POS, SOKOREC, Len(SOKOREC), K0_SOKO, Len(K0_SOKO), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2), "ëqå…ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Ido_In_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "ëqå…É}ÉXÉ^", 0)
                                Exit Function
                        End Select
                        '------------------ ç¨ç⁄É`ÉFÉbÉN
                        If StrConv(SOKOREC.KONS_KBN, vbUnicode) = KONS_KBN_NG Then
                            If StrConv(SOKOREC.JGYOBU, vbUnicode) <> ID_KANRI_TBL(ING_No).JGYOBU Or _
                                StrConv(SOKOREC.NAIGAI, vbUnicode) <> ID_KANRI_TBL(ING_No).NAIGAI Then
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Recv_text(i), 2), "ç¨ç⁄ÉGÉâÅ[", "", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                Ido_In_OSAKA_Proc = False
                                Exit Function
                            End If
                        End If
                        '------------------ íIÉ}ÉXÉ^ì«çûÇ›
                        Call UniCode_Conv(K0_TANA.SOKO_NO, Left(TO_Tanaban, 2))
                        Call UniCode_Conv(K0_TANA.Retu, Mid(TO_Tanaban, 3, 2))
                        Call UniCode_Conv(K0_TANA.Ren, Mid(TO_Tanaban, 5, 2))
                        Call UniCode_Conv(K0_TANA.Dan, Right(TO_Tanaban, 2))
                        sts = BTRV(BtOpGetEqual, TANA_POS, TANAREC, Len(TANAREC), K0_TANA, Len(K0_TANA), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
            
                            '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIî‘ÉGÉâÅ[", "", "")
                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                                Ido_In_OSAKA_Proc = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Call File_Error(sts, BtOpGetEqual, "íIÉ}ÉXÉ^", 0)
                                Exit Function
                        End Select
        
        
                        '------------------ ã÷é~íIÇÃÉ`ÉFÉbÉN
                        If StrConv(TANAREC.KAHI_KBN, vbUnicode) = KAHI_KBN_NG Then
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2), "íIégópïsâ¬", "", "")
                
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
        
                            Ido_In_OSAKA_Proc = False
                            Exit Function
                        End If
        
        
        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                
                        ID_KANRI_TBL(ING_No).Tanaban = TO_Tanaban       'íIî‘ÇÉZÅ[Éu
                                                                    'è§ïiâªópëqå…ãÊï™ÇÉZÅ[Éu
                        ID_KANRI_TBL(ING_No).GOODS_ON_F = StrConv(SOKOREC.GOODS_ON_F, vbUnicode)
                        'êîó ïtÇ´ÇÃëóêMÉÅÉbÉZÅ[ÉWÇçÏê¨Ç∑ÇÈ
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                                                                    
                        '-----------------------------------------------ÇPçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(0).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).Hinban)
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(1).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                            'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, _
                                        Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2))
            
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, _
                                        Left(TO_Tanaban, 2) & "-" & Mid(TO_Tanaban, 3, 2) & "-" & Mid(TO_Tanaban, 5, 2) & "-" & Right(TO_Tanaban, 2))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                        
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(2).Max_Size = "08"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "08"
                                                                                            
                        Send_Text.Box_Type(2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_Suryo & ":" & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY + ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_Suryo & ":" & Format(ID_KANRI_TBL(ING_No).Send_MI_QTY + ID_KANRI_TBL(ING_No).Send_SUMI_QTY, "#0"))
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(3).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇTçsñ⁄
                                                                        'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                        'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                        'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                        'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                        'ì¸óÕåÖêî
                        Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                            
                        Send_Text.Box_Type(4).MENU = ""                 'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                    
                    
                        Sendbuf = Text_Create_Proc()
                        Ido_In_OSAKA_Proc = False
                        Exit Function
        
        
                End Select
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiENTë“ÇøÅj
            
            '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                        'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
            sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                Exit Function
            End If
            '2006.01.30
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
        
        
            sts = IDO_Update_Proc(ID_KANRI_TBL(ING_No).S_JGYOBU, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    ID_KANRI_TBL(ING_No).Hinban, _
                                    "", _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.PARAM & "01" & "01" & "01"), _
                                    ID_KANRI_TBL(ING_No).Tanaban, _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    0, _
                                    ID_KANRI_TBL(ING_No).Send_MI_QTY + ID_KANRI_TBL(ING_No).Send_SUMI_QTY, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, , MENU_NO)

    
    
            Select Case sts
                Case False
        
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, Left(ID_KANRI_TBL(ING_No).Tanaban, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 3, 2) & "-" & Mid(ID_KANRI_TBL(ING_No).Tanaban, 5, 2) & "-" & Right(ID_KANRI_TBL(ING_No).Tanaban, 2), ID_KANRI_TBL(ING_No).Hinban, "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
            
                    Ido_In_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    Ido_In_OSAKA_Proc = False
                    GoTo Abort_Tran
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Ido_In_OSAKA_Proc = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    GoTo Abort_Tran
            End Select
    
                                        'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
            sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
            If sts <> BtNoErr Then
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpEndTransaction, "", 0)
                GoTo Abort_Tran
            End If
                                        
                                        
                            
            'èoâ◊ó\íËÅ^ç›å…ÇÃó\ñÒâèú
            sts = Data_Clear_Proc(0, Sendbuf)
            Select Case sts
                Case SYS_CANCEL
                    Call Err_Send_Proc("ÉfÅ[É^égópíÜ", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
                
                Case SYS_ERR
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Exit Function
            End Select
                                        
                                        
                                        'éüÇÃçÏã∆óvãÅ
            
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                Sendbuf = Text_Create_Proc()
                Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                Exit Function
            End Select
            
            
            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
            
            Sendbuf = Text_Create_Proc()
    
    End Select

    Ido_In_OSAKA_Proc = False
    
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function COMPO_OSAKA_CHECK_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@ïîçﬁæ›¿∞è§ïiâªç\ê¨¡™Ø∏èàóùÅx
'       2012.03.16
'
'-------------------------------------------------------
Dim sts             As Integer



Dim SHIJI_No        As String * 8

Dim Hinban          As String * 20

Dim i               As Integer
Dim j               As Integer
Dim k               As Integer


Dim RET_JGYOBU      As String * 1
Dim RET_NAIGAI      As String * 1



Dim MENU_NO         As String * 2

Dim KO_CNT          As Integer
Dim RD_CNT          As Integer


Dim Found_F         As Boolean
Dim wkJgoybu        As String * 1

    COMPO_OSAKA_CHECK_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ï[áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SHIJI_NO      'éwê}ï[áÇ
    
    
                        SHIJI_No = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        
                        
                        sts = COMPO_OSAKA_Check_Read_Proc(SHIJI_No, KO_CNT)
                        
                        
                        Select Case sts
                            Case False          'ê≥èÌ
                                
                            
                            
                            Case BtErrKeyNotFound
                                    
                                
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                COMPO_OSAKA_CHECK_PROC = False
                                Exit Function
                            
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        
                        End Select
                
                        
                        'éqïîïiÇ»Çµ
                        If KO_CNT < 0 Then
                        
                        
                        
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "éqïîïiÇ»Çµ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_OSAKA_CHECK_PROC = False
                            Exit Function
                        
                        
                        
                        
                        End If
                        
                        
                        'ÉLÉÉÉìÉZÉãçœ
                        If StrConv(P_SSHIJI_O_REC.CANCEL_F, vbUnicode) = "1" Then
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_OSAKA_CHECK_PROC = False
                            Exit Function
                        End If
                                                
                        'äÆóπçœ
                        If StrConv(P_SSHIJI_O_REC.KAN_F, vbUnicode) = "1" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_OSAKA_CHECK_PROC = False
                            Exit Function
                        End If
                        
                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> éqïîïiÉ`ÉFÉbÉN 20012.04.13
                        If StrConv(P_SSHIJI_O_REC.COMPO_END_F, vbUnicode) = "9" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "éqïîïi¡™Ø∏", "äÆóπçœ", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            COMPO_OSAKA_CHECK_PROC = False
                            Exit Function
                        End If
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> éqïîïiÉ`ÉFÉbÉN 20012.04.13
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).SHIJI_No = SHIJI_No
                        ID_KANRI_TBL(ING_No).Hinban = StrConv(P_SSHIJI_O_REC.HIN_GAI, vbUnicode)
                        ID_KANRI_TBL(ING_No).Input_Line = 0
                                                
                        
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                        Call COMPO_Check_Cnt_Proc(KO_CNT, RD_CNT)
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, LCD_Hinban)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, LCD_Hinban)
                                                                                
                                                                                
                                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "20"
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = "01"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = "01"
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "20"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "20"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(4).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(4).Start_Pos = ""                    'êîílÇÕÇTåÖå≈íË
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                         Send_Text.Box_Type(4).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiÉâÉxÉãïiî‘Åj
            For i = 0 To M_Gyo - 1
            
                Select Case i
                
                                    
                    Case 0
                                    
                                    
                        Hinban = ID_KANRI_TBL(ING_No).Recv_text(i)
                                    
                        If Trim(Hinban) = Ent_Para Then
                        
                            '2011.06.14
                            For k = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                                If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG <> 1 Then
                                    Exit For
                                End If
                            Next k
                            
                            If k > UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) Then
                            Else
                            
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, "¡™Ø∏ñ¢äÆóπ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                COMPO_OSAKA_CHECK_PROC = False
                                Exit Function
                            
                            End If
                            
                            
                            
                            
                            ID_KANRI_TBL(ING_No).Step = Step_Sagyo3_REQ
                            
                        
                        
                        
                            '-----------------------------------------------ÉwÉbÉ_Å[
                            Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                            ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                    
                            Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                            ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                    
                            Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                            ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                    
                            Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                            ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                    
                            Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                            ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                    
                            Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                                    
                            '-----------------------------------------------ÇPçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(0).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                                                                                    
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(0).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(0).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(0).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                            '-----------------------------------------------ÇQçsñ⁄
                                                                                    'BOXëÆê´
                            Send_Text.Box_Type(1).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇ" & ID_KANRI_TBL(ING_No).SHIJI_No)
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(1).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(1).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(1).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                            '-----------------------------------------------ÇRçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(2).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(2).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(2).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(2).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                                                                                    
                            Send_Text.Box_Type(2).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                    
                                                                                    
                                                                                    
                            Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                            Send_Text.Box_Type(3).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, "É`ÉFÉbÉNäÆóπ")
                
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(3).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(3).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(3).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                                    '-----------------------------------------------ÇSçsñ⁄
                                                                                            'BOXëÆê´
                            Send_Text.Box_Type(4).Box_Type = TYPE_REF
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_REF
                                                                                    'ï\é¶ì‡óe
                            Call UniCode_Conv(Send_Text.Box_Type(4).LCD, "")
                            Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, "")
                                                                                    'êîílèâä˙ï\é¶
                            Send_Text.Box_Type(4).INIT = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                    'èâä˙ÉJÅ[É\Éãà íu
                            Send_Text.Box_Type(4).Start_Pos = ""
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = ""
                                                                                    'ì¸óÕåÖêî
                            Send_Text.Box_Type(4).Max_Size = "00"
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "00"
                                                                                    
                            Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                            ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""
                
                            Sendbuf = Text_Create_Proc()
                        
                            COMPO_OSAKA_CHECK_PROC = False
        
                            Exit Function
                            
                            
                            
                            '2011.06.14
                            Exit For
                        End If
                    Case 2, 3, 4        'ïiî‘
                        
                        
                        
                        For j = 2 To 4
                        
                            If j - 2 = ID_KANRI_TBL(ING_No).Input_Line Then
                        
                                                    
                        
                                Hinban = ID_KANRI_TBL(ING_No).Recv_text(j)
                    
                    
                                For k = 0 To UBound(JGYOBU_T)
                                
                                
                                    If JGYOBU_T(k).CODE = SHIZAI Then
                                        sts = Item_Read_Proc(JGYOBU_T(k).CODE, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI, , BUZAI)
                                    Else
                                        sts = Item_Read_Proc(JGYOBU_T(k).CODE, ID_KANRI_TBL(ING_No).NAIGAI, Hinban, RET_JGYOBU, RET_NAIGAI)
                                            Select Case sts
                                            Case BtNoErr
                                                Exit For
                                            Case BtErrKeyNotFound
                                        
                                            Case Else
                                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                Sendbuf = Text_Create_Proc()
                                                Call File_Error(sts, BtOpGetEqual, "ïiñ⁄É}ÉXÉ^", 0)
                                                Exit Function
                                
                                        End Select
                                    End If
                                Next k
                    
                    
                                Found_F = False
                                For k = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                                
                                    If Trim(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).KO_HIN_GAI) = Trim(Hinban) Then
                                    
                                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.04.13
                                        If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 1 Then
                                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, Hinban, "É`ÉFÉbÉNçœ", "")
                                            Sendbuf = Text_Create_Proc()
                                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                            COMPO_OSAKA_CHECK_PROC = False
                                            Exit Function
                                        End If
                                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.04.13
                                    
                                        Found_F = True
                                        If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 0 Then
                                            ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 1
                                            Exit For
                                        End If
                                    
                                    End If
                                
                                
                                Next k
                    
                    
                                If Not Found_F Then
                                
                                
                                
                                    For k = 0 To UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL)
                                
                                        'ïiî‘ì«Ç›ë÷Ç¶Ç≈É`ÉFÉbÉN
                                        
                                        If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).KO_JGYOBU = SHIZAI Then
                                            Call UniCode_Conv(K1_FURIKAE.JGYOBU_GO, BUZAI)
                                            Call UniCode_Conv(K1_FURIKAE.NAIGAI_GO, NAIGAI_NAI)
                                            Call UniCode_Conv(K1_FURIKAE.HIN_GO, Hinban)
                                        
                                            Call UniCode_Conv(K1_FURIKAE.JGYOBU_MAE, BUZAI)
                                            Call UniCode_Conv(K1_FURIKAE.NAIGAI_MAE, NAIGAI_NAI)
                                            Call UniCode_Conv(K1_FURIKAE.HIN_MAE, ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).KO_HIN_GAI)
                                        
                                    
                                            sts = BTRV(BtOpGetEqual, FURIKAE_POS, FURIKAEREC, Len(FURIKAEREC), K1_FURIKAE, Len(K1_FURIKAE), 1)
                                            Select Case sts
                                                Case BtNoErr
                                                    
                                                                                                        
                                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.04.13
                                                    If ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 1 Then
                                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, Hinban, "É`ÉFÉbÉNçœ", "")
                                                        Sendbuf = Text_Create_Proc()
                                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                                        COMPO_OSAKA_CHECK_PROC = False
                                                        Exit Function
                                                    End If
                                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.04.13
                                                    
                                                    
                                                    ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(k).RD_FLAG = 1
                                                    Exit For
                                                    
                                                Case BtErrKeyNotFound
                                                
'                                                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, Hinban, "ïiî‘¥◊∞", "")
'
'                                                    Sendbuf = Text_Create_Proc()
'                                                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
'                                                    COMPO_OSAKA_CHECK_PROC = False
'                                                    Exit Function
                                                
                                                Case Else
                                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                                    Sendbuf = Text_Create_Proc()
                                                    Call File_Error(sts, BtOpGetEqual, "ïiî‘êUë÷É}ÉXÉ^", 0)
                                                    Exit Function
                                            End Select
                                    
                                    
                                    
                                        End If
                                    Next k
                                
                                    If k > UBound(ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL) Then
                                        Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & ID_KANRI_TBL(ING_No).SHIJI_No, Hinban, "ïiî‘¥◊∞", "")
                                        Sendbuf = Text_Create_Proc()
                                        ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                        COMPO_OSAKA_CHECK_PROC = False
                                        Exit Function
                                    End If
                                        
                                                            
                                End If
                        
                            
                           End If
                        
                        
                        
                        Next j
                        
                        ID_KANRI_TBL(ING_No).RD_HINBAN(ID_KANRI_TBL(ING_No).Input_Line) = Hinban
                        ID_KANRI_TBL(ING_No).Input_Line = ID_KANRI_TBL(ING_No).Input_Line + 1
                        
                        If ID_KANRI_TBL(ING_No).Input_Line > 2 Then
                            ID_KANRI_TBL(ING_No).Input_Line = 0
                        
                            ID_KANRI_TBL(ING_No).RD_HINBAN(0) = ""
                            ID_KANRI_TBL(ING_No).RD_HINBAN(1) = ""
                            ID_KANRI_TBL(ING_No).RD_HINBAN(2) = ""
                        
                        End If
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                            
                            
                            
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                            
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                                                                                
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                        Call COMPO_Check_Cnt_Proc(KO_CNT, RD_CNT)
                                                                                
                                                                                
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, ID_KANRI_TBL(ING_No).SHIJI_No & "     " & Format(RD_CNT, "##0") & "/" & Format(KO_CNT, "#"))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                        For j = 0 To 2
                        
                            If j = ID_KANRI_TBL(ING_No).Input_Line Then
                                                                                    'BOXëÆê´
                                Send_Text.Box_Type(j + 2).Box_Type = TYPE_BCANK
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Box_Type = TYPE_BCANK
                                                                                'ï\é¶ì‡óe
                                Call UniCode_Conv(Send_Text.Box_Type(j + 2).LCD, LCD_Hinban)
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).LCD, LCD_Hinban)
                        
                        
                        
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(j + 2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(j + 2).Start_Pos = "01"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Start_Pos = "01"
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                Send_Text.Box_Type(j + 2).Max_Size = "20"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Max_Size = "20"
                                                                                        
                                                                                        
                                Send_Text.Box_Type(j + 2).MENU = ""                     'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).MENU = ""
                        
                        
                        
                        
                            Else
                                                                                    'BOXëÆê´
                                Send_Text.Box_Type(j + 2).Box_Type = TYPE_REF
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Box_Type = TYPE_REF
                                Call UniCode_Conv(Send_Text.Box_Type(j + 2).LCD, ID_KANRI_TBL(ING_No).RD_HINBAN(j))
                                Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).LCD, ID_KANRI_TBL(ING_No).RD_HINBAN(j))
                        
                        
                            
                            
                                                                                        'êîílèâä˙ï\é¶
                                Send_Text.Box_Type(j + 2).INIT = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).INIT = ""
                                                                                        'èâä˙ÉJÅ[É\Éãà íu
                                Send_Text.Box_Type(j + 2).Start_Pos = ""
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Start_Pos = ""
                                                                                        'ì¸óÕåÖêî
                                                                                        
                                Send_Text.Box_Type(j + 2).Max_Size = "00"
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).Max_Size = "00"
                                                                                        
                                                                                        
                                Send_Text.Box_Type(j + 2).MENU = ""                       'ÉÅÉjÉÖÅ\î‘çÜ
                                ID_KANRI_TBL(ING_No).Send_Text.Box_Type(j + 2).MENU = ""
                            
                            
                            End If
                        
                        Next j
                                                                                                        
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   ëSïiñ⁄É`ÉFÉbÉNçœÇ›ÇÕÅ@ÉuÉUÅ[âπÇë÷Ç¶ÇÈ  2012.04.13
                        If (KO_CNT = RD_CNT) Then
                            Send_Text.Buzzer = Buzzer_DOUBLE
                            ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DOUBLE
                        End If
                        '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   ëSïiñ⁄É`ÉFÉbÉNçœÇ›ÇÕÅ@ÉuÉUÅ[âπÇë÷Ç¶ÇÈ  2012.04.13
                                                                                    
                                                                                    
                                                                                    
    
                        Sendbuf = Text_Create_Proc()
                                    
                        Exit For
                           
                End Select
            
            Next i
        Case Step_Sagyo3_RES        'ÇRâÒñ⁄ÇÃéÛêMÅiÇdÇmÇsÅj
        
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
            
            If Trim(MENU_NO) = "" Then
            Else
            'çÏã∆€∏ﬁèoóÕ
                
                If P_SAGYO_LOG_OUTPUT_PROC(ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                                    (Format(ID_KANRI_TBL(ING_No).ID, "000")), _
                                                    ID_KANRI_TBL(ING_No).JGYOBU, _
                                                    ID_KANRI_TBL(ING_No).NAIGAI, _
                                                    MENU_NO, _
                                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                                     ID_KANRI_TBL(ING_No).Hinban, , , , , , , , , _
                                                     ID_KANRI_TBL(ING_No).SHIJI_No) Then
                    COMPO_OSAKA_CHECK_PROC = SYS_ERR
                    Exit Function
                End If
            End If
            
            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> éwê}ï\(êe)çXêV  2012.04.13
            Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
            sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case BtErrKeyNotFound
                    Call Err_Send_Proc("ñ¢ìoò^àŸèÌ", "éwê}ï\(êe)", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    COMPO_OSAKA_CHECK_PROC = False
                    Exit Function
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "éwê}ï\(êe)", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "éwê}ï\(êe)", 0)
                    Exit Function
            End Select
                        
            Call UniCode_Conv(P_SSHIJI_O_REC.COMPO_END_F, "9")
            sts = BTRV(BtOpUpdate, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "éwê}ï\(êe)", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpUpdate, "éwê}ï\(êe)", 0)
                    Exit Function
            End Select
                   
            
            
            
            
            
            
            '>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> éwê}ï\(êe)çXêV  2012.04.13
            
            
            
            
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select

            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
        
        
    End Select
        

    COMPO_OSAKA_CHECK_PROC = False
    


End Function


Private Function COMPO_OSAKA_Check_Read_Proc(SHIJI_No As String, KO_CNT As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@ïîçﬁæ›¿∞éwê}ï[ÉfÅ[É^ÇÃç\ê¨ïîïiêîÅx
'
'       2012.03.16
'-------------------------------------------------------
Dim sts         As Integer
Dim com         As Integer


Dim i           As Integer

            
            
Dim Check_f     As Boolean
Dim j           As Integer
            
            
            
    COMPO_OSAKA_Check_Read_Proc = True



    
        
    
    
    
    Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, SHIJI_No)
    
    
    sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            COMPO_OSAKA_Check_Read_Proc = BtErrKeyNotFound
            Exit Function
        Case Else
            Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éwê}ï[ÉfÅ[É^(êe)", 0)
            COMPO_OSAKA_Check_Read_Proc = SYS_ERR
            Exit Function
    End Select
    
    
    Erase ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL
    KO_CNT = -1
    
    
    Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, SHIJI_No)
    Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
    Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")
    
    com = BtOpGetGreater
            
            
    Do
    
    
        DoEvents
    
        sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
        Select Case sts
            Case BtNoErr
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "èoâ◊ó\íË", 0)
                COMPO_OSAKA_Check_Read_Proc = SYS_ERR
                Exit Function
        End Select
    
    
    
        If StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) <> SHIJI_No Then
            Exit Do
        End If
    
    
        If StrConv(P_SSHIJI_K_REC.DATA_KBN, vbUnicode) = "3" Then
    
    
            Check_f = False
            If Kousei_check_F Then
                If Kousei_check_Tb(0) = "*" Then
                    Check_f = True
                Else
                
                
                    For j = 0 To UBound(Kousei_check_Tb)
                        If Kousei_check_Tb(j) = Trim(StrConv(P_SSHIJI_K_REC.KO_SYUBETSU, vbUnicode)) Then
                            Check_f = True
                            Exit For
                        End If
                    
                    Next j
                
                
                End If
            End If
            If Check_f Then
                KO_CNT = KO_CNT + 1
                
                ReDim Preserve ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(0 To KO_CNT)
                            
                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_JGYOBU = StrConv(P_SSHIJI_K_REC.KO_JGYOBU, vbUnicode)
                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_NAIGAI = StrConv(P_SSHIJI_K_REC.KO_NAIGAI, vbUnicode)
                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_HIN_GAI = StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)
            
                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).RD_FLAG = False
            
                ID_KANRI_TBL(ING_No).CHK_HINBAN_TBL(KO_CNT).KO_QTY = Val(StrConv(P_SSHIJI_K_REC.KO_QTY, vbUnicode))
            
            End If
        
        
        End If
    Loop
    
    COMPO_OSAKA_Check_Read_Proc = False

End Function


Private Function KENPIN_OSAKA_PROC(Sendbuf As String, Ti As Integer, Tj As Integer) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@ïîçﬁæ›¿∞åüïièàóùÅx
'       2012.03.18
'
'-------------------------------------------------------
Dim sts             As Integer



Dim SHIJI_No        As String * 8


Dim MENU_NO         As String * 2

Dim ans             As String * 1

Dim i               As Integer



    KENPIN_OSAKA_PROC = True

    Select Case ID_KANRI_TBL(ING_No).Step
        Case Step_Sagyo1_RES        'ÇPâÒñ⁄ÇÃéÛêMÅiéwê}ï[áÇÅj
            For i = 0 To M_Gyo - 1
                
                Select Case Trim(WEL_Para_Tbl(Ti, Tj).Wel_Para(i).LCD)
                    Case LCD_SHIJI_NO      'éwê}ï[áÇ
    
    
                        SHIJI_No = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        
                        
                        
                        Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, SHIJI_No)
                        
                        
                        sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
                        Select Case sts
                            Case BtNoErr
                            Case BtErrKeyNotFound
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äYìñÉfÅ[É^Ç»Çµ", "", "")
                                
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KENPIN_OSAKA_PROC = False
                                Exit Function
                            Case Else
                                Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                Sendbuf = Text_Create_Proc()
                                Exit Function
                        End Select
                        
                        
                
                        'ÉLÉÉÉìÉZÉãçœ
                        If StrConv(P_SSHIJI_O_REC.CANCEL_F, vbUnicode) = "1" Then
                            
                            
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "ÉLÉÉÉìÉZÉãçœ", "", "")
                            
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KENPIN_OSAKA_PROC = False
                            Exit Function
                        End If
                                                
                        'äÆóπçœ
                        If StrConv(P_SSHIJI_O_REC.KAN_F, vbUnicode) = "1" Then
                            Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME, "éwê}ï[áÇ:" & SHIJI_No, "äÆóπçœ", "", "")
                            Sendbuf = Text_Create_Proc()
                            ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                            KENPIN_OSAKA_PROC = False
                            Exit Function
                        End If
                        
                        
                        
                        
                        
                        ID_KANRI_TBL(ING_No).SHIJI_No = SHIJI_No
                        
                        ID_KANRI_TBL(ING_No).S_JGYOBU = StrConv(P_SSHIJI_O_REC.JGYOBU, vbUnicode)
                        ID_KANRI_TBL(ING_No).S_NAIGAI = StrConv(P_SSHIJI_O_REC.NAIGAI, vbUnicode)
                        
                        
                        
                        ID_KANRI_TBL(ING_No).Step = Step_Sagyo2_REQ
                        
                        
                        
                        '-----------------------------------------------ÉwÉbÉ_Å[
                        Send_Text.sts = Sts_OK                                  'ÉXÉeÅ[É^ÉXÅ@OK
                        ID_KANRI_TBL(ING_No).Send_Text.sts = Sts_OK
                
                        Send_Text.Display_Flg = Display_DEF                     'ï\é¶âÊñ ÉtÉâÉO í èÌì¸óÕâÊñ 
                        ID_KANRI_TBL(ING_No).Send_Text.Display_Flg = Display_DEF
                
                        Send_Text.End_Menu = Menu_Only                          'ç≈èIÉÅÉjÉÖÅ[ÉtÉâÉO
                        ID_KANRI_TBL(ING_No).Send_Text.End_Menu = Menu_Only
                
                        Send_Text.Menu_Suu = "05"                               'ÉÅÉjÉÖÅ[çÄñ⁄êîÅi05å≈íËÅj
                        ID_KANRI_TBL(ING_No).Send_Text.Menu_Suu = "05"
                
                        Send_Text.fileName = ""                                 'ëóêMÉfÅ[É^ÉtÉ@ÉCÉãñº
                        ID_KANRI_TBL(ING_No).Send_Text.fileName = ""
                
                        Send_Text.Buzzer = Buzzer_DEF                           'ÉuÉUÅ[âπÅ@ïWèÄ
                        ID_KANRI_TBL(ING_No).Send_Text.Buzzer = Buzzer_DEF
                        
                        '-----------------------------------------------ÇPçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(0).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Box_Type = TYPE_REF
                                                                                
                        Call UniCode_Conv(Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).LCD, ID_KANRI_TBL(ING_No).YOIN_LONG_DNAME)
                                                                                
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(0).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(0).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(0).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(0).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(0).MENU = ""
                        '-----------------------------------------------ÇQçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(1).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(1).LCD, "éwê}ï[áÇÅF" & SHIJI_No)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).LCD, "éwê}ï[áÇÅF" & SHIJI_No)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(1).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(1).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(1).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(1).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(1).MENU = ""
                        '-----------------------------------------------ÇRçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(2).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(2).LCD, Trim(StrConv(P_SSHIJI_O_REC.HIN_GAI, vbUnicode)))
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, Trim(StrConv(P_SSHIJI_O_REC.HIN_GAI, vbUnicode)))
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(2).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(2).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                                                                                
                        Send_Text.Box_Type(2).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                                                
                                                                                
                        Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(3).Box_Type = TYPE_REF
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Box_Type = TYPE_REF
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(3).LCD, LCD_SHIJI_END)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).LCD, LCD_SHIJI_END)
                                                                                'êîílèâä˙ï\é¶
                        Send_Text.Box_Type(3).INIT = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).INIT = ""
                                                                                'èâä˙ÉJÅ[É\Éãà íu
                        Send_Text.Box_Type(3).Start_Pos = ""
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Start_Pos = ""
                                                                                'ì¸óÕåÖêî
                        Send_Text.Box_Type(3).Max_Size = "00"
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).Max_Size = "00"
                                                                                
                        Send_Text.Box_Type(3).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(3).MENU = ""
                        '-----------------------------------------------ÇSçsñ⁄
                                                                                'BOXëÆê´
                        Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Box_Type = TYPE_BCNUM
                                                                                'ï\é¶ì‡óe
                        Call UniCode_Conv(Send_Text.Box_Type(4).LCD, LCD_CAN_ANS)
                        Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).LCD, LCD_CAN_ANS)
                                                                                
                        Send_Text.Box_Type(4).INIT = ""                         'êîílèâä˙ï\é¶
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).INIT = ""
                                                                                
                        Send_Text.Box_Type(4).Start_Pos = "20"                  'èâä˙ÉJÅ[É\Éãà íu
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Start_Pos = "20"
                                                                                
                         Send_Text.Box_Type(4).Max_Size = "01"                  'ì¸óÕåÖêî
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).Max_Size = "01"
                                                                                
                        Send_Text.Box_Type(4).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
                        ID_KANRI_TBL(ING_No).Send_Text.Box_Type(4).MENU = ""

                        Sendbuf = Text_Create_Proc()
                        KENPIN_OSAKA_PROC = False
                        Exit Function
                            
    
                End Select
            Next i
        
        Case Step_Sagyo2_RES        'ÇQâÒñ⁄ÇÃéÛêMÅiYES or NoÅj
            For i = 0 To M_Gyo - 1
            
                Select Case RTrim(StrConv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(i).LCD, vbUnicode))
                    Case LCD_CAN_ANS        'YES or No
                        ans = Trim(ID_KANRI_TBL(ING_No).Recv_text(i))
                        Select Case ans
                            Case "1"
                                
                                
                                '----------------------------------- ÉfÅ[É^çXêVèàóùäJén -----------
                                                                    
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìäJén
                                sts = BTRV(BtOpBeginConcurrentTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpBeginConcurrentTransaction, "", 0)
                                    Exit Function
                                End If
                                                                    
                                If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                                    MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                                            
                                Else
                                            
                                    MENU_NO = ""
                                End If
                                
                                
                                
                                If KENPIN_OSAKA_Update_PROC(Sendbuf) Then
                                    
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    GoTo Abort_Tran
                                End If
                                
                                
                                
                                                                    'ÉgÉâÉìÉUÉNÉVÉáÉìèIóπ
                                sts = BTRV(BtOpEndTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
                                If sts <> BtNoErr Then
                                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                                    Sendbuf = Text_Create_Proc()
                                    Call File_Error(sts, BtOpEndTransaction, "", 0)
                                    GoTo Abort_Tran
                                End If
                                
                                
                                
                                
                            Case "9"
                            Case Else
                                Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, ans, "(1 OR 9)", "Çì¸óÕÇµÇƒâ∫Ç≥Ç¢", "")
                                Sendbuf = Text_Create_Proc()
                                ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                                KENPIN_OSAKA_PROC = False
                                Exit Function
                        End Select
                         
                         
                         
                         
                End Select
            
            Next i
            'éüÇÃçÏã∆óvãÅ
            Call UniCode_Conv(K0_YOIN.CODE_TYPE, ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE)
            Call UniCode_Conv(K0_YOIN.YOIN_CODE, ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE)
            sts = BTRV(BtOpGetEqual, YOIN_POS, YOINREC, Len(YOINREC), K0_YOIN, Len(K0_YOIN), 0)
            Select Case sts
                Case BtNoErr
                '   -------------------------------- ÉGÉâÅ[ÉÅÉbÉZÅ[ÉWçÏê¨
                Case Else
                'èdóvÇ»óvàˆÇ»ÇÃÇ≈ñ¢ìoò^ÇÕÉVÉXÉeÉÄí‚é~Ç∆Ç∑ÇÈ
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    Call File_Error(sts, BtOpGetEqual, "óvàˆÉ}ÉXÉ^", 0)
                    Exit Function
            End Select

            ID_KANRI_TBL(ING_No).Step = Step_Sagyo1_REQ
            
            If Sagyo_Send_Proc() Then
                Sendbuf = Text_Create_Proc()
                Exit Function
            End If
        
            Sendbuf = Text_Create_Proc()
        
        
    End Select
        

    KENPIN_OSAKA_PROC = False
    Exit Function

Abort_Tran:
    
    sts = BTRV(BtOpAbortTransaction, ITEM_POS, ITEMREC, Len(ITEMREC), K0_ITEM, Len(K0_ITEM), 0)
    If sts <> BtNoErr Then
        Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
        Sendbuf = Text_Create_Proc()
        Call File_Error(sts, BtOpAbortTransaction, "", 0)
    End If

End Function

Private Function KENPIN_OSAKA_Update_PROC(Sendbuf As String) As Integer
'-------------------------------------------------------
'
'   ÅwëÂç„ÇoÇbÅ@ïîçﬁæ›¿∞åüïiçXêVèàóùÅx
'       2012.03.18
'
'-------------------------------------------------------
Dim sts             As Integer
Dim com             As Integer

Dim MENU_NO         As String * 2

Dim wkJgyobu        As String * 1

Dim SUMI_QTY        As Long         '2012.04.14
Dim MI_QTY          As Long         '2012.04.14


Dim SEQNO           As Integer      '2012.09.14


    KENPIN_OSAKA_Update_PROC = True


'-----------------------------------------------------------------------    éwê}ï[ÉfÅ[É^çXêV
    'éwê}ï[ÉfÅ[É^(ÕØ¿ﬁ∞)èàóù
    Call UniCode_Conv(K0_P_SSHIJI_O.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
    sts = BTRV(BtOpGetEqual, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
            
    Select Case sts
        Case BtNoErr
        
            
        Case Else
            Call File_Error(sts, BtOpGetEqual, "è§ïiâªéwê}ï[√ﬁ∞¿(êe)", 0)
            Exit Function
    End Select


    Call UniCode_Conv(K0_P_UKEHARAI.UKEHARAI_CODE, StrConv(P_SSHIJI_O_REC.UKEHARAI_CODE, vbUnicode))
    sts = BTRV(BtOpGetEqual, P_UKEHARAI_POS, P_UKEHARAIREC, Len(P_UKEHARAIREC), K0_P_UKEHARAI, Len(K0_P_UKEHARAI), 0)
        
    Select Case sts
        Case BtNoErr
        Case BtErrKeyNotFound
            Call UniCode_Conv(P_UKEHARAIREC.TORI_KBN, "0")
        Case Else
            Call File_Error(sts, BtOpGetEqual, "éÛï•êÊÉ}ÉXÉ^", 0)
            Exit Function
    End Select
    Call UniCode_Conv(P_SSHIJI_O_REC.TORI_KBN, StrConv(P_UKEHARAIREC.TORI_KBN, vbUnicode))

    Call UniCode_Conv(P_SSHIJI_O_REC.KAN_F, P_KAN_ON)                   'äÆóπÃ◊∏ﬁ
    Call UniCode_Conv(P_SSHIJI_O_REC.KAN_DT, Format(Now, "YYYYMMDD"))   'äÆóπì˙

    Call UniCode_Conv(P_SSHIJI_O_REC.BUNNOU_CNT, "00")                  'ï™î[âÒêî
                                                                            
    Call UniCode_Conv(P_SSHIJI_O_REC.S_TANTO, "")                       'é˚íPÅ^íSìñé“∏◊Ω
                                                                        'éÛì¸êîó 
    Call UniCode_Conv(P_SSHIJI_O_REC.UKEIRE_QTY, StrConv(P_SSHIJI_O_REC.SHIJI_QTY, vbUnicode))
                                                                        'çXêVì˙éû
    Call UniCode_Conv(P_SSHIJI_O_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))

    sts = BTRV(BtOpUpdate, P_SSHIJI_O_POS, P_SSHIJI_O_REC, Len(P_SSHIJI_O_REC), K0_P_SSHIJI_O, Len(K0_P_SSHIJI_O), 0)
    Select Case sts
        Case BtNoErr
        Case Else
            Call File_Error(sts, BtOpUpdate, "è§ïiâªéwê}√ﬁ∞¿(êe)", 0)
            Exit Function
    End Select
'-----------------------------------------------------------------------    éÛì¸óöó√ﬁ∞¿èàóù
        
        
        
        
    'éÛì¸óöó√ﬁ∞¿èàóù               2012.09.14  Å§
    Call UniCode_Conv(K0_P_SUKEIRE.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
    Call UniCode_Conv(K0_P_SUKEIRE.SEQNO, "")
    
    SEQNO = 0
    
    com = BtOpGetGreater
    
    Do
    
        sts = BTRV(com, P_SUKEIRE_POS, P_SUKEIRE_REC, Len(P_SUKEIRE_REC), K0_P_SUKEIRE, Len(K0_P_SUKEIRE), 0)
            
        Select Case sts
            Case BtNoErr
            
                If StrConv(P_SUKEIRE_REC.SHIJI_No, vbUnicode) <> ID_KANRI_TBL(ING_No).SHIJI_No Then
                    Exit Do
                End If
            
            Case BtErrEOF
                Exit Do
            
            Case Else
                Call File_Error(sts, BtOpUpdate, "è§ïiâªéÛì¸óöó", 0)
                Exit Function
        
        End Select
        
        
        
        SEQNO = SEQNO + 1
        
        
        com = BtOpGetNext
        
    Loop
    '                               2012.09.14Å@Å¢
        
        
        
        
        
    Call UniCode_Conv(P_SUKEIRE_REC.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)    'éwê}ï[áÇ
                                                                                'édå¸ÇØêÊ∫∞ƒﬁ
    Call UniCode_Conv(P_SUKEIRE_REC.SHIMUKE_CODE, StrConv(P_SSHIJI_O_REC.SHIMUKE_CODE, vbUnicode))
                                                                                'éÛì¸ì˙
    Call UniCode_Conv(P_SUKEIRE_REC.UKEIRE_DT, Format(Now, "YYYYMMDD"))
                                                                                'éÛì¸êîó 
    Call UniCode_Conv(P_SUKEIRE_REC.UKEIRE_QTY, StrConv(P_SSHIJI_O_REC.SHIJI_QTY, vbUnicode))
    
                                            
    Call UniCode_Conv(P_SUKEIRE_REC.LAST_F, P_UKEIRE_END)
                                                                                'éÊà¯êÊ
    Call UniCode_Conv(P_SUKEIRE_REC.TORI_CODE, StrConv(P_SSHIJI_O_REC.UKEHARAI_CODE, vbUnicode))
    'ëO1
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(4).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(4).TIMES, "000.00")
        
    'ëO2
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(5).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(5).TIMES, "000.00")
        
    'ëO3
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(6).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(6).TIMES, "000.00")
    
    'çÏã∆1
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(0).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(0).TIMES, "000.00")
        
    'çÏã∆2
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(1).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(1).TIMES, "000.00")
        
    'çÏã∆3
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(2).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(2).TIMES, "000.00")
        
    'å„1
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(7).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(7).TIMES, "000.00")
        
    'å„2
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(8).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(8).TIMES, "000.00")
        
    'â¡çH1
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(9).NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.GENKA_TBL(9).TIMES, "000.00")
        
        
    Call UniCode_Conv(P_SUKEIRE_REC.JISEKI_NAME, "")
    Call UniCode_Conv(P_SUKEIRE_REC.JISEKI_NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.JISEKI_TIMES, "000.00")
    
    Call UniCode_Conv(P_SUKEIRE_REC.TASEKI_NAME, "")
    Call UniCode_Conv(P_SUKEIRE_REC.TASEKI_NIN, "0.0")
    Call UniCode_Conv(P_SUKEIRE_REC.TASEKI_TIMES, "000.00")
                                                
    Call UniCode_Conv(P_SUKEIRE_REC.BIKOU, "")                                  'îıçl
        
    Call UniCode_Conv(P_SUKEIRE_REC.FILLER, "")
                                                                                'çXêVì˙éû
    Call UniCode_Conv(P_SUKEIRE_REC.UPD_DATETIME, Format(Now, "YYYYMMDD") & Format(Now, "HHMMSS"))
                                                                                'í«î‘
    Call UniCode_Conv(P_SUKEIRE_REC.SEQNO, "001")
            
    
    
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.09.14
'    sts = BTRV(BtOpInsert, P_SUKEIRE_POS, P_SUKEIRE_REC, Len(P_SUKEIRE_REC), K0_P_SUKEIRE, Len(K0_P_SUKEIRE), 0)
'    Select Case sts
'        Case BtNoErr
'        Case BtErrDuplicates
'            sts = BTRV(BtOpUpdate, P_SUKEIRE_POS, P_SUKEIRE_REC, Len(P_SUKEIRE_REC), K0_P_SUKEIRE, Len(K0_P_SUKEIRE), 0)
'            Select Case sts
'                Case BtNoErr
'                Case Else
'                    Call File_Error(sts, BtOpUpdate, "è§ïiâªéÛì¸óöó", 0)
'                    Exit Function
'            End Select
'        Case Else
'            Call File_Error(sts, BtOpInsert, "è§ïiâªéÛì¸óöó", 0)
'            Exit Function
'    End Select
 

    Do
            
        SEQNO = SEQNO + 1
                                                'í«î‘
        Call UniCode_Conv(P_SUKEIRE_REC.SEQNO, Format(SEQNO, "000"))
            
        DoEvents
            
        sts = BTRV(BtOpInsert, P_SUKEIRE_POS, P_SUKEIRE_REC, Len(P_SUKEIRE_REC), K0_P_SUKEIRE, Len(K0_P_SUKEIRE), 0)
        Select Case sts
            Case BtNoErr
                Exit Do
            Case BtErrDuplicates
            
            Case BtErrRECORD_INUSE, BtErrFILE_INUSE
                            
            Case Else
                Call File_Error(sts, BtOpInsert, "éÛì¸óöó", 0)
                Exit Function
        End Select
        
    Loop
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  2012.09.14




'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.26  çXêVèáÅ@ïœçX
'-----------------------------------------------------------------------    î≠íçåüì¢ÅFêeïîïiíçï∂ÉfÅ[É^çXêV
    If Trim(StrConv(P_SSHIJI_O_REC.ORDER_DT, vbUnicode) & StrConv(P_SSHIJI_O_REC.ORDER_DT_SEQ, vbUnicode)) <> "" Then
        Call UniCode_Conv(K6_ODR_ORDER.ORDER_NO, StrConv(P_SSHIJI_O_REC.ORDER_DT, vbUnicode) & StrConv(P_SSHIJI_O_REC.ORDER_DT_SEQ, vbUnicode))
        sts = BTRV(BtOpGetEqual, ODR_ORDER_POS, ODR_ORDER_REC, Len(ODR_ORDER_REC), K6_ODR_ORDER, Len(K6_ODR_ORDER), 6)
        Select Case sts
            Case BtNoErr
            Case BtErrKeyNotFound
                KENPIN_OSAKA_Update_PROC = False
                Exit Function
            Case Else
                Call File_Error(sts, BtOpGetEqual, "êeïiî‘Å@íçï∂Çe", 0)
                KENPIN_OSAKA_Update_PROC = SYS_ERR
                Exit Function
        End Select
    
    
        
        Call UniCode_Conv(ODR_ORDER_REC.UPD_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
        Call UniCode_Conv(ODR_ORDER_REC.FIN_DT, Format(Now, "YYYYMMDD"))
    
        Call UniCode_Conv(ODR_ORDER_REC.UPD_DT, Format(Now, "YYYYMMDD"))
        Call UniCode_Conv(ODR_ORDER_REC.UPD_TM, Format(Now, "HHMMSS"))
        Call UniCode_Conv(ODR_ORDER_REC.UPD_PG, App.EXEName)
        
        sts = BTRV(BtOpUpdate, ODR_ORDER_POS, ODR_ORDER_REC, Len(ODR_ORDER_REC), K6_ODR_ORDER, Len(K6_ODR_ORDER), 6)
        Select Case sts
            Case BtNoErr
            Case BtErrKeyNotFound
            Case Else
                Call File_Error(sts, BtOpUpdate, "êeïiî‘Å@íçï∂Çe", 0)
                KENPIN_OSAKA_Update_PROC = SYS_ERR
                Exit Function
        End Select
    End If
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.26





'-----------------------------------------------------------------------    éqïîïièoå…èàóù

    Call UniCode_Conv(K0_P_SSHIJI_K.SHIJI_No, ID_KANRI_TBL(ING_No).SHIJI_No)
    Call UniCode_Conv(K0_P_SSHIJI_K.DATA_KBN, "")
    Call UniCode_Conv(K0_P_SSHIJI_K.SEQNO, "")


    com = BtOpGetGreater

    Do
        DoEvents
        sts = BTRV(com, P_SSHIJI_K_POS, P_SSHIJI_K_REC, Len(P_SSHIJI_K_REC), K0_P_SSHIJI_K, Len(K0_P_SSHIJI_K), 0)
        Select Case sts
            Case BtNoErr
                If StrConv(P_SSHIJI_K_REC.SHIJI_No, vbUnicode) <> ID_KANRI_TBL(ING_No).SHIJI_No Then
                    Exit Do
                End If
            Case BtErrEOF
                Exit Do
            Case Else
                Call File_Error(sts, BtOpGetEqual + BtSNoWait, "éwê}ï[ÉfÅ[É^(éq)", 0)
                KENPIN_OSAKA_Update_PROC = SYS_ERR
                Exit Function
        End Select
    
    
        If Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI, vbUnicode)) = 9 Then
    
            If ID_KANRI_TBL(ING_No).SAGYO_LOG = "1" Then
                MENU_NO = ID_KANRI_TBL(ING_No).MENU_LV1
                        
            Else
                        
                MENU_NO = ""
            End If
    
    
    
                                            'èoå…çXêV
            If StrConv(P_SSHIJI_K_REC.KO_JGYOBU, vbUnicode) = SHIZAI Then
                wkJgyobu = BUZAI
                MI_QTY = Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI_QTY, vbUnicode))
                SUMI_QTY = 0
            Else
                wkJgyobu = StrConv(P_SSHIJI_K_REC.KO_JGYOBU, vbUnicode)
                SUMI_QTY = Val(StrConv(P_SSHIJI_K_REC.IDO_SUMI_QTY, vbUnicode))
                MI_QTY = 0
            End If
            
            
            
            
            
            sts = Syuko_Update_Proc(wkJgyobu, _
                                    ID_KANRI_TBL(ING_No).S_NAIGAI, _
                                    StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode), _
                                    "", _
                                    KENPIN_OSAKA_SOKO_No & "01" & "01" & "01", _
                                    (ID_KANRI_TBL(ING_No).Sagyo_Code.CODE_TYPE & ID_KANRI_TBL(ING_No).Sagyo_Code.YOIN_CODE), _
                                    SUMI_QTY, _
                                    MI_QTY, _
                                    0, _
                                    Format(ID_KANRI_TBL(ING_No).ID, "000"), _
                                    ID_KANRI_TBL(ING_No).TANTO_CODE, _
                                    FILE_RETRY, ID_KANRI_TBL(ING_No).SHIJI_No, , , , , , MENU_NO)
            Select Case sts
                Case False
                
                Case True       'ç›å…ïsë´éûÇ…î≠ê∂
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, KENPIN_OSAKA_SOKO_No & "-01-01-01", RTrim(StrConv(P_SSHIJI_K_REC.KO_HIN_GAI, vbUnicode)), "ç›å…êîïsë´", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                    Exit Function
                Case SYS_CANCEL
                    Call Err_Send_Proc(ID_KANRI_TBL(ING_No).YOIN_DNAME, "èàóùíÜíf", "", "", "")
                    Sendbuf = Text_Create_Proc()
                    ID_KANRI_TBL(ING_No).Step = ID_KANRI_TBL(ING_No).Step - 1
                    
                
                    Exit Function
                Case SYS_ERR
                    Sendbuf = Text_Create_Proc()
                    Call Err_Send_Proc("ÉVÉXÉeÉÄàŸèÌî≠ê∂", "", "", "", "")
                    KENPIN_OSAKA_Update_PROC = SYS_ERR    'ÉVÉXÉeÉÄàŸèÌî≠ê∂
                    
                    Exit Function
            End Select
        End If
    
        com = BtOpGetNext
    
    Loop


'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.26  çXêVèáÅ@ïœçX
'-----------------------------------------------------------------------    î≠íçåüì¢ÅFêeïîïiíçï∂ÉfÅ[É^çXêV
'
'    Call UniCode_Conv(K6_ODR_ORDER.ORDER_NO, StrConv(P_SSHIJI_O_REC.ORDER_DT, vbUnicode) & StrConv(P_SSHIJI_O_REC.ORDER_DT_SEQ, vbUnicode))
'    sts = BTRV(BtOpGetEqual, ODR_ORDER_POS, ODR_ORDER_REC, Len(ODR_ORDER_REC), K6_ODR_ORDER, Len(K6_ODR_ORDER), 6)
'    Select Case sts
'        Case BtNoErr
'        Case BtErrKeyNotFound
'            KENPIN_OSAKA_Update_PROC = False
'            Exit Function
'        Case Else
'            Call File_Error(sts, BtOpGetEqual, "êeïiî‘Å@íçï∂Çe", 0)
'            KENPIN_OSAKA_Update_PROC = SYS_ERR
'            Exit Function
'    End Select
'
'
'
'    Call UniCode_Conv(ODR_ORDER_REC.UPD_TANTO, ID_KANRI_TBL(ING_No).TANTO_CODE)
'    Call UniCode_Conv(ODR_ORDER_REC.FIN_DT, Format(Now, "YYYYMMDD"))
'
'    Call UniCode_Conv(ODR_ORDER_REC.UPD_DT, Format(Now, "YYYYMMDD"))
'    Call UniCode_Conv(ODR_ORDER_REC.UPD_TM, Format(Now, "HHMMSS"))
'    Call UniCode_Conv(ODR_ORDER_REC.UPD_PG, App.EXEName)
'
'    sts = BTRV(BtOpUpdate, ODR_ORDER_POS, ODR_ORDER_REC, Len(ODR_ORDER_REC), K6_ODR_ORDER, Len(K6_ODR_ORDER), 6)
'    Select Case sts
'        Case BtNoErr
'        Case BtErrKeyNotFound
'        Case Else
'            Call File_Error(sts, BtOpUpdate, "êeïiî‘Å@íçï∂Çe", 0)
'            KENPIN_OSAKA_Update_PROC = SYS_ERR
'            Exit Function
'    End Select
'>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>   2012.12.26  çXêVèáÅ@ïœçX
    

    
    
    
    KENPIN_OSAKA_Update_PROC = False
    


End Function




Private Sub Text2_Change(Index As Integer)
    
    Label3.Caption = ""             '2012.11.06

End Sub

Private Sub Text2_GotFocus(Index As Integer)
    Text2(Index) = Trim(Text2(Index).Text)
    Text2(Index).SelStart = 0
    Text2(Index).SelLength = Len(Text2(Index).Text)
End Sub

Private Sub Text2_LostFocus(Index As Integer)
    
    Text2(0).Text = Format(Val(Text2(0).Text), "00")
    Text2(1).Text = Format(Val(Text2(1).Text), "00")

End Sub

Private Sub Timer1_Timer()
'-------------------------------------------------------
'
'   ÅwèIóπäƒéãÉ^ÉCÉ}Å[Åx
'       2012.05.18
'
'-------------------------------------------------------
    Timer1.Enabled = False
    
    
    If Text2(0).Text & Text2(1).Text = Format(Time, "HHMM") Then
        Command1(2).Value = True
    End If
    Timer1.Enabled = True
End Sub


Private Sub Wel_OKURI_SAKI_PROC()
    Send_Text.Box_Type(2).Box_Type = TYPE_REF
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Box_Type = TYPE_REF
                                                            'ï\é¶ì‡óe
    Call UniCode_Conv(Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
    Call UniCode_Conv(ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).LCD, ID_KANRI_TBL(ING_No).KEN_OKURI_SAKI)
                                                            'êîílèâä˙ï\é¶
    Send_Text.Box_Type(2).INIT = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).INIT = ""
                                                            'èâä˙ÉJÅ[É\Éãà íu
    Send_Text.Box_Type(2).Start_Pos = ""
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Start_Pos = ""
                                                            'ì¸óÕåÖêî
    Send_Text.Box_Type(2).Max_Size = "00"
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).Max_Size = "00"
                                                            
    Send_Text.Box_Type(2).MENU = ""                         'ÉÅÉjÉÖÅ\î‘çÜ
    ID_KANRI_TBL(ING_No).Send_Text.Box_Type(2).MENU = ""

End Sub

Private Function Fueikae_Read_Proc(Hinban As String, Hinban_GO As String) As Integer
'-------------------------------------------------------
'
'   Åwïiî‘êUë÷œΩ¿ì«çûÇ›Åx
'       2012.12.27
'
'-------------------------------------------------------
Dim wkVal1  As Integer
Dim wkVal2  As Integer
    
Dim sts     As Integer
    
    
    Fueikae_Read_Proc = True

        



    Hinban_GO = ""



    wkVal1 = ToRoundDown(CCur(1 / Val(StrConv(P_SSHIJI_K_REC.KO_QTY, vbUnicode))), 0)



    Call UniCode_Conv(K0_FURIKAE.JGYOBU_MAE, BUZAI)
    Call UniCode_Conv(K0_FURIKAE.NAIGAI_MAE, NAIGAI_NAI)
    Call UniCode_Conv(K0_FURIKAE.HIN_MAE, Hinban)

    Call UniCode_Conv(K0_FURIKAE.JGYOBU_GO, BUZAI)
    Call UniCode_Conv(K0_FURIKAE.NAIGAI_GO, NAIGAI_NAI)
    Call UniCode_Conv(K0_FURIKAE.HIN_GO, Trim(Hinban) & "-" & Format(wkVal1, "0"))
    
    sts = BTRV(BtOpGetEqual, FURIKAE_POS, FURIKAEREC, Len(FURIKAEREC), K0_FURIKAE, Len(K0_FURIKAE), 0)
    Select Case sts
        Case BtNoErr
            Hinban_GO = StrConv(FURIKAEREC.HIN_GO, vbUnicode)
        Case BtErrKeyNotFound
        Case Else
            Call File_Error(sts, BtOpGetEqual, "ïiî‘êUë÷", 0)
            Fueikae_Read_Proc = SYS_ERR
            Exit Function
    End Select
    

    Fueikae_Read_Proc = False
End Function

